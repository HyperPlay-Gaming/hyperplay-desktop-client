LavaPack.loadBundle([[2511,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=self.location?self.location.protocol+"//"+self.location.host:"",s=self.URL;t.exports={URLWithLegacySupport:class{constructor(e="",t=n){this.super=new s(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:n,format:function(e){if("string"==typeof e){return new s(e).toString()}if(!(e instanceof s)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",s=e.protocol?e.protocol+"//":"",a=e.host||"",i=e.hostname||"",o=e.search||(e.query?"?"+e.query:""),c=e.hash||"",u=e.pathname||"";return`${s}${t||r}${a||i+n}${e.path||u+o}${c}`}}}}}},{package:"eth-lattice-keyring>gridplus-sdk>borc>iso-url",file:"node_modules/iso-url/src/url-browser.js"}],[2513,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){return t=t||"and",r=r||", ",e.length<2?e[0]||"":(t.slice(0,2)===r?2==e.length&&(t=t.slice(1)):t=" "+t,e.slice(0,-1).join(r)+t+" "+e[e.length-1])}}}},{package:"@segment/loosely-validate-event>join-component",file:"node_modules/join-component/index.js"}],[2514,{buffer:1768},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):function(){const t=e.Base64,r=n();r.noConflict=()=>(e.Base64=t,r),e.Meteor&&(Base64=r),e.Base64=r}()}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:this,(function(){const t="3.6.1",r="function"==typeof atob,n="function"==typeof btoa,s="function"==typeof e,a="function"==typeof TextDecoder?new TextDecoder:undefined,i="function"==typeof TextEncoder?new TextEncoder:undefined,o=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],c=(e=>{let t={};return e.forEach(((e,r)=>t[e]=r)),t})(o),u=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,d=String.fromCharCode.bind(String),l="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),h=e=>e.replace(/[+\/]/g,(e=>"+"==e?"-":"_")).replace(/=+$/m,""),p=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),f=e=>{let t,r,n,s,a="";const i=e.length%3;for(let i=0;i<e.length;){if((r=e.charCodeAt(i++))>255||(n=e.charCodeAt(i++))>255||(s=e.charCodeAt(i++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|s,a+=o[t>>18&63]+o[t>>12&63]+o[t>>6&63]+o[63&t]}return i?a.slice(0,i-3)+"===".substring(i):a},m=n?e=>btoa(e):s?t=>e.from(t,"binary").toString("base64"):f,g=s?t=>e.from(t).toString("base64"):e=>{let t=[];for(let r=0,n=e.length;r<n;r+=4096)t.push(d.apply(null,e.subarray(r,r+4096)));return m(t.join(""))},y=(e,t=!1)=>t?h(g(e)):g(e),E=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?d(192|t>>>6)+d(128|63&t):d(224|t>>>12&15)+d(128|t>>>6&63)+d(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return d(240|t>>>18&7)+d(128|t>>>12&63)+d(128|t>>>6&63)+d(128|63&t)},b=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,T=e=>e.replace(b,E),_=s?t=>e.from(t,"utf8").toString("base64"):i?e=>g(i.encode(e)):e=>m(T(e)),v=(e,t=!1)=>t?h(_(e)):_(e),w=e=>v(e,!0),S=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,k=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return d(55296+(t>>>10))+d(56320+(1023&t));case 3:return d((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return d((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},A=e=>e.replace(S,k),P=e=>{if(e=e.replace(/\s+/g,""),!u.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,r,n,s="";for(let a=0;a<e.length;)t=c[e.charAt(a++)]<<18|c[e.charAt(a++)]<<12|(r=c[e.charAt(a++)])<<6|(n=c[e.charAt(a++)]),s+=64===r?d(t>>16&255):64===n?d(t>>16&255,t>>8&255):d(t>>16&255,t>>8&255,255&t);return s},x=r?e=>atob(p(e)):s?t=>e.from(t,"base64").toString("binary"):P,M=s?t=>l(e.from(t,"base64")):e=>l(x(e),(e=>e.charCodeAt(0))),R=e=>M(O(e)),I=s?t=>e.from(t,"base64").toString("utf8"):a?e=>a.decode(M(e)):e=>A(x(e)),O=e=>p(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),C=e=>I(O(e)),N=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),L=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,N(t));e("fromBase64",(function(){return C(this)})),e("toBase64",(function(e){return v(this,e)})),e("toBase64URI",(function(){return v(this,!0)})),e("toBase64URL",(function(){return v(this,!0)})),e("toUint8Array",(function(){return R(this)}))},j=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,N(t));e("toBase64",(function(e){return y(this,e)})),e("toBase64URI",(function(){return y(this,!0)})),e("toBase64URL",(function(){return y(this,!0)}))},D={version:t,VERSION:"3.6.1",atob:x,atobPolyfill:P,btoa:m,btoaPolyfill:f,fromBase64:C,toBase64:v,encode:v,encodeURI:w,encodeURL:w,utob:T,btou:A,decode:C,isValid:e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/=+$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:y,toUint8Array:R,extendString:L,extendUint8Array:j,extendBuiltins:()=>{L(),j()},Base64:{}};return Object.keys(D).forEach((e=>D.Base64[e]=D[e])),D}))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ensdomains/content-hash>js-base64",file:"node_modules/js-base64/base64.js"}],[2518,{"@metamask/safe-event-emitter":1162,"eth-rpc-errors":1994},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.JsonRpcEngine=void 0;const s=n(e("@metamask/safe-event-emitter")),a=e("eth-rpc-errors");class i extends s.default{constructor(){super(),this._middleware=[]}push(e){this._middleware.push(e)}handle(e,t){if(t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,n)=>{try{const[s,a,o]=await i._runAllMiddleware(e,t,this._middleware);return a?(await i._runReturnHandlers(o),n(s)):r((async e=>{try{await i._runReturnHandlers(o)}catch(t){return e(t)}return e()}))}catch(e){return n(e)}}}async _handleBatch(e,t){try{const r=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}}_promiseHandle(e){return new Promise((t=>{this._handle(e,((e,r)=>{t(r)}))}))}async _handle(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){const r=new a.EthereumRpcError(a.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(r,{id:undefined,jsonrpc:"2.0",error:r})}if("string"!=typeof e.method){const r=new a.EthereumRpcError(a.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return t(r,{id:e.id,jsonrpc:"2.0",error:r})}const r=Object.assign({},e),n={id:r.id,jsonrpc:r.jsonrpc};let s=null;try{await this._processRequest(r,n)}catch(e){s=e}return s&&(delete n.result,n.error||(n.error=a.serializeError(s))),t(s,n)}async _processRequest(e,t){const[r,n,s]=await i._runAllMiddleware(e,t,this._middleware);if(i._checkForCompletion(e,t,n),await i._runReturnHandlers(s),r)throw r}static async _runAllMiddleware(e,t,r){const n=[];let s=null,a=!1;for(const o of r)if([s,a]=await i._runMiddleware(e,t,o,n),a)break;return[s,a,n.reverse()]}static _runMiddleware(e,t,r,n){return new Promise((s=>{const i=e=>{const r=e||t.error;r&&(t.error=a.serializeError(r)),s([r,!0])},c=r=>{t.error?i(t.error):(r&&("function"!=typeof r&&i(new a.EthereumRpcError(a.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof r}" for request:\n${o(e)}`,{request:e})),n.push(r)),s([null,!1]))};try{r(e,t,c,i)}catch(e){i(e)}}))}static async _runReturnHandlers(e){for(const t of e)await new Promise(((e,r)=>{t((t=>t?r(t):e()))}))}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new a.EthereumRpcError(a.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${o(e)}`,{request:e});if(!r)throw new a.EthereumRpcError(a.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${o(e)}`,{request:e})}}function o(e){return JSON.stringify(e,null,2)}r.JsonRpcEngine=i}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/JsonRpcEngine.js"}],[2519,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createAsyncMiddleware=void 0,r.createAsyncMiddleware=function(e){return async(t,r,n,s)=>{let a;const i=new Promise((e=>{a=e}));let o=null,c=!1;const u=async()=>{c=!0,n((e=>{o=e,a()})),await i};try{await e(t,r,u),c?(await i,o(null)):s(null)}catch(e){o?o(e):s(e)}}}}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/createAsyncMiddleware.js"}],[2520,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createScaffoldMiddleware=void 0,r.createScaffoldMiddleware=function(e){return(t,r,n,s)=>{const a=e[t.method];return a===undefined?n():"function"==typeof a?a(t,r,n,s):(r.result=a,s())}}}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/createScaffoldMiddleware.js"}],[2521,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getUniqueId=void 0;const n=4294967295;let s=Math.floor(Math.random()*n);r.getUniqueId=function(){return s=(s+1)%n,s}}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/getUniqueId.js"}],[2522,{"./getUniqueId":2521},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createIdRemapMiddleware=void 0;const n=e("./getUniqueId");r.createIdRemapMiddleware=function(){return(e,t,r,s)=>{const a=e.id,i=n.getUniqueId();e.id=i,t.id=i,r((r=>{e.id=a,t.id=a,r()}))}}}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/idRemapMiddleware.js"}],[2523,{"./JsonRpcEngine":2518,"./createAsyncMiddleware":2519,"./createScaffoldMiddleware":2520,"./getUniqueId":2521,"./idRemapMiddleware":2522,"./mergeMiddleware":2524},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./idRemapMiddleware"),r),s(e("./createAsyncMiddleware"),r),s(e("./createScaffoldMiddleware"),r),s(e("./getUniqueId"),r),s(e("./JsonRpcEngine"),r),s(e("./mergeMiddleware"),r)}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/index.js"}],[2524,{"./JsonRpcEngine":2518},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mergeMiddleware=void 0;const n=e("./JsonRpcEngine");r.mergeMiddleware=function(e){const t=new n.JsonRpcEngine;return e.forEach((e=>t.push(e))),t.asMiddleware()}}}},{package:"json-rpc-engine",file:"node_modules/json-rpc-engine/dist/mergeMiddleware.js"}],[2525,{"readable-stream":2990},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});const n=e("readable-stream");r.default=function(e){if(!e||!e.engine)throw new Error("Missing engine parameter!");const{engine:t}=e,r=new n.Duplex({objectMode:!0,read:()=>undefined,write:function(e,n,s){t.handle(e,((e,t)=>{r.push(t)})),s()}});return t.on&&t.on("notification",(e=>{r.push(e)})),r}}}},{package:"json-rpc-middleware-stream",file:"node_modules/json-rpc-middleware-stream/dist/createEngineStream.js"}],[2526,{"@metamask/safe-event-emitter":1162,"readable-stream":2990},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const s=n(e("@metamask/safe-event-emitter")),a=e("readable-stream");r.default=function(e={}){const t={},r=new a.Duplex({objectMode:!0,read:()=>undefined,write:function(r,s,a){let o=null;try{!r.id?function(r){(null==e?void 0:e.retryOnMessage)&&r.method===e.retryOnMessage&&Object.values(t).forEach((({req:e,retryCount:r=0})=>{if(e.id){if(r>=3)throw new Error(`StreamMiddleware - Retry limit exceeded for request id "${e.id}"`);t[e.id].retryCount=r+1,i(e)}}));n.emit("notification",r)}(r):function(e){const r=t[e.id];if(!r)return void console.warn(`StreamMiddleware - Unknown response id "${e.id}"`);delete t[e.id],Object.assign(r.res,e),setTimeout(r.end)}(r)}catch(e){o=e}a(o)}}),n=new s.default;return{events:n,middleware:(e,r,n,s)=>{i(e),t[e.id]={req:e,res:r,next:n,end:s}},stream:r};function i(e){r.push(e)}}}}},{package:"json-rpc-middleware-stream",file:"node_modules/json-rpc-middleware-stream/dist/createStreamMiddleware.js"}],[2527,{"./createEngineStream":2525,"./createStreamMiddleware":2526},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createStreamMiddleware=r.createEngineStream=void 0;const s=n(e("./createEngineStream"));r.createEngineStream=s.default;const a=n(e("./createStreamMiddleware"));r.createStreamMiddleware=a.default}}},{package:"json-rpc-middleware-stream",file:"node_modules/json-rpc-middleware-stream/dist/index.js"}],[2529,{jsonify:2530},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof JSON?JSON:e("jsonify");t.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r=t.space||"";"number"==typeof r&&(r=Array(r+1).join(" "));var i,o="boolean"==typeof t.cycles&&t.cycles,c=t.replacer||function(e,t){return t},u=t.cmp&&(i=t.cmp,function(e){return function(t,r){var n={key:t,value:e[t]},s={key:r,value:e[r]};return i(n,s)}}),d=[];return function e(t,i,l,h){var p=r?"\n"+new Array(h+1).join(r):"",f=r?": ":":";if(l&&l.toJSON&&"function"==typeof l.toJSON&&(l=l.toJSON()),(l=c.call(t,i,l))!==undefined){if("object"!=typeof l||null===l)return n.stringify(l);if(s(l)){for(var m=[],g=0;g<l.length;g++){var y=e(l,g,l[g],h+1)||n.stringify(null);m.push(p+r+y)}return"["+m.join(",")+p+"]"}if(-1!==d.indexOf(l)){if(o)return n.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}d.push(l);var E=a(l).sort(u&&u(l));for(m=[],g=0;g<E.length;g++){var b=e(l,i=E[g],l[i],h+1);if(b){var T=n.stringify(i)+f+b;m.push(p+r+T)}}return d.splice(d.indexOf(l),1),"{"+m.join(",")+p+"}"}}({"":e},"",e,0)};var s=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},a=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r}}}},{package:"lavamoat>json-stable-stringify",file:"node_modules/json-stable-stringify/index.js"}],[2530,{"./lib/parse":2531,"./lib/stringify":2532},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.parse=e("./lib/parse"),r.stringify=e("./lib/stringify")}}},{package:"lavamoat>json-stable-stringify>jsonify",file:"node_modules/jsonify/index.js"}],[2531,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,a,i,o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c=function(e){throw{name:"SyntaxError",message:e,at:n,text:a}},u=function(e){return e&&e!==s&&c("Expected '"+e+"' instead of '"+s+"'"),s=a.charAt(n),n+=1,s},d=function(){var e,t="";for("-"===s&&(t="-",u("-"));s>="0"&&s<="9";)t+=s,u();if("."===s)for(t+=".";u()&&s>="0"&&s<="9";)t+=s;if("e"===s||"E"===s)for(t+=s,u(),"-"!==s&&"+"!==s||(t+=s,u());s>="0"&&s<="9";)t+=s,u();if(e=+t,isFinite(e))return e;c("Bad number")},l=function(){var e,t,r,n="";if('"'===s)for(;u();){if('"'===s)return u(),n;if("\\"===s)if(u(),"u"===s){for(r=0,t=0;t<4&&(e=parseInt(u(),16),isFinite(e));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else{if("string"!=typeof o[s])break;n+=o[s]}else n+=s}c("Bad string")},h=function(){for(;s&&s<=" ";)u()};i=function(){switch(h(),s){case"{":return function(){var e,t={};if("{"===s){if(u("{"),h(),"}"===s)return u("}"),t;for(;s;){if(e=l(),h(),u(":"),Object.hasOwnProperty.call(t,e)&&c('Duplicate key "'+e+'"'),t[e]=i(),h(),"}"===s)return u("}"),t;u(","),h()}}c("Bad object")}();case"[":return function(){var e=[];if("["===s){if(u("["),h(),"]"===s)return u("]"),e;for(;s;){if(e.push(i()),h(),"]"===s)return u("]"),e;u(","),h()}}c("Bad array")}();case'"':return l();case"-":return d();default:return s>="0"&&s<="9"?d():function(){switch(s){case"t":return u("t"),u("r"),u("u"),u("e"),!0;case"f":return u("f"),u("a"),u("l"),u("s"),u("e"),!1;case"n":return u("n"),u("u"),u("l"),u("l"),null}c("Unexpected '"+s+"'")}()}},t.exports=function(e,t){var r;return a=e,n=0,s=" ",r=i(),h(),s&&c("Syntax error"),"function"==typeof t?function e(r,n){var s,a,i=r[n];if(i&&"object"==typeof i)for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&((a=e(i,s))!==undefined?i[s]=a:delete i[s]);return t.call(r,n,i)}({"":r},""):r}}}},{package:"lavamoat>json-stable-stringify>jsonify",file:"node_modules/jsonify/lib/parse.js"}],[2532,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,a,i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function c(e){return i.lastIndex=0,i.test(e)?'"'+e.replace(i,(function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function u(e,t){var r,i,o,d,l,h=n,p=t[e];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(e)),"function"==typeof a&&(p=a.call(t,e,p)),typeof p){case"string":return c(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(n+=s,l=[],"[object Array]"===Object.prototype.toString.apply(p)){for(d=p.length,r=0;r<d;r+=1)l[r]=u(r,p)||"null";return o=0===l.length?"[]":n?"[\n"+n+l.join(",\n"+n)+"\n"+h+"]":"["+l.join(",")+"]",n=h,o}if(a&&"object"==typeof a)for(d=a.length,r=0;r<d;r+=1)"string"==typeof(i=a[r])&&(o=u(i,p))&&l.push(c(i)+(n?": ":":")+o);else for(i in p)Object.prototype.hasOwnProperty.call(p,i)&&(o=u(i,p))&&l.push(c(i)+(n?": ":":")+o);return o=0===l.length?"{}":n?"{\n"+n+l.join(",\n"+n)+"\n"+h+"}":"{"+l.join(",")+"}",n=h,o}}t.exports=function(e,t,r){var i;if(n="",s="","number"==typeof r)for(i=0;i<r;i+=1)s+=" ";else"string"==typeof r&&(s=r);if(a=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return u("",{"":e})}}}},{package:"lavamoat>json-stable-stringify>jsonify",file:"node_modules/jsonify/lib/stringify.js"}],[2533,{"./helpers":2534},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./helpers"),s=n.ValidatorResult,a=n.SchemaError,i={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0}},o=i.validators={};function c(e,t,r,n,s){var a=t.throwError;t.throwError=!1;var i=this.validateSchema(e,s,t,r);return t.throwError=a,!i.valid&&n instanceof Function&&n(i),i.valid}function u(e,t,r,n,s,a){if(this.types.object(e)&&(!t.properties||t.properties[s]===undefined))if(!1===t.additionalProperties)a.addError({name:"additionalProperties",argument:s,message:"additionalProperty "+JSON.stringify(s)+" exists in instance when not allowed"});else{var i=t.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,s,i,r,n);var o=this.validateSchema(e[s],i,r,n.makeChild(i,s));o.instance!==a.instance[s]&&(a.instance[s]=o.instance),a.importErrors(o)}}o.type=function(e,t,r,n){if(e===undefined)return null;var a=new s(e,t,r,n),i=Array.isArray(t.type)?t.type:[t.type];if(!i.some(this.testType.bind(this,e,t,r,n))){var o=i.map((function(e){return e.id&&"<"+e.id+">"||e+""}));a.addError({name:"type",argument:o,message:"is not of a type(s) "+o})}return a},o.anyOf=function(e,t,r,n){if(e===undefined)return null;var i=new s(e,t,r,n),o=new s(e,t,r,n);if(!Array.isArray(t.anyOf))throw new a("anyOf must be an array");if(!t.anyOf.some(c.bind(this,e,r,n,(function(e){o.importErrors(e)})))){var u=t.anyOf.map((function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));r.nestedErrors&&i.importErrors(o),i.addError({name:"anyOf",argument:u,message:"is not any of "+u.join(",")})}return i},o.allOf=function(e,t,r,n){if(e===undefined)return null;if(!Array.isArray(t.allOf))throw new a("allOf must be an array");var i=new s(e,t,r,n),o=this;return t.allOf.forEach((function(t,s){var a=o.validateSchema(e,t,r,n);if(!a.valid){var c=t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+s+"]";i.addError({name:"allOf",argument:{id:c,length:a.errors.length,valid:a},message:"does not match allOf schema "+c+" with "+a.errors.length+" error[s]:"}),i.importErrors(a)}})),i},o.oneOf=function(e,t,r,n){if(e===undefined)return null;if(!Array.isArray(t.oneOf))throw new a("oneOf must be an array");var i=new s(e,t,r,n),o=new s(e,t,r,n),u=t.oneOf.filter(c.bind(this,e,r,n,(function(e){o.importErrors(e)}))).length,d=t.oneOf.map((function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));return 1!==u&&(r.nestedErrors&&i.importErrors(o),i.addError({name:"oneOf",argument:d,message:"is not exactly one from "+d.join(",")})),i},o.properties=function(e,t,r,n){if(this.types.object(e)){var a=new s(e,t,r,n),i=t.properties||{};for(var o in i){"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,o,i[o],r,n);var c=Object.hasOwnProperty.call(e,o)?e[o]:undefined,u=this.validateSchema(c,i[o],r,n.makeChild(i[o],o));u.instance!==a.instance[o]&&(a.instance[o]=u.instance),a.importErrors(u)}return a}},o.patternProperties=function(e,t,r,n){if(this.types.object(e)){var a=new s(e,t,r,n),i=t.patternProperties||{};for(var o in e){var c=!0;for(var d in i){if(new RegExp(d).test(o)){c=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,o,i[d],r,n);var l=this.validateSchema(e[o],i[d],r,n.makeChild(i[d],o));l.instance!==a.instance[o]&&(a.instance[o]=l.instance),a.importErrors(l)}}c&&u.call(this,e,t,r,n,o,a)}return a}},o.additionalProperties=function(e,t,r,n){if(this.types.object(e)){if(t.patternProperties)return null;var a=new s(e,t,r,n);for(var i in e)u.call(this,e,t,r,n,i,a);return a}},o.minProperties=function(e,t,r,n){if(this.types.object(e)){var a=new s(e,t,r,n);return Object.keys(e).length>=t.minProperties||a.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),a}},o.maxProperties=function(e,t,r,n){if(this.types.object(e)){var a=new s(e,t,r,n);return Object.keys(e).length<=t.maxProperties||a.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),a}},o.items=function(e,t,r,n){var a=this;if(this.types.array(e)&&t.items){var i=new s(e,t,r,n);return e.every((function(e,s){var o=Array.isArray(t.items)?t.items[s]||t.additionalItems:t.items;if(o===undefined)return!0;if(!1===o)return i.addError({name:"items",message:"additionalItems not permitted"}),!1;var c=a.validateSchema(e,o,r,n.makeChild(o,s));return c.instance!==i.instance[s]&&(i.instance[s]=c.instance),i.importErrors(c),!0})),i}},o.minimum=function(e,t,r,n){if(this.types.number(e)){var a=new s(e,t,r,n);return(t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum:e>=t.minimum)||a.addError({name:"minimum",argument:t.minimum,message:"must have a minimum value of "+t.minimum}),a}},o.maximum=function(e,t,r,n){if(this.types.number(e)){var a=new s(e,t,r,n);return(t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum:e<=t.maximum)||a.addError({name:"maximum",argument:t.maximum,message:"must have a maximum value of "+t.maximum}),a}};var d=function(e,t,r,i,o,c){if(this.types.number(e)){var u=t[o];if(0==u)throw new a(o+" cannot be zero");var d=new s(e,t,r,i),l=n.getDecimalPlaces(e),h=n.getDecimalPlaces(u),p=Math.max(l,h),f=Math.pow(10,p);return Math.round(e*f)%Math.round(u*f)!=0&&d.addError({name:o,argument:u,message:c+JSON.stringify(u)}),d}};function l(e,t,r){var s,a=r.length;for(s=t+1;s<a;s++)if(n.deepCompareStrict(e,r[s]))return!1;return!0}o.multipleOf=function(e,t,r,n){return d.call(this,e,t,r,n,"multipleOf","is not a multiple of (divisible by) ")},o.divisibleBy=function(e,t,r,n){return d.call(this,e,t,r,n,"divisibleBy","is not divisible by (multiple of) ")},o.required=function(e,t,r,n){var a=new s(e,t,r,n);return e===undefined&&!0===t.required?a.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach((function(t){e[t]===undefined&&a.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})})),a},o.pattern=function(e,t,r,n){if(this.types.string(e)){var a=new s(e,t,r,n);return e.match(t.pattern)||a.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern)}),a}},o.format=function(e,t,r,a){if(e!==undefined){var i=new s(e,t,r,a);return i.disableFormat||n.isFormat(e,t.format,this)||i.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),i}},o.minLength=function(e,t,r,n){if(this.types.string(e)){var a=new s(e,t,r,n),i=e.match(/[\uDC00-\uDFFF]/g);return e.length-(i?i.length:0)>=t.minLength||a.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),a}},o.maxLength=function(e,t,r,n){if(this.types.string(e)){var a=new s(e,t,r,n),i=e.match(/[\uDC00-\uDFFF]/g);return e.length-(i?i.length:0)<=t.maxLength||a.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),a}},o.minItems=function(e,t,r,n){if(this.types.array(e)){var a=new s(e,t,r,n);return e.length>=t.minItems||a.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),a}},o.maxItems=function(e,t,r,n){if(this.types.array(e)){var a=new s(e,t,r,n);return e.length<=t.maxItems||a.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),a}},o.uniqueItems=function(e,t,r,a){if(this.types.array(e)){var i=new s(e,t,r,a);return e.every((function(e,t,r){for(var s=t+1;s<r.length;s++)if(n.deepCompareStrict(e,r[s]))return!1;return!0}))||i.addError({name:"uniqueItems",message:"contains duplicate item"}),i}},o.uniqueItems=function(e,t,r,n){if(this.types.array(e)){var a=new s(e,t,r,n);return e.every(l)||a.addError({name:"uniqueItems",message:"contains duplicate item"}),a}},o.dependencies=function(e,t,r,n){if(this.types.object(e)){var a=new s(e,t,r,n);for(var i in t.dependencies)if(e[i]!==undefined){var o=t.dependencies[i],c=n.makeChild(o,i);if("string"==typeof o&&(o=[o]),Array.isArray(o))o.forEach((function(t){e[t]===undefined&&a.addError({name:"dependencies",argument:c.propertyPath,message:"property "+t+" not found, required by "+c.propertyPath})}));else{var u=this.validateSchema(e,o,r,c);a.instance!==u.instance&&(a.instance=u.instance),u&&u.errors.length&&(a.addError({name:"dependencies",argument:c.propertyPath,message:"does not meet dependency required by "+c.propertyPath}),a.importErrors(u))}}return a}},o.enum=function(e,t,r,i){if(e===undefined)return null;if(!Array.isArray(t.enum))throw new a("enum expects an array",t);var o=new s(e,t,r,i);return t.enum.some(n.deepCompareStrict.bind(null,e))||o.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),o},o.const=function(e,t,r,a){if(e===undefined)return null;var i=new s(e,t,r,a);return n.deepCompareStrict(t.const,e)||i.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),i},o.not=o.disallow=function(e,t,r,n){var a=this;if(e===undefined)return null;var i=new s(e,t,r,n),o=t.not||t.disallow;return o?(Array.isArray(o)||(o=[o]),o.forEach((function(s){if(a.testType(e,t,r,n,s)){var o=s&&s.id&&"<"+s.id+">"||s;i.addError({name:"not",argument:o,message:"is of prohibited type "+o})}})),i):null},t.exports=i}}},{package:"jsonschema",file:"node_modules/jsonschema/lib/attribute.js"}],[2534,{url:3149},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("url"),s=r.ValidationError=function(e,t,r,n,s,a){n&&(this.property=n),e&&(this.message=e),r&&(r.id?this.schema=r.id:this.schema=r),t&&(this.instance=t),this.name=s,this.argument=a,this.stack=this.toString()};s.prototype.toString=function(){return this.property+" "+this.message};var a=r.ValidatorResult=function(e,t,r,n){this.instance=e,this.schema=t,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.disableFormat=r&&!0===r.disableFormat};function i(e,t){return t+": "+e.toString()+"\n"}a.prototype.addError=function(e){var t;if("string"==typeof e)t=new s(e,this.instance,this.schema,this.propertyPath);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new s(e.message,this.instance,this.schema,this.propertyPath,e.name,e.argument)}if(this.throwError)throw t;return this.errors.push(t),t},a.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&Array.prototype.push.apply(this.errors,e.errors)},a.prototype.toString=function(e){return this.errors.map(i).join("")},Object.defineProperty(a.prototype,"valid",{get:function(){return!this.errors.length}});var o=r.SchemaError=function e(t,r){this.message=t,this.schema=r,Error.call(this,t),Error.captureStackTrace(this,e)};o.prototype=Object.create(Error.prototype,{constructor:{value:o,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var c=r.SchemaContext=function(e,t,r,n,s){this.schema=e,this.options=t,this.propertyPath=r,this.base=n,this.schemas=s};c.prototype.resolve=function(e){return n.resolve(this.base,e)},c.prototype.makeChild=function(e,t){var r=t===undefined?this.propertyPath:this.propertyPath+d(t),s=n.resolve(this.base,e.id||""),a=new c(e,this.options,r,s,Object.create(this.schemas));return e.id&&!a.schemas[s]&&(a.schemas[s]=e),a};var u=r.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};u.regexp=u.regex,u.pattern=u.regex,u.ipv4=u["ip-address"],r.isFormat=function(e,t,r){if("string"==typeof e&&u[t]!==undefined){if(u[t]instanceof RegExp)return u[t].test(e);if("function"==typeof u[t])return u[t](e)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[t])return r.customFormats[t](e);return!0};var d=r.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function l(e,t,r,n){"object"==typeof r?t[n]=f(e[n],r):-1===e.indexOf(r)&&t.push(r)}function h(e,t,r){t[r]=e[r]}function p(e,t,r,n){"object"==typeof t[n]&&t[n]&&e[n]?r[n]=f(e[n],t[n]):r[n]=t[n]}function f(e,t){var r=Array.isArray(t),n=r&&[]||{};return r?(e=e||[],n=n.concat(e),t.forEach(l.bind(null,e,n))):(e&&"object"==typeof e&&Object.keys(e).forEach(h.bind(null,e,n)),Object.keys(t).forEach(p.bind(null,e,t,n))),n}function m(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}r.deepCompareStrict=function e(t,r){if(typeof t!=typeof r)return!1;if(t instanceof Array)return r instanceof Array&&(t.length===r.length&&t.every((function(n,s){return e(t[s],r[s])})));if("object"==typeof t){if(!t||!r)return t===r;var n=Object.keys(t),s=Object.keys(r);return n.length===s.length&&n.every((function(n){return e(t[n],r[n])}))}return t===r},t.exports.deepMerge=f,r.objectGetPath=function(e,t){for(var r,n=t.split("/").slice(1);"string"==typeof(r=n.shift());){var s=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(s in e))return;e=e[s]}return e},r.encodePath=function(e){return e.map(m).join("")},r.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var r=e.toString().split("e");if(2===r.length){if("-"!==r[1][0])return t;t=Number(r[1].slice(1))}var n=r[0].split(".");return 2===n.length&&(t+=n[1].length),t}}}},{package:"jsonschema",file:"node_modules/jsonschema/lib/helpers.js"}],[2535,{"./helpers":2534,"./scan":2536,"./validator":2537},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=t.exports.Validator=e("./validator");t.exports.ValidatorResult=e("./helpers").ValidatorResult,t.exports.ValidationError=e("./helpers").ValidationError,t.exports.SchemaError=e("./helpers").SchemaError,t.exports.SchemaScanResult=e("./scan").SchemaScanResult,t.exports.scan=e("./scan").scan,t.exports.validate=function(e,t,r){return(new n).validate(e,t,r)}}}},{package:"jsonschema",file:"node_modules/jsonschema/lib/index.js"}],[2536,{"./helpers":2534,url:3149},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("url"),s=e("./helpers");function a(e,t){this.id=e,this.ref=t}t.exports.SchemaScanResult=a,t.exports.scan=function(e,t){function r(e,t){if(t&&"object"==typeof t)if(t.$ref){var a=n.resolve(e,t.$ref);u[a]=u[a]?u[a]+1:0}else{var d=t.id?n.resolve(e,t.id):e;if(d){if(d.indexOf("#")<0&&(d+="#"),c[d]){if(!s.deepCompareStrict(c[d],t))throw new Error("Schema <"+t+"> already exists with different definition");return c[d]}c[d]=t,"#"==d[d.length-1]&&(c[d.substring(0,d.length-1)]=t)}i(d+"/items",t.items instanceof Array?t.items:[t.items]),i(d+"/extends",t.extends instanceof Array?t.extends:[t.extends]),r(d+"/additionalItems",t.additionalItems),o(d+"/properties",t.properties),r(d+"/additionalProperties",t.additionalProperties),o(d+"/definitions",t.definitions),o(d+"/patternProperties",t.patternProperties),o(d+"/dependencies",t.dependencies),i(d+"/disallow",t.disallow),i(d+"/allOf",t.allOf),i(d+"/anyOf",t.anyOf),i(d+"/oneOf",t.oneOf),r(d+"/not",t.not)}}function i(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++)r(e+"/"+n,t[n])}function o(e,t){if(t&&"object"==typeof t)for(var n in t)r(e+"/"+n,t[n])}var c={},u={};return r(e,t),new a(c,u)}}}},{package:"jsonschema",file:"node_modules/jsonschema/lib/scan.js"}],[2537,{"./attribute":2533,"./helpers":2534,"./scan":2536,url:3149},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("url"),s=e("./attribute"),a=e("./helpers"),i=e("./scan").scan,o=a.ValidatorResult,c=a.SchemaError,u=a.SchemaContext,d=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(h),this.attributes=Object.create(s.validators)};function l(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}d.prototype.customFormats={},d.prototype.schemas=null,d.prototype.types=null,d.prototype.attributes=null,d.prototype.unresolvedRefs=null,d.prototype.addSchema=function(e,t){var r=this;if(!e)return null;var n=i(t||"/",e),s=t||e.id;for(var a in n.id)this.schemas[a]=n.id[a];for(var a in n.ref)this.unresolvedRefs.push(a);return this.unresolvedRefs=this.unresolvedRefs.filter((function(e){return void 0===r.schemas[e]})),this.schemas[s]},d.prototype.addSubSchemaArray=function(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++)this.addSubSchema(e,t[r])},d.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var r in t)this.addSubSchema(e,t[r])},d.prototype.setSchemas=function(e){this.schemas=e},d.prototype.getSchema=function(e){return this.schemas[e]},d.prototype.validate=function(e,t,r,s){r||(r={});var a=r.propertyName||"instance",o=n.resolve(r.base||"/",t.id||"");if(!s){(s=new u(t,r,a,o,Object.create(this.schemas))).schemas[o]||(s.schemas[o]=t);var d=i(o,t);for(var l in d.id){var h=d.id[l];s.schemas[l]=h}}if(t){var p=this.validateSchema(e,t,r,s);if(!p)throw new Error("Result undefined");return p}throw new c("no schema specified",t)},d.prototype.validateSchema=function(e,t,r,n){var i,d=new o(e,t,r,n);if("boolean"==typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(t.extends instanceof Array){var h={schema:t,ctx:n};t.extends.forEach(this.schemaTraverser.bind(this,h)),t=h.schema,h.schema=null,h.ctx=null,h=null}else t=a.deepMerge(t,this.superResolve(t.extends,n));if(i=l(t)){var p=this.resolve(t,i,n),f=new u(p.subschema,r,n.propertyPath,p.switchSchema,n.schemas);return this.validateSchema(e,p.subschema,r,f)}var m=r&&r.skipAttributes||[];for(var g in t)if(!s.ignoreProperties[g]&&m.indexOf(g)<0){var y=null,E=this.attributes[g];if(E)y=E.call(this,e,t,r,n);else if(!1===r.allowUnknownAttributes)throw new c("Unsupported attribute: "+g,t);y&&d.importErrors(y)}if("function"==typeof r.rewrite){var b=r.rewrite.call(this,e,t,r,n);d.instance=b}return d},d.prototype.schemaTraverser=function(e,t){e.schema=a.deepMerge(e.schema,this.superResolve(t,e.ctx))},d.prototype.superResolve=function(e,t){var r;return(r=l(e))?this.resolve(e,r,t).subschema:e},d.prototype.resolve=function(e,t,r){if(t=r.resolve(t),r.schemas[t])return{subschema:r.schemas[t],switchSchema:t};var s=n.parse(t),i=s&&s.hash,o=i&&i.length&&t.substr(0,t.length-i.length);if(!o||!r.schemas[o])throw new c("no such schema <"+t+">",e);var u=a.objectGetPath(r.schemas[o],i.substr(1));if(u===undefined)throw new c("no such schema "+i+" located in <"+o+">",e);return{subschema:u,switchSchema:t}},d.prototype.testType=function(e,t,r,n,s){if("function"==typeof this.types[s])return this.types[s].call(this,e);if(s&&"object"==typeof s){var a=this.validateSchema(e,s,r,n);return a===undefined||!(a&&a.errors.length)}return!0};var h=d.prototype.types={};h.string=function(e){return"string"==typeof e},h.number=function(e){return"number"==typeof e&&isFinite(e)},h.integer=function(e){return"number"==typeof e&&e%1==0},h.boolean=function(e){return"boolean"==typeof e},h.array=function(e){return Array.isArray(e)},h.null=function(e){return null===e},h.date=function(e){return e instanceof Date},h.any=function(e){return!0},h.object=function(e){return e&&"object"==typeof e&&!(e instanceof Array)&&!(e instanceof Date)},t.exports=d}}},{package:"jsonschema",file:"node_modules/jsonschema/lib/validator.js"}],[26,{"../../../../shared/constants/permissions":3210,reselect:3001},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var n=e("reselect"),s=e("../../../../shared/constants/permissions");const a=(0,n.createSelector)((e=>e.subjects),(e=>Object.values(e).reduce(((e,t)=>{var r,n;const a=null===(r=t.permissions)||void 0===r||null===(n=r.eth_accounts)||void 0===n?void 0:n.caveats.find((({type:e})=>e===s.CaveatTypes.restrictReturnedAccounts));return a&&e.set(t.origin,a.value),e}),new Map)));r.getPermittedAccountsByOrigin=a;r.getChangedAccounts=(e,t)=>{if(t===undefined)return e;const r=new Map;if(e===t)return r;const n=new Set([...e.keys()]);for(const a of t.keys()){var s;const i=null!==(s=e.get(a))&&void 0!==s?s:[];t.get(a)!==i&&r.set(a,i),n.delete(a)}for(const t of n.keys())r.set(t,e.get(t));return r}}}},{package:"$root$",file:"app/scripts/controllers/permissions/selectors.js"}],[2604,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=Math.max,s=Math.min;t.exports=function(e,t,r){return e>=s(t,r)&&e<n(t,r)}}}},{package:"lodash",file:"node_modules/lodash/_baseInRange.js"}],[2623,{"./_trimmedEndIndex":2703},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_trimmedEndIndex"),s=/^\s+/;t.exports=function(e){return e?e.slice(0,n(e)+1).replace(s,""):e}}}},{package:"lodash",file:"node_modules/lodash/_baseTrim.js"}],[27,{"../../../../shared/constants/permissions":3210,"@metamask/permission-controller":1146},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var n=e("@metamask/permission-controller"),s=e("../../../../shared/constants/permissions");const a=Object.freeze({...s.RestrictedMethods}),i=Object.freeze({[s.CaveatTypes.restrictReturnedAccounts]:e=>({type:s.CaveatTypes.restrictReturnedAccounts,value:e})});r.getCaveatSpecifications=({getIdentities:e})=>({[s.CaveatTypes.restrictReturnedAccounts]:{type:s.CaveatTypes.restrictReturnedAccounts,decorator:(e,t)=>async r=>(await e(r)).filter((e=>t.value.includes(e))).slice(0,1),validator:(t,r,n)=>function(e,t){if(!Array.isArray(e)||0===e.length)throw new Error(`${a.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=t();e.forEach((e=>{if(!e||"string"!=typeof e)throw new Error(`${a.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${e}".`);if(!r[e])throw new Error(`${a.eth_accounts} error: Received unrecognized address: "${e}".`)}))}(t.value,e)}});r.getPermissionSpecifications=({getAllAccounts:e,getIdentities:t,captureKeyringTypesWithMissingIdentities:r})=>({[a.eth_accounts]:{permissionType:n.PermissionType.RestrictedMethod,targetKey:a.eth_accounts,allowedCaveats:[s.CaveatTypes.restrictReturnedAccounts],factory:(e,t)=>{if(Array.isArray(e.caveats))throw new Error(`${a.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!t.approvedAccounts)throw new Error(`${a.eth_accounts} error: No approved accounts specified.`);return(0,n.constructPermission)({...e,caveats:[i[s.CaveatTypes.restrictReturnedAccounts](t.approvedAccounts)]})},methodImplementation:async n=>{const s=await e(),a=t();return s.sort(((e,t)=>{if(!a[e])throw r(a,s),new Error(`Missing identity for address: "${e}".`);if(!a[t])throw r(a,s),new Error(`Missing identity for address: "${t}".`);return a[e].lastSelected===a[t].lastSelected?0:a[e].lastSelected===undefined?1:a[t].lastSelected===undefined?-1:a[t].lastSelected-a[e].lastSelected}))},validator:(e,t,r)=>{const{caveats:n}=e;if(!n||1!==n.length||n[0].type!==s.CaveatTypes.restrictReturnedAccounts)throw new Error(`${a.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${s.CaveatTypes.restrictReturnedAccounts}".`)}}});const o=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_subscribe","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","eth_unsubscribe","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3"]);r.unrestrictedMethods=o}}},{package:"$root$",file:"app/scripts/controllers/permissions/specifications.js"}],[2703,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=/\s/;t.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}}}},{package:"lodash",file:"node_modules/lodash/_trimmedEndIndex.js"}],[2710,{"./_baseInRange":2604,"./toFinite":2739,"./toNumber":2741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseInRange"),s=e("./toFinite"),a=e("./toNumber");t.exports=function(e,t,r){return t=s(t),r===undefined?(r=t,t=0):r=s(r),e=a(e),n(e,t,r)}}}},{package:"lodash",file:"node_modules/lodash/inRange.js"}],[2716,{"./_baseKeys":2614,"./_getTag":2655,"./_isPrototype":2670,"./isArguments":2711,"./isArray":2712,"./isArrayLike":2713,"./isBuffer":2715,"./isTypedArray":2728},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseKeys"),s=e("./_getTag"),a=e("./isArguments"),i=e("./isArray"),o=e("./isArrayLike"),c=e("./isBuffer"),u=e("./_isPrototype"),d=e("./isTypedArray"),l=Object.prototype.hasOwnProperty;t.exports=function(e){if(null==e)return!0;if(o(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||d(e)||a(e)))return!e.length;var t=s(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!n(e).length;for(var r in e)if(l.call(e,r))return!1;return!0}}}},{package:"lodash",file:"node_modules/lodash/isEmpty.js"}],[2719,{"./toInteger":2740},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./toInteger");t.exports=function(e){return"number"==typeof e&&e==n(e)}}}},{package:"lodash",file:"node_modules/lodash/isInteger.js"}],[2732,{"./_baseAssignValue":2594,"./_baseForOwn":2599,"./_baseIteratee":2613},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseAssignValue"),s=e("./_baseForOwn"),a=e("./_baseIteratee");t.exports=function(e,t){var r={};return t=a(t,3),s(e,(function(e,s,a){n(r,s,t(e,s,a))})),r}}}},{package:"lodash",file:"node_modules/lodash/mapValues.js"}],[2739,{"./toNumber":2741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./toNumber"),s=1/0;t.exports=function(e){return e?(e=n(e))===s||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}}}},{package:"lodash",file:"node_modules/lodash/toFinite.js"}],[2740,{"./toFinite":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./toFinite");t.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}}}},{package:"lodash",file:"node_modules/lodash/toInteger.js"}],[2741,{"./_baseTrim":2623,"./isObject":2723,"./isSymbol":2727},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseTrim"),s=e("./isObject"),a=e("./isSymbol"),i=0/0,o=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,d=parseInt;t.exports=function(e){if("number"==typeof e)return e;if(a(e))return i;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=c.test(e);return r||u.test(e)?d(e.slice(2),r?2:8):o.test(e)?i:+e}}}},{package:"lodash",file:"node_modules/lodash/toNumber.js"}],[2753,{"./util":2757},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{encodeText:n}=e("./util");t.exports=class{constructor(e,t,r,s){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=s,this.codec=r(s)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/base.js"}],[2754,{"./base.js":2753,"./rfc4648":2756,"./util":2757,"@multiformats/base-x":1189},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@multiformats/base-x"),s=e("./base.js"),{rfc4648:a}=e("./rfc4648"),{decodeText:i,encodeText:o}=e("./util"),c=[["identity","\0",()=>({encode:i,decode:o}),""],["base2","0",a(1),"01"],["base8","7",a(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",a(4),"0123456789abcdef"],["base16upper","F",a(4),"0123456789ABCDEF"],["base32hex","v",a(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",a(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",a(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",a(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",a(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=c.reduce(((e,t)=>(e[t[0]]=new s(t[0],t[1],t[2],t[3]),e)),{}),d=c.reduce(((e,t)=>(e[t[1]]=u[t[0]],e)),{});t.exports={names:u,codes:d}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/constants.js"}],[2755,{"./constants":2754,"./util":2757},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./constants"),{encodeText:s,decodeText:a,concat:i}=e("./util");function o(e){if(Object.prototype.hasOwnProperty.call(n.names,e))return n.names[e];if(Object.prototype.hasOwnProperty.call(n.codes,e))return n.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=t.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");const{name:r,codeBuf:n}=o(e);return function(e,t){o(e).decode(a(t))}(r,t),i([n,t],n.length+t.length)}).encode=function(e,t){const r=o(e),n=s(r.encode(t));return i([r.codeBuf,n],r.codeBuf.length+n.length)},r.decode=function(e){e instanceof Uint8Array&&(e=a(e));const t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),o(e[0]).decode(e.substring(1))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=a(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return o(e[0]).name}catch(e){return!1}},r.encoding=o,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=a(e)),o(e[0])};const c=Object.freeze(n.names),u=Object.freeze(n.codes);r.names=c,r.codes=u}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/index.js"}],[2756,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let a="",i=0,o=0;for(let n=0;n<e.length;++n)for(o=o<<8|e[n],i+=8;i>r;)i-=r,a+=t[s&o>>i];if(i&&(a+=t[s&o<<r-i]),n)for(;a.length*r&7;)a+="=";return a})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const a=new Uint8Array(s*r/8|0);let i=0,o=0,c=0;for(let t=0;t<s;++t){const s=n[e[t]];if(s===undefined)throw new SyntaxError("Invalid character "+e[t]);o=o<<r|s,i+=r,i>=8&&(i-=8,a[c++]=255&o>>i)}if(i>=r||255&o<<8-i)throw new SyntaxError("Unexpected end of data");return a})(r,t,e)})}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/rfc4648.js"}],[2757,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=new TextDecoder,s=new TextEncoder;t.exports={decodeText:e=>n.decode(e),encodeText:e=>s.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/util.js"}],[2758,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r){var n,s=0,a=0,i=r=r||0,o=t.length;do{if(i>=o||a>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[i++],s+=a<28?(127&n)<<a:(127&n)*Math.pow(2,a),a+=7}while(n>=128);return e.bytes=i-r,s}}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/decode.js"}],[2759,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r,s){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");r=r||[];var a=s=s||0;for(;t>=n;)r[s++]=255&t|128,t/=128;for(;-128&t;)r[s++]=255&t|128,t>>>=7;return r[s]=0|t,e.bytes=s-a+1,r};var n=Math.pow(2,31)}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/encode.js"}],[2760,{"./decode.js":2758,"./encode.js":2759,"./length.js":2761},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/index.js"}],[2761,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=Math.pow(2,7),s=Math.pow(2,14),a=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),c=Math.pow(2,42),u=Math.pow(2,49),d=Math.pow(2,56),l=Math.pow(2,63);t.exports=function(e){return e<n?1:e<s?2:e<a?3:e<i?4:e<o?5:e<c?6:e<u?7:e<d?8:e<l?9:10}}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/length.js"}],[2762,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});t.exports={baseTable:n}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/generated-table.js"}],[2763,{"./maps":2764,"./util":2765,"uint8arrays/concat":3141,varint:2760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("varint"),s=e("uint8arrays/concat"),a=e("./util"),{nameToVarint:i,constantToCode:o,nameToCode:c,codeToName:u}=e("./maps");function d(e){const t=n.decode(e),r=u[t];if(r===undefined)throw new Error(`Code "${t}" not found`);return r}function l(e){return u[e]}function h(e){const t=c[e];if(t===undefined)throw new Error(`Codec "${e}" not found`);return t}function p(e){return n.decode(e)}function f(e){const t=i[e];if(t===undefined)throw new Error(`Codec "${e}" not found`);return t}function m(e){return a.varintEncode(e)}t.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=a.varintUint8ArrayEncode(e);else{if(!i[e])throw new Error("multicodec not recognized");r=i[e]}return s([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getNameFromData:d,getNameFromCode:l,getCodeFromName:h,getCodeFromData:p,getVarintFromName:f,getVarintFromCode:m,getCodec:function(e){return d(e)},getName:function(e){return l(e)},getNumber:function(e){return h(e)},getCode:function(e){return p(e)},getCodeVarint:function(e){return f(e)},getVarint:function(e){return Array.from(m(e))},...o,nameToVarint:i,nameToCode:c,codeToName:u}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/index.js"}],[2764,{"./generated-table":2762,"./util":2765},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./generated-table"),s=e("./util").varintEncode,a={},i={},o={};for(const e in n){const t=e,r=n[t];a[t]=s(r);i[t.toUpperCase().replace(/-/g,"_")]=r,o[r]||(o[r]=t)}Object.freeze(a),Object.freeze(i),Object.freeze(o);const c=Object.freeze(n);t.exports={nameToVarint:a,constantToCode:i,nameToCode:c,codeToName:o}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/maps.js"}],[2765,{"uint8arrays/from-string":3143,"uint8arrays/to-string":3144,varint:2760},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("varint"),s=e("uint8arrays/to-string"),a=e("uint8arrays/from-string");function i(e){return parseInt(s(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return a(t,"base16")},uint8ArrayToNumber:i,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(i(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/util.js"}],[2783,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){for(var n=self.crypto||self.msCrypto,s="-_",a=36;a--;)s+=a.toString(36);for(a=36;a---10;)s+=a.toString(36).toUpperCase();t.exports=function(e){var t="",r=n.getRandomValues(new Uint8Array(e||21));for(a=e||21;a--;)t+=s[63&r[a]];return t}}}},{package:"nanoid",file:"node_modules/nanoid/index.browser.js"}],[2788,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();t.exports=r=n.fetch,n.fetch&&(r.default=n.fetch.bind(n)),r.Headers=n.Headers,r.Request=n.Request,r.Response=n.Response}}},{package:"node-fetch",file:"node_modules/node-fetch/browser.js"}],[2791,{assert:1535,"await-semaphore":1543,"ethjs-query":2073},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("ethjs-query"),s=e("assert"),a=e("await-semaphore").Mutex;t.exports=class{constructor({provider:e,blockTracker:t,getPendingTransactions:r,getConfirmedTransactions:s}){this.provider=e,this.blockTracker=t,this.ethQuery=new n(e),this.getPendingTransactions=r,this.getConfirmedTransactions=s,this.lockMap={}}async getGlobalLock(){const e=this._lookupMutex("global");return{releaseLock:await e.acquire()}}async getNonceLock(e){await this._globalMutexFree();const t=await this._takeMutex(e);try{const r={},n=await this._getNetworkNextNonce(e),a=this._getHighestLocallyConfirmed(e),i=n.nonce,o=Math.max(i,a),c=this.getPendingTransactions(e),u=this._getHighestContinuousFrom(c,o)||0;r.params={highestLocallyConfirmed:a,highestSuggested:o,nextNetworkNonce:i},r.local=u,r.network=n;const d=Math.max(n.nonce,u.nonce);return s(Number.isInteger(d),`nonce-tracker - nextNonce is not an integer - got: (${typeof d}) "${d}"`),{nextNonce:d,nonceDetails:r,releaseLock:t}}catch(e){throw t(),e}}async _globalMutexFree(){const e=this._lookupMutex("global");(await e.acquire())()}async _takeMutex(e){const t=this._lookupMutex(e);return await t.acquire()}_lookupMutex(e){let t=this.lockMap[e];return t||(t=new a,this.lockMap[e]=t),t}async _getNetworkNextNonce(e){const t=await this.blockTracker.getLatestBlock(),r=(await this.ethQuery.getTransactionCount(e,t)).toNumber();s(Number.isInteger(r),`nonce-tracker - baseCount is not an integer - got: (${typeof r}) "${r}"`);return{name:"network",nonce:r,details:{blockNumber:t,baseCount:r}}}_getHighestLocallyConfirmed(e){const t=this.getConfirmedTransactions(e),r=this._getHighestNonce(t);return Number.isInteger(r)?r+1:0}_getHighestNonce(e){const t=e.map((e=>{const t=e.txParams.nonce;return s(typeof t,"string","nonces should be hex strings"),parseInt(t,16)}));return Math.max.apply(null,t)}_getHighestContinuousFrom(e,t){const r=e.map((e=>{const t=e.txParams.nonce;return s(typeof t,"string","nonces should be hex strings"),parseInt(t,16)}));let n=t;for(;r.includes(n);)n++;return{name:"local",nonce:n,details:{startPoint:t,highest:n}}}}}}},{package:"nonce-tracker",file:"node_modules/nonce-tracker/index.js"}],[28,{"../../../shared/constants/hardware-wallets":3206,"../../../shared/constants/network":3209,"../../../shared/constants/preferences":3211,"../../../shared/modules/network.utils":3236,"./network":18,"@metamask/obs-store":1139,"eth-sig-util":1996},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store"),s=e("eth-sig-util"),a=e("../../../shared/constants/network"),i=e("../../../shared/modules/network.utils"),o=e("../../../shared/constants/hardware-wallets"),c=e("../../../shared/constants/preferences"),u=e("./network");r.default=class{constructor(e={}){const t={frequentRpcListDetail:[],useBlockie:!1,useNonceField:!1,usePhishDetect:!0,dismissSeedBackUpReminder:!1,disabledRpcMethodPreferences:{eth_sign:!1},useMultiAccountBalanceChecker:!0,useTokenDetection:!1,useNftDetection:!1,useCurrencyRateCheck:!0,openSeaEnabled:!1,advancedGasFee:null,featureFlags:{showIncomingTransactions:!0},knownMethodData:{},currentLocale:e.initLangCode,identities:{},lostIdentities:{},forgottenPassword:!1,preferences:{autoLockTimeLimit:undefined,showFiatInTestnets:!1,showTestNetworks:!1,useNativeCurrencyAsPrimaryCurrency:!0,hideZeroBalanceTokens:!1},ipfsGateway:a.IPFS_DEFAULT_GATEWAY_URL,infuraBlocked:null,ledgerTransportType:window.navigator.hid?o.LedgerTransportTypes.webhid:o.LedgerTransportTypes.u2f,transactionSecurityCheckEnabled:!1,theme:c.ThemeType.os,...e.initState};this.network=e.network,this.store=new n.ObservableStore(t),this.store.setMaxListeners(13),this.openPopup=e.openPopup,this.tokenListController=e.tokenListController,this._subscribeToInfuraAvailability(),global.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.store.updateState({forgottenPassword:e})}setUseBlockie(e){this.store.updateState({useBlockie:e})}setUseNonceField(e){this.store.updateState({useNonceField:e})}setUsePhishDetect(e){this.store.updateState({usePhishDetect:e})}setUseMultiAccountBalanceChecker(e){this.store.updateState({useMultiAccountBalanceChecker:e})}setUseTokenDetection(e){this.store.updateState({useTokenDetection:e}),this.tokenListController.updatePreventPollingOnNetworkRestart(!e),e?this.tokenListController.start():(this.tokenListController.clearingTokenListData(),this.tokenListController.stop())}setUseNftDetection(e){this.store.updateState({useNftDetection:e})}setUseCurrencyRateCheck(e){this.store.updateState({useCurrencyRateCheck:e})}setOpenSeaEnabled(e){this.store.updateState({openSeaEnabled:e})}setAdvancedGasFee(e){this.store.updateState({advancedGasFee:e})}setTheme(e){this.store.updateState({theme:e})}setTransactionSecurityCheckEnabled(e){this.store.updateState({transactionSecurityCheckEnabled:e})}addKnownMethodData(e,t){const{knownMethodData:r}=this.store.getState();r[e]=t,this.store.updateState({knownMethodData:r})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.store.updateState({currentLocale:e,textDirection:t}),t}setAddresses(e){const t=this.store.getState().identities,r=e.reduce(((e,r,n)=>{const s=t[r]||{};return e[r]={name:`Account ${n+1}`,address:r,...s},e}),{});this.store.updateState({identities:r})}removeAddress(e){const{identities:t}=this.store.getState();if(!t[e])throw new Error(`${e} can't be deleted cause it was not found`);if(delete t[e],this.store.updateState({identities:t}),e===this.getSelectedAddress()){const[e]=Object.keys(t);this.setSelectedAddress(e)}return e}addAddresses(e){const{identities:t}=this.store.getState();e.forEach((e=>{if(t[e])return;const r=Object.keys(t).length;t[e]={name:`Account ${r+1}`,address:e}})),this.store.updateState({identities:t})}syncAddresses(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array of addresses. Error #11201");const{identities:t,lostIdentities:r}=this.store.getState(),n={};Object.keys(t).forEach((r=>{e.includes(r)||(n[r]=t[r],delete t[r])})),Object.keys(n).length>0&&Object.keys(n).forEach((e=>{r[e]=n[e]})),this.store.updateState({identities:t,lostIdentities:r}),this.addAddresses(e);let s=this.getSelectedAddress();return e.includes(s)||([s]=e,this.setSelectedAddress(s)),s}setSelectedAddress(e){const t=(0,s.normalize)(e),{identities:r}=this.store.getState(),n=r[t];if(!n)throw new Error(`Identity for '${t} not found`);n.lastSelected=Date.now(),this.store.updateState({identities:r,selectedAddress:t})}getSelectedAddress(){return this.store.getState().selectedAddress}async setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const r=(0,s.normalize)(e),{identities:n}=this.store.getState();return n[r]=n[r]||{},n[r].name=t,this.store.updateState({identities:n}),t}upsertToFrequentRpcList(e,t,r="ETH",n="",s={}){const a=this.getFrequentRpcListDetail(),o=a.findIndex((t=>t.rpcUrl===e));if(-1===o){if(!(0,i.isPrefixedFormattedHexString)(t))throw new Error(`Invalid chainId: "${t}"`);a.push({rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:s}),this.store.updateState({frequentRpcListDetail:a})}else a.splice(o,1,{rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:s})}async removeFromFrequentRpcList(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e));return-1!==r&&t.splice(r,1),this.store.updateState({frequentRpcListDetail:t}),t}getFrequentRpcListDetail(){return this.store.getState().frequentRpcListDetail}async setFeatureFlag(e,t){const r={...this.store.getState().featureFlags,[e]:t};return this.store.updateState({featureFlags:r}),r}async setPreference(e,t){const r={...this.getPreferences(),[e]:t};return this.store.updateState({preferences:r}),r}getPreferences(){return this.store.getState().preferences}getIpfsGateway(){return this.store.getState().ipfsGateway}async setIpfsGateway(e){return this.store.updateState({ipfsGateway:e}),e}setLedgerTransportPreference(e){return this.store.updateState({ledgerTransportType:e}),e}getLedgerTransportPreference(){return this.store.getState().ledgerTransportType}async setDismissSeedBackUpReminder(e){await this.store.updateState({dismissSeedBackUpReminder:e})}async setDisabledRpcMethodPreference(e,t){const r={...this.store.getState().disabledRpcMethodPreferences,[e]:t};this.store.updateState({disabledRpcMethodPreferences:r})}getRpcMethodPreferences(){return this.store.getState().disabledRpcMethodPreferences}_subscribeToInfuraAvailability(){this.network.on(u.NETWORK_EVENTS.INFURA_IS_BLOCKED,(()=>{this._setInfuraBlocked(!0)})),this.network.on(u.NETWORK_EVENTS.INFURA_IS_UNBLOCKED,(()=>{this._setInfuraBlocked(!1)}))}_setInfuraBlocked(e){const{infuraBlocked:t}=this.store.getState();t!==e&&this.store.updateState({infuraBlocked:e})}}}}},{package:"$root$",file:"app/scripts/controllers/preferences.js"}],[2803,{"safe-event-emitter":3009,xtend:3191},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){e("xtend");const n=e("safe-event-emitter");t.exports=class extends n{constructor(e={}){super(),this._state=e}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState(),r=Object.assign({},t,e);this.putState(r)}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}}}},{package:"@metamask/eth-keyring-controller>obs-store",file:"node_modules/obs-store/index.js"}],[29,{"../../../shared/constants/common":3204,"../../../shared/constants/gas":3205,"../../../shared/constants/network":3209,"../../../shared/constants/smartTransactions":3212,"../../../shared/constants/swaps":3213,"../../../shared/constants/time":3214,"../../../shared/lib/fetch-with-cache":3218,"../../../shared/lib/swaps-utils":3221,"../../../shared/lib/transactions-controller-utils":3224,"../../../shared/modules/Numeric":3226,"../../../shared/modules/conversion.utils":3230,"../../../shared/modules/string-utils":3241,"../../../shared/modules/swaps.utils":3242,"../../../ui/helpers/utils/optimism/fetchEstimatedL1Fee":3870,"./network":18,"@ethersproject/contracts":370,"@ethersproject/providers":409,"@metamask/obs-store":1139,"bignumber.js":1678,"human-standard-token-abi":2486,lodash:2731,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.default=void 0;var n=e("@ethersproject/providers"),s=e("@ethersproject/contracts"),a=k(e("loglevel")),i=k(e("bignumber.js")),o=e("@metamask/obs-store"),c=e("lodash"),u=k(e("human-standard-token-abi")),d=e("../../../shared/modules/conversion.utils"),l=e("../../../shared/constants/swaps"),h=e("../../../shared/constants/gas"),p=e("../../../shared/constants/network"),f=e("../../../shared/constants/smartTransactions"),m=e("../../../shared/modules/swaps.utils"),g=e("../../../shared/lib/swaps-utils"),y=k(e("../../../shared/lib/fetch-with-cache")),E=e("../../../shared/constants/time"),b=e("../../../shared/modules/string-utils"),T=e("../../../shared/lib/transactions-controller-utils"),_=k(e("../../../ui/helpers/utils/optimism/fetchEstimatedL1Fee")),v=e("../../../shared/modules/Numeric"),w=e("../../../shared/constants/common"),S=e("./network");function k(e){return e&&e.__esModule?e:{default:e}}const A=25e5,P=E.MINUTE;function x(e=25e5,t=0,r=0){const n=new i.default(e,10).minus(t,10);return!n.lt(0)&&n.lt(r,16)?`0x${n.toString(16)}`:r}const M={quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:P,swapsQuotePrefetchingRefreshTime:P,swapsStxBatchStatusRefreshTime:f.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxGetTransactionsRefreshTime:f.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxMaxFeeMultiplier:f.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,swapsFeatureFlags:{}};function R(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort(((e,t)=>{const r=new i.default(e.overallValueOfQuote,10),n=new i.default(t.overallValueOfQuote,10);return r.equals(n)?0:r.lessThan(n)?-1:1})),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return I(t.filter((t=>e===t.overallValueOfQuote)))}const r=t.length/2,n=r-1,s=t[r].overallValueOfQuote,a=t[n].overallValueOfQuote,o=t.filter((e=>s===e.overallValueOfQuote)),c=t.filter((e=>a===e.overallValueOfQuote)),u=I(o),d=I(c);return{ethFee:new i.default(u.ethFee,10).plus(d.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new i.default(u.metaMaskFeeInEth,10).plus(d.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new i.default(u.ethValueOfTokens,10).plus(d.ethValueOfTokens,10).dividedBy(2).toString(10)}}function I(e){const t=e.reduce(((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)})),{ethFee:new i.default(0,10),metaMaskFeeInEth:new i.default(0,10),ethValueOfTokens:new i.default(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}r.default=class{constructor({getBufferedGasLimit:e,networkController:t,provider:r,getProviderConfig:s,getTokenRatesState:a,fetchTradesInfo:i=g.fetchTradesInfo,getCurrentChainId:c,getEIP1559GasFeeEstimates:u}){this.store=new o.ObservableStore({swapsState:{...M}}),this.resetState=()=>{this.store.updateState({swapsState:{...M}})},this._fetchTradesInfo=i,this._getCurrentChainId=c,this._getEIP1559GasFeeEstimates=u,this.getBufferedGasLimit=e,this.getTokenRatesState=a,this.pollCount=0,this.getProviderConfig=s,this.indexOfNewestCallInFlight=0,this.ethersProvider=new n.Web3Provider(r),this._currentNetwork=t.store.getState().network,t.on(S.NETWORK_EVENTS.NETWORK_DID_CHANGE,(e=>{"loading"!==e&&e!==this._currentNetwork&&(this._currentNetwork=e,this.ethersProvider=new n.Web3Provider(r))}))}async fetchSwapsNetworkConfig(e){const t=await(0,y.default)((0,g.getBaseApi)("network",e),{method:"GET"},{cacheRefreshTime:6e5}),{refreshRates:r,parameters:n={}}=t||{};if(!r||"number"!=typeof r.quotes||"number"!=typeof r.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*r.quotes,quotesPrefetching:1e3*r.quotesPrefetching,stxGetTransactions:1e3*r.stxGetTransactions,stxBatchStatus:1e3*r.stxBatchStatus,stxStatusDeadline:r.stxStatusDeadline,stxMaxFeeMultiplier:n.stxMaxFeeMultiplier}}async _setSwapsNetworkConfig(){var e,t,r,n,s,a;const i=this._getCurrentChainId();let o;try{o=await this.fetchSwapsNetworkConfig(i)}catch(e){console.error("Request for Swaps network config failed: ",e)}const{swapsState:c}=this.store.getState();this.store.updateState({swapsState:{...c,swapsQuoteRefreshTime:(null===(e=o)||void 0===e?void 0:e.quotes)||P,swapsQuotePrefetchingRefreshTime:(null===(t=o)||void 0===t?void 0:t.quotesPrefetching)||P,swapsStxGetTransactionsRefreshTime:(null===(r=o)||void 0===r?void 0:r.stxGetTransactions)||f.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxBatchStatusRefreshTime:(null===(n=o)||void 0===n?void 0:n.stxBatchStatus)||f.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxStatusDeadline:(null===(s=o)||void 0===s?void 0:s.stxStatusDeadline)||f.FALLBACK_SMART_TRANSACTIONS_DEADLINE,swapsStxMaxFeeMultiplier:(null===(a=o)||void 0===a?void 0:a.stxMaxFeeMultiplier)||f.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER}})}pollForNewQuotes(){const{swapsState:{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:r}}=this.store.getState(),n=r?e:t;this.pollingTimeout=setTimeout((()=>{var e;const{swapsState:t}=this.store.getState();this.fetchAndSetQuotes(t.fetchParams,null===(e=t.fetchParams)||void 0===e?void 0:e.metaData,!0)}),n)}stopPollingForQuotes(){this.pollingTimeout&&clearTimeout(this.pollingTimeout)}async fetchAndSetQuotes(e,t={},r){const{chainId:n}=t,{swapsState:{quotesPollingLimitEnabled:s,saveFetchedQuotes:a}}=this.store.getState();if(!e)return null;r||(this.pollCount=0),clearTimeout(this.pollingTimeout),r||this.setSwapsErrorKey("");const i=this.indexOfNewestCallInFlight+1;this.indexOfNewestCallInFlight=i,a||this.setSaveFetchedQuotes(!0);let[o]=await Promise.all([this._fetchTradesInfo(e,{...t}),this._setSwapsNetworkConfig()]);const{swapsState:{saveFetchedQuotes:u}}=this.store.getState();if(!u)return[{},null];o=(0,c.mapValues)(o,(e=>({...e,sourceTokenInfo:t.sourceTokenInfo,destinationTokenInfo:t.destinationTokenInfo}))),n===p.CHAIN_IDS.OPTIMISM&&Object.values(o).length>0&&await Promise.all(Object.values(o).map((async e=>{if(e.trade){const t=await(0,_.default)({txParams:e.trade,chainId:n},this.ethersProvider);e.multiLayerL1TradeFeeTotal=t}return e})));const d=Date.now();let h=!1;if(!(0,m.isSwapsDefaultTokenAddress)(e.sourceToken,n)&&Object.values(o).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,n),[s]=Object.values(o);if(h=s.approvalNeeded&&t.eq(0)&&"wrappedNative"!==s.aggregator,h){if(!r){const{gasLimit:e}=await this.timedoutGasReturn(s.approvalNeeded);o=(0,c.mapValues)(o,(t=>({...t,approvalNeeded:{...t.approvalNeeded,gas:e||l.DEFAULT_ERC20_APPROVE_GAS}})))}}else o=(0,c.mapValues)(o,(e=>({...e,approvalNeeded:null})))}let f=null;if(h||null!=e&&e.balanceError||(o=await this.getAllQuotesWithGasEstimates(o)),0===Object.values(o).length)this.setSwapsErrorKey(l.QUOTES_NOT_AVAILABLE_ERROR);else{const[e,t]=await this._findTopQuoteAndCalculateSavings(o);f=e,o=t}if(this.indexOfNewestCallInFlight!==i)throw new Error(l.SWAPS_FETCH_ORDER_CONFLICT);const{swapsState:g}=this.store.getState();let{selectedAggId:y}=g;return o[y]||(y=null),this.store.updateState({swapsState:{...g,quotes:o,fetchParams:{...e,metaData:t},quotesLastFetched:d,selectedAggId:y,topAggId:f}}),s&&(this.pollCount+=1),!s||this.pollCount<4?(this.pollForNewQuotes(),[o,f]):(this.resetPostFetchState(),this.setSwapsErrorKey(l.QUOTES_EXPIRED_ERROR),null)}safeRefetchQuotes(){const{swapsState:e}=this.store.getState();!this.pollingTimeout&&e.fetchParams&&this.fetchAndSetQuotes(e.fetchParams)}setSelectedQuoteAggId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,selectedAggId:e}})}setSwapsTokens(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,tokens:e}})}clearSwapsQuotes(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,quotes:{}}})}setSwapsErrorKey(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,errorKey:e}})}async getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map((async e=>{const{gasLimit:t,simulationFails:r}=await this.timedoutGasReturn(e.trade);return[t,r,e.aggregator]}))),r={};return t.forEach((([t,n,s])=>{if(t&&!n){const n=x(e[s].maxGas,e[s].estimatedRefund,t);r[s]={...e[s],gasEstimate:t,gasEstimateWithRefund:n}}else e[s].approvalNeeded&&(r[s]=e[s])})),r}timedoutGasReturn(e){return new Promise((t=>{let r=!1;const n=setTimeout((()=>{r=!0,t({gasLimit:null,simulationFails:!0})}),5*E.SECOND),s={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:s},1).then((({gasLimit:e,simulationFails:s})=>{r||(clearTimeout(n),t({gasLimit:e,simulationFails:s}))})).catch((e=>{a.default.error(e),r||(clearTimeout(n),t({gasLimit:null,simulationFails:!0}))}))}))}async setInitialGasEstimate(e){const{swapsState:t}=this.store.getState(),r={...t.quotes[e]},{gasLimit:n,simulationFails:s}=await this.timedoutGasReturn(r.trade);if(n&&!s){const e=x(r.maxGas,r.estimatedRefund,n);r.gasEstimate=n,r.gasEstimateWithRefund=e}this.store.updateState({swapsState:{...t,quotes:{...t.quotes,[e]:r}}})}setApproveTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,approveTxId:e}})}setTradeTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,tradeTxId:e}})}setQuotesLastFetched(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,quotesLastFetched:e}})}setSwapsTxGasPrice(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customGasPrice:e}})}setSwapsTxMaxFeePerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customMaxFeePerGas:e}})}setSwapsUserFeeLevel(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,swapsUserFeeLevel:e}})}setSwapsQuotesPollingLimitEnabled(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,quotesPollingLimitEnabled:e}})}setSwapsTxMaxFeePriorityPerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customMaxPriorityFeePerGas:e}})}setSwapsTxGasLimit(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customMaxGas:e}})}setCustomApproveTxData(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customApproveTxData:e}})}setBackgroundSwapRouteState(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,routeState:e}})}setSaveFetchedQuotes(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,saveFetchedQuotes:e}})}setSwapsLiveness(e){const{swapsState:t}=this.store.getState(),{swapsFeatureIsLive:r}=e;this.store.updateState({swapsState:{...t,swapsFeatureIsLive:r}})}setSwapsFeatureFlags(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,swapsFeatureFlags:e}})}resetPostFetchState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...M,tokens:e.tokens,fetchParams:e.fetchParams,swapsFeatureIsLive:e.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsFeatureFlags}}),clearTimeout(this.pollingTimeout)}resetSwapsState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...M,swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime}}),clearTimeout(this.pollingTimeout)}async _findTopQuoteAndCalculateSavings(e={}){const{contractExchangeRates:t}=this.getTokenRatesState(),{swapsState:{customGasPrice:r,customMaxPriorityFeePerGas:n}}=this.store.getState(),s=this._getCurrentChainId();if(!Object.keys(e).length)return{};const a=(0,c.cloneDeep)(e),{gasFeeEstimates:o,gasEstimateType:u}=await this._getEIP1559GasFeeEstimates();let l="0x0";if(u===h.GasEstimateTypes.feeMarket){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=o,r=(0,d.decGWEIToHexWEI)(e),s=new v.Numeric(t,10,w.EtherDenomination.GWEI).toDenomination(w.EtherDenomination.WEI);l=new v.Numeric(n||r,16).add(s).round(6).toString()}else u===h.GasEstimateTypes.legacy?l=r||(0,d.decGWEIToHexWEI)(o.high):u===h.GasEstimateTypes.ethGasPrice&&(l=r||(0,d.decGWEIToHexWEI)(o.gasPrice));let p=null,f=null;Object.values(a).forEach((e=>{const{aggregator:r,approvalNeeded:n,averageGas:a,destinationAmount:o=0,destinationToken:c,destinationTokenInfo:u,gasEstimateWithRefund:h,sourceAmount:g,sourceToken:y,trade:E,fee:_,multiLayerL1TradeFeeTotal:S}=e,k=(h?new i.default(h,16):new i.default(a||A,10)).plus((null==n?void 0:n.gas)||"0x0",16).toString(16);let P=(0,T.calcGasTotal)(k,l);null!==S&&(P=(0,d.sumHexes)(P||"0x0",S||"0x0"));const x=new v.Numeric(P,16,w.EtherDenomination.WEI).add(new v.Numeric(E.value,16,w.EtherDenomination.WEI)),M=x.toDenomination(w.EtherDenomination.ETH).round(6).value,R=(0,m.isSwapsDefaultTokenAddress)(y,s)?x.minus(new v.Numeric(g,10)).toDenomination(w.EtherDenomination.ETH).round(6).value:M,I=(0,T.calcTokenAmount)(o,u.decimals),O=new i.default(100,10).minus(_,10).div(100),C=I.div(O).minus(I),N=t[Object.keys(t).find((e=>(0,b.isEqualCaseInsensitive)(e,c)))],L=N||1,j=I.times(L.toString(10),10),D=(0,m.isSwapsDefaultTokenAddress)(c,s)?1:N,U=D===undefined?j:j.minus(R,10);e.ethFee=R.toString(10),D!==undefined&&(e.ethValueOfTokens=j.toString(10),e.overallValueOfQuote=U.toString(10),e.metaMaskFeeInEth=C.times(D.toString(10)).toString(10)),(null===f||U.gt(f))&&(p=r,f=U)}));let g=null;if((0,m.isSwapsDefaultTokenAddress)(a[p].destinationToken,s)||Boolean(t[Object.keys(t).find((e=>{var t;return(0,b.isEqualCaseInsensitive)(e,null===(t=a[p])||void 0===t?void 0:t.destinationToken)}))])){const e=a[p];g={};const{ethFee:t,metaMaskFeeInEth:r,ethValueOfTokens:n}=R(Object.values(a));g.performance=new i.default(e.ethValueOfTokens,10).minus(n,10),g.fee=new i.default(t).minus(e.ethFee,10),g.metaMaskFee=e.metaMaskFeeInEth,g.total=g.performance.plus(g.fee).minus(g.metaMaskFee).toString(10),g.performance=g.performance.toString(10),g.fee=g.fee.toString(10),g.medianMetaMaskFee=r,a[p].isBestQuote=!0,a[p].savings=g}return[p,a]}async _getERC20Allowance(e,t,r){const n=new s.Contract(e,u.default,this.ethersProvider);return await n.allowance(t,l.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[r])}};const O={getMedianEthValueQuote:R,meansOfQuotesFeesAndValue:I};r.utils=O}}},{package:"$root$",file:"app/scripts/controllers/swaps.js"}],[3,{"../../../shared/modules/hexstring-utils":3234,"../lib/util":87,"ethereumjs-util":2038,"ethereumjs-wallet":2044,"ethereumjs-wallet/thirdparty":2059,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("loglevel")),s=u(e("ethereumjs-wallet")),a=u(e("ethereumjs-wallet/thirdparty")),i=e("ethereumjs-util"),o=e("../lib/util"),c=e("../../../shared/modules/hexstring-utils");function u(e){return e&&e.__esModule?e:{default:e}}var d={async importAccount(e,t){return(0,this.strategies[e])(...t)},strategies:{"Private Key":e=>{if(!e)throw new Error("Cannot import an empty key.");const t=(0,o.addHexPrefix)(e),r=(0,i.toBuffer)(t);if(!(0,i.isValidPrivate)(r))throw new Error("Cannot import invalid private key.");return(0,c.stripHexPrefix)(t)},"JSON File":(e,t)=>{let r;try{r=a.default.fromEtherWallet(e,t)}catch(a){n.default.debug("Attempt to import as EtherWallet format failed, trying V3"),r=s.default.fromV3(e,t,!0)}return function(e){const t=e.getPrivateKey();return(0,i.bufferToHex)(t)}(r)}}};r.default=d}}},{package:"$root$",file:"app/scripts/account-import-strategies/index.js"}],[30,{"../../../../shared/constants/app":3203,"../../../../shared/constants/gas":3205,"../../../../shared/constants/metametrics":3208,"../../../../shared/constants/network":3209,"../../../../shared/constants/transaction":3216,"../../../../shared/lib/transactions-controller-utils":3224,"../../../../shared/modules/Numeric":3226,"../../../../shared/modules/conversion.utils":3230,"../../../../shared/modules/swaps.utils":3242,"../../../../shared/modules/transaction.utils":3243,"../../lib/cleanErrorStack":41,"../../lib/util":87,"../../metamask-controller":88,"./lib/util":32,"./pending-tx-tracker":33,"./tx-gas-utils":34,"./tx-state-manager":35,"@ethereumjs/common":298,"@ethereumjs/tx":303,"@metamask/obs-store":1139,"bignumber.js":1678,"eth-rpc-errors":1994,"ethereumjs-util":2038,"ethjs-query":2073,lodash:2731,loglevel:2743,"nonce-tracker":2791,"safe-event-emitter":3009},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=O(e("safe-event-emitter")),s=e("@metamask/obs-store"),a=e("ethereumjs-util"),i=O(e("ethjs-query")),o=e("eth-rpc-errors"),c=O(e("@ethereumjs/common")),u=e("@ethereumjs/tx"),d=O(e("nonce-tracker")),l=O(e("loglevel")),h=O(e("bignumber.js")),p=e("lodash"),f=O(e("../../lib/cleanErrorStack")),m=e("../../lib/util"),g=e("../../../../shared/constants/transaction"),y=e("../../metamask-controller"),E=e("../../../../shared/constants/gas"),b=e("../../../../shared/modules/conversion.utils"),T=e("../../../../shared/modules/swaps.utils"),_=e("../../../../shared/constants/metametrics"),v=e("../../../../shared/constants/network"),w=e("../../../../shared/modules/transaction.utils"),S=e("../../../../shared/constants/app"),k=e("../../../../shared/lib/transactions-controller-utils"),A=e("../../../../shared/modules/Numeric"),P=O(e("./tx-state-manager")),x=O(e("./tx-gas-utils")),M=O(e("./pending-tx-tracker")),R=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=I(t);if(r&&r.has(e))return r.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=s?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(e("./lib/util"));function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(I=function(e){return e?r:t})(e)}function O(e){return e&&e.__esModule?e:{default:e}}const C=[g.TransactionType.swap,g.TransactionType.swapApproval],N=[...C,g.TransactionType.simpleSend,g.TransactionType.tokenMethodTransfer,g.TransactionType.tokenMethodTransferFrom,g.TransactionType.contractInteraction],L="failed on-chain";class j extends n.default{constructor(e){super(),this.getNetworkState=e.getNetworkState,this._getCurrentChainId=e.getCurrentChainId,this.getProviderConfig=e.getProviderConfig,this._getCurrentNetworkEIP1559Compatibility=e.getCurrentNetworkEIP1559Compatibility,this._getCurrentAccountEIP1559Compatibility=e.getCurrentAccountEIP1559Compatibility,this.preferencesStore=e.preferencesStore||new s.ObservableStore({}),this.provider=e.provider,this.getPermittedAccounts=e.getPermittedAccounts,this.blockTracker=e.blockTracker,this.signEthTx=e.signTransaction,this.inProcessOfSigning=new Set,this._trackMetaMetricsEvent=e.trackMetaMetricsEvent,this._getParticipateInMetrics=e.getParticipateInMetrics,this._getEIP1559GasFeeEstimates=e.getEIP1559GasFeeEstimates,this.createEventFragment=e.createEventFragment,this.updateEventFragment=e.updateEventFragment,this.finalizeEventFragment=e.finalizeEventFragment,this.getEventFragmentById=e.getEventFragmentById,this.getDeviceModel=e.getDeviceModel,this.getAccountType=e.getAccountType,this.getTokenStandardAndDetails=e.getTokenStandardAndDetails,this.securityProviderRequest=e.securityProviderRequest,this.memStore=new s.ObservableStore({}),this.resetState=()=>{this._updateMemstore()},this.query=new i.default(this.provider),this.txGasUtil=new x.default(this.provider),this._mapMethods(),this.txStateManager=new P.default({initState:e.initState,txHistoryLimit:e.txHistoryLimit,getNetworkState:this.getNetworkState,getCurrentChainId:e.getCurrentChainId}),this.store=this.txStateManager.store,this.nonceTracker=new d.default({provider:this.provider,blockTracker:this.blockTracker,getPendingTransactions:(...t)=>[...this.txStateManager.getPendingTransactions(...t),...e.getExternalPendingTransactions(...t)],getConfirmedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.pendingTxTracker=new M.default({provider:this.provider,nonceTracker:this.nonceTracker,publishTransaction:e=>this.query.sendRawTransaction(e),getPendingTransactions:()=>[...this.txStateManager.getPendingTransactions(),...this.txStateManager.getApprovedTransactions()],approveTransaction:this.approveTransaction.bind(this),getCompletedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.txStateManager.store.subscribe((()=>this.emit(y.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE))),this._setupListeners(),this._updateMemstore(),this.txStateManager.store.subscribe((()=>this._updateMemstore())),e.onNetworkStateChange((()=>{this._onBootCleanUp(),this._updateMemstore()})),this._updatePendingTxsAfterFirstBlock(),this._onBootCleanUp()}getChainId(){const e=this.getNetworkState(),t=this._getCurrentChainId(),r=parseInt(t,16);return"loading"===e||Number.isNaN(r)?0:r}async getEIP1559Compatibility(e){const t=await this._getCurrentNetworkEIP1559Compatibility(),r=await this._getCurrentAccountEIP1559Compatibility(e);return t&&r}async getCommonConfiguration(e){const{type:t,nickname:r}=this.getProviderConfig(),n=await this.getEIP1559Compatibility(e)?v.HARDFORKS.LONDON:v.HARDFORKS.BERLIN;if(t!==v.NETWORK_TYPES.RPC&&t!==v.NETWORK_TYPES.SEPOLIA)return new c.default({chain:t,hardfork:n});const s=parseInt(this._getCurrentChainId(),16),a=this.getNetworkState(),i={name:r,chainId:s,networkId:"loading"===a?0:parseInt(a,10)};return c.default.forCustomChain(v.NETWORK_TYPES.MAINNET,i,n)}addTransaction(e){this.txStateManager.addTransaction(e),this.emit(`${e.id}:unapproved`,e),this._trackTransactionMetricsEvent(e,g.TransactionMetaMetricsEvent.added,e.actionId)}wipeTransactions(e){this.txStateManager.wipeTransactions(e)}async newUnapprovedTransaction(e,t={}){l.default.debug(`MetaMaskController newUnapprovedTransaction ${JSON.stringify(e)}`);const r=await this.addUnapprovedTransaction(t.method,e,t.origin,undefined,undefined,t.id);return new Promise(((e,t)=>{this.txStateManager.once(`${r.id}:finished`,(r=>{switch(r.status){case g.TransactionStatus.submitted:return e(r.hash);case g.TransactionStatus.rejected:return t((0,f.default)(o.ethErrors.provider.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.")));case g.TransactionStatus.failed:return t((0,f.default)(o.ethErrors.rpc.internal(r.err.message)));default:return t((0,f.default)(o.ethErrors.rpc.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(r.txParams)}`)))}}))}))}_getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}_isUnapprovedTransaction(e){return this.txStateManager.getTransaction(e).status===g.TransactionStatus.unapproved}_throwErrorIfNotUnapprovedTx(e,t){if(!this._isUnapprovedTransaction(e))throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n         Current tx status: ${this.txStateManager.getTransaction(e).status}`)}_updateTransaction(e,t,r){const n=this.txStateManager.getTransaction(e),s=(0,p.merge)(n,t);this.txStateManager.updateTransaction(s,r)}updatePreviousGasParams(e,{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}){const s={previousGas:{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}};s.previousGas=(0,p.pickBy)(s.previousGas);const a=`Update Previous Gas for ${e}`;return this._updateTransaction(e,s,a),this._getTransaction(e)}async updateEditableParams(e,{data:t,from:r,to:n,value:s,gas:a,gasPrice:i}){this._throwErrorIfNotUnapprovedTx(e,"updateEditableParams");const o={txParams:{data:t,from:r,to:n,value:s,gas:a,gasPrice:i}};o.txParams=(0,p.pickBy)(o.txParams,(e=>e!==undefined));const c=this._getTransaction(e),{type:u}=await(0,w.determineTransactionType)({...c.txParams,...o.txParams},this.query);o.type=u;const d=`Update Editable Params for ${e}`;return this._updateTransaction(e,o,d),this._getTransaction(e)}updateTransactionGasFees(e,{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:s,maxFeePerGas:a,estimateUsed:i,estimateSuggested:o,defaultGasEstimates:c,originalGasEstimate:u,userEditedGasLimit:d,userFeeLevel:l}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionGasFees");let h={txParams:{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:s,maxFeePerGas:a},estimateUsed:i,estimateSuggested:o,defaultGasEstimates:c,originalGasEstimate:u,userEditedGasLimit:d,userFeeLevel:l};h.txParams=(0,p.pickBy)(h.txParams),h=(0,p.pickBy)(h);const f=`Update Transaction Gas Fees for ${e}`;return this._updateTransaction(e,h,f),this._getTransaction(e)}updateTransactionEstimatedBaseFee(e,{estimatedBaseFee:t,decEstimatedBaseFee:r}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionEstimatedBaseFee");let n={estimatedBaseFee:t,decEstimatedBaseFee:r};n=(0,p.pickBy)(n);const s=`Update Transaction Estimated Base Fees for ${e}`;return this._updateTransaction(e,n,s),this._getTransaction(e)}updateSwapApprovalTransaction(e,{type:t,sourceTokenSymbol:r}){this._throwErrorIfNotUnapprovedTx(e,"updateSwapApprovalTransaction");let n={type:t,sourceTokenSymbol:r};n=(0,p.pickBy)(n);const s=`Update Swap Approval Transaction for ${e}`;return this._updateTransaction(e,n,s),this._getTransaction(e)}updateSwapTransaction(e,{sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:s,destinationTokenAddress:a,swapMetaData:i,swapTokenValue:o,estimatedBaseFee:c,approvalTxId:u}){this._throwErrorIfNotUnapprovedTx(e,"updateSwapTransaction");let d={sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:s,destinationTokenAddress:a,swapMetaData:i,swapTokenValue:o,estimatedBaseFee:c,approvalTxId:u};d=(0,p.pickBy)(d);const l=`Update Swap Transaction for ${e}`;return this._updateTransaction(e,d,l),this._getTransaction(e)}updateTransactionUserSettings(e,{userEditedGasLimit:t,userFeeLevel:r}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionUserSettings");let n={userEditedGasLimit:t,userFeeLevel:r};n=(0,p.pickBy)(n);const s=`Update User Settings for ${e}`;return this._updateTransaction(e,n,s),this._getTransaction(e)}updateTransactionSendFlowHistory(e,t,r){var n;this._throwErrorIfNotUnapprovedTx(e,"updateTransactionSendFlowHistory");const s=this._getTransaction(e);if(t===((null==s||null===(n=s.sendFlowHistory)||void 0===n?void 0:n.length)||0)){var a;const t=`Update sendFlowHistory for ${e}`;this.txStateManager.updateTransaction({...s,sendFlowHistory:[...null!==(a=null==s?void 0:s.sendFlowHistory)&&void 0!==a?a:[],...r]},t)}return this._getTransaction(e)}async addTransactionGasDefaults(e){const t=await(0,w.determineTransactionContractCode)(e.txParams,this.query);let r=e;try{r=await this.addTxGasDefaults(e,t)}catch(t){throw l.default.warn(t),r=this.txStateManager.getTransaction(e.id),r.loadingDefaults=!1,this.txStateManager.updateTransaction(e,"Failed to calculate gas defaults."),t}return r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"Added new unapproved transaction."),r}async addUnapprovedTransaction(e,t,r,n,s=[],a){if(n!==undefined&&!N.includes(n))throw new Error(`TransactionController - invalid transactionType value: ${n}`);if(a){let e=this.txStateManager.getTransactionWithActionId(a);if(e)return this.emit("newUnapprovedTx",e),e=await this.addTransactionGasDefaults(e),e}const i=R.normalizeTxParams(t),c=await this.getEIP1559Compatibility();R.validateTxParams(i,c);let u=this.txStateManager.generateTxMeta({txParams:i,origin:r,sendFlowHistory:s});if(a&&(u.actionId=a),r===S.ORIGIN_METAMASK){if(i.from!==this.getSelectedAddress())throw o.ethErrors.rpc.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:r,fromAddress:i.from,selectedAddress:this.getSelectedAddress()}})}else{if(!(await this.getPermittedAccounts(r)).includes(i.from))throw o.ethErrors.provider.unauthorized({data:{origin:r}})}const{type:d}=await(0,w.determineTransactionType)(i,this.query);if(u.type=n||d,u.txParams.value=u.txParams.value?(0,m.addHexPrefix)(u.txParams.value):"0x0",e&&this.securityProviderRequest){const t=await this.securityProviderRequest(u,e);u.securityProviderResponse=t}return this.addTransaction(u),this.emit("newUnapprovedTx",u),u=await this.addTransactionGasDefaults(u),u}async addTxGasDefaults(e,t){const r=e.txParams.type!==g.TransactionEnvelopeType.legacy&&await this.getEIP1559Compatibility(),{gasPrice:n,maxFeePerGas:s,maxPriorityFeePerGas:a}=await this._getDefaultGasFees(e,r),{gasLimit:i,simulationFails:o}=await this._getDefaultGasLimit(e,t);if(e=this.txStateManager.getTransaction(e.id),o&&(e.simulationFails=o),r){const t=this.getAdvancedGasFee();Boolean(t)&&!C.includes(e.type)?(e.userFeeLevel=E.CUSTOM_GAS_ESTIMATE,e.txParams.maxFeePerGas=(0,b.decGWEIToHexWEI)(t.maxBaseFee),e.txParams.maxPriorityFeePerGas=(0,b.decGWEIToHexWEI)(t.priorityFee)):!e.txParams.gasPrice||e.txParams.maxFeePerGas||e.txParams.maxPriorityFeePerGas?(s&&a&&!e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas||e.origin===S.ORIGIN_METAMASK?e.userFeeLevel=E.GasRecommendations.medium:e.userFeeLevel=E.PriorityLevels.dAppSuggested,s&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=s),a&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=a),n&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=n),e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=e.txParams.maxFeePerGas)):(e.txParams.maxFeePerGas=e.txParams.gasPrice,e.txParams.maxPriorityFeePerGas=e.txParams.gasPrice,e.origin===S.ORIGIN_METAMASK?e.userFeeLevel=E.CUSTOM_GAS_ESTIMATE:e.userFeeLevel=E.PriorityLevels.dAppSuggested),delete e.txParams.gasPrice}else delete e.txParams.maxPriorityFeePerGas,delete e.txParams.maxFeePerGas;return!n||e.txParams.gasPrice||e.txParams.maxPriorityFeePerGas||e.txParams.maxFeePerGas||(e.txParams.gasPrice=n),i&&!e.txParams.gas&&(e.txParams.gas=i,e.originalGasEstimate=i),e.defaultGasEstimates={estimateType:e.userFeeLevel,gas:e.txParams.gas,gasPrice:e.txParams.gasPrice,maxFeePerGas:e.txParams.maxFeePerGas,maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas},e}async _getDefaultGasFees(e,t){if(!t&&e.txParams.gasPrice||t&&e.txParams.maxFeePerGas&&e.txParams.maxPriorityFeePerGas)return{};try{const{gasFeeEstimates:e,gasEstimateType:r}=await this._getEIP1559GasFeeEstimates();if(t&&r===E.GasEstimateTypes.feeMarket){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:r}={}}=e;if(t&&r)return{maxFeePerGas:(0,b.decGWEIToHexWEI)(r),maxPriorityFeePerGas:(0,b.decGWEIToHexWEI)(t)}}else{if(r===E.GasEstimateTypes.legacy)return{gasPrice:(0,b.decGWEIToHexWEI)(e.medium)};if(r===E.GasEstimateTypes.ethGasPrice)return{gasPrice:(0,b.decGWEIToHexWEI)(e.gasPrice)}}}catch(e){console.error(e)}const r=await this.query.gasPrice();return{gasPrice:r&&(0,m.addHexPrefix)(r.toString(16))}}async _getDefaultGasLimit(e){const t=this._getCurrentChainId(),r=v.CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP[t],n=(0,m.getChainType)(t);if(e.txParams.gas)return{};if(e.txParams.to&&e.type===g.TransactionType.simpleSend&&"custom"!==n&&!e.txParams.data)return{gasLimit:E.GAS_LIMITS.SIMPLE};const{blockGasLimit:s,estimatedGasHex:a,simulationFails:i}=await this.txGasUtil.analyzeGasUsage(e);return{gasLimit:this.txGasUtil.addGasBuffer((0,m.addHexPrefix)(a),s,r),simulationFails:i}}generateNewGasParams(e,t={},r=11){const{txParams:n}=e,s={},a={};var i;t.gasLimit&&(a.gas=null!==(i=null==t?void 0:t.gas)&&void 0!==i?i:E.GAS_LIMITS.SIMPLE);return t.estimateSuggested&&(a.estimateSuggested=t.estimateSuggested),t.estimateUsed&&(a.estimateUsed=t.estimateUsed),(0,w.isEIP1559Transaction)(e)?(s.maxFeePerGas=n.maxFeePerGas,s.maxPriorityFeePerGas=n.maxPriorityFeePerGas,a.maxFeePerGas=(null==t?void 0:t.maxFeePerGas)||(0,b.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.maxFeePerGas),r,10)),a.maxPriorityFeePerGas=(null==t?void 0:t.maxPriorityFeePerGas)||(0,b.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.maxPriorityFeePerGas),r,10))):(s.gasPrice=n.gasPrice,a.gasPrice=(null==t?void 0:t.gasPrice)||(0,b.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.gasPrice),r,10))),{previousGasParams:s,newGasParams:a}}async createCancelTransaction(e,t,{estimatedBaseFee:r,actionId:n}={}){if(n){const e=this.txStateManager.getTransactionWithActionId(n);if(e)return e}const s=this.txStateManager.getTransaction(e),{txParams:a}=s,{from:i,nonce:o}=a,{previousGasParams:c,newGasParams:u}=this.generateNewGasParams(s,{...t,gasLimit:t.gasLimit||E.GAS_LIMITS.SIMPLE}),d=this.txStateManager.generateTxMeta({txParams:{from:i,to:i,nonce:o,value:"0x0",...u},previousGasParams:c,loadingDefaults:!1,status:g.TransactionStatus.approved,type:g.TransactionType.cancel,actionId:n});return r&&(d.estimatedBaseFee=r),this.addTransaction(d),await this.approveTransaction(d.id,n),d}async createSpeedUpTransaction(e,t,{estimatedBaseFee:r,actionId:n}={}){if(n){const e=this.txStateManager.getTransactionWithActionId(n);if(e)return e}const s=this.txStateManager.getTransaction(e),{txParams:a}=s,{previousGasParams:i,newGasParams:o}=this.generateNewGasParams(s,t),c=this.txStateManager.generateTxMeta({txParams:{...a,...o},previousGasParams:i,loadingDefaults:!1,status:g.TransactionStatus.approved,type:g.TransactionType.retry,originalType:s.type,actionId:n});return r&&(c.estimatedBaseFee=r),this.addTransaction(c),await this.approveTransaction(c.id,n),c}async updateTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user updated transaction")}async updateAndApproveTransaction(e,t){this.txStateManager.updateTransaction(e,"confTx: user approved transaction"),await this.approveTransaction(e.id,t)}async approveTransaction(e,t){const r=this.txStateManager.getTransaction(e);if(this.inProcessOfSigning.has(e))return;let n;this.inProcessOfSigning.add(e);try{this.txStateManager.setTxStatusApproved(e);const s=r.txParams.from;let{customNonceValue:a}=r;a=Number(a),n=await this.nonceTracker.getNonceLock(s);const i=r.previousGasParams?r.txParams.nonce:n.nextNonce,o=0===a?a:a||i;r.txParams.nonce=(0,m.addHexPrefix)(o.toString(16)),r.nonceDetails=n.nonceDetails,a&&(r.nonceDetails.customNonceValue=a),this.txStateManager.updateTransaction(r,"transactions#approveTransaction");const c=await this.signTransaction(e);await this.publishTransaction(e,c,t),this._trackTransactionMetricsEvent(r,g.TransactionMetaMetricsEvent.approved,t),n.releaseLock()}catch(r){try{this._failTransaction(e,r,t)}catch(e){l.default.error(e)}throw n&&n.releaseLock(),r}finally{this.inProcessOfSigning.delete(e)}}async approveTransactionsWithSameNonce(e=[]){if(0===e.length)return"";const t=e[0],r=await this.getCommonConfiguration(t.from),n=u.TransactionFactory.fromTxData(t,{common:r}),s=(0,a.bufferToHex)(n.serialize());if(this.inProcessOfSigning.has(s))return"";let i,o;this.inProcessOfSigning.add(s);try{const r=t.from;o=await this.nonceTracker.getNonceLock(r);const n=o.nextNonce;i=await Promise.all(e.map((e=>(e.nonce=(0,m.addHexPrefix)(n.toString(16)),this.signExternalTransaction(e)))))}catch(e){throw l.default.error(e),e}finally{o&&o.releaseLock(),this.inProcessOfSigning.delete(s)}return i}async signExternalTransaction(e){const t=R.normalizeTxParams(e),r=this.getChainId(),n=(0,w.isEIP1559Transaction)({txParams:t})?g.TransactionEnvelopeType.feeMarket:g.TransactionEnvelopeType.legacy,s={...t,type:n,gasLimit:t.gas,chainId:new A.Numeric(r,10).toPrefixedHexString()},i=s.from,o=await this.getCommonConfiguration(i),c=u.TransactionFactory.fromTxData(s,{common:o}),d=await this.signEthTx(c,i);return(0,a.bufferToHex)(d.serialize())}async signTransaction(e){const t=this.txStateManager.getTransaction(e),r=this.getChainId(),n=(0,w.isEIP1559Transaction)(t)?g.TransactionEnvelopeType.feeMarket:g.TransactionEnvelopeType.legacy,s={...t.txParams,type:n,chainId:r,gasLimit:t.txParams.gas},i=s.from,o=await this.getCommonConfiguration(s.from),c=u.TransactionFactory.fromTxData(s,{common:o}),d=await this.signEthTx(c,i);t.r=(0,a.bufferToHex)(d.r),t.s=(0,a.bufferToHex)(d.s),t.v=(0,a.bufferToHex)(d.v),this.txStateManager.updateTransaction(t,"transactions#signTransaction: add r, s, v values"),this.txStateManager.setTxStatusSigned(t.id);return(0,a.bufferToHex)(d.serialize())}async publishTransaction(e,t,r){const n=this.txStateManager.getTransaction(e);if(n.rawTx=t,n.type===g.TransactionType.swap){const e=await this.query.getBalance(n.txParams.from);n.preTxBalance=e.toString(16)}let s;this.txStateManager.updateTransaction(n,"transactions#publishTransaction");try{s=await this.query.sendRawTransaction(t)}catch(e){if(!e.message.toLowerCase().includes("known transaction"))throw e;s=(0,a.keccak)((0,a.toBuffer)((0,m.addHexPrefix)(t),"hex")).toString("hex"),s=(0,m.addHexPrefix)(s)}this.setTxHash(e,s),this.txStateManager.setTxStatusSubmitted(e),this._trackTransactionMetricsEvent(n,g.TransactionMetaMetricsEvent.submitted,r)}async updatePostTxBalance({txMeta:e,txId:t,numberOfAttempts:r=6}){const n=await this.query.getBalance(e.txParams.from),s=this.txStateManager.getTransaction(t),a=s.approvalTxId?this.txStateManager.getTransaction(s.approvalTxId):null;s.postTxBalance=n.toString(16);(0,T.isSwapsDefaultTokenAddress)(e.destinationTokenAddress,e.chainId)&&e.preTxBalance===s.postTxBalance&&r>0?setTimeout((()=>{this.updatePostTxBalance({txMeta:e,txId:t,numberOfAttempts:r-1})}),5e3):(this.txStateManager.updateTransaction(s,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(s,a))}async confirmTransaction(e,t,r,n){const s=this.txStateManager.getTransaction(e);if(s)try{const a=R.normalizeTxReceiptGasUsed(t.gasUsed);s.txReceipt={...t,gasUsed:a},r&&(s.baseFeePerGas=r),n&&(s.blockTimestamp=n),this.txStateManager.setTxStatusConfirmed(e),this._markNonceDuplicatesDropped(e);const{submittedTime:i}=s,o={gas_used:a};i&&(o.completion_time=this._getTransactionCompletionTime(i)),"0x0"===t.status&&(o.status=L),this._trackTransactionMetricsEvent(s,g.TransactionMetaMetricsEvent.finalized,undefined,o),this.txStateManager.updateTransaction(s,"transactions#confirmTransaction - add txReceipt"),s.type===g.TransactionType.swap&&await this.updatePostTxBalance({txMeta:s,txId:e})}catch(e){l.default.error(e)}}async confirmExternalTransaction(e,t,r){if(await this.txStateManager.addExternalTransaction(e),!e)return;const n=e.id;try{const s=R.normalizeTxReceiptGasUsed(t.gasUsed);e.txReceipt={...t,gasUsed:s},r&&(e.baseFeePerGas=r),this.txStateManager.setTxStatusConfirmed(n),this._markNonceDuplicatesDropped(n);const{submittedTime:a}=e,i={gas_used:s};a&&(i.completion_time=this._getTransactionCompletionTime(a)),"0x0"===t.status&&(i.status=L),this._trackTransactionMetricsEvent(e,g.TransactionMetaMetricsEvent.finalized,undefined,i),this.txStateManager.updateTransaction(e,"transactions#confirmTransaction - add txReceipt"),e.type===g.TransactionType.swap&&await this.updatePostTxBalance({txMeta:e,txId:n})}catch(e){l.default.error(e)}}async cancelTransaction(e,t){const r=this.txStateManager.getTransaction(e);this.txStateManager.setTxStatusRejected(e),this._trackTransactionMetricsEvent(r,g.TransactionMetaMetricsEvent.rejected,t)}setTxHash(e,t){const r=this.txStateManager.getTransaction(e);r.hash=t,this.txStateManager.updateTransaction(r,"transactions#setTxHash")}async createTransactionEventFragment(e,t,r){const n=this.txStateManager.getTransaction(e),{properties:s,sensitiveProperties:a}=await this._buildEventFragmentProperties(n);this._createTransactionEventFragment(n,t,s,a,r)}_mapMethods(){this.getState=()=>this.memStore.getState(),this.getSelectedAddress=()=>this.preferencesStore.getState().selectedAddress,this.getUnapprovedTxCount=()=>Object.keys(this.txStateManager.getUnapprovedTxList()).length,this.getPendingTxCount=e=>this.txStateManager.getPendingTransactions(e).length,this.getTransactions=e=>this.txStateManager.getTransactions(e),this.getAdvancedGasFee=()=>this.preferencesStore.getState().advancedGasFee}async _updatePendingTxsAfterFirstBlock(){await this.blockTracker.getLatestBlock(),await this.pendingTxTracker.updatePendingTxs()}_onBootCleanUp(){this.txStateManager.getTransactions({searchCriteria:{status:g.TransactionStatus.unapproved,loadingDefaults:!0}}).forEach((e=>{this.addTxGasDefaults(e).then((e=>{e.loadingDefaults=!1,this.txStateManager.updateTransaction(e,"transactions: gas estimation for tx on boot")})).catch((t=>{const r=this.txStateManager.getTransaction(e.id);r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"failed to estimate gas during boot cleanup."),this._failTransaction(r.id,t)}))})),this.txStateManager.getTransactions({searchCriteria:{status:g.TransactionStatus.approved}}).forEach((e=>{this.approveTransaction(e.id)}))}_setupListeners(){this.txStateManager.on("tx:status-update",this.emit.bind(this,"tx:status-update")),this._setupBlockTrackerListener(),this.pendingTxTracker.on("tx:warning",(e=>{this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:warning")})),this.pendingTxTracker.on("tx:failed",((e,t)=>{this._failTransaction(e,t)})),this.pendingTxTracker.on("tx:confirmed",((e,t,r,n)=>this.confirmTransaction(e,t,r,n))),this.pendingTxTracker.on("tx:dropped",(e=>{this._dropTransaction(e)})),this.pendingTxTracker.on("tx:block-update",((e,t)=>{e.firstRetryBlockNumber||(e.firstRetryBlockNumber=t,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:block-update"))})),this.pendingTxTracker.on("tx:retry",(e=>{"retryCount"in e||(e.retryCount=0),e.retryCount+=1,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:retry")}))}_markNonceDuplicatesDropped(e){const t=this.txStateManager.getTransaction(e),{nonce:r,from:n}=t.txParams,s=this.txStateManager.getTransactions({searchCriteria:{nonce:r,from:n}});s.length&&s.forEach((r=>{r.id!==e&&(r.replacedBy=t.hash,r.replacedById=t.id,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce"),r.status!==g.TransactionStatus.failed&&this._dropTransaction(r.id))}))}_setupBlockTrackerListener(){let e=!1;const t=this._onLatestBlock.bind(this),{blockTracker:r,txStateManager:n}=this;function s(){const s=n.getPendingTransactions();!e&&s.length>0?(r.on("latest",t),e=!0):e&&!s.length&&(r.removeListener("latest",t),e=!1)}n.on("tx:status-update",s),s()}async _onLatestBlock(e){try{await this.pendingTxTracker.updatePendingTxs()}catch(e){l.default.error(e)}try{await this.pendingTxTracker.resubmitPendingTxs(e)}catch(e){l.default.error(e)}}_updateMemstore(){const e=this.txStateManager.getUnapprovedTxList(),t=this.txStateManager.getTransactions({limit:100});this.memStore.updateState({unapprovedTxs:e,currentNetworkTxList:t})}_calculateTransactionsCost(e,t){let r="0x0";null!=t&&t.txReceipt&&(r=(0,k.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const n=(0,k.calcGasTotal)(e.txReceipt.gasUsed,e.txReceipt.effectiveGasPrice),s=new h.default(n,16).plus(r,16).toString(16);return{approvalGasCostInEth:Number((0,b.hexWEIToDecETH)(r)),tradeGasCostInEth:Number((0,b.hexWEIToDecETH)(n)),tradeAndApprovalGasCostInEth:Number((0,b.hexWEIToDecETH)(s))}}_trackSwapsMetrics(e,t){if(this._getParticipateInMetrics()&&e.swapMetaData)if("0x0"===e.txReceipt.status)this._trackMetaMetricsEvent({event:"Swap Failed",sensitiveProperties:{...e.swapMetaData},category:_.EVENT.CATEGORIES.SWAPS});else{const r=(0,k.getSwapsTokensReceivedFromTxMeta)(e.destinationTokenSymbol,e,e.destinationTokenAddress,e.txParams.from,e.destinationTokenDecimals,t,e.chainId),n=r?`${new h.default(r,10).div(e.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,s=e.txReceipt.gasUsed&&e.swapMetaData.estimated_gas?`${new h.default(e.txReceipt.gasUsed,16).div(e.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,a=this._calculateTransactionsCost(e,t);this._trackMetaMetricsEvent({event:"Swap Completed",category:_.EVENT.CATEGORIES.SWAPS,sensitiveProperties:{...e.swapMetaData,token_to_amount_received:r,quote_vs_executionRatio:n,estimated_vs_used_gasRatio:s,approval_gas_cost_in_eth:a.approvalGasCostInEth,trade_gas_cost_in_eth:a.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:a.tradeAndApprovalGasCostInEth}})}}_allowanceAmountInRelationToDappProposedValue(e,t,r){return e===g.TransactionApprovalAmountType.custom&&t&&r?`${new h.default(t,10).div(r,10).times(100).round(2)}`:null}_allowanceAmountInRelationToTokenBalance(e,t,r){return(e===g.TransactionApprovalAmountType.custom||e===g.TransactionApprovalAmountType.dappProposed)&&t&&r?`${new h.default(t,16).div(r,10).times(100).round(2)}`:null}async _buildEventFragmentProperties(e,t){const{type:r,time:n,status:s,chainId:a,origin:i,txParams:{gasPrice:o,gas:c,maxFeePerGas:u,maxPriorityFeePerGas:d,estimateSuggested:l,estimateUsed:h},defaultGasEstimates:p,originalType:f,replacedById:m,metamaskNetworkId:y,customTokenAmount:b,dappProposedTokenAmount:T,currentTokenBalance:_,originalApprovalAmount:v,finalApprovalAmount:A,contractMethodName:P}=e,x=i===S.ORIGIN_METAMASK?"user":"dapp",{assetType:M,tokenStandard:R}=await(0,w.determineTransactionAssetType)(e,this.query,this.getTokenStandardAndDetails),I={};if((0,w.isEIP1559Transaction)(e)?(I.max_fee_per_gas=u,I.max_priority_fee_per_gas=d):I.gas_price=o,p){const{estimateType:t}=p;if(t){I.default_estimate=t;let r=e.defaultGasEstimates.maxFeePerGas,n=e.defaultGasEstimates.maxPriorityFeePerGas;if([E.GasRecommendations.low,E.GasRecommendations.medium,E.GasRecommendations.high].includes(t)){var O,C;const{gasFeeEstimates:e}=await this._getEIP1559GasFeeEstimates();var N,L;if(null!=e&&null!==(O=e[t])&&void 0!==O&&O.suggestedMaxFeePerGas)r=null===(N=e[t])||void 0===N?void 0:N.suggestedMaxFeePerGas,I.default_max_fee_per_gas=r;if(null!=e&&null!==(C=e[t])&&void 0!==C&&C.suggestedMaxPriorityFeePerGas)n=null===(L=e[t])||void 0===L?void 0:L.suggestedMaxPriorityFeePerGas,I.default_max_priority_fee_per_gas=n}}e.defaultGasEstimates.gas&&(I.default_gas=e.defaultGasEstimates.gas),e.defaultGasEstimates.gasPrice&&(I.default_gas_price=e.defaultGasEstimates.gasPrice)}l&&(I.estimate_suggested=l),h&&(I.estimate_used=h),null!=t&&t.gas_used&&(I.gas_used=t.gas_used);const j=this._getGasValuesInGWEI(I);let D="0";e.txParams.maxFeePerGas&&(D="2");const U=[g.TransactionType.contractInteraction,g.TransactionType.tokenMethodApprove,g.TransactionType.tokenMethodSafeTransferFrom,g.TransactionType.tokenMethodSetApprovalForAll,g.TransactionType.tokenMethodTransfer,g.TransactionType.tokenMethodTransferFrom,g.TransactionType.smart,g.TransactionType.swap,g.TransactionType.swapApproval].includes(r),F="Approve";let B,G,z,q,H=g.TransactionType.simpleSend;r===g.TransactionType.cancel?H=g.TransactionType.cancel:r===g.TransactionType.retry?H=f:r===g.TransactionType.deployContract?H=g.TransactionType.deployContract:U&&(H=g.TransactionType.contractInteraction,G=P,G===F&&R===g.TokenStandard.ERC20&&("0"===T||"0"===b?B=g.TransactionApprovalAmountType.revoke:b?B=g.TransactionApprovalAmountType.custom:T&&(B=g.TransactionApprovalAmountType.dappProposed),z=this._allowanceAmountInRelationToDappProposedValue(B,v,A),q=this._allowanceAmountInRelationToTokenBalance(B,T,_)));const $=this._getTransaction(m),V={RETRY:g.TransactionType.retry,CANCEL:g.TransactionType.cancel,SAME_NONCE:"other"};let Q;null!=t&&t.dropped&&(Q=V.SAME_NONCE,(null==$?void 0:$.type)===g.TransactionType.cancel?Q=V.CANCEL:(null==$?void 0:$.type)===g.TransactionType.retry&&(Q=V.RETRY));let K={chain_id:a,referrer:i,source:x,network:y,eip_1559_version:D,gas_edit_type:"none",gas_edit_attempted:"none",account_type:await this.getAccountType(this.getSelectedAddress()),device_model:await this.getDeviceModel(this.getSelectedAddress()),asset_type:M,token_standard:R,transaction_type:H,transaction_speed_up:r===g.TransactionType.retry};G===F&&(K={...K,transaction_approval_amount_type:B});let W={status:s,transaction_envelope_type:(0,w.isEIP1559Transaction)(e)?k.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:k.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:n,gas_limit:c,transaction_contract_method:G,transaction_replaced:Q,...t,...j};return G===F&&(W={...W,transaction_approval_amount_vs_balance_ratio:q,transaction_approval_amount_vs_proposed_ratio:z}),{properties:K,sensitiveProperties:W}}_createTransactionEventFragment(e,t,r,n,s){const a=`transaction-${[g.TransactionMetaMetricsEvent.finalized,g.TransactionMetaMetricsEvent.submitted].includes(t)?"submitted":"added"}-${e.id}`;if(void 0===this.getEventFragmentById(a))switch(t){case g.TransactionMetaMetricsEvent.added:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:g.TransactionMetaMetricsEvent.added,successEvent:g.TransactionMetaMetricsEvent.approved,failureEvent:g.TransactionMetaMetricsEvent.rejected,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:s});break;case g.TransactionMetaMetricsEvent.approved:case g.TransactionMetaMetricsEvent.rejected:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,successEvent:g.TransactionMetaMetricsEvent.approved,failureEvent:g.TransactionMetaMetricsEvent.rejected,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:s});break;case g.TransactionMetaMetricsEvent.submitted:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:g.TransactionMetaMetricsEvent.submitted,successEvent:g.TransactionMetaMetricsEvent.finalized,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:s});break;case g.TransactionMetaMetricsEvent.finalized:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,successEvent:g.TransactionMetaMetricsEvent.finalized,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:s})}}async _trackTransactionMetricsEvent(e,t,r,n={}){if(!e)return;const{properties:s,sensitiveProperties:a}=await this._buildEventFragmentProperties(e,n);let i;switch(this._createTransactionEventFragment(e,t,s,a,r),t){case g.TransactionMetaMetricsEvent.approved:i=`transaction-added-${e.id}`,this.updateEventFragment(i,{properties:s,sensitiveProperties:a}),this.finalizeEventFragment(i);break;case g.TransactionMetaMetricsEvent.rejected:i=`transaction-added-${e.id}`,this.updateEventFragment(i,{properties:s,sensitiveProperties:a}),this.finalizeEventFragment(i,{abandoned:!0});break;case g.TransactionMetaMetricsEvent.finalized:i=`transaction-submitted-${e.id}`,this.updateEventFragment(i,{properties:s,sensitiveProperties:a}),this.finalizeEventFragment(`transaction-submitted-${e.id}`)}}_getTransactionCompletionTime(e){return Math.round((Date.now()-e)/1e3).toString()}_getGasValuesInGWEI(e){const t={};for(const r in e)(0,a.isHexString)(e[r])?t[r]=(0,b.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}_failTransaction(e,t,r){this.txStateManager.setTxStatusFailed(e,t);const n=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(n,g.TransactionMetaMetricsEvent.finalized,r,{error:t.message})}_dropTransaction(e){this.txStateManager.setTxStatusDropped(e);const t=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(t,g.TransactionMetaMetricsEvent.finalized,undefined,{dropped:!0})}}r.default=j}}},{package:"$root$",file:"app/scripts/controllers/transactions/index.js"}],[3e3,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(r=t.exports=function(e){return String(e).replace(r.expr,"")}).expr=/\/+$/}}},{package:"remove-trailing-slash",file:"node_modules/remove-trailing-slash/index.js"}],[3017,{buffer:1768,pbkdf2:2817},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("pbkdf2").pbkdf2Sync,s=2147483647;function a(e,t,n,s,a){if(r.isBuffer(e)&&r.isBuffer(n))e.copy(n,s,t,t+a);else for(;a--;)n[s++]=e[t++]}t.exports=function(e,t,i,o,c,u,d){if(0===i||0!=(i&i-1))throw Error("N must be > 0 and a power of 2");if(i>s/128/o)throw Error("Parameter N is too large");if(o>s/128/c)throw Error("Parameter r is too large");var l,h=new r(256*o),p=new r(128*o*i),f=new Int32Array(16),m=new Int32Array(16),g=new r(64),y=n(e,t,1,128*c*o,"sha256");if(d){var E=c*i*2,b=0;l=function(){++b%1e3==0&&d({current:b,total:E,percent:b/E*100})}}for(var T=0;T<c;T++)_(y,128*T*o,o,i,p,h);return n(e,y,1,u,"sha256");function _(e,t,r,n,s,a){var i,o=128*r;for(e.copy(a,0,t,t+o),i=0;i<n;i++)a.copy(s,i*o,0,0+o),v(a,0,o,r),l&&l();for(i=0;i<n;i++){var c=0+64*(2*r-1);k(s,(a.readUInt32LE(c)&n-1)*o,a,0,o),v(a,0,o,r),l&&l()}a.copy(e,t,0,0+o)}function v(e,t,r,n){var s;for(a(e,t+64*(2*n-1),g,0,64),s=0;s<2*n;s++)k(e,64*s,g,0,64),S(g),a(g,0,e,r+64*s,64);for(s=0;s<n;s++)a(e,r+2*s*64,e,t+64*s,64);for(s=0;s<n;s++)a(e,r+64*(2*s+1),e,t+64*(s+n),64)}function w(e,t){return e<<t|e>>>32-t}function S(e){var t;for(t=0;t<16;t++)f[t]=(255&e[4*t+0])<<0,f[t]|=(255&e[4*t+1])<<8,f[t]|=(255&e[4*t+2])<<16,f[t]|=(255&e[4*t+3])<<24;for(a(f,0,m,0,16),t=8;t>0;t-=2)m[4]^=w(m[0]+m[12],7),m[8]^=w(m[4]+m[0],9),m[12]^=w(m[8]+m[4],13),m[0]^=w(m[12]+m[8],18),m[9]^=w(m[5]+m[1],7),m[13]^=w(m[9]+m[5],9),m[1]^=w(m[13]+m[9],13),m[5]^=w(m[1]+m[13],18),m[14]^=w(m[10]+m[6],7),m[2]^=w(m[14]+m[10],9),m[6]^=w(m[2]+m[14],13),m[10]^=w(m[6]+m[2],18),m[3]^=w(m[15]+m[11],7),m[7]^=w(m[3]+m[15],9),m[11]^=w(m[7]+m[3],13),m[15]^=w(m[11]+m[7],18),m[1]^=w(m[0]+m[3],7),m[2]^=w(m[1]+m[0],9),m[3]^=w(m[2]+m[1],13),m[0]^=w(m[3]+m[2],18),m[6]^=w(m[5]+m[4],7),m[7]^=w(m[6]+m[5],9),m[4]^=w(m[7]+m[6],13),m[5]^=w(m[4]+m[7],18),m[11]^=w(m[10]+m[9],7),m[8]^=w(m[11]+m[10],9),m[9]^=w(m[8]+m[11],13),m[10]^=w(m[9]+m[8],18),m[12]^=w(m[15]+m[14],7),m[13]^=w(m[12]+m[15],9),m[14]^=w(m[13]+m[12],13),m[15]^=w(m[14]+m[13],18);for(t=0;t<16;++t)f[t]=m[t]+f[t];for(t=0;t<16;t++){var r=4*t;e[r+0]=f[t]>>0&255,e[r+1]=f[t]>>8&255,e[r+2]=f[t]>>16&255,e[r+3]=f[t]>>24&255}}function k(e,t,r,n,s){for(var a=0;a<s;a++)r[n+a]^=e[t+a]}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>scryptsy",file:"node_modules/scryptsy/lib/scrypt.js"}],[3083,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=()=>!0,s=["newListener","removeListener"],a=e=>!s.includes(e);t.exports=function(e,t){let r=(t=t||{}).eventFilter||n;if("skipInternal"===r&&(r=a),"function"!=typeof r)throw new Error("createEventEmitterProxy - Invalid eventFilter");let s=e;return new Proxy({},{get:(e,t)=>"setTarget"===t?i:s[t],set:(e,t,r)=>"setTarget"===t?(i=r,!0):(s[t]=r,!0)});function i(e){const t=s;s=e,t.eventNames().filter(r).forEach((r=>{(function(e,t){if(e.rawListeners)return e.rawListeners(t);let r=e._events[t]||[];Array.isArray(r)||(r=[r]);return r.slice()})(t,r).forEach((t=>e.on(r,t)))})),t.removeAllListeners()}}}}},{package:"swappable-obj-proxy",file:"node_modules/swappable-obj-proxy/src/createEventEmitterProxy.js"}],[3084,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){let t=e;return new Proxy({},{get:(e,n)=>"setTarget"===n?r:t[n],set:(e,n,s)=>"setTarget"===n?(r=s,!0):(t[n]=s,!0)});function r(e){t=e}}}}},{package:"swappable-obj-proxy",file:"node_modules/swappable-obj-proxy/src/createSwappableProxy.js"}],[3085,{"./createEventEmitterProxy":3083,"./createSwappableProxy":3084},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./createSwappableProxy"),s=e("./createEventEmitterProxy");t.exports={createSwappableProxy:n,createEventEmitterProxy:s}}}},{package:"swappable-obj-proxy",file:"node_modules/swappable-obj-proxy/src/index.js"}],[3086,{_process:2826,stream:1771},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("stream");function s(e,t,s){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var a=!1,i=!1,o=[],c=!1,u=new n;function d(){for(;o.length&&!u.paused;){var e=o.shift();if(null===e)return u.emit("end");u.emit("data",e)}}function l(){u.writable=!1,t.call(u),!u.readable&&u.autoDestroy&&u.destroy()}return u.readable=u.writable=!0,u.paused=!1,u.autoDestroy=!(s&&!1===s.autoDestroy),u.write=function(t){return e.call(this,t),!u.paused},u.queue=u.push=function(e){return c||(null===e&&(c=!0),o.push(e),d()),u},u.on("end",(function(){u.readable=!1,!u.writable&&u.autoDestroy&&r.nextTick((function(){u.destroy()}))})),u.end=function(e){if(!a)return a=!0,arguments.length&&u.write(e),l(),u},u.destroy=function(){if(!i)return i=!0,a=!0,o.length=0,u.writable=u.readable=!1,u.emit("close"),u},u.pause=function(){if(!u.paused)return u.paused=!0,u},u.resume=function(){return u.paused&&(u.paused=!1,u.emit("resume")),d(),u.paused||u.emit("drain"),u},u}t.exports=s,s.through=s}).call(this)}).call(this,e("_process"))}}},{package:"debounce-stream>through",file:"node_modules/through/index.js"}],[3091,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new DataView(e.buffer,e.byteOffset,e.byteLength);if(e instanceof ArrayBuffer)return new DataView(e);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}}}},{package:"base32-encode>to-data-view",file:"node_modules/to-data-view/index.js"}],[3093,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.FIAT_RATES_UPDATE=r.NOTIFICATION=r.BLOCK=r.CONNECT=r.ERROR=void 0;r.ERROR="blockchain-error";r.CONNECT="blockchain-connect";r.BLOCK="blockchain-block";r.NOTIFICATION="blockchain-notification";r.FIAT_RATES_UPDATE="fiat-rates-update"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/blockchain.js"}],[3094,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.POOL_RELAY_TYPE=r.CERTIFICATE_TYPE=r.ADDRESS_TYPE=r.NETWORK_IDS=r.PROTOCOL_MAGICS=void 0;var n=Object.freeze({mainnet:764824073,testnet:42});r.PROTOCOL_MAGICS=n;var s=Object.freeze({mainnet:1,testnet:0});r.NETWORK_IDS=s;var a=Object.freeze({Base:0,Pointer:4,Enterprise:6,Byron:8,Reward:14});r.ADDRESS_TYPE=a;var i=Object.freeze({StakeRegistration:0,StakeDeregistration:1,StakeDelegation:2,StakePoolRegistration:3});r.CERTIFICATE_TYPE=i;var o=Object.freeze({SingleHostIp:0,SingleHostName:1,MultipleHostName:2});r.POOL_RELAY_TYPE=o}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/cardano.js"}],[3095,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.WAIT_FOR_SELECTION=r.WORD=r.PASSPHRASE_ON_DEVICE=r.PASSPHRASE=r.PIN=r.BUTTON=r.LOADING=r.USED_ELSEWHERE=r.RELEASED=r.ACQUIRED=r.RELEASE=r.ACQUIRE=r.CHANGED=r.DISCONNECT=r.CONNECT_UNACQUIRED=r.CONNECT=void 0;r.CONNECT="device-connect";r.CONNECT_UNACQUIRED="device-connect_unacquired";r.DISCONNECT="device-disconnect";r.CHANGED="device-changed";r.ACQUIRE="device-acquire";r.RELEASE="device-release";r.ACQUIRED="device-acquired";r.RELEASED="device-released";r.USED_ELSEWHERE="device-used_elsewhere";r.LOADING="device-loading";r.BUTTON="button";r.PIN="pin";r.PASSPHRASE="passphrase";r.PASSPHRASE_ON_DEVICE="passphrase_on_device";r.WORD="word";r.WAIT_FOR_SELECTION="device-wait_for_selection"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/device.js"}],[3096,{"@babel/runtime/helpers/inheritsLoose":184,"@babel/runtime/helpers/interopRequireDefault":185,"@babel/runtime/helpers/wrapNativeSuper":203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.LIBUSB_ERROR_MESSAGE=r.WEBUSB_ERROR_MESSAGE=r.INVALID_PIN_ERROR_MESSAGE=r.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE=r.TypedError=r.TrezorError=r.ERROR_CODES=void 0;var s=n(e("@babel/runtime/helpers/inheritsLoose")),a=n(e("@babel/runtime/helpers/wrapNativeSuper")),i={Init_NotInitialized:"TrezorConnect not yet initialized",Init_AlreadyInitialized:"TrezorConnect has been already initialized",Init_IframeBlocked:"Iframe blocked",Init_IframeTimeout:"Iframe timeout",Init_ManifestMissing:"Manifest not set. Read more at https://github.com/trezor/connect/blob/develop/docs/index.md",Popup_ConnectionMissing:"Unable to establish connection with iframe",Transport_Missing:"Transport is missing",Transport_InvalidProtobuf:"",Method_InvalidPackage:"This version of trezor-connect is not suitable to work without browser. Use trezor-connect@extended package instead",Method_InvalidParameter:"",Method_NotAllowed:"Method not allowed for this configuration",Method_PermissionsNotGranted:"Permissions not granted",Method_Cancel:"Cancelled",Method_Interrupted:"Popup closed",Method_UnknownCoin:"Coin not found",Method_AddressNotMatch:"Addresses do not match",Method_FirmwareUpdate_DownloadFailed:"Failed to download firmware binary",Method_CustomMessage_Callback:'Parameter "callback" is not a function',Method_Discovery_BundleException:"",Method_Override:"override",Method_NoResponse:"Call resolved without response",Backend_NotSupported:"BlockchainLink settings not found in coins.json",Backend_WorkerMissing:"",Backend_Disconnected:"Backend disconnected",Backend_Invalid:"Invalid backend",Backend_Error:"",Runtime:"",Device_NotFound:"Device not found",Device_InitializeFailed:"",Device_FwException:"",Device_ModeException:"",Device_Disconnected:"Device disconnected",Device_UsedElsewhere:"Device is used in another window",Device_InvalidState:"Passphrase is incorrect",Device_CallInProgress:"Device call in progress"};r.ERROR_CODES=i;var o=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).code=t,n.message=r,n}return(0,s.default)(t,e),t}((0,a.default)(Error));r.TrezorError=o;r.TypedError=function(e,t){return new o(e,t||i[e])};r.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE="wrong previous session";r.INVALID_PIN_ERROR_MESSAGE="PIN invalid";r.WEBUSB_ERROR_MESSAGE="NetworkError: Unable to claim interface.";r.LIBUSB_ERROR_MESSAGE="LIBUSB_ERROR"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/errors.js"}],[3097,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CALL=r.ERROR=r.INIT=r.LOADED=r.BOOTSTRAP=void 0;r.BOOTSTRAP="iframe-bootstrap";r.LOADED="iframe-loaded";r.INIT="iframe-init";r.ERROR="iframe-error";r.CALL="iframe-call"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/iframe.js"}],[3098,{"./blockchain":3093,"./cardano":3094,"./device":3095,"./errors":3096,"./iframe":3097,"./network":3099,"./popup":3100,"./transport":3101,"./ui":3102},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CARDANO=r.UI=r.TRANSPORT=r.POPUP=r.NETWORK=r.IFRAME=r.ERRORS=r.DEVICE=r.BLOCKCHAIN=r.BLOCKCHAIN_EVENT=r.RESPONSE_EVENT=r.TRANSPORT_EVENT=r.DEVICE_EVENT=r.UI_EVENT=r.CORE_EVENT=void 0;var n=p(e("./blockchain"));r.BLOCKCHAIN=n;var s=p(e("./device"));r.DEVICE=s;var a=p(e("./errors"));r.ERRORS=a;var i=p(e("./iframe"));r.IFRAME=i;var o=p(e("./network"));r.NETWORK=o;var c=p(e("./popup"));r.POPUP=c;var u=p(e("./transport"));r.TRANSPORT=u;var d=p(e("./ui"));r.UI=d;var l=p(e("./cardano"));function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=s?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}r.CARDANO=l;r.CORE_EVENT="CORE_EVENT";r.UI_EVENT="UI_EVENT";r.DEVICE_EVENT="DEVICE_EVENT";r.TRANSPORT_EVENT="TRANSPORT_EVENT";r.RESPONSE_EVENT="RESPONSE_EVENT";r.BLOCKCHAIN_EVENT="BLOCKCHAIN_EVENT"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/index.js"}],[3099,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.TYPES=void 0;var n=Object.freeze({bitcoin:"Bitcoin",ethereum:"Ethereum",eos:"Eos",nem:"NEM",stellar:"Stellar",cardano:"Cardano",ripple:"Ripple",tezos:"Tezors",binance:"Binance"});r.TYPES=n}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/network.js"}],[31,{"fast-json-patch":2289,lodash:2731},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.generateHistoryEntry=i,r.migrateFromSnapshotsToDiffs=function(e){return e.map(((t,r)=>0===r?t:i(e[r-1],t)))},r.replayHistory=function(e){return(0,a.cloneDeep)(e).reduce(((e,t)=>s.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t={...e};return delete t.history,(0,a.cloneDeep)(t)};var n,s=(n=e("fast-json-patch"))&&n.__esModule?n:{default:n},a=e("lodash");function i(e,t,r){const n=s.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}}}},{package:"$root$",file:"app/scripts/controllers/transactions/lib/tx-state-history-helpers.js"}],[3100,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CLOSE_WINDOW=r.CANCEL_POPUP_REQUEST=r.CLOSED=r.HANDSHAKE=r.EXTENSION_USB_PERMISSIONS=r.ERROR=r.INIT=r.LOADED=r.BOOTSTRAP=void 0;r.BOOTSTRAP="popup-bootstrap";r.LOADED="popup-loaded";r.INIT="popup-init";r.ERROR="popup-error";r.EXTENSION_USB_PERMISSIONS="open-usb-permissions";r.HANDSHAKE="popup-handshake";r.CLOSED="popup-closed";r.CANCEL_POPUP_REQUEST="ui-cancel-popup-request";r.CLOSE_WINDOW="window.close"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/popup.js"}],[3101,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.START_PENDING=r.DISABLE_WEBUSB=r.REQUEST=r.STREAM=r.UPDATE=r.ERROR=r.START=void 0;r.START="transport-start";r.ERROR="transport-error";r.UPDATE="transport-update";r.STREAM="transport-stream";r.REQUEST="transport-request_device";r.DISABLE_WEBUSB="transport-disable_webusb";r.START_PENDING="transport-start_pending"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/transport.js"}],[3102,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.IFRAME_FAILURE=r.ADDRESS_VALIDATION=r.BUNDLE_PROGRESS=r.LOGIN_CHALLENGE_RESPONSE=r.LOGIN_CHALLENGE_REQUEST=r.CUSTOM_MESSAGE_RESPONSE=r.CUSTOM_MESSAGE_REQUEST=r.CHANGE_SETTINGS=r.RECEIVE_WORD=r.RECEIVE_FEE=r.RECEIVE_ACCOUNT=r.CHANGE_ACCOUNT=r.RECEIVE_DEVICE=r.RECEIVE_PASSPHRASE=r.RECEIVE_PIN=r.RECEIVE_CONFIRMATION=r.RECEIVE_PERMISSION=r.REQUEST_WORD=r.REQUEST_BUTTON=r.INSUFFICIENT_FUNDS=r.UPDATE_CUSTOM_FEE=r.SELECT_FEE=r.SELECT_ACCOUNT=r.SELECT_DEVICE=r.SET_OPERATION=r.LOADING=r.CONNECT=r.INVALID_PASSPHRASE_ACTION=r.INVALID_PASSPHRASE=r.REQUEST_PASSPHRASE_ON_DEVICE=r.REQUEST_PASSPHRASE=r.INVALID_PIN=r.REQUEST_PIN=r.REQUEST_CONFIRMATION=r.REQUEST_PERMISSION=r.CLOSE_UI_WINDOW=r.REQUEST_UI_WINDOW=r.DEVICE_NEEDS_BACKUP=r.FIRMWARE_PROGRESS=r.FIRMWARE_NOT_INSTALLED=r.FIRMWARE_NOT_COMPATIBLE=r.FIRMWARE_NOT_SUPPORTED=r.FIRMWARE_OUTDATED=r.FIRMWARE_OLD=r.SEEDLESS=r.INITIALIZE=r.REQUIRE_MODE=r.NOT_IN_BOOTLOADER=r.BOOTLOADER=r.TRANSPORT=void 0;r.TRANSPORT="ui-no_transport";r.BOOTLOADER="ui-device_bootloader_mode";r.NOT_IN_BOOTLOADER="ui-device_not_in_bootloader_mode";r.REQUIRE_MODE="ui-device_require_mode";r.INITIALIZE="ui-device_not_initialized";r.SEEDLESS="ui-device_seedless";r.FIRMWARE_OLD="ui-device_firmware_old";r.FIRMWARE_OUTDATED="ui-device_firmware_outdated";r.FIRMWARE_NOT_SUPPORTED="ui-device_firmware_unsupported";r.FIRMWARE_NOT_COMPATIBLE="ui-device_firmware_not_compatible";r.FIRMWARE_NOT_INSTALLED="ui-device_firmware_not_installed";r.FIRMWARE_PROGRESS="ui-firmware-progress";r.DEVICE_NEEDS_BACKUP="ui-device_needs_backup";r.REQUEST_UI_WINDOW="ui-request_window";r.CLOSE_UI_WINDOW="ui-close_window";r.REQUEST_PERMISSION="ui-request_permission";r.REQUEST_CONFIRMATION="ui-request_confirmation";r.REQUEST_PIN="ui-request_pin";r.INVALID_PIN="ui-invalid_pin";r.REQUEST_PASSPHRASE="ui-request_passphrase";r.REQUEST_PASSPHRASE_ON_DEVICE="ui-request_passphrase_on_device";r.INVALID_PASSPHRASE="ui-invalid_passphrase";r.INVALID_PASSPHRASE_ACTION="ui-invalid_passphrase_action";r.CONNECT="ui-connect";r.LOADING="ui-loading";r.SET_OPERATION="ui-set_operation";r.SELECT_DEVICE="ui-select_device";r.SELECT_ACCOUNT="ui-select_account";r.SELECT_FEE="ui-select_fee";r.UPDATE_CUSTOM_FEE="ui-update_custom_fee";r.INSUFFICIENT_FUNDS="ui-insufficient_funds";r.REQUEST_BUTTON="ui-button";r.REQUEST_WORD="ui-request_word";r.RECEIVE_PERMISSION="ui-receive_permission";r.RECEIVE_CONFIRMATION="ui-receive_confirmation";r.RECEIVE_PIN="ui-receive_pin";r.RECEIVE_PASSPHRASE="ui-receive_passphrase";r.RECEIVE_DEVICE="ui-receive_device";r.CHANGE_ACCOUNT="ui-change_account";r.RECEIVE_ACCOUNT="ui-receive_account";r.RECEIVE_FEE="ui-receive_fee";r.RECEIVE_WORD="ui-receive_word";r.CHANGE_SETTINGS="ui-change_settings";r.CUSTOM_MESSAGE_REQUEST="ui-custom_request";r.CUSTOM_MESSAGE_RESPONSE="ui-custom_response";r.LOGIN_CHALLENGE_REQUEST="ui-login_challenge_request";r.LOGIN_CHALLENGE_RESPONSE="ui-login_challenge_response";r.BUNDLE_PROGRESS="ui-bundle_progress";r.ADDRESS_VALIDATION="ui-address_validation";r.IFRAME_FAILURE="ui-iframe_failure"}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/constants/ui.js"}],[3103,{"@babel/runtime/helpers/defineProperty":180,"@babel/runtime/helpers/interopRequireDefault":185},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.parse=r.corsValidator=r.getEnv=r.DEFAULT_PRIORITY=void 0;var s=n(e("@babel/runtime/helpers/defineProperty"));function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var i="8.2.6",o="https://connect.trezor.io/"+(i.split(".").map((function(e){return parseInt(e,10)}))[0]+"/");r.DEFAULT_PRIORITY=2;var c={configSrc:"./data/config.json",version:i,debug:!1,priority:2,trustedHost:!1,connectSrc:o,iframeSrc:o+"iframe.html",popup:!0,popupSrc:o+"popup.html",webusbSrc:o+"webusb.html",transportReconnect:!1,webusb:!0,pendingTransportEvent:!0,supportedBrowser:"undefined"==typeof navigator||!/Trident|MSIE|Edge/.test(navigator.userAgent),manifest:null,env:"web",lazyLoad:!1,timestamp:(new Date).getTime(),interactionTimeout:600},u=function(){if("undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect)return"webextension";if("undefined"!=typeof navigator){if("string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return"react-native";if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)return"electron"}return"web"};r.getEnv=u;var d=function(e){if("string"==typeof e)return e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*trezor\.io\//)||e.match(/^https?:\/\/localhost:[58][0-9]{3}\//)||e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*sldev\.cz\//)||e.match(/^https?:\/\/([A-Za-z0-9\-_]+\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\.onion\//)?e:void 0};r.corsValidator=d;r.parse=function(e){void 0===e&&(e={});var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c);if(Object.prototype.hasOwnProperty.call(e,"debug")&&(Array.isArray(e),"boolean"==typeof e.debug?t.debug=e.debug:"string"==typeof e.debug&&(t.debug="true"===e.debug)),"string"==typeof e.connectSrc&&(t.connectSrc=e.connectSrc),"undefined"!=typeof global&&"string"==typeof global.__TREZOR_CONNECT_SRC&&(t.connectSrc=d(global.__TREZOR_CONNECT_SRC),t.debug=!0),"undefined"!=typeof window&&window.location&&"string"==typeof window.location.search){var r=window.location.search.split("&").find((function(e){return e.indexOf("trezor-connect-src")>=0}));if(r){var n=r.split("=")[1];t.connectSrc=d(decodeURIComponent(n)),t.debug=!0}}var i=t.connectSrc||o;return t.iframeSrc=i+"iframe.html",t.popupSrc=i+"popup.html",t.webusbSrc=i+"webusb.html","boolean"==typeof e.transportReconnect&&(t.transportReconnect=e.transportReconnect),"boolean"==typeof e.webusb&&(t.webusb=e.webusb),"boolean"==typeof e.popup&&(t.popup=e.popup),"boolean"==typeof e.lazyLoad&&(t.lazyLoad=e.lazyLoad),"boolean"==typeof e.pendingTransportEvent&&(t.pendingTransportEvent=e.pendingTransportEvent),"undefined"!=typeof window&&window.location&&"file:"===window.location.protocol&&(t.origin="file://"+window.location.pathname,t.webusb=!1),"string"==typeof e.extension&&(t.extension=e.extension),"string"==typeof e.env?t.env=e.env:t.env=u(),"number"==typeof e.timestamp&&(t.timestamp=e.timestamp),"number"==typeof e.interactionTimeout&&(t.interactionTimeout=e.interactionTimeout),"object"==typeof e.manifest&&(t.manifest=function(e){if(e&&"string"==typeof e.email&&"string"==typeof e.appUrl)return{email:e.email,appUrl:e.appUrl}}(e.manifest)),c=t}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/data/ConnectSettings.js"}],[3104,{"../../constants":3098,"../../data/ConnectSettings":3103,"../../iframe/builder":3106,"../../message":3110,"../../message/builder":3109,"../../popup/PopupManager":3112,"../../types":3119,"../../utils/debug":3135,"../../webusb/button":3137,"@babel/runtime/helpers/asyncToGenerator":176,"@babel/runtime/helpers/defineProperty":180,"@babel/runtime/helpers/interopRequireDefault":185,"@babel/runtime/regenerator":204,events:1769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.disableWebUSB=r.requestLogin=r.customMessage=r.getSettings=r.renderWebUSBButton=r.uiResponse=r.call=r.init=r.cancel=r.dispose=r.manifest=r.eventEmitter=void 0;var s=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/defineProperty")),i=n(e("@babel/runtime/helpers/asyncToGenerator")),o=n(e("events")),c=n(e("../../popup/PopupManager")),u=y(e("../../iframe/builder")),d=n(e("../../webusb/button")),l=e("../../message"),h=e("../../message/builder"),p=e("../../data/ConnectSettings"),f=e("../../utils/debug"),m=e("../../constants");y(e("../../types"));function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(g=function(e){return e?r:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=g(t);if(r&&r.has(e))return r.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=s?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T=new o.default;r.eventEmitter=T;var _,v,w=(0,f.initLog)("[trezor-connect.js]"),S=function(){var e=new c.default(_);return e.on(m.POPUP.CLOSED,(function(e){u.postMessage({type:m.POPUP.CLOSED,payload:e?{error:e}:null},!1)})),e};r.manifest=function(e){_=(0,p.parse)({manifest:e})};var k=function(){T.removeAllListeners(),u.dispose(),v&&v.close()};r.dispose=k;r.cancel=function(e){v&&v.emit(m.POPUP.CLOSED,e)};var A=function(e){if(e.origin===u.origin){var t=(0,l.parseMessage)(e.data),r=t.event,n=t.type,s=t.payload,a=t.id||0;switch(w.log("handleMessage",t),r){case m.RESPONSE_EVENT:u.messagePromises[a]?(u.messagePromises[a].resolve({id:a,success:t.success,payload:s}),delete u.messagePromises[a]):w.warn("Unknown message id "+a);break;case m.DEVICE_EVENT:case m.TRANSPORT_EVENT:case m.BLOCKCHAIN_EVENT:T.emit(r,t),T.emit(n,s);break;case m.UI_EVENT:if(n===m.IFRAME.BOOTSTRAP){u.clearTimeout();break}n===m.IFRAME.LOADED&&u.initPromise.resolve(),n===m.IFRAME.ERROR&&u.initPromise.reject(s.error),T.emit(r,t),T.emit(n,s);break;default:w.log("Undefined message",r,e)}}},P=function(){var e=(0,i.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),!u.instance){e.next=3;break}throw m.ERRORS.TypedError("Init_AlreadyInitialized");case 3:if(_||(_=(0,p.parse)(t)),_.manifest){e.next=6;break}throw m.ERRORS.TypedError("Init_ManifestMissing");case 6:if(!_.lazyLoad){e.next=9;break}return _.lazyLoad=!1,e.abrupt("return");case 9:return v||(v=S()),w.enabled=!!_.debug,window.addEventListener("message",A),window.addEventListener("unload",k),e.next=15,u.init(_);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.init=P;var x=function(){var e=(0,i.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.instance||u.timeout){e.next=15;break}if((_=(0,p.parse)(_)).manifest){e.next=4;break}return e.abrupt("return",(0,l.errorMessage)(m.ERRORS.TypedError("Init_ManifestMissing")));case 4:return v||(v=S()),v.request(!0),e.prev=6,e.next=9,P(_);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),v&&(["Init_IframeBlocked","Init_IframeTimeout"].includes(e.t0.code)?v.postMessage((0,h.UiMessage)(m.UI.IFRAME_FAILURE)):v.close()),e.abrupt("return",(0,l.errorMessage)(e.t0));case 15:if(!u.timeout){e.next=17;break}return e.abrupt("return",(0,l.errorMessage)(m.ERRORS.TypedError("Init_ManifestMissing")));case 17:if(!u.error){e.next=19;break}return e.abrupt("return",(0,l.errorMessage)(u.error));case 19:return _.popup&&v&&v.request(),e.prev=20,e.next=23,u.postMessage({type:m.IFRAME.CALL,payload:t});case 23:if(!(r=e.sent)){e.next=27;break}return!r.success&&"Device_CallInProgress"!==r.payload.code&&v&&v.unlock(),e.abrupt("return",r);case 27:return v&&v.unlock(),e.abrupt("return",(0,l.errorMessage)(m.ERRORS.TypedError("Method_NoResponse")));case 31:return e.prev=31,e.t1=e.catch(20),w.error("__call error",e.t1),v&&v.close(),e.abrupt("return",(0,l.errorMessage)(e.t1));case 36:case"end":return e.stop()}}),e,null,[[6,11],[20,31]])})));return function(t){return e.apply(this,arguments)}}();r.call=x;var M=function(e){u.postMessage({event:m.UI_EVENT,type:m.UI.CUSTOM_MESSAGE_RESPONSE,payload:e})};r.uiResponse=function(e){var t=e.type,r=e.payload;u.postMessage({event:m.UI_EVENT,type:t,payload:r})};r.renderWebUSBButton=function(e){(0,d.default)(e,_.webusbSrc,u.origin)};r.getSettings=function(){return u.instance?x({method:"getSettings"}):Promise.resolve((0,l.errorMessage)(m.ERRORS.TypedError("Init_NotInitialized")))};var R=function(){var e=(0,i.default)(s.default.mark((function e(t){var r,n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof t.callback){e.next=2;break}return e.abrupt("return",(0,l.errorMessage)(m.ERRORS.TypedError("Method_CustomMessage_Callback")));case 2:return r=t.callback,n=function(){var e=(0,i.default)(s.default.mark((function e(t){var n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.data)||n.type!==m.UI.CUSTOM_MESSAGE_REQUEST){e.next=6;break}return e.next=4,r(n.payload);case 4:a=e.sent,M(a||{message:"release"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.addEventListener("message",n,!1),e.next=7,x(b(b({method:"customMessage"},t),{},{callback:null}));case 7:return a=e.sent,window.removeEventListener("message",n),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.customMessage=R;var I=function(){var e=(0,i.default)(s.default.mark((function e(t){var r,n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof t.callback){e.next=9;break}return r=t.callback,n=function(){var e=(0,i.default)(s.default.mark((function e(t){var n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.data)||n.type!==m.UI.LOGIN_CHALLENGE_REQUEST){e.next=12;break}return e.prev=2,e.next=5,r();case 5:a=e.sent,u.postMessage({event:m.UI_EVENT,type:m.UI.LOGIN_CHALLENGE_RESPONSE,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),u.postMessage({event:m.UI_EVENT,type:m.UI.LOGIN_CHALLENGE_RESPONSE,payload:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),window.addEventListener("message",n,!1),e.next=6,x(b(b({method:"requestLogin"},t),{},{asyncChallenge:!0,callback:null}));case 6:return a=e.sent,window.removeEventListener("message",n),e.abrupt("return",a);case 9:return e.abrupt("return",x(b({method:"requestLogin"},t)));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.requestLogin=I;r.disableWebUSB=function(){u.postMessage({event:m.UI_EVENT,type:m.TRANSPORT.DISABLE_WEBUSB})}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/env/browser/index.js"}],[3105,{"@babel/runtime/helpers/asyncToGenerator":176,"@babel/runtime/helpers/interopRequireDefault":185,"@babel/runtime/regenerator":204,"cross-fetch":1889},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.getOrigin=r.httpRequest=void 0;var s=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/asyncToGenerator")),i=n(e("cross-fetch")),o=function(){var e=(0,a.default)(s.default.mark((function e(t,r){var n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r="text"),e.next=3,(0,i.default)(t,{credentials:"same-origin"});case 3:if(!(n=e.sent).ok){e.next=13;break}if("json"!==r){e.next=10;break}return e.next=8,n.text();case 8:return a=e.sent,e.abrupt("return",JSON.parse(a));case 10:if("binary"!==r){e.next=12;break}return e.abrupt("return",n.arrayBuffer());case 12:return e.abrupt("return",n.text());case 13:throw new Error("httpRequest error: "+t+" "+n.statusText);case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();r.httpRequest=o;r.getOrigin=function(e){if(0===e.indexOf("file://"))return"file://";var t=e.match(/^.+\:\/\/[^\/]+/);return Array.isArray(t)&&t.length>0?t[0]:"unknown"}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/env/browser/networkUtils.js"}],[3106,{"../constants":3098,"../env/browser/networkUtils":3105,"../utils/deferred":3136,"./inline-styles":3107,"@babel/runtime/helpers/asyncToGenerator":176,"@babel/runtime/helpers/interopRequireDefault":185,"@babel/runtime/regenerator":204},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.clearTimeout=r.dispose=r.postMessage=r.init=r.messagePromises=r.error=r.timeout=r.initPromise=r.origin=r.instance=void 0;var s,a,i=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/asyncToGenerator")),c=e("../utils/deferred"),u=e("../constants"),d=e("../env/browser/networkUtils"),l=n(e("./inline-styles"));r.instance=s,r.origin=a;var h=(0,c.create)();r.initPromise=h;var p,f=0;r.timeout=f,r.error=p;var m=0,g={};r.messagePromises=g;var y=function(){var e=(0,o.default)(i.default.mark((function e(t){var n,o,l,p,m;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.initPromise=h=(0,c.create)(),(n=document.getElementById("trezorconnect"))?r.instance=s=n:(r.instance=s=document.createElement("iframe"),s.frameBorder="0",s.width="0px",s.height="0px",s.style.position="absolute",s.style.display="none",s.style.border="0px",s.style.width="0px",s.style.height="0px",s.id="trezorconnect"),"web"===t.env?(l=t.manifest?JSON.stringify(t.manifest):"undefined",p="version="+t.version+"&manifest="+encodeURIComponent(btoa(JSON.stringify(l))),o=t.iframeSrc+"?"+p):o=t.iframeSrc,s.setAttribute("src",o),t.webusb&&s.setAttribute("allow","usb"),r.origin=a=(0,d.getOrigin)(s.src),r.timeout=f=window.setTimeout((function(){h.reject(u.ERRORS.TypedError("Init_IframeTimeout"))}),1e4),m=function(){if(s){try{var e=s.contentWindow.location.origin;if(!e||"null"===e)return void b()}catch(e){}var r;"undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect&&(chrome.runtime.onConnect.addListener((function(){})),r=chrome.runtime.id),s.contentWindow.postMessage({type:u.IFRAME.INIT,payload:{settings:t,extension:r}},a),s.onload=undefined}else h.reject(u.ERRORS.TypedError("Init_IframeBlocked"))},s.attachEvent?s.attachEvent("onload",m):s.onload=m,document.body&&(document.body.appendChild(s),E()),e.prev=11,e.next=14,h.promise;case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(11),s&&(s.parentNode&&s.parentNode.removeChild(s),r.instance=s=null),e.t0;case 20:return e.prev=20,window.clearTimeout(f),r.timeout=f=0,e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[11,16,20,24]])})));return function(t){return e.apply(this,arguments)}}();r.init=y;var E=function(){if(!s)throw u.ERRORS.TypedError("Init_IframeBlocked");var e=s.ownerDocument,t=e.head||e.getElementsByTagName("head")[0],r=document.createElement("style");r.setAttribute("type","text/css"),r.setAttribute("id","TrezorConnectStylesheet"),r.styleSheet?(r.styleSheet.cssText=l.default,t.appendChild(r)):(r.appendChild(document.createTextNode(l.default)),t.append(r))},b=function(){window.clearTimeout(f),r.error=p=u.ERRORS.TypedError("Init_IframeBlocked"),T(),h.reject(p)};r.postMessage=function(e,t){if(void 0===t&&(t=!0),!s)throw u.ERRORS.TypedError("Init_IframeBlocked");if(t){m++,e.id=m,g[m]=(0,c.create)();var r=g[m].promise;return s.contentWindow.postMessage(e,a),r}return s.contentWindow.postMessage(e,a),null};var T=function(){if(s&&s.parentNode)try{s.parentNode.removeChild(s)}catch(e){}r.instance=s=null,r.timeout=f=0};r.dispose=T;r.clearTimeout=function(){window.clearTimeout(f)}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/iframe/builder.js"}],[3107,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.default=void 0;r.default='.trezorconnect-container{position:fixed!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-ms-flex-direction:column!important;flex-direction:column!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important;z-index:10000!important;width:100%!important;height:100%!important;top:0!important;left:0!important;background:rgba(0,0,0,.35)!important;overflow:auto!important;padding:20px!important;margin:0!important}.trezorconnect-container .trezorconnect-window{position:relative!important;display:block!important;width:370px!important;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif!important;margin:auto!important;border-radius:3px!important;background-color:#fff!important;text-align:center!important;overflow:hidden!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head{text-align:left;padding:12px 24px!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-logo{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close{cursor:pointer!important;height:24px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close svg{fill:#757575;-webkit-transition:fill .3s ease-in-out!important;transition:fill .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close:hover svg{fill:#494949}.trezorconnect-container .trezorconnect-window .trezorconnect-body{padding:24px 24px 32px!important;background:#FBFBFB!important;border-top:1px solid #EBEBEB}.trezorconnect-container .trezorconnect-window .trezorconnect-body h3{color:#505050!important;font-size:16px!important;font-weight:500!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body p{margin:8px 0 24px!important;font-weight:400!important;color:#A9A9A9!important;font-size:12px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button{width:100%!important;padding:12px 24px!important;margin:0!important;border-radius:3px!important;font-size:14px!important;font-weight:300!important;cursor:pointer!important;background:#01B757!important;color:#fff!important;border:0!important;-webkit-transition:background-color .3s ease-in-out!important;transition:background-color .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:hover{background-color:#00AB51!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:active{background-color:#009546!important}/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0IiwiJHN0ZGluIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLHlCQUNJLFNBQUEsZ0JBQ0EsUUFBQSxzQkFDQSxRQUFBLHVCQUNBLFFBQUEsc0JBRUEsUUFBQSxlQUNBLG1CQUFBLG1CQUNBLHNCQUFBLGlCQUNBLHVCQUFBLGlCQUNBLG1CQUFBLGlCQUNBLGVBQUEsaUJBRUEsa0JBQUEsaUJBQ0Esb0JBQUEsaUJBQ0EsZUFBQSxpQkNmTSxZQUFhLGlCREFyQixRQUFTLGdCQWtCSCxNQUFBLGVBQ0EsT0FBQSxlQUNBLElBQUEsWUFDQSxLQUFBLFlBQ0EsV0FBQSwwQkFDQSxTQUFBLGVBQ0EsUUFBQSxlQUNBLE9BQUEsWUNkUiwrQ0RYRSxTQUFVLG1CQTZCQSxRQUFBLGdCQUNBLE1BQUEsZ0JBQ0EsWUFBQSxjQUFBLG1CQUFBLFdBQUEsT0FBQSxpQkFBQSxNQUFBLHFCQUNBLE9BQUEsZUNmVixjQUFlLGNEakJmLGlCQWlCRSxlQWtCWSxXQUFBLGlCQ2ZkLFNBQVUsaUJEbUJJLG1FQUNBLFdBQUEsS0NoQmQsUUFBUyxLQUFLLGVEeEJkLFFBQVMsc0JBMENTLFFBQUEsdUJBQ0EsUUFBQSxzQkNmbEIsUUFBUyxlRGlCSyxrQkE1QlosaUJBOEJvQixvQkFBQSxpQkNoQmxCLGVBQWdCLGlCRC9CWixZQWlCTixpQkFzQ1EsdUZBQ0EsaUJBQUEsRUNwQlYsYUFBYyxFRHBDVixTQUFVLEVBMkRBLEtBQUEsRUFFQSx3RkNwQmQsT0FBUSxrQkR6Q1IsT0FBUSxlQWlFTSw0RkFDQSxLQUFBLFFBQ0EsbUJBQUEsS0FBQSxJQUFBLHNCQ3BCZCxXQUFZLEtBQUssSUFBSyxzQkR3QlIsa0dBQ0EsS0FBQSxRQUVBLG1FQUNBLFFBQUEsS0FBQSxLQUFBLGVBQ0EsV0FBQSxrQkFDQSxXQUFBLElBQUEsTUFBQSxRQUVBLHNFQUNBLE1BQUEsa0JBQ0EsVUFBQSxlQ3JCZCxZQUFhLGNEd0JLLHFFQ3JCbEIsT0FBUSxJQUFJLEVBQUksZUR3QkYsWUFBQSxjQUNJLE1BQUEsa0JDdEJsQixVQUFXLGVBRWIsMEVBQ0UsTUFBTyxlQUNQLFFBQVMsS0FBSyxlQUNkLE9BQVEsWUFDUixjQUFlLGNBQ2YsVUFBVyxlQUNYLFlBQWEsY0FDYixPQUFRLGtCQUNSLFdBQVksa0JBQ1osTUFBTyxlQUNQLE9BQVEsWUFDUixtQkFBb0IsaUJBQWlCLElBQUssc0JBQzFDLFdBQVksaUJBQWlCLElBQUssc0JBRXBDLGdGQUNFLGlCQUFrQixrQkFFcEIsaUZBQ0UsaUJBQWtCIn0= */'}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/iframe/inline-styles.js"}],[3108,{"./constants":3098,"./env/node":3104,"./types":3119,"@babel/runtime/helpers/defineProperty":180,"@babel/runtime/helpers/interopRequireDefault":185},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0;var s={};r.default=void 0;var a=n(e("@babel/runtime/helpers/defineProperty")),i=e("./constants");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(s,e)||e in r&&r[e]===i[e]||(r[e]=i[e]))}));var o=e("./env/node"),c=e("./types");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(s,e)||e in r&&r[e]===c[e]||(r[e]=c[e]))}));var l={manifest:o.manifest,init:o.init,getSettings:o.getSettings,on:function(e,t){o.eventEmitter.on(e,t)},off:function(e,t){o.eventEmitter.removeListener(e,t)},removeAllListeners:function(){o.eventEmitter.removeAllListeners()},uiResponse:o.uiResponse,blockchainGetAccountBalanceHistory:function(e){return(0,o.call)(d({method:"blockchainGetAccountBalanceHistory"},e))},blockchainGetCurrentFiatRates:function(e){return(0,o.call)(d({method:"blockchainGetCurrentFiatRates"},e))},blockchainGetFiatRatesForTimestamps:function(e){return(0,o.call)(d({method:"blockchainGetFiatRatesForTimestamps"},e))},blockchainDisconnect:function(e){return(0,o.call)(d({method:"blockchainDisconnect"},e))},blockchainEstimateFee:function(e){return(0,o.call)(d({method:"blockchainEstimateFee"},e))},blockchainGetTransactions:function(e){return(0,o.call)(d({method:"blockchainGetTransactions"},e))},blockchainSetCustomBackend:function(e){return(0,o.call)(d({method:"blockchainSetCustomBackend"},e))},blockchainSubscribe:function(e){return(0,o.call)(d({method:"blockchainSubscribe"},e))},blockchainSubscribeFiatRates:function(e){return(0,o.call)(d({method:"blockchainSubscribeFiatRates"},e))},blockchainUnsubscribe:function(e){return(0,o.call)(d({method:"blockchainUnsubscribe"},e))},blockchainUnsubscribeFiatRates:function(e){return(0,o.call)(d({method:"blockchainUnsubscribeFiatRates"},e))},customMessage:function(e){return(0,o.customMessage)(e)},requestLogin:function(e){return(0,o.requestLogin)(e)},cardanoGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"cardanoGetAddress"},e),{},{useEventListener:t}))},cardanoGetNativeScriptHash:function(e){return(0,o.call)(d({method:"cardanoGetNativeScriptHash"},e))},cardanoGetPublicKey:function(e){return(0,o.call)(d({method:"cardanoGetPublicKey"},e))},cardanoSignTransaction:function(e){return(0,o.call)(d({method:"cardanoSignTransaction"},e))},cipherKeyValue:function(e){return(0,o.call)(d({method:"cipherKeyValue"},e))},composeTransaction:function(e){return(0,o.call)(d({method:"composeTransaction"},e))},ethereumGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"ethereumGetAddress"},e),{},{useEventListener:t}))},ethereumGetPublicKey:function(e){return(0,o.call)(d({method:"ethereumGetPublicKey"},e))},ethereumSignMessage:function(e){return(0,o.call)(d({method:"ethereumSignMessage"},e))},ethereumSignTransaction:function(e){return(0,o.call)(d({method:"ethereumSignTransaction"},e))},ethereumSignTypedData:function(e){return(0,o.call)(d({method:"ethereumSignTypedData"},e))},ethereumVerifyMessage:function(e){return(0,o.call)(d({method:"ethereumVerifyMessage"},e))},getAccountInfo:function(e){return(0,o.call)(d({method:"getAccountInfo"},e))},getAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"getAddress"},e),{},{useEventListener:t}))},getDeviceState:function(e){return(0,o.call)(d({method:"getDeviceState"},e))},getFeatures:function(e){return(0,o.call)(d({method:"getFeatures"},e))},getPublicKey:function(e){return(0,o.call)(d({method:"getPublicKey"},e))},liskGetAddress:function(){return(0,o.call)({method:"liskDeprecated"})},liskGetPublicKey:function(){return(0,o.call)({method:"liskDeprecated"})},liskSignMessage:function(){return(0,o.call)({method:"liskDeprecated"})},liskSignTransaction:function(){return(0,o.call)({method:"liskDeprecated"})},liskVerifyMessage:function(){return(0,o.call)({method:"liskDeprecated"})},nemGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"nemGetAddress"},e),{},{useEventListener:t}))},nemSignTransaction:function(e){return(0,o.call)(d({method:"nemSignTransaction"},e))},pushTransaction:function(e){return(0,o.call)(d({method:"pushTransaction"},e))},rippleGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"rippleGetAddress"},e),{},{useEventListener:t}))},rippleSignTransaction:function(e){return(0,o.call)(d({method:"rippleSignTransaction"},e))},signMessage:function(e){return(0,o.call)(d({method:"signMessage"},e))},signTransaction:function(e){return(0,o.call)(d({method:"signTransaction"},e))},stellarGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"stellarGetAddress"},e),{},{useEventListener:t}))},stellarSignTransaction:function(e){return(0,o.call)(d({method:"stellarSignTransaction"},e))},tezosGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"tezosGetAddress"},e),{},{useEventListener:t}))},tezosGetPublicKey:function(e){return(0,o.call)(d({method:"tezosGetPublicKey"},e))},tezosSignTransaction:function(e){return(0,o.call)(d({method:"tezosSignTransaction"},e))},eosGetPublicKey:function(e){return(0,o.call)(d({method:"eosGetPublicKey"},e))},eosSignTransaction:function(e){return(0,o.call)(d({method:"eosSignTransaction"},e))},binanceGetAddress:function(e){var t=o.eventEmitter.listenerCount(i.UI.ADDRESS_VALIDATION)>0;return(0,o.call)(d(d({method:"binanceGetAddress"},e),{},{useEventListener:t}))},binanceGetPublicKey:function(e){return(0,o.call)(d({method:"binanceGetPublicKey"},e))},binanceSignTransaction:function(e){return(0,o.call)(d({method:"binanceSignTransaction"},e))},verifyMessage:function(e){return(0,o.call)(d({method:"verifyMessage"},e))},resetDevice:function(e){return(0,o.call)(d({method:"resetDevice"},e))},wipeDevice:function(e){return(0,o.call)(d({method:"wipeDevice"},e))},applyFlags:function(e){return(0,o.call)(d({method:"applyFlags"},e))},applySettings:function(e){return(0,o.call)(d({method:"applySettings"},e))},backupDevice:function(e){return(0,o.call)(d({method:"backupDevice"},e))},changePin:function(e){return(0,o.call)(d({method:"changePin"},e))},firmwareUpdate:function(e){return(0,o.call)(d({method:"firmwareUpdate"},e))},recoveryDevice:function(e){return(0,o.call)(d({method:"recoveryDevice"},e))},getCoinInfo:function(e){return(0,o.call)(d({method:"getCoinInfo"},e))},rebootToBootloader:function(e){return(0,o.call)(d({method:"rebootToBootloader"},e))},dispose:o.dispose,cancel:o.cancel,renderWebUSBButton:o.renderWebUSBButton,disableWebUSB:o.disableWebUSB};r.default=l}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/index.js"}],[3109,{"../constants":3098,"@babel/runtime/helpers/defineProperty":180,"@babel/runtime/helpers/interopRequireDefault":185},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.BlockchainMessage=r.ResponseMessage=r.TransportMessage=r.DeviceMessage=r.UiMessage=void 0;var s=n(e("@babel/runtime/helpers/defineProperty")),a=e("../constants");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.UiMessage=function(e,t){return{event:a.UI_EVENT,type:e,payload:t}};r.DeviceMessage=function(e,t){return{event:a.DEVICE_EVENT,type:e,payload:t}};r.TransportMessage=function(e,t){return{event:a.TRANSPORT_EVENT,type:e,payload:t.error?o(o({},t),{},{error:t.error.message,code:t.error.code}):t}};r.ResponseMessage=function(e,t,r){return void 0===r&&(r=null),{event:a.RESPONSE_EVENT,type:a.RESPONSE_EVENT,id:e,success:t,payload:t?r:{error:r.error.message,code:r.error.code}}};r.BlockchainMessage=function(e,t){return{event:a.BLOCKCHAIN_EVENT,type:e,payload:t}}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/message/builder.js"}],[3110,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.errorMessage=r.parseMessage=void 0;r.parseMessage=function(e){var t={event:e.event,type:e.type,payload:e.payload};return"number"==typeof e.id&&(t.id=e.id),"boolean"==typeof e.success&&(t.success=e.success),t};r.errorMessage=function(e){return{success:!1,payload:{error:e.message,code:e.code}}}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/message/index.js"}],[3111,{"@babel/runtime/helpers/defineProperty":180,"@babel/runtime/helpers/interopRequireDefault":185,"@metamask/eth-sig-util":1050},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/defineProperty"));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var a=e("@metamask/eth-sig-util");function i(e){switch(Object.prototype.toString.call(e)){case"[object Object]":var t=Object.keys(e).map((function(t){return[t,i(e[t])]}));return Object.fromEntries(t);case"[object Array]":return e.map((function(e){return i(e)}));case"[object BigInt]":return e.toString();default:return e}}t.exports=function(e,t){if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");var r=a.SignTypedDataVersion.V4,o=a.TypedDataUtils.sanitizeData(e),c=o.types,u=o.primaryType,d=o.domain,l=o.message;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({domain_separator_hash:a.TypedDataUtils.hashStruct("EIP712Domain",i(d),c,r).toString("hex"),message_hash:a.TypedDataUtils.hashStruct(u,i(l),c,r).toString("hex")},e)}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/plugins/ethereum/typedData.js"}],[3112,{"../constants/iframe":3097,"../constants/popup":3100,"../constants/ui":3102,"../env/browser/networkUtils":3105,"../utils/deferred":3136,"./showPopupRequest":3113,"@babel/runtime/helpers/assertThisInitialized":175,"@babel/runtime/helpers/asyncToGenerator":176,"@babel/runtime/helpers/defineProperty":180,"@babel/runtime/helpers/inheritsLoose":184,"@babel/runtime/helpers/interopRequireDefault":185,"@babel/runtime/regenerator":204,events:1769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.default=void 0;var s=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/asyncToGenerator")),i=n(e("@babel/runtime/helpers/assertThisInitialized")),o=n(e("@babel/runtime/helpers/inheritsLoose")),c=n(e("@babel/runtime/helpers/defineProperty")),u=n(e("events")),d=y(e("../constants/popup")),l=y(e("../constants/iframe")),h=y(e("../constants/ui")),p=e("./showPopupRequest"),f=e("../env/browser/networkUtils"),m=e("../utils/deferred");function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(g=function(e){return e?r:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=g(t);if(r&&r.has(e))return r.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=s?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}var E=function(e){function t(t){var r;return r=e.call(this)||this,(0,c.default)((0,i.default)(r),"requestTimeout",0),(0,c.default)((0,i.default)(r),"closeInterval",0),(0,c.default)((0,i.default)(r),"extensionTabId",0),r.settings=t,r.origin=(0,f.getOrigin)(t.popupSrc),r.handleMessage=r.handleMessage.bind((0,i.default)(r)),r.iframeHandshake=(0,m.create)(l.LOADED),"webextension"===r.settings.env&&(r.handleExtensionConnect=r.handleExtensionConnect.bind((0,i.default)(r)),r.handleExtensionMessage=r.handleExtensionMessage.bind((0,i.default)(r)),chrome.runtime.onConnect.addListener(r.handleExtensionConnect)),window.addEventListener("message",r.handleMessage,!1),r}(0,o.default)(t,e);var r=t.prototype;return r.request=function(e){var t=this;if(void 0===e&&(e=!1),this.locked)this._window&&("webextension"===this.settings.env?chrome.tabs.update(this._window.id,{active:!0}):this._window.focus());else{var r=this.open.bind(this);if(this.locked=!0,this.settings.supportedBrowser){var n=e||"webextension"===this.settings.env?1:850;this.requestTimeout=window.setTimeout((function(){t.requestTimeout=0,r(e)}),n)}else r()}},r.cancel=function(){this.close()},r.unlock=function(){this.locked=!1},r.open=function(e){var t=this,r=this.settings.popupSrc;this.settings.supportedBrowser?(this.popupPromise=(0,m.create)(d.LOADED),this.openWrapper(e?r+"#loading":r),this.closeInterval=window.setInterval((function(){t._window&&("webextension"===t.settings.env?chrome.tabs.get(t._window.id,(function(e){e||(t.close(),t.emit(d.CLOSED))})):t._window.closed&&(t.close(),t.emit(d.CLOSED)))}),500),this.openTimeout=window.setTimeout((function(){t.close(),(0,p.showPopupRequest)(t.open.bind(t),(function(){t.emit(d.CLOSED)}))}),3e3)):this.openWrapper(r+"#unsupported")},r.openWrapper=function(e){var t=this;"webextension"===this.settings.env?chrome.windows.getCurrent(null,(function(r){"normal"!==r.type?chrome.windows.create({url:e},(function(e){chrome.tabs.query({windowId:e.id,active:!0},(function(e){t._window=e[0]}))})):chrome.tabs.query({currentWindow:!0,active:!0},(function(r){t.extensionTabId=r[0].id,chrome.tabs.create({url:e,index:r[0].index+1},(function(e){t._window=e}))}))})):"electron"===this.settings.env?this._window=window.open(e,"modal"):(this._window=window.open("","_blank"),this._window&&(this._window.location.href=e))},r.handleExtensionConnect=function(e){"trezor-connect"===e.name&&(!this._window||this._window&&this._window.id!==e.sender.tab.id?e.disconnect():(window.clearTimeout(this.openTimeout),this.extensionPort=e,this.extensionPort.onMessage.addListener(this.handleExtensionMessage)))},r.handleExtensionMessage=function(e){var t=this;if(this.extensionPort){var r=this.extensionPort,n=e.data;if(n&&"object"==typeof n)if(n.type===d.ERROR){var s=n.payload&&"string"==typeof n.payload.error?n.payload.error:null;this.emit(d.CLOSED,s?"Popup error: "+s:null),this.close()}else n.type===d.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((function(e){r.postMessage({type:d.INIT,payload:{settings:t.settings,useBroadcastChannel:e}})}))):n.type===d.EXTENSION_USB_PERMISSIONS?chrome.tabs.query({currentWindow:!0,active:!0},(function(e){chrome.tabs.create({url:"trezor-usb-permissions.html",index:e[0].index+1},(function(e){}))})):n.type===d.CLOSE_WINDOW&&(this.emit(d.CLOSED),this.close())}},r.handleMessage=function(e){var t=this,r=e.data;if((0,f.getOrigin)(e.origin)===this.origin&&r&&"object"==typeof r)if(r.type===l.LOADED){var n=!(!r.payload||"boolean"!=typeof r.payload.useBroadcastChannel)&&r.payload.useBroadcastChannel;this.iframeHandshake.resolve(n)}else if(r.type===d.BOOTSTRAP)window.clearTimeout(this.openTimeout);else if(r.type===d.ERROR&&this._window){var s=r.payload&&"string"==typeof r.payload.error?r.payload.error:null;this.emit(d.CLOSED,s?"Popup error: "+s:null),this.close()}else r.type===d.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((function(e){t._window.postMessage({type:d.INIT,payload:{settings:t.settings,useBroadcastChannel:e}},t.origin)}))):r.type!==d.CANCEL_POPUP_REQUEST&&r.type!==h.CLOSE_UI_WINDOW||this.close()},r.close=function(){if(this.locked=!1,this.popupPromise=undefined,this.requestTimeout&&(window.clearTimeout(this.requestTimeout),this.requestTimeout=0),this.openTimeout&&(window.clearTimeout(this.openTimeout),this.openTimeout=0),this.closeInterval&&(window.clearInterval(this.closeInterval),this.closeInterval=0),this.extensionPort&&(this.extensionPort.disconnect(),this.extensionPort=null),this.extensionTabId&&(chrome.tabs.update(this.extensionTabId,{active:!0}),this.extensionTabId=0),this._window){if("webextension"===this.settings.env){chrome.runtime.lastError;chrome.tabs.remove(this._window.id,(function(){chrome.runtime.lastError}))}else this._window.close();this._window=null}},r.postMessage=function(){var e=(0,a.default)(s.default.mark((function e(t){var r=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._window||t.type===h.REQUEST_UI_WINDOW||!this.openTimeout){e.next=4;break}return this.close(),(0,p.showPopupRequest)(this.open.bind(this),(function(){r.emit(d.CLOSED)})),e.abrupt("return");case 4:if(!this.popupPromise){e.next=7;break}return e.next=7,this.popupPromise.promise;case 7:this._window&&this._window.postMessage(t,this.origin);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(u.default);r.default=E}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/popup/PopupManager.js"}],[3113,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.showPopupRequest=void 0;var n="TrezorConnectInteractionLayer",s='\n    <div class="trezorconnect-container" id="'+n+'">\n        <div class="trezorconnect-window">\n            <div class="trezorconnect-head">\n                <svg class="trezorconnect-logo" x="0px" y="0px" viewBox="0 0 163.7 41.9" width="78px" height="20px" preserveAspectRatio="xMinYMin meet">\n                    <polygon points="101.1,12.8 118.2,12.8 118.2,17.3 108.9,29.9 118.2,29.9 118.2,35.2 101.1,35.2 101.1,30.7 110.4,18.1 101.1,18.1"/>\n                    <path d="M158.8,26.9c2.1-0.8,4.3-2.9,4.3-6.6c0-4.5-3.1-7.4-7.7-7.4h-10.5v22.3h5.8v-7.5h2.2l4.1,7.5h6.7L158.8,26.9z M154.7,22.5 h-4V18h4c1.5,0,2.5,0.9,2.5,2.2C157.2,21.6,156.2,22.5,154.7,22.5z"/>\n                    <path d="M130.8,12.5c-6.8,0-11.6,4.9-11.6,11.5s4.9,11.5,11.6,11.5s11.7-4.9,11.7-11.5S137.6,12.5,130.8,12.5z M130.8,30.3 c-3.4,0-5.7-2.6-5.7-6.3c0-3.8,2.3-6.3,5.7-6.3c3.4,0,5.8,2.6,5.8,6.3C136.6,27.7,134.2,30.3,130.8,30.3z"/>\n                    <polygon points="82.1,12.8 98.3,12.8 98.3,18 87.9,18 87.9,21.3 98,21.3 98,26.4 87.9,26.4 87.9,30 98.3,30 98.3,35.2 82.1,35.2 "/>\n                    <path d="M24.6,9.7C24.6,4.4,20,0,14.4,0S4.2,4.4,4.2,9.7v3.1H0v22.3h0l14.4,6.7l14.4-6.7h0V12.9h-4.2V9.7z M9.4,9.7 c0-2.5,2.2-4.5,5-4.5s5,2,5,4.5v3.1H9.4V9.7z M23,31.5l-8.6,4l-8.6-4V18.1H23V31.5z"/>\n                    <path d="M79.4,20.3c0-4.5-3.1-7.4-7.7-7.4H61.2v22.3H67v-7.5h2.2l4.1,7.5H80l-4.9-8.3C77.2,26.1,79.4,24,79.4,20.3z M71,22.5h-4V18 h4c1.5,0,2.5,0.9,2.5,2.2C73.5,21.6,72.5,22.5,71,22.5z"/>\n                    <polygon points="40.5,12.8 58.6,12.8 58.6,18.1 52.4,18.1 52.4,35.2 46.6,35.2 46.6,18.1 40.5,18.1 "/>\n                </svg>\n                <div class="trezorconnect-close">\n                    <svg x="0px" y="0px" viewBox="24 24 60 60" width="24px" height="24px" preserveAspectRatio="xMinYMin meet">\n                        <polygon class="st0" points="40,67.9 42.1,70 55,57.1 67.9,70 70,67.9 57.1,55 70,42.1 67.9,40 55,52.9 42.1,40 40,42.1 52.9,55 "/>\n                    </svg>\n                </div>\n            </div>\n            <div class="trezorconnect-body">\n                <h3>Popup was blocked</h3>\n                <p>Please click to “Continue” to open popup manually</p>\n                <button class="trezorconnect-open">Continue</button>\n            </div>\n        </div>\n    </div>\n';r.showPopupRequest=function(e,t){if(!document.getElementById(n)){var r=document.createElement("div");r.id=n,r.className="trezorconnect-container",r.innerHTML=s,document.body&&document.body.appendChild(r),r.getElementsByClassName("trezorconnect-open")[0].onclick=function(){e(),document.body&&document.body.removeChild(r)},r.getElementsByClassName("trezorconnect-close")[0].onclick=function(){t(),document.body&&document.body.removeChild(r)}}}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/popup/showPopupRequest.js"}],[3114,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/account.js"}],[3115,{"../constants":3098,"./account":3114,"./backend/blockchain":3116,"./events":3118,"./misc":3120,"./networks/binance":3121,"./networks/bitcoin":3122,"./networks/cardano":3123,"./networks/coinInfo":3124,"./networks/eos":3125,"./networks/ethereum":3126,"./networks/nem":3127,"./networks/ripple":3128,"./networks/stellar":3129,"./networks/tezos":3130,"./params":3131,"./trezor/device":3132,"./trezor/management":3133,"./trezor/protobuf":3134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){s(e("../constants")),s(e("./params")),s(e("./trezor/device")),s(e("./trezor/management")),s(e("./trezor/protobuf")),s(e("./account")),s(e("./networks/bitcoin")),s(e("./networks/binance")),s(e("./networks/cardano")),s(e("./networks/coinInfo")),s(e("./networks/eos")),s(e("./networks/ethereum")),s(e("./networks/nem")),s(e("./networks/ripple")),s(e("./networks/stellar")),s(e("./networks/tezos")),s(e("./misc")),s(e("./events")),s(e("./backend/blockchain"));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=e[i]}return s.default=e,r&&r.set(e,s),s}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/api.js"}],[3116,{"../../constants":3098},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){e("../../constants")}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/backend/blockchain.js"}],[3117,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/backend/transactions.js"}],[3118,{"../constants":3098},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){e("../constants")}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/events.js"}],[3119,{"./account":3114,"./api":3115,"./backend/blockchain":3116,"./backend/transactions":3117,"./events":3118,"./misc":3120,"./networks/binance":3121,"./networks/bitcoin":3122,"./networks/cardano":3123,"./networks/coinInfo":3124,"./networks/eos":3125,"./networks/ethereum":3126,"./networks/nem":3127,"./networks/ripple":3128,"./networks/stellar":3129,"./networks/tezos":3130,"./params":3131,"./trezor/device":3132,"./trezor/management":3133},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0;var n=e("./api");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||(r[e]=n[e]))}));var s=e("./events");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||(r[e]=s[e]))}));var a=e("./misc");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===a[e]||(r[e]=a[e]))}));var i=e("./params");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===i[e]||(r[e]=i[e]))}));var o=e("./account");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===o[e]||(r[e]=o[e]))}));var c=e("./trezor/device");Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===c[e]||(r[e]=c[e]))}));var u=e("./trezor/management");Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===u[e]||(r[e]=u[e]))}));var d=e("./networks/bitcoin");Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===d[e]||(r[e]=d[e]))}));var l=e("./networks/binance");Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===l[e]||(r[e]=l[e]))}));var h=e("./networks/cardano");Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===h[e]||(r[e]=h[e]))}));var p=e("./networks/coinInfo");Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===p[e]||(r[e]=p[e]))}));var f=e("./networks/eos");Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===f[e]||(r[e]=f[e]))}));var m=e("./networks/ethereum");Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===m[e]||(r[e]=m[e]))}));var g=e("./networks/nem");Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===g[e]||(r[e]=g[e]))}));var y=e("./networks/ripple");Object.keys(y).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===y[e]||(r[e]=y[e]))}));var E=e("./networks/stellar");Object.keys(E).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===E[e]||(r[e]=E[e]))}));var b=e("./networks/tezos");Object.keys(b).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===b[e]||(r[e]=b[e]))}));var T=e("./backend/blockchain");Object.keys(T).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===T[e]||(r[e]=T[e]))}));var _=e("./backend/transactions");Object.keys(_).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===_[e]||(r[e]=_[e]))}))}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/index.js"}],[3120,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/misc.js"}],[3121,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/binance.js"}],[3122,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/bitcoin.js"}],[3123,{"../trezor/protobuf":3134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CardanoTxWitnessType=r.CardanoTxSigningMode=r.CardanoPoolRelayType=r.CardanoNativeScriptHashDisplayFormat=r.CardanoNativeScriptType=r.CardanoCertificateType=r.CardanoAddressType=void 0;var n=e("../trezor/protobuf");r.CardanoAddressType=n.Enum_CardanoAddressType,r.CardanoCertificateType=n.Enum_CardanoCertificateType,r.CardanoNativeScriptType=n.Enum_CardanoNativeScriptType,r.CardanoNativeScriptHashDisplayFormat=n.Enum_CardanoNativeScriptHashDisplayFormat,r.CardanoPoolRelayType=n.Enum_CardanoPoolRelayType,r.CardanoTxSigningMode=n.Enum_CardanoTxSigningMode,r.CardanoTxWitnessType=n.Enum_CardanoTxWitnessType}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/cardano.js"}],[3124,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/coinInfo.js"}],[3125,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/eos.js"}],[3126,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/ethereum.js"}],[3127,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/nem.js"}],[3128,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/ripple.js"}],[3129,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/stellar.js"}],[3130,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/networks/tezos.js"}],[3131,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/params.js"}],[3132,{"../../constants":3098},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){e("../../constants")}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/trezor/device.js"}],[3133,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/trezor/management.js"}],[3134,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.Enum_TezosBallotType=r.Enum_TezosContractType=r.Enum_StellarSignerType=r.Enum_StellarMemoType=r.Enum_StellarAssetType=r.Enum_NEMImportanceTransferMode=r.Enum_NEMModificationType=r.Enum_NEMSupplyChangeType=r.Enum_NEMMosaicLevy=r.Enum_WordRequestType=r.Enum_RecoveryDeviceType=r.Enum_SdProtectOperationType=r.Enum_Capability=r.Enum_SafetyCheckLevel=r.Enum_BackupType=r.Enum_EthereumDataType=r.Enum_PinMatrixRequestType=r.Enum_ButtonRequestType=r.Enum_FailureType=r.Enum_CardanoTxWitnessType=r.Enum_CardanoTxSigningMode=r.Enum_CardanoTxAuxiliaryDataSupplementType=r.Enum_CardanoPoolRelayType=r.Enum_CardanoCertificateType=r.Enum_CardanoNativeScriptHashDisplayFormat=r.Enum_CardanoNativeScriptType=r.Enum_CardanoAddressType=r.Enum_CardanoDerivationType=r.Enum_RequestType=r.Enum_AmountUnit=r.Enum_DecredStakingSpendType=r.Enum_OutputScriptType=r.Enum_InputScriptType=r.Enum_BinanceTimeInForce=r.Enum_BinanceOrderSide=r.Enum_BinanceOrderType=void 0;var n=Object.freeze({OT_UNKNOWN:0,MARKET:1,LIMIT:2,OT_RESERVED:3});r.Enum_BinanceOrderType=n;var s=Object.freeze({SIDE_UNKNOWN:0,BUY:1,SELL:2});r.Enum_BinanceOrderSide=s;var a=Object.freeze({TIF_UNKNOWN:0,GTE:1,TIF_RESERVED:2,IOC:3});r.Enum_BinanceTimeInForce=a;var i=Object.freeze({SPENDADDRESS:0,SPENDMULTISIG:1,EXTERNAL:2,SPENDWITNESS:3,SPENDP2SHWITNESS:4,SPENDTAPROOT:5});r.Enum_InputScriptType=i;var o=Object.freeze({PAYTOADDRESS:0,PAYTOSCRIPTHASH:1,PAYTOMULTISIG:2,PAYTOOPRETURN:3,PAYTOWITNESS:4,PAYTOP2SHWITNESS:5,PAYTOTAPROOT:6});r.Enum_OutputScriptType=o;var c=Object.freeze({SSGen:0,SSRTX:1});r.Enum_DecredStakingSpendType=c;var u=Object.freeze({BITCOIN:0,MILLIBITCOIN:1,MICROBITCOIN:2,SATOSHI:3});r.Enum_AmountUnit=u;var d=Object.freeze({TXINPUT:0,TXOUTPUT:1,TXMETA:2,TXFINISHED:3,TXEXTRADATA:4,TXORIGINPUT:5,TXORIGOUTPUT:6});r.Enum_RequestType=d;var l=Object.freeze({LEDGER:0,ICARUS:1,ICARUS_TREZOR:2});r.Enum_CardanoDerivationType=l;var h=Object.freeze({BASE:0,BASE_SCRIPT_KEY:1,BASE_KEY_SCRIPT:2,BASE_SCRIPT_SCRIPT:3,POINTER:4,POINTER_SCRIPT:5,ENTERPRISE:6,ENTERPRISE_SCRIPT:7,BYRON:8,REWARD:14,REWARD_SCRIPT:15});r.Enum_CardanoAddressType=h;var p=Object.freeze({PUB_KEY:0,ALL:1,ANY:2,N_OF_K:3,INVALID_BEFORE:4,INVALID_HEREAFTER:5});r.Enum_CardanoNativeScriptType=p;var f=Object.freeze({HIDE:0,BECH32:1,POLICY_ID:2});r.Enum_CardanoNativeScriptHashDisplayFormat=f;var m=Object.freeze({STAKE_REGISTRATION:0,STAKE_DEREGISTRATION:1,STAKE_DELEGATION:2,STAKE_POOL_REGISTRATION:3});r.Enum_CardanoCertificateType=m;var g=Object.freeze({SINGLE_HOST_IP:0,SINGLE_HOST_NAME:1,MULTIPLE_HOST_NAME:2});r.Enum_CardanoPoolRelayType=g;var y=Object.freeze({NONE:0,CATALYST_REGISTRATION_SIGNATURE:1});r.Enum_CardanoTxAuxiliaryDataSupplementType=y;var E=Object.freeze({ORDINARY_TRANSACTION:0,POOL_REGISTRATION_AS_OWNER:1,MULTISIG_TRANSACTION:2});r.Enum_CardanoTxSigningMode=E;var b=Object.freeze({BYRON_WITNESS:0,SHELLEY_WITNESS:1});r.Enum_CardanoTxWitnessType=b;var T=Object.freeze({Failure_UnexpectedMessage:1,Failure_ButtonExpected:2,Failure_DataError:3,Failure_ActionCancelled:4,Failure_PinExpected:5,Failure_PinCancelled:6,Failure_PinInvalid:7,Failure_InvalidSignature:8,Failure_ProcessError:9,Failure_NotEnoughFunds:10,Failure_NotInitialized:11,Failure_PinMismatch:12,Failure_WipeCodeMismatch:13,Failure_InvalidSession:14,Failure_FirmwareError:99});r.Enum_FailureType=T;var _=Object.freeze({ButtonRequest_Other:1,ButtonRequest_FeeOverThreshold:2,ButtonRequest_ConfirmOutput:3,ButtonRequest_ResetDevice:4,ButtonRequest_ConfirmWord:5,ButtonRequest_WipeDevice:6,ButtonRequest_ProtectCall:7,ButtonRequest_SignTx:8,ButtonRequest_FirmwareCheck:9,ButtonRequest_Address:10,ButtonRequest_PublicKey:11,ButtonRequest_MnemonicWordCount:12,ButtonRequest_MnemonicInput:13,_Deprecated_ButtonRequest_PassphraseType:14,ButtonRequest_UnknownDerivationPath:15,ButtonRequest_RecoveryHomepage:16,ButtonRequest_Success:17,ButtonRequest_Warning:18,ButtonRequest_PassphraseEntry:19,ButtonRequest_PinEntry:20});r.Enum_ButtonRequestType=_;var v=Object.freeze({PinMatrixRequestType_Current:1,PinMatrixRequestType_NewFirst:2,PinMatrixRequestType_NewSecond:3,PinMatrixRequestType_WipeCodeFirst:4,PinMatrixRequestType_WipeCodeSecond:5});r.Enum_PinMatrixRequestType=v;var w=Object.freeze({UINT:1,INT:2,BYTES:3,STRING:4,BOOL:5,ADDRESS:6,ARRAY:7,STRUCT:8});r.Enum_EthereumDataType=w;var S=Object.freeze({Bip39:0,Slip39_Basic:1,Slip39_Advanced:2});r.Enum_BackupType=S;var k=Object.freeze({Strict:0,PromptAlways:1,PromptTemporarily:2});r.Enum_SafetyCheckLevel=k;var A=Object.freeze({Capability_Bitcoin:1,Capability_Bitcoin_like:2,Capability_Binance:3,Capability_Cardano:4,Capability_Crypto:5,Capability_EOS:6,Capability_Ethereum:7,Capability_Lisk:8,Capability_Monero:9,Capability_NEM:10,Capability_Ripple:11,Capability_Stellar:12,Capability_Tezos:13,Capability_U2F:14,Capability_Shamir:15,Capability_ShamirGroups:16,Capability_PassphraseEntry:17});r.Enum_Capability=A;var P=Object.freeze({DISABLE:0,ENABLE:1,REFRESH:2});r.Enum_SdProtectOperationType=P;var x=Object.freeze({RecoveryDeviceType_ScrambledWords:0,RecoveryDeviceType_Matrix:1});r.Enum_RecoveryDeviceType=x;var M=Object.freeze({WordRequestType_Plain:0,WordRequestType_Matrix9:1,WordRequestType_Matrix6:2});r.Enum_WordRequestType=M;var R=Object.freeze({MosaicLevy_Absolute:1,MosaicLevy_Percentile:2});r.Enum_NEMMosaicLevy=R;var I=Object.freeze({SupplyChange_Increase:1,SupplyChange_Decrease:2});r.Enum_NEMSupplyChangeType=I;var O=Object.freeze({CosignatoryModification_Add:1,CosignatoryModification_Delete:2});r.Enum_NEMModificationType=O;var C=Object.freeze({ImportanceTransfer_Activate:1,ImportanceTransfer_Deactivate:2});r.Enum_NEMImportanceTransferMode=C;var N=Object.freeze({NATIVE:0,ALPHANUM4:1,ALPHANUM12:2});r.Enum_StellarAssetType=N;var L=Object.freeze({NONE:0,TEXT:1,ID:2,HASH:3,RETURN:4});r.Enum_StellarMemoType=L;var j=Object.freeze({ACCOUNT:0,PRE_AUTH:1,HASH:2});r.Enum_StellarSignerType=j;var D=Object.freeze({Implicit:0,Originated:1});r.Enum_TezosContractType=D;var U=Object.freeze({Yay:0,Nay:1,Pass:2});r.Enum_TezosBallotType=U}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/types/trezor/protobuf.js"}],[3135,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.getLog=r.enableLogByPrefix=r.enableLog=r.initLog=void 0;var n={DescriptorStream:"color: #77ab59",DeviceList:"color: #36802d",Device:"color: #bada55",Core:"color: #c9df8a",IFrame:"color: #FFFFFF; background: #f4a742;",Popup:"color: #f48a00"},s=function(){function e(e,t){this.prefix=e,this.enabled=t,this.messages=[],this.css=n[e]||"color: #000000; background: #FFFFFF;"}var t=e.prototype;return t.addMessage=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];this.messages.push({level:e,prefix:t,message:n,timestamp:(new Date).getTime()}),this.messages.length>100&&this.messages.shift()},t.log=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["log",this.prefix].concat(t)),this.enabled)&&(n=console).log.apply(n,[this.prefix].concat(t))},t.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["error",this.prefix].concat(t)),this.enabled)&&(n=console).error.apply(n,[this.prefix].concat(t))},t.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["warn",this.prefix].concat(t)),this.enabled)&&(n=console).warn.apply(n,[this.prefix].concat(t))},t.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["debug",this.prefix].concat(t)),this.enabled)&&(n=console).log.apply(n,["%c"+this.prefix,this.css].concat(t))},e}(),a={};r.initLog=function(e,t){var r=new s(e,!!t);return a[e]=r,r};r.enableLog=function(e){Object.keys(a).forEach((function(t){a[t].enabled=e}))};r.enableLogByPrefix=function(e,t){a[e]&&(a[e].enabled=t)};r.getLog=function(){var e=[];return Object.keys(a).forEach((function(t){e=e.concat(a[t].messages)})),e.sort((function(e,t){return e.timestamp-t.timestamp})),e}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/utils/debug.js"}],[3136,{"@babel/runtime/helpers/asyncToGenerator":176,"@babel/runtime/helpers/interopRequireDefault":185,"@babel/runtime/regenerator":204},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.create=function(e,t){var r,n=function(e){},i=function(e){},o=new Promise(function(){var t=(0,a.default)(s.default.mark((function t(a,o){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a,i=o,"function"!=typeof e){t.next=11;break}return t.prev=3,t.next=6,e();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),o(t.t0);case 11:"string"==typeof e&&(r=e);case 12:case"end":return t.stop()}}),t,null,[[3,8]])})));return function(e,r){return t.apply(this,arguments)}}());return{id:r,device:t,resolve:n,reject:i,promise:o}},r.createAsync=function(e){var t=function(e){},r=function(e){},n=new Promise((function(e,n){t=e,r=n})),i=function(){var t=(0,a.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{resolve:t,reject:r,promise:n,run:function(){return i(),n}}},r.resolveTimeoutPromise=function(e,t){return new Promise((function(r){setTimeout((function(){r(t)}),e)}))},r.rejectTimeoutPromise=void 0;var s=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/asyncToGenerator"));r.rejectTimeoutPromise=function(e,t){return new Promise((function(r,n){setTimeout((function(){n(t)}),e)}))}}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/utils/deferred.js"}],[3137,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.default=void 0;var n=function(e,t,r){var n=e||".trezor-webusb-button",s=document.querySelectorAll(n),a=t+"?"+Date.now();s.forEach((function(e){if(e.getElementsByTagName("iframe").length<1){var t=e.getBoundingClientRect(),n=document.createElement("iframe");n.frameBorder="0",n.width=Math.round(t.width)+"px",n.height=Math.round(t.height)+"px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex="1",n.setAttribute("allow","usb"),n.setAttribute("scrolling","no"),n.onload=function(){n.contentWindow.postMessage({},r)},n.src=a,e.append(n)}}))};r.default=n}}},{package:"eth-trezor-keyring>trezor-connect",file:"node_modules/trezor-connect/lib/webusb/button.js"}],[3139,{buffer:1767},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){var r,n;r=this,n=function(){var t={};function r(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return t.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");var t,r=unescape(encodeURIComponent(e)),n=new Uint8Array(r.length);for(t=0;t<r.length;t++)n[t]=r.charCodeAt(t);return n},t.encodeUTF8=function(e){var t,r=[];for(t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(r.join("")))},"undefined"==typeof atob?void 0!==e.from?(t.encodeBase64=function(t){return e.from(t).toString("base64")},t.decodeBase64=function(t){return r(t),new Uint8Array(Array.prototype.slice.call(e.from(t,"base64"),0))}):(t.encodeBase64=function(t){return new e(t).toString("base64")},t.decodeBase64=function(t){return r(t),new Uint8Array(Array.prototype.slice.call(new e(t,"base64"),0))}):(t.encodeBase64=function(e){var t,r=[],n=e.length;for(t=0;t<n;t++)r.push(String.fromCharCode(e[t]));return btoa(r.join(""))},t.decodeBase64=function(e){r(e);var t,n=atob(e),s=new Uint8Array(n.length);for(t=0;t<n.length;t++)s[t]=n.charCodeAt(t);return s}),t},void 0!==t&&t.exports?t.exports=n():(r.nacl||(r.nacl={}),r.nacl.util=n())}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-sig-util>tweetnacl-util",file:"node_modules/tweetnacl-util/nacl-util.js"}],[3140,{crypto:1767},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){!function(t){var r=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),a=new Uint8Array(32);a[0]=9;var i=r(),o=r([1]),c=r([56129,1]),u=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function m(e,t,r,n,s){var a,i=0;for(a=0;a<s;a++)i|=e[t+a]^r[n+a];return(1&i-1>>>8)-1}function g(e,t,r,n){return m(e,t,r,n,16)}function y(e,t,r,n){return m(e,t,r,n,32)}function E(e,t,r,n){!function(e,t,r,n){for(var s,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,o=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,d=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,E=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,T=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=a,v=i,w=o,S=c,k=u,A=d,P=l,x=h,M=p,R=f,I=m,O=g,C=y,N=E,L=b,j=T,D=0;D<20;D+=2)_^=(s=(C^=(s=(M^=(s=(k^=(s=_+C|0)<<7|s>>>25)+_|0)<<9|s>>>23)+k|0)<<13|s>>>19)+M|0)<<18|s>>>14,A^=(s=(v^=(s=(N^=(s=(R^=(s=A+v|0)<<7|s>>>25)+A|0)<<9|s>>>23)+R|0)<<13|s>>>19)+N|0)<<18|s>>>14,I^=(s=(P^=(s=(w^=(s=(L^=(s=I+P|0)<<7|s>>>25)+I|0)<<9|s>>>23)+L|0)<<13|s>>>19)+w|0)<<18|s>>>14,j^=(s=(O^=(s=(x^=(s=(S^=(s=j+O|0)<<7|s>>>25)+j|0)<<9|s>>>23)+S|0)<<13|s>>>19)+x|0)<<18|s>>>14,_^=(s=(S^=(s=(w^=(s=(v^=(s=_+S|0)<<7|s>>>25)+_|0)<<9|s>>>23)+v|0)<<13|s>>>19)+w|0)<<18|s>>>14,A^=(s=(k^=(s=(x^=(s=(P^=(s=A+k|0)<<7|s>>>25)+A|0)<<9|s>>>23)+P|0)<<13|s>>>19)+x|0)<<18|s>>>14,I^=(s=(R^=(s=(M^=(s=(O^=(s=I+R|0)<<7|s>>>25)+I|0)<<9|s>>>23)+O|0)<<13|s>>>19)+M|0)<<18|s>>>14,j^=(s=(L^=(s=(N^=(s=(C^=(s=j+L|0)<<7|s>>>25)+j|0)<<9|s>>>23)+C|0)<<13|s>>>19)+N|0)<<18|s>>>14;_=_+a|0,v=v+i|0,w=w+o|0,S=S+c|0,k=k+u|0,A=A+d|0,P=P+l|0,x=x+h|0,M=M+p|0,R=R+f|0,I=I+m|0,O=O+g|0,C=C+y|0,N=N+E|0,L=L+b|0,j=j+T|0,e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=v>>>0&255,e[5]=v>>>8&255,e[6]=v>>>16&255,e[7]=v>>>24&255,e[8]=w>>>0&255,e[9]=w>>>8&255,e[10]=w>>>16&255,e[11]=w>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=k>>>0&255,e[17]=k>>>8&255,e[18]=k>>>16&255,e[19]=k>>>24&255,e[20]=A>>>0&255,e[21]=A>>>8&255,e[22]=A>>>16&255,e[23]=A>>>24&255,e[24]=P>>>0&255,e[25]=P>>>8&255,e[26]=P>>>16&255,e[27]=P>>>24&255,e[28]=x>>>0&255,e[29]=x>>>8&255,e[30]=x>>>16&255,e[31]=x>>>24&255,e[32]=M>>>0&255,e[33]=M>>>8&255,e[34]=M>>>16&255,e[35]=M>>>24&255,e[36]=R>>>0&255,e[37]=R>>>8&255,e[38]=R>>>16&255,e[39]=R>>>24&255,e[40]=I>>>0&255,e[41]=I>>>8&255,e[42]=I>>>16&255,e[43]=I>>>24&255,e[44]=O>>>0&255,e[45]=O>>>8&255,e[46]=O>>>16&255,e[47]=O>>>24&255,e[48]=C>>>0&255,e[49]=C>>>8&255,e[50]=C>>>16&255,e[51]=C>>>24&255,e[52]=N>>>0&255,e[53]=N>>>8&255,e[54]=N>>>16&255,e[55]=N>>>24&255,e[56]=L>>>0&255,e[57]=L>>>8&255,e[58]=L>>>16&255,e[59]=L>>>24&255,e[60]=j>>>0&255,e[61]=j>>>8&255,e[62]=j>>>16&255,e[63]=j>>>24&255}(e,t,r,n)}function b(e,t,r,n){!function(e,t,r,n){for(var s,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,o=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,d=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,E=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,T=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=0;_<20;_+=2)a^=(s=(y^=(s=(p^=(s=(u^=(s=a+y|0)<<7|s>>>25)+a|0)<<9|s>>>23)+u|0)<<13|s>>>19)+p|0)<<18|s>>>14,d^=(s=(i^=(s=(E^=(s=(f^=(s=d+i|0)<<7|s>>>25)+d|0)<<9|s>>>23)+f|0)<<13|s>>>19)+E|0)<<18|s>>>14,m^=(s=(l^=(s=(o^=(s=(b^=(s=m+l|0)<<7|s>>>25)+m|0)<<9|s>>>23)+b|0)<<13|s>>>19)+o|0)<<18|s>>>14,T^=(s=(g^=(s=(h^=(s=(c^=(s=T+g|0)<<7|s>>>25)+T|0)<<9|s>>>23)+c|0)<<13|s>>>19)+h|0)<<18|s>>>14,a^=(s=(c^=(s=(o^=(s=(i^=(s=a+c|0)<<7|s>>>25)+a|0)<<9|s>>>23)+i|0)<<13|s>>>19)+o|0)<<18|s>>>14,d^=(s=(u^=(s=(h^=(s=(l^=(s=d+u|0)<<7|s>>>25)+d|0)<<9|s>>>23)+l|0)<<13|s>>>19)+h|0)<<18|s>>>14,m^=(s=(f^=(s=(p^=(s=(g^=(s=m+f|0)<<7|s>>>25)+m|0)<<9|s>>>23)+g|0)<<13|s>>>19)+p|0)<<18|s>>>14,T^=(s=(b^=(s=(E^=(s=(y^=(s=T+b|0)<<7|s>>>25)+T|0)<<9|s>>>23)+y|0)<<13|s>>>19)+E|0)<<18|s>>>14;e[0]=a>>>0&255,e[1]=a>>>8&255,e[2]=a>>>16&255,e[3]=a>>>24&255,e[4]=d>>>0&255,e[5]=d>>>8&255,e[6]=d>>>16&255,e[7]=d>>>24&255,e[8]=m>>>0&255,e[9]=m>>>8&255,e[10]=m>>>16&255,e[11]=m>>>24&255,e[12]=T>>>0&255,e[13]=T>>>8&255,e[14]=T>>>16&255,e[15]=T>>>24&255,e[16]=l>>>0&255,e[17]=l>>>8&255,e[18]=l>>>16&255,e[19]=l>>>24&255,e[20]=h>>>0&255,e[21]=h>>>8&255,e[22]=h>>>16&255,e[23]=h>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=f>>>0&255,e[29]=f>>>8&255,e[30]=f>>>16&255,e[31]=f>>>24&255}(e,t,r,n)}var T=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function _(e,t,r,n,s,a,i){var o,c,u=new Uint8Array(16),d=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=a[c];for(;s>=64;){for(E(d,u,i,T),c=0;c<64;c++)e[t+c]=r[n+c]^d[c];for(o=1,c=8;c<16;c++)o=o+(255&u[c])|0,u[c]=255&o,o>>>=8;s-=64,t+=64,n+=64}if(s>0)for(E(d,u,i,T),c=0;c<s;c++)e[t+c]=r[n+c]^d[c];return 0}function v(e,t,r,n,s){var a,i,o=new Uint8Array(16),c=new Uint8Array(64);for(i=0;i<16;i++)o[i]=0;for(i=0;i<8;i++)o[i]=n[i];for(;r>=64;){for(E(c,o,s,T),i=0;i<64;i++)e[t+i]=c[i];for(a=1,i=8;i<16;i++)a=a+(255&o[i])|0,o[i]=255&a,a>>>=8;r-=64,t+=64}if(r>0)for(E(c,o,s,T),i=0;i<r;i++)e[t+i]=c[i];return 0}function w(e,t,r,n,s){var a=new Uint8Array(32);b(a,n,s,T);for(var i=new Uint8Array(8),o=0;o<8;o++)i[o]=n[o+16];return v(e,t,r,i,a)}function S(e,t,r,n,s,a,i){var o=new Uint8Array(32);b(o,a,i,T);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=a[u+16];return _(e,t,r,n,s,c,o)}var k=function(e){var t,r,n,s,a,i,o,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),s=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|s<<9),a=255&e[8]|(255&e[9])<<8,this.r[4]=255&(s>>>4|a<<12),this.r[5]=a>>>1&8190,i=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(a>>>14|i<<2),o=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(i>>>11|o<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(o>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function A(e,t,r,n,s,a){var i=new k(a);return i.update(r,n,s),i.finish(e,t),0}function P(e,t,r,n,s,a){var i=new Uint8Array(16);return A(i,0,r,n,s,a),g(e,t,i,0)}function x(e,t,r,n,s){var a;if(r<32)return-1;for(S(e,0,t,0,r,n,s),A(e,16,e,32,r-32,e),a=0;a<16;a++)e[a]=0;return 0}function M(e,t,r,n,s){var a,i=new Uint8Array(32);if(r<32)return-1;if(w(i,0,32,n,s),0!==P(t,16,t,32,r-32,i))return-1;for(S(e,0,t,0,r,n,s),a=0;a<32;a++)e[a]=0;return 0}function R(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function I(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function O(e,t,r){for(var n,s=~(r-1),a=0;a<16;a++)n=s&(e[a]^t[a]),e[a]^=n,t[a]^=n}function C(e,t){var n,s,a,i=r(),o=r();for(n=0;n<16;n++)o[n]=t[n];for(I(o),I(o),I(o),s=0;s<2;s++){for(i[0]=o[0]-65517,n=1;n<15;n++)i[n]=o[n]-65535-(i[n-1]>>16&1),i[n-1]&=65535;i[15]=o[15]-32767-(i[14]>>16&1),a=i[15]>>16&1,i[14]&=65535,O(o,i,1-a)}for(n=0;n<16;n++)e[2*n]=255&o[n],e[2*n+1]=o[n]>>8}function N(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return C(r,e),C(n,t),y(r,0,n,0)}function L(e){var t=new Uint8Array(32);return C(t,e),1&t[0]}function j(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function D(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function U(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function F(e,t,r){var n,s,a=0,i=0,o=0,c=0,u=0,d=0,l=0,h=0,p=0,f=0,m=0,g=0,y=0,E=0,b=0,T=0,_=0,v=0,w=0,S=0,k=0,A=0,P=0,x=0,M=0,R=0,I=0,O=0,C=0,N=0,L=0,j=r[0],D=r[1],U=r[2],F=r[3],B=r[4],G=r[5],z=r[6],q=r[7],H=r[8],$=r[9],V=r[10],Q=r[11],K=r[12],W=r[13],Y=r[14],J=r[15];a+=(n=t[0])*j,i+=n*D,o+=n*U,c+=n*F,u+=n*B,d+=n*G,l+=n*z,h+=n*q,p+=n*H,f+=n*$,m+=n*V,g+=n*Q,y+=n*K,E+=n*W,b+=n*Y,T+=n*J,i+=(n=t[1])*j,o+=n*D,c+=n*U,u+=n*F,d+=n*B,l+=n*G,h+=n*z,p+=n*q,f+=n*H,m+=n*$,g+=n*V,y+=n*Q,E+=n*K,b+=n*W,T+=n*Y,_+=n*J,o+=(n=t[2])*j,c+=n*D,u+=n*U,d+=n*F,l+=n*B,h+=n*G,p+=n*z,f+=n*q,m+=n*H,g+=n*$,y+=n*V,E+=n*Q,b+=n*K,T+=n*W,_+=n*Y,v+=n*J,c+=(n=t[3])*j,u+=n*D,d+=n*U,l+=n*F,h+=n*B,p+=n*G,f+=n*z,m+=n*q,g+=n*H,y+=n*$,E+=n*V,b+=n*Q,T+=n*K,_+=n*W,v+=n*Y,w+=n*J,u+=(n=t[4])*j,d+=n*D,l+=n*U,h+=n*F,p+=n*B,f+=n*G,m+=n*z,g+=n*q,y+=n*H,E+=n*$,b+=n*V,T+=n*Q,_+=n*K,v+=n*W,w+=n*Y,S+=n*J,d+=(n=t[5])*j,l+=n*D,h+=n*U,p+=n*F,f+=n*B,m+=n*G,g+=n*z,y+=n*q,E+=n*H,b+=n*$,T+=n*V,_+=n*Q,v+=n*K,w+=n*W,S+=n*Y,k+=n*J,l+=(n=t[6])*j,h+=n*D,p+=n*U,f+=n*F,m+=n*B,g+=n*G,y+=n*z,E+=n*q,b+=n*H,T+=n*$,_+=n*V,v+=n*Q,w+=n*K,S+=n*W,k+=n*Y,A+=n*J,h+=(n=t[7])*j,p+=n*D,f+=n*U,m+=n*F,g+=n*B,y+=n*G,E+=n*z,b+=n*q,T+=n*H,_+=n*$,v+=n*V,w+=n*Q,S+=n*K,k+=n*W,A+=n*Y,P+=n*J,p+=(n=t[8])*j,f+=n*D,m+=n*U,g+=n*F,y+=n*B,E+=n*G,b+=n*z,T+=n*q,_+=n*H,v+=n*$,w+=n*V,S+=n*Q,k+=n*K,A+=n*W,P+=n*Y,x+=n*J,f+=(n=t[9])*j,m+=n*D,g+=n*U,y+=n*F,E+=n*B,b+=n*G,T+=n*z,_+=n*q,v+=n*H,w+=n*$,S+=n*V,k+=n*Q,A+=n*K,P+=n*W,x+=n*Y,M+=n*J,m+=(n=t[10])*j,g+=n*D,y+=n*U,E+=n*F,b+=n*B,T+=n*G,_+=n*z,v+=n*q,w+=n*H,S+=n*$,k+=n*V,A+=n*Q,P+=n*K,x+=n*W,M+=n*Y,R+=n*J,g+=(n=t[11])*j,y+=n*D,E+=n*U,b+=n*F,T+=n*B,_+=n*G,v+=n*z,w+=n*q,S+=n*H,k+=n*$,A+=n*V,P+=n*Q,x+=n*K,M+=n*W,R+=n*Y,I+=n*J,y+=(n=t[12])*j,E+=n*D,b+=n*U,T+=n*F,_+=n*B,v+=n*G,w+=n*z,S+=n*q,k+=n*H,A+=n*$,P+=n*V,x+=n*Q,M+=n*K,R+=n*W,I+=n*Y,O+=n*J,E+=(n=t[13])*j,b+=n*D,T+=n*U,_+=n*F,v+=n*B,w+=n*G,S+=n*z,k+=n*q,A+=n*H,P+=n*$,x+=n*V,M+=n*Q,R+=n*K,I+=n*W,O+=n*Y,C+=n*J,b+=(n=t[14])*j,T+=n*D,_+=n*U,v+=n*F,w+=n*B,S+=n*G,k+=n*z,A+=n*q,P+=n*H,x+=n*$,M+=n*V,R+=n*Q,I+=n*K,O+=n*W,C+=n*Y,N+=n*J,T+=(n=t[15])*j,i+=38*(v+=n*U),o+=38*(w+=n*F),c+=38*(S+=n*B),u+=38*(k+=n*G),d+=38*(A+=n*z),l+=38*(P+=n*q),h+=38*(x+=n*H),p+=38*(M+=n*$),f+=38*(R+=n*V),m+=38*(I+=n*Q),g+=38*(O+=n*K),y+=38*(C+=n*W),E+=38*(N+=n*Y),b+=38*(L+=n*J),a=(n=(a+=38*(_+=n*D))+(s=1)+65535)-65536*(s=Math.floor(n/65536)),i=(n=i+s+65535)-65536*(s=Math.floor(n/65536)),o=(n=o+s+65535)-65536*(s=Math.floor(n/65536)),c=(n=c+s+65535)-65536*(s=Math.floor(n/65536)),u=(n=u+s+65535)-65536*(s=Math.floor(n/65536)),d=(n=d+s+65535)-65536*(s=Math.floor(n/65536)),l=(n=l+s+65535)-65536*(s=Math.floor(n/65536)),h=(n=h+s+65535)-65536*(s=Math.floor(n/65536)),p=(n=p+s+65535)-65536*(s=Math.floor(n/65536)),f=(n=f+s+65535)-65536*(s=Math.floor(n/65536)),m=(n=m+s+65535)-65536*(s=Math.floor(n/65536)),g=(n=g+s+65535)-65536*(s=Math.floor(n/65536)),y=(n=y+s+65535)-65536*(s=Math.floor(n/65536)),E=(n=E+s+65535)-65536*(s=Math.floor(n/65536)),b=(n=b+s+65535)-65536*(s=Math.floor(n/65536)),T=(n=T+s+65535)-65536*(s=Math.floor(n/65536)),a=(n=(a+=s-1+37*(s-1))+(s=1)+65535)-65536*(s=Math.floor(n/65536)),i=(n=i+s+65535)-65536*(s=Math.floor(n/65536)),o=(n=o+s+65535)-65536*(s=Math.floor(n/65536)),c=(n=c+s+65535)-65536*(s=Math.floor(n/65536)),u=(n=u+s+65535)-65536*(s=Math.floor(n/65536)),d=(n=d+s+65535)-65536*(s=Math.floor(n/65536)),l=(n=l+s+65535)-65536*(s=Math.floor(n/65536)),h=(n=h+s+65535)-65536*(s=Math.floor(n/65536)),p=(n=p+s+65535)-65536*(s=Math.floor(n/65536)),f=(n=f+s+65535)-65536*(s=Math.floor(n/65536)),m=(n=m+s+65535)-65536*(s=Math.floor(n/65536)),g=(n=g+s+65535)-65536*(s=Math.floor(n/65536)),y=(n=y+s+65535)-65536*(s=Math.floor(n/65536)),E=(n=E+s+65535)-65536*(s=Math.floor(n/65536)),b=(n=b+s+65535)-65536*(s=Math.floor(n/65536)),T=(n=T+s+65535)-65536*(s=Math.floor(n/65536)),a+=s-1+37*(s-1),e[0]=a,e[1]=i,e[2]=o,e[3]=c,e[4]=u,e[5]=d,e[6]=l,e[7]=h,e[8]=p,e[9]=f,e[10]=m,e[11]=g,e[12]=y,e[13]=E,e[14]=b,e[15]=T}function B(e,t){F(e,t,t)}function G(e,t){var n,s=r();for(n=0;n<16;n++)s[n]=t[n];for(n=253;n>=0;n--)B(s,s),2!==n&&4!==n&&F(s,s,t);for(n=0;n<16;n++)e[n]=s[n]}function z(e,t){var n,s=r();for(n=0;n<16;n++)s[n]=t[n];for(n=250;n>=0;n--)B(s,s),1!==n&&F(s,s,t);for(n=0;n<16;n++)e[n]=s[n]}function q(e,t,n){var s,a,i=new Uint8Array(32),o=new Float64Array(80),u=r(),d=r(),l=r(),h=r(),p=r(),f=r();for(a=0;a<31;a++)i[a]=t[a];for(i[31]=127&t[31]|64,i[0]&=248,j(o,n),a=0;a<16;a++)d[a]=o[a],h[a]=u[a]=l[a]=0;for(u[0]=h[0]=1,a=254;a>=0;--a)O(u,d,s=i[a>>>3]>>>(7&a)&1),O(l,h,s),D(p,u,l),U(u,u,l),D(l,d,h),U(d,d,h),B(h,p),B(f,u),F(u,l,u),F(l,d,p),D(p,u,l),U(u,u,l),B(d,u),U(l,h,f),F(u,l,c),D(u,u,h),F(l,l,u),F(u,h,f),F(h,d,o),B(d,p),O(u,d,s),O(l,h,s);for(a=0;a<16;a++)o[a+16]=u[a],o[a+32]=l[a],o[a+48]=d[a],o[a+64]=h[a];var m=o.subarray(32),g=o.subarray(16);return G(m,m),F(g,g,m),C(e,g),0}function H(e,t){return q(e,t,a)}function $(e,t){return n(t,32),H(e,t)}function V(e,t,r){var n=new Uint8Array(32);return q(n,r,t),b(e,s,n,T)}k.prototype.blocks=function(e,t,r){for(var n,s,a,i,o,c,u,d,l,h,p,f,m,g,y,E,b,T,_,v=this.fin?0:2048,w=this.h[0],S=this.h[1],k=this.h[2],A=this.h[3],P=this.h[4],x=this.h[5],M=this.h[6],R=this.h[7],I=this.h[8],O=this.h[9],C=this.r[0],N=this.r[1],L=this.r[2],j=this.r[3],D=this.r[4],U=this.r[5],F=this.r[6],B=this.r[7],G=this.r[8],z=this.r[9];r>=16;)h=l=0,h+=(w+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*C,h+=(S+=8191&(n>>>13|(s=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*z),h+=(k+=8191&(s>>>10|(a=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*G),h+=(A+=8191&(a>>>7|(i=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*B),l=(h+=(P+=8191&(i>>>4|(o=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*F))>>>13,h&=8191,h+=(x+=o>>>1&8191)*(5*U),h+=(M+=8191&(o>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*D),h+=(R+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*j),h+=(I+=8191&(u>>>8|(d=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*L),p=l+=(h+=(O+=d>>>5|v)*(5*N))>>>13,p+=w*N,p+=S*C,p+=k*(5*z),p+=A*(5*G),l=(p+=P*(5*B))>>>13,p&=8191,p+=x*(5*F),p+=M*(5*U),p+=R*(5*D),p+=I*(5*j),l+=(p+=O*(5*L))>>>13,p&=8191,f=l,f+=w*L,f+=S*N,f+=k*C,f+=A*(5*z),l=(f+=P*(5*G))>>>13,f&=8191,f+=x*(5*B),f+=M*(5*F),f+=R*(5*U),f+=I*(5*D),m=l+=(f+=O*(5*j))>>>13,m+=w*j,m+=S*L,m+=k*N,m+=A*C,l=(m+=P*(5*z))>>>13,m&=8191,m+=x*(5*G),m+=M*(5*B),m+=R*(5*F),m+=I*(5*U),g=l+=(m+=O*(5*D))>>>13,g+=w*D,g+=S*j,g+=k*L,g+=A*N,l=(g+=P*C)>>>13,g&=8191,g+=x*(5*z),g+=M*(5*G),g+=R*(5*B),g+=I*(5*F),y=l+=(g+=O*(5*U))>>>13,y+=w*U,y+=S*D,y+=k*j,y+=A*L,l=(y+=P*N)>>>13,y&=8191,y+=x*C,y+=M*(5*z),y+=R*(5*G),y+=I*(5*B),E=l+=(y+=O*(5*F))>>>13,E+=w*F,E+=S*U,E+=k*D,E+=A*j,l=(E+=P*L)>>>13,E&=8191,E+=x*N,E+=M*C,E+=R*(5*z),E+=I*(5*G),b=l+=(E+=O*(5*B))>>>13,b+=w*B,b+=S*F,b+=k*U,b+=A*D,l=(b+=P*j)>>>13,b&=8191,b+=x*L,b+=M*N,b+=R*C,b+=I*(5*z),T=l+=(b+=O*(5*G))>>>13,T+=w*G,T+=S*B,T+=k*F,T+=A*U,l=(T+=P*D)>>>13,T&=8191,T+=x*j,T+=M*L,T+=R*N,T+=I*C,_=l+=(T+=O*(5*z))>>>13,_+=w*z,_+=S*G,_+=k*B,_+=A*F,l=(_+=P*U)>>>13,_&=8191,_+=x*D,_+=M*j,_+=R*L,_+=I*N,w=h=8191&(l=(l=((l+=(_+=O*C)>>>13)<<2)+l|0)+(h&=8191)|0),S=p+=l>>>=13,k=f&=8191,A=m&=8191,P=g&=8191,x=y&=8191,M=E&=8191,R=b&=8191,I=T&=8191,O=_&=8191,t+=16,r-=16;this.h[0]=w,this.h[1]=S,this.h[2]=k,this.h[3]=A,this.h[4]=P,this.h[5]=x,this.h[6]=M,this.h[7]=R,this.h[8]=I,this.h[9]=O},k.prototype.finish=function(e,t){var r,n,s,a,i=new Uint16Array(10);if(this.leftover){for(a=this.leftover,this.buffer[a++]=1;a<16;a++)this.buffer[a]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,a=2;a<10;a++)this.h[a]+=r,r=this.h[a]>>>13,this.h[a]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,i[0]=this.h[0]+5,r=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this.h[a]+r,r=i[a]>>>13,i[a]&=8191;for(i[9]-=8192,n=(1^r)-1,a=0;a<10;a++)i[a]&=n;for(n=~n,a=0;a<10;a++)this.h[a]=this.h[a]&n|i[a];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),s=this.h[0]+this.pad[0],this.h[0]=65535&s,a=1;a<8;a++)s=(this.h[a]+this.pad[a]|0)+(s>>>16)|0,this.h[a]=65535&s;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},k.prototype.update=function(e,t,r){var n,s;if(this.leftover){for((s=16-this.leftover)>r&&(s=r),n=0;n<s;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=s,t+=s,this.leftover+=s,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(s=r-r%16,this.blocks(e,t,s),t+=s,r-=s),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var Q=x,K=M;var W=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Y(e,t,r,n){for(var s,a,i,o,c,u,d,l,h,p,f,m,g,y,E,b,T,_,v,w,S,k,A,P,x,M,R=new Int32Array(16),I=new Int32Array(16),O=e[0],C=e[1],N=e[2],L=e[3],j=e[4],D=e[5],U=e[6],F=e[7],B=t[0],G=t[1],z=t[2],q=t[3],H=t[4],$=t[5],V=t[6],Q=t[7],K=0;n>=128;){for(v=0;v<16;v++)w=8*v+K,R[v]=r[w+0]<<24|r[w+1]<<16|r[w+2]<<8|r[w+3],I[v]=r[w+4]<<24|r[w+5]<<16|r[w+6]<<8|r[w+7];for(v=0;v<80;v++)if(s=O,a=C,i=N,o=L,c=j,u=D,d=U,F,h=B,p=G,f=z,m=q,g=H,y=$,E=V,Q,A=65535&(k=Q),P=k>>>16,x=65535&(S=F),M=S>>>16,A+=65535&(k=(H>>>14|j<<18)^(H>>>18|j<<14)^(j>>>9|H<<23)),P+=k>>>16,x+=65535&(S=(j>>>14|H<<18)^(j>>>18|H<<14)^(H>>>9|j<<23)),M+=S>>>16,A+=65535&(k=H&$^~H&V),P+=k>>>16,x+=65535&(S=j&D^~j&U),M+=S>>>16,A+=65535&(k=W[2*v+1]),P+=k>>>16,x+=65535&(S=W[2*v]),M+=S>>>16,S=R[v%16],P+=(k=I[v%16])>>>16,x+=65535&S,M+=S>>>16,x+=(P+=(A+=65535&k)>>>16)>>>16,A=65535&(k=_=65535&A|P<<16),P=k>>>16,x=65535&(S=T=65535&x|(M+=x>>>16)<<16),M=S>>>16,A+=65535&(k=(B>>>28|O<<4)^(O>>>2|B<<30)^(O>>>7|B<<25)),P+=k>>>16,x+=65535&(S=(O>>>28|B<<4)^(B>>>2|O<<30)^(B>>>7|O<<25)),M+=S>>>16,P+=(k=B&G^B&z^G&z)>>>16,x+=65535&(S=O&C^O&N^C&N),M+=S>>>16,l=65535&(x+=(P+=(A+=65535&k)>>>16)>>>16)|(M+=x>>>16)<<16,b=65535&A|P<<16,A=65535&(k=m),P=k>>>16,x=65535&(S=o),M=S>>>16,P+=(k=_)>>>16,x+=65535&(S=T),M+=S>>>16,C=s,N=a,L=i,j=o=65535&(x+=(P+=(A+=65535&k)>>>16)>>>16)|(M+=x>>>16)<<16,D=c,U=u,F=d,O=l,G=h,z=p,q=f,H=m=65535&A|P<<16,$=g,V=y,Q=E,B=b,v%16==15)for(w=0;w<16;w++)S=R[w],A=65535&(k=I[w]),P=k>>>16,x=65535&S,M=S>>>16,S=R[(w+9)%16],A+=65535&(k=I[(w+9)%16]),P+=k>>>16,x+=65535&S,M+=S>>>16,T=R[(w+1)%16],A+=65535&(k=((_=I[(w+1)%16])>>>1|T<<31)^(_>>>8|T<<24)^(_>>>7|T<<25)),P+=k>>>16,x+=65535&(S=(T>>>1|_<<31)^(T>>>8|_<<24)^T>>>7),M+=S>>>16,T=R[(w+14)%16],P+=(k=((_=I[(w+14)%16])>>>19|T<<13)^(T>>>29|_<<3)^(_>>>6|T<<26))>>>16,x+=65535&(S=(T>>>19|_<<13)^(_>>>29|T<<3)^T>>>6),M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,R[w]=65535&x|M<<16,I[w]=65535&A|P<<16;A=65535&(k=B),P=k>>>16,x=65535&(S=O),M=S>>>16,S=e[0],P+=(k=t[0])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[0]=O=65535&x|M<<16,t[0]=B=65535&A|P<<16,A=65535&(k=G),P=k>>>16,x=65535&(S=C),M=S>>>16,S=e[1],P+=(k=t[1])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[1]=C=65535&x|M<<16,t[1]=G=65535&A|P<<16,A=65535&(k=z),P=k>>>16,x=65535&(S=N),M=S>>>16,S=e[2],P+=(k=t[2])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[2]=N=65535&x|M<<16,t[2]=z=65535&A|P<<16,A=65535&(k=q),P=k>>>16,x=65535&(S=L),M=S>>>16,S=e[3],P+=(k=t[3])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[3]=L=65535&x|M<<16,t[3]=q=65535&A|P<<16,A=65535&(k=H),P=k>>>16,x=65535&(S=j),M=S>>>16,S=e[4],P+=(k=t[4])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[4]=j=65535&x|M<<16,t[4]=H=65535&A|P<<16,A=65535&(k=$),P=k>>>16,x=65535&(S=D),M=S>>>16,S=e[5],P+=(k=t[5])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[5]=D=65535&x|M<<16,t[5]=$=65535&A|P<<16,A=65535&(k=V),P=k>>>16,x=65535&(S=U),M=S>>>16,S=e[6],P+=(k=t[6])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[6]=U=65535&x|M<<16,t[6]=V=65535&A|P<<16,A=65535&(k=Q),P=k>>>16,x=65535&(S=F),M=S>>>16,S=e[7],P+=(k=t[7])>>>16,x+=65535&S,M+=S>>>16,M+=(x+=(P+=(A+=65535&k)>>>16)>>>16)>>>16,e[7]=F=65535&x|M<<16,t[7]=Q=65535&A|P<<16,K+=128,n-=128}return n}function J(e,t,r){var n,s=new Int32Array(8),a=new Int32Array(8),i=new Uint8Array(256),o=r;for(s[0]=1779033703,s[1]=3144134277,s[2]=1013904242,s[3]=2773480762,s[4]=1359893119,s[5]=2600822924,s[6]=528734635,s[7]=1541459225,a[0]=4089235720,a[1]=2227873595,a[2]=4271175723,a[3]=1595750129,a[4]=2917565137,a[5]=725511199,a[6]=4215389547,a[7]=327033209,Y(s,a,t,r),r%=128,n=0;n<r;n++)i[n]=t[o-r+n];for(i[r]=128,i[(r=256-128*(r<112?1:0))-9]=0,f(i,r-8,o/536870912|0,o<<3),Y(s,a,i,r),n=0;n<8;n++)f(e,8*n,s[n],a[n]);return 0}function Z(e,t){var n=r(),s=r(),a=r(),i=r(),o=r(),c=r(),u=r(),l=r(),h=r();U(n,e[1],e[0]),U(h,t[1],t[0]),F(n,n,h),D(s,e[0],e[1]),D(h,t[0],t[1]),F(s,s,h),F(a,e[3],t[3]),F(a,a,d),F(i,e[2],t[2]),D(i,i,i),U(o,s,n),U(c,i,a),D(u,i,a),D(l,s,n),F(e[0],o,c),F(e[1],l,u),F(e[2],u,c),F(e[3],o,l)}function X(e,t,r){var n;for(n=0;n<4;n++)O(e[n],t[n],r)}function ee(e,t){var n=r(),s=r(),a=r();G(a,t[2]),F(n,t[0],a),F(s,t[1],a),C(e,s),e[31]^=L(n)<<7}function te(e,t,r){var n,s;for(R(e[0],i),R(e[1],o),R(e[2],o),R(e[3],i),s=255;s>=0;--s)X(e,t,n=r[s/8|0]>>(7&s)&1),Z(t,e),Z(e,e),X(e,t,n)}function re(e,t){var n=[r(),r(),r(),r()];R(n[0],l),R(n[1],h),R(n[2],o),F(n[3],l,h),te(e,n,t)}function ne(e,t,s){var a,i=new Uint8Array(64),o=[r(),r(),r(),r()];for(s||n(t,32),J(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,re(o,i),ee(e,o),a=0;a<32;a++)t[a+32]=e[a];return 0}var se=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ae(e,t){var r,n,s,a;for(n=63;n>=32;--n){for(r=0,s=n-32,a=n-12;s<a;++s)t[s]+=r-16*t[n]*se[s-(n-32)],r=Math.floor((t[s]+128)/256),t[s]-=256*r;t[s]+=r,t[n]=0}for(r=0,s=0;s<32;s++)t[s]+=r-(t[31]>>4)*se[s],r=t[s]>>8,t[s]&=255;for(s=0;s<32;s++)t[s]-=r*se[s];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function ie(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ae(e,r)}function oe(e,t,n,s){var a,i,o=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),d=new Float64Array(64),l=[r(),r(),r(),r()];J(o,s,32),o[0]&=248,o[31]&=127,o[31]|=64;var h=n+64;for(a=0;a<n;a++)e[64+a]=t[a];for(a=0;a<32;a++)e[32+a]=o[32+a];for(J(u,e.subarray(32),n+32),ie(u),re(l,u),ee(e,l),a=32;a<64;a++)e[a]=s[a];for(J(c,e,n+64),ie(c),a=0;a<64;a++)d[a]=0;for(a=0;a<32;a++)d[a]=u[a];for(a=0;a<32;a++)for(i=0;i<32;i++)d[a+i]+=c[a]*o[i];return ae(e.subarray(32),d),h}function ce(e,t,n,s){var a,c=new Uint8Array(32),d=new Uint8Array(64),l=[r(),r(),r(),r()],h=[r(),r(),r(),r()];if(n<64)return-1;if(function(e,t){var n=r(),s=r(),a=r(),c=r(),d=r(),l=r(),h=r();return R(e[2],o),j(e[1],t),B(a,e[1]),F(c,a,u),U(a,a,e[2]),D(c,e[2],c),B(d,c),B(l,d),F(h,l,d),F(n,h,a),F(n,n,c),z(n,n),F(n,n,a),F(n,n,c),F(n,n,c),F(e[0],n,c),B(s,e[0]),F(s,s,c),N(s,a)&&F(e[0],e[0],p),B(s,e[0]),F(s,s,c),N(s,a)?-1:(L(e[0])===t[31]>>7&&U(e[0],i,e[0]),F(e[3],e[0],e[1]),0)}(h,s))return-1;for(a=0;a<n;a++)e[a]=t[a];for(a=0;a<32;a++)e[a+32]=s[a];if(J(d,e,n),ie(d),te(l,h,d),re(h,t.subarray(32)),Z(l,h),ee(c,l),n-=64,y(t,0,c,0)){for(a=0;a<n;a++)e[a]=0;return-1}for(a=0;a<n;a++)e[a]=t[a+64];return n}var ue=16,de=64,le=32,he=64;function pe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function fe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function me(e){for(var t=0;t<e.length;t++)e[t]=0}t.lowlevel={crypto_core_hsalsa20:b,crypto_stream_xor:S,crypto_stream:w,crypto_stream_salsa20_xor:_,crypto_stream_salsa20:v,crypto_onetimeauth:A,crypto_onetimeauth_verify:P,crypto_verify_16:g,crypto_verify_32:y,crypto_secretbox:x,crypto_secretbox_open:M,crypto_scalarmult:q,crypto_scalarmult_base:H,crypto_box_beforenm:V,crypto_box_afternm:Q,crypto_box:function(e,t,r,n,s,a){var i=new Uint8Array(32);return V(i,s,a),Q(e,t,r,n,i)},crypto_box_open:function(e,t,r,n,s,a){var i=new Uint8Array(32);return V(i,s,a),K(e,t,r,n,i)},crypto_box_keypair:$,crypto_hash:J,crypto_sign:oe,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:ue,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:de,crypto_sign_PUBLICKEYBYTES:le,crypto_sign_SECRETKEYBYTES:he,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:r,D:u,L:se,pack25519:C,unpack25519:j,M:F,A:D,S:B,Z:U,pow2523:z,add:Z,set25519:R,modL:ae,scalarmult:te,scalarbase:re},t.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},t.secretbox=function(e,t,r){fe(e,t,r),pe(r,t);for(var n=new Uint8Array(32+e.length),s=new Uint8Array(n.length),a=0;a<e.length;a++)n[a+32]=e[a];return x(s,n,n.length,t,r),s.subarray(ue)},t.secretbox.open=function(e,t,r){fe(e,t,r),pe(r,t);for(var n=new Uint8Array(ue+e.length),s=new Uint8Array(n.length),a=0;a<e.length;a++)n[a+ue]=e[a];return n.length<32||0!==M(s,n,n.length,t,r)?null:s.subarray(32)},t.secretbox.keyLength=32,t.secretbox.nonceLength=24,t.secretbox.overheadLength=ue,t.scalarMult=function(e,t){if(fe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return q(r,e,t),r},t.scalarMult.base=function(e){if(fe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return H(t,e),t},t.scalarMult.scalarLength=32,t.scalarMult.groupElementLength=32,t.box=function(e,r,n,s){var a=t.box.before(n,s);return t.secretbox(e,r,a)},t.box.before=function(e,t){fe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return V(r,e,t),r},t.box.after=t.secretbox,t.box.open=function(e,r,n,s){var a=t.box.before(n,s);return t.secretbox.open(e,r,a)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return $(e,t),{publicKey:e,secretKey:t}},t.box.keyPair.fromSecretKey=function(e){if(fe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return H(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},t.box.publicKeyLength=32,t.box.secretKeyLength=32,t.box.sharedKeyLength=32,t.box.nonceLength=24,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(e,t){if(fe(e,t),t.length!==he)throw new Error("bad secret key size");var r=new Uint8Array(de+e.length);return oe(r,e,e.length,t),r},t.sign.open=function(e,t){if(fe(e,t),t.length!==le)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ce(r,e,e.length,t);if(n<0)return null;for(var s=new Uint8Array(n),a=0;a<s.length;a++)s[a]=r[a];return s},t.sign.detached=function(e,r){for(var n=t.sign(e,r),s=new Uint8Array(de),a=0;a<s.length;a++)s[a]=n[a];return s},t.sign.detached.verify=function(e,t,r){if(fe(e,t,r),t.length!==de)throw new Error("bad signature size");if(r.length!==le)throw new Error("bad public key size");var n,s=new Uint8Array(de+e.length),a=new Uint8Array(de+e.length);for(n=0;n<de;n++)s[n]=t[n];for(n=0;n<e.length;n++)s[n+de]=e[n];return ce(a,s,s.length,r)>=0},t.sign.keyPair=function(){var e=new Uint8Array(le),t=new Uint8Array(he);return ne(e,t),{publicKey:e,secretKey:t}},t.sign.keyPair.fromSecretKey=function(e){if(fe(e),e.length!==he)throw new Error("bad secret key size");for(var t=new Uint8Array(le),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},t.sign.keyPair.fromSeed=function(e){if(fe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(le),r=new Uint8Array(he),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},t.sign.publicKeyLength=le,t.sign.secretKeyLength=he,t.sign.seedLength=32,t.sign.signatureLength=de,t.hash=function(e){fe(e);var t=new Uint8Array(64);return J(t,e,e.length),t},t.hash.hashLength=64,t.verify=function(e,t){return fe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===m(e,0,t,0,e.length))},t.setPRNG=function(e){n=e},function(){var r="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(r&&r.getRandomValues){t.setPRNG((function(e,t){var n,s=new Uint8Array(t);for(n=0;n<t;n+=65536)r.getRandomValues(s.subarray(n,n+Math.min(t-n,65536)));for(n=0;n<t;n++)e[n]=s[n];me(s)}))}else void 0!==e&&(r=e("crypto"))&&r.randomBytes&&t.setPRNG((function(e,t){var n,s=r.randomBytes(t);for(n=0;n<t;n++)e[n]=s[n];me(s)}))}()}(void 0!==t&&t.exports?t.exports:self.nacl=self.nacl||{})}}},{package:"eth-sig-util>tweetnacl",file:"node_modules/tweetnacl/nacl-fast.js"}],[3141,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/concat.js"}],[3142,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/equals.js"}],[3143,{multibase:2755},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{encoding:n}=e("multibase"),s=new TextEncoder;t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?s.encode(e):"ascii"===t?function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e):n(t).decode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/from-string.js"}],[3144,{multibase:2755},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{encoding:n}=e("multibase"),s=new TextDecoder("utf8");t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?s.decode(e):"ascii"===t?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):n(t).encode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/to-string.js"}],[3178,{util:1774},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.TextEncoder="undefined"!=typeof TextEncoder?TextEncoder:e("util").TextEncoder,r.TextDecoder="undefined"!=typeof TextDecoder?TextDecoder:e("util").TextDecoder}}},{package:"@ensdomains/content-hash>multihashes>web-encoding",file:"node_modules/web-encoding/src/lib.js"}],[32,{"../../../../../shared/constants/transaction":3216,"../../../../../shared/modules/hexstring-utils":3234,"../../../../../shared/modules/transaction.utils":3243,"../../../lib/util":87,"@ethersproject/abi":346,"eth-rpc-errors":1994,"human-standard-token-abi":2486},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFinalStates=function(){return[c.TransactionStatus.rejected,c.TransactionStatus.confirmed,c.TransactionStatus.failed,c.TransactionStatus.dropped]},r.normalizeAndValidateTxParams=function(e,t=!0){const r=h(e,t);return g(r),r},r.normalizeTxParams=h,r.normalizeTxReceiptGasUsed=function(e){return"string"==typeof e?e:e.toString(16)},r.validateConfirmedExternalTransaction=void 0,r.validateFrom=E,r.validateInputData=y,r.validateRecipient=b,r.validateTxParams=g;var n,s=e("eth-rpc-errors"),a=e("@ethersproject/abi"),i=(n=e("human-standard-token-abi"))&&n.__esModule?n:{default:n},o=e("../../../lib/util"),c=e("../../../../../shared/constants/transaction"),u=e("../../../../../shared/modules/transaction.utils"),d=e("../../../../../shared/modules/hexstring-utils");const l={from:o.addHexPrefix,to:(e,t)=>t?(0,o.addHexPrefix)(e).toLowerCase():(0,o.addHexPrefix)(e),nonce:o.addHexPrefix,value:o.addHexPrefix,data:o.addHexPrefix,gas:o.addHexPrefix,gasPrice:o.addHexPrefix,maxFeePerGas:o.addHexPrefix,maxPriorityFeePerGas:o.addHexPrefix,type:o.addHexPrefix,estimateSuggested:e=>e,estimateUsed:e=>e};function h(e,t=!0){const r={};for(const n in l)e[n]&&(r[n]=l[n](e[n],t));return r}function p(e,t,r){if(void 0!==e[r])throw s.ethErrors.rpc.invalidParams(`Invalid transaction params: specified ${t} but also included ${r}, these cannot be mixed`)}function f(e,t){if("string"!=typeof e[t])throw s.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}function m(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&e.type!==c.TransactionEnvelopeType.feeMarket)throw s.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${c.TransactionEnvelopeType.feeMarket}"`);break;default:if(e.type&&e.type===c.TransactionEnvelopeType.feeMarket)throw s.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function g(e,t=!0){if(!e||"object"!=typeof e||Array.isArray(e))throw s.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!e.to&&!e.data)throw s.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');if((0,u.isEIP1559Transaction)({txParams:e})&&!t)throw s.ethErrors.rpc.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559");Object.entries(e).forEach((([t,r])=>{switch(t){case"from":E(e);break;case"to":b(e);break;case"gasPrice":m(e,"gasPrice"),p(e,"gasPrice","maxFeePerGas"),p(e,"gasPrice","maxPriorityFeePerGas"),f(e,"gasPrice");break;case"maxFeePerGas":m(e,"maxFeePerGas"),p(e,"maxFeePerGas","gasPrice"),f(e,"maxFeePerGas");break;case"maxPriorityFeePerGas":m(e,"maxPriorityFeePerGas"),p(e,"maxPriorityFeePerGas","gasPrice"),f(e,"maxPriorityFeePerGas");break;case"value":if(f(e,"value"),r.toString().includes("-"))throw s.ethErrors.rpc.invalidParams(`Invalid transaction value "${r}": not a positive number.`);if(r.toString().includes("."))throw s.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": number must be in wei.`);if(!r.match(/^0x[a-fA-F0-9]+$/u))throw s.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": not a valid hex string.`);break;case"chainId":if("number"!=typeof r&&"string"!=typeof r)throw s.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a Number or hex string. got: (${r})`);break;case"data":y(r),f(e,"data");break;default:f(e,t)}}))}function y(e){if(null!==e){const t=new a.Interface(i.default);try{t.parseTransaction({data:e})}catch(e){if(e.message.match(/BUFFER_OVERRUN/))throw s.ethErrors.rpc.invalidParams("Invalid transaction params: data out-of-bounds, BUFFER_OVERRUN.")}}}function E(e){if("string"!=typeof e.from)throw s.ethErrors.rpc.invalidParams(`Invalid "from" address "${e.from}": not a string.`);if(!(0,d.isValidHexAddress)(e.from,{allowNonPrefixed:!1}))throw s.ethErrors.rpc.invalidParams('Invalid "from" address.')}function b(e){if("0x"===e.to||null===e.to){if(!e.data)throw s.ethErrors.rpc.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,d.isValidHexAddress)(e.to,{allowNonPrefixed:!1}))throw s.ethErrors.rpc.invalidParams('Invalid "to" address.');return e}r.validateConfirmedExternalTransaction=({txMeta:e,pendingTransactions:t,confirmedTransactions:r}={})=>{if(!e||!e.txParams)throw s.ethErrors.rpc.invalidParams('"txMeta" or "txMeta.txParams" is missing');if(e.status!==c.TransactionStatus.confirmed)throw s.ethErrors.rpc.invalidParams('External transaction status should be "confirmed"');const n=e.txParams.nonce;if(t&&t.length>0){if(t.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===n})))throw s.ethErrors.rpc.invalidParams("External transaction nonce should not be in pending txs")}if(r&&r.length>0){if(r.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===n})))throw s.ethErrors.rpc.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"$root$",file:"app/scripts/controllers/transactions/lib/util.js"}],[3201,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM=r.AUTO_LOCK_TIMEOUT_ALARM=void 0;r.AUTO_LOCK_TIMEOUT_ALARM="AUTO_LOCK_TIMEOUT_ALARM";r.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM="METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM"}}},{package:"$root$",file:"shared/constants/alarms.js"}],[3212,{"./time":3214},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME=r.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER=r.FALLBACK_SMART_TRANSACTIONS_DEADLINE=void 0;const n=10*e("./time").SECOND;r.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME=n;r.FALLBACK_SMART_TRANSACTIONS_DEADLINE=180;r.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER=2}}},{package:"$root$",file:"shared/constants/smartTransactions.js"}],[33,{"../../../../shared/constants/transaction":3216,"./tx-state-manager":35,"ethjs-query":2073,loglevel:2743,"safe-event-emitter":3009},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("safe-event-emitter")),s=c(e("loglevel")),a=c(e("ethjs-query")),i=e("../../../../shared/constants/transaction"),o=e("./tx-state-manager");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends n.default{constructor(e){super(),u(this,"DROPPED_BUFFER_COUNT",3),u(this,"droppedBlocksBufferByHash",new Map),this.query=e.query||new a.default(e.provider),this.nonceTracker=e.nonceTracker,this.getPendingTransactions=e.getPendingTransactions,this.getCompletedTransactions=e.getCompletedTransactions,this.publishTransaction=e.publishTransaction,this.approveTransaction=e.approveTransaction,this.confirmTransaction=e.confirmTransaction}async updatePendingTxs(){const e=await this.nonceTracker.getGlobalLock();try{const e=this.getPendingTransactions();await Promise.all(e.map((e=>this._checkPendingTx(e))))}catch(e){s.default.error("PendingTransactionTracker - Error updating pending transactions"),s.default.error(e)}e.releaseLock()}async resubmitPendingTxs(e){const t=this.getPendingTransactions();if(t.length)for(const s of t)try{await this._resubmitTx(s,e)}catch(e){var r,n;const t=(null===(r=e.value)||void 0===r||null===(n=r.message)||void 0===n?void 0:n.toLowerCase())||e.message.toLowerCase();if(t.includes("replacement transaction underpriced")||t.includes("known transaction")||t.includes("gas price too low to replace")||t.includes("transaction with the same hash was already imported")||t.includes("gateway timeout")||t.includes("nonce too low"))return;s.warning={error:t,message:o.ERROR_SUBMITTING},this.emit("tx:warning",s,e)}}async _resubmitTx(e,t){e.firstRetryBlockNumber||this.emit("tx:block-update",e,t);const r=e.firstRetryBlockNumber||t,n=Number.parseInt(t,16)-Number.parseInt(r,16),s=e.retryCount||0;if(n<Math.min(50,Math.pow(2,s)))return undefined;if(!("rawTx"in e))return this.approveTransaction(e.id);const{rawTx:a}=e,i=await this.publishTransaction(a);return this.emit("tx:retry",e),i}async _checkPendingTx(e){const t=e.hash,r=e.id;if(e.status===i.TransactionStatus.submitted){if(!t){const e=new Error("We had an error while submitting this transaction, please try again.");return e.name="NoTxHashError",void this.emit("tx:failed",r,e)}if(await this._checkIfNonceIsTaken(e))this.emit("tx:dropped",r);else{try{const e=await this.query.getTransactionReceipt(t);if(null!=e&&e.blockNumber){const{baseFeePerGas:t,timestamp:n}=await this.query.getBlockByHash(null==e?void 0:e.blockHash,!1);return void this.emit("tx:confirmed",r,e,t,n)}}catch(t){return e.warning={error:t.message,message:"There was a problem loading this transaction."},void this.emit("tx:warning",e,t)}await this._checkIfTxWasDropped(e)&&this.emit("tx:dropped",r)}}}async _checkIfTxWasDropped(e){const{hash:t,txParams:{nonce:r,from:n}}=e,s=await this.query.getTransactionCount(n);if(parseInt(r,16)>=s.toNumber())return!1;this.droppedBlocksBufferByHash.has(t)||this.droppedBlocksBufferByHash.set(t,0);const a=this.droppedBlocksBufferByHash.get(t);return a<this.DROPPED_BUFFER_COUNT?(this.droppedBlocksBufferByHash.set(t,a+1),!1):(this.droppedBlocksBufferByHash.delete(t),!0)}async _checkIfNonceIsTaken(e){const t=e.txParams.from;return this.getCompletedTransactions(t).some((t=>!(t.id===e.id)&&t.txParams.nonce===e.txParams.nonce))}}r.default=d}}},{package:"$root$",file:"app/scripts/controllers/transactions/pending-tx-tracker.js"}],[34,{"../../../../shared/modules/conversion.utils":3230,"../../lib/util":87,"ethereumjs-util":2038,"ethjs-query":2073,lodash:2731,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("ethjs-query")),s=u(e("loglevel")),a=e("ethereumjs-util"),i=e("lodash"),o=e("../../lib/util"),c=e("../../../../shared/modules/conversion.utils");function u(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(e){this.query=new n.default(e)}async analyzeGasUsage(e){const t=await this.query.getBlockByNumber("latest",!1),r=(0,o.hexToBn)(t.gasLimit),n=(0,o.BnMultiplyByFraction)(r,19,20);let a,i=(0,c.bnToHex)(n);try{i=await this.estimateTxGas(e)}catch(e){s.default.warn(e),a={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:t.number,blockGasLimit:t.gasLimit}}}return{blockGasLimit:t.gasLimit,estimatedGasHex:i,simulationFails:a}}async estimateTxGas(e){const t=(0,i.cloneDeep)(e.txParams);return delete t.gasPrice,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,await this.query.estimateGas(t)}addGasBuffer(e,t,r=1.5){const n=(0,o.hexToBn)(e),s=(0,o.hexToBn)(t).muln(.9),a=n.muln(r);return n.gt(s)?(0,c.bnToHex)(n):a.lt(s)?(0,c.bnToHex)(a):(0,c.bnToHex)(s)}async getBufferedGasLimit(e,t){const{blockGasLimit:r,estimatedGasHex:n,simulationFails:s}=await this.analyzeGasUsage(e);return{gasLimit:this.addGasBuffer((0,a.addHexPrefix)(n),r,t),simulationFails:s}}}}}},{package:"$root$",file:"app/scripts/controllers/transactions/tx-gas-utils.js"}],[35,{"../../../../shared/constants/app":3203,"../../../../shared/constants/transaction":3216,"../../../../shared/modules/random-id":3238,"../../../../shared/modules/transaction.utils":3243,"../../metamask-controller":88,"./lib/tx-state-history-helpers":31,"./lib/util":32,"@metamask/obs-store":1139,lodash:2731,loglevel:2743,"safe-event-emitter":3009},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ERROR_SUBMITTING=void 0;var n=f(e("safe-event-emitter")),s=e("@metamask/obs-store"),a=f(e("loglevel")),i=e("lodash"),o=f(e("../../../../shared/modules/random-id")),c=e("../../../../shared/constants/transaction"),u=e("../../metamask-controller"),d=e("../../../../shared/modules/transaction.utils"),l=e("../../../../shared/constants/app"),h=e("./lib/tx-state-history-helpers"),p=e("./lib/util");function f(e){return e&&e.__esModule?e:{default:e}}const m="There was an error when resubmitting this transaction.";r.ERROR_SUBMITTING=m;class g extends n.default{constructor({initState:e,txHistoryLimit:t,getNetworkState:r,getCurrentChainId:n}){super(),this.store=new s.ObservableStore({transactions:{},...e}),this.txHistoryLimit=t,this.getNetworkState=r,this.getCurrentChainId=n}generateTxMeta(e={}){var t;const r=this.getNetworkState(),n=this.getCurrentChainId();if("loading"===r)throw new Error("MetaMask is having trouble connecting to the network");let s=null;return e.txParams&&"string"==typeof e.origin&&e.origin!==l.ORIGIN_METAMASK&&(void 0!==e.txParams.gasPrice?s={gasPrice:e.txParams.gasPrice}:void 0===e.txParams.maxFeePerGas&&void 0===e.txParams.maxPriorityFeePerGas||(s={maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas,maxFeePerGas:e.txParams.maxFeePerGas}),void 0!==e.txParams.gas&&(s={...s,gas:e.txParams.gas})),{id:(0,o.default)(),time:(new Date).getTime(),status:c.TransactionStatus.unapproved,metamaskNetworkId:r,originalGasEstimate:null===(t=e.txParams)||void 0===t?void 0:t.gas,userEditedGasLimit:!1,chainId:n,loadingDefaults:!0,dappSuggestedGasFees:s,sendFlowHistory:[],...e}}getUnapprovedTxList(){const e=this.getCurrentChainId(),t=this.getNetworkState();return(0,i.pickBy)(this.store.getState().transactions,(r=>r.status===c.TransactionStatus.unapproved&&(0,d.transactionMatchesNetwork)(r,e,t)))}getApprovedTransactions(e){const t={status:c.TransactionStatus.approved};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getPendingTransactions(e){const t={status:c.TransactionStatus.submitted};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getConfirmedTransactions(e){const t={status:c.TransactionStatus.confirmed};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getTransactionWithActionId(e){return(0,i.values)((0,i.pickBy)(this.store.getState().transactions,(t=>t.actionId===e)))[0]}addTransaction(e){e.txParams&&(e.txParams=(0,p.normalizeAndValidateTxParams)(e.txParams,!1)),this.once(`${e.id}:signed`,(()=>{this.removeAllListeners(`${e.id}:rejected`)})),this.once(`${e.id}:rejected`,(()=>{this.removeAllListeners(`${e.id}:signed`)})),e.history=[];const t=(0,h.snapshotFromTxMeta)(e);e.history.push(t);const r=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:n}=this,s=new Set,a=r.reverse().filter((e=>{const{nonce:t,from:r}=e.txParams,{chainId:a,metamaskNetworkId:i,status:o}=e,c=`${t}-${null!=a?a:i}-${r}`;return!s.has(c)&&(!(s.size<n-1||!1===(0,p.getFinalStates)().includes(o))||(s.add(c),!1))})).map((e=>e.id));return this._deleteTransactions(a),this._addTransactionsToState([e]),e}addExternalTransaction(e){var t;const r=null==e||null===(t=e.txParams)||void 0===t?void 0:t.from,n=this.getConfirmedTransactions(r),s=this.getPendingTransactions(r);return(0,p.validateConfirmedExternalTransaction)({txMeta:e,pendingTransactions:s,confirmedTransactions:n}),this._addTransactionsToState([e]),e}getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}updateTransaction(e,t){if(e.txParams)try{e.txParams=(0,p.normalizeAndValidateTxParams)(e.txParams,!1)}catch(t){if(e.warning.message!==m)throw t;return void this.setTxStatusFailed(e.id,t)}this._updateTransactionHistory(e,t)}_updateTransactionHistory(e,t){const r=(0,h.snapshotFromTxMeta)(e),n=(0,h.replayHistory)(e.history),s=(0,h.generateHistoryEntry)(n,r,t);s.length&&e.history.push(s);const a=e.id;this.store.updateState({transactions:{...this.store.getState().transactions,[a]:e}})}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:r=!0,limit:n}={}){const s=this.getCurrentChainId(),a=this.getNetworkState(),o=(0,i.mapValues)(e,(e=>"function"==typeof e?e:t=>t===e)),c=t?(0,i.keyBy)(t,"id"):this.store.getState().transactions,u=(0,i.sortBy)((0,i.pickBy)(c,(e=>{if(r&&!1===(0,d.transactionMatchesNetwork)(e,s,a))return!1;for(const[t,r]of Object.entries(o))if(t in e.txParams){if(!1===r(e.txParams[t]))return!1}else if(!1===r(e[t]))return!1;return!0})),"time");if(n!==undefined){const e=new Set,t=[];for(let r=u.length-1;r>-1;r--){const s=u[r],{nonce:a}=s.txParams;if(!e.has(a)){if(!(e.size<n))continue;e.add(a)}t.unshift(s)}return t}return u}setTxStatusRejected(e){this._setTransactionStatus(e,c.TransactionStatus.rejected),this._deleteTransaction(e)}setTxStatusUnapproved(e){this._setTransactionStatus(e,c.TransactionStatus.unapproved)}setTxStatusApproved(e){this._setTransactionStatus(e,c.TransactionStatus.approved)}setTxStatusSigned(e){this._setTransactionStatus(e,c.TransactionStatus.signed)}setTxStatusSubmitted(e){const t=this.getTransaction(e);t.submittedTime=(new Date).getTime(),this.updateTransaction(t,"txStateManager - add submitted time stamp"),this._setTransactionStatus(e,c.TransactionStatus.submitted)}setTxStatusConfirmed(e){this._setTransactionStatus(e,c.TransactionStatus.confirmed)}setTxStatusDropped(e){this._setTransactionStatus(e,c.TransactionStatus.dropped)}setTxStatusFailed(e,t){var r;const n=t||new Error("Internal metamask failure"),s=this.getTransaction(e);s.err={message:(null===(r=n.message)||void 0===r?void 0:r.toString())||n.toString(),rpc:n.value,stack:n.stack},this._updateTransactionHistory(s,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(e,c.TransactionStatus.failed)}wipeTransactions(e){const{transactions:t}=this.store.getState(),r=this.getNetworkState(),n=this.getCurrentChainId();this.store.updateState({transactions:(0,i.omitBy)(t,(t=>t.txParams.from===e&&(0,d.transactionMatchesNetwork)(t,n,r)))})}clearUnapprovedTxs(){this.store.updateState({transactions:(0,i.omitBy)(this.store.getState().transactions,(e=>e.status===c.TransactionStatus.unapproved))})}_setTransactionStatus(e,t){const r=this.getTransaction(e);if(r){r.status=t;try{this._updateTransactionHistory(r,`txStateManager: setting status to ${t}`),this.emit(`${r.id}:${t}`,e),this.emit("tx:status-update",e,t),[c.TransactionStatus.submitted,c.TransactionStatus.rejected,c.TransactionStatus.failed].includes(t)&&this.emit(`${r.id}:finished`,r),this.emit(u.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}catch(e){a.default.error(e)}}}_addTransactionsToState(e){this.store.updateState({transactions:e.reduce(((e,t)=>(e[t.id]=t,e)),this.store.getState().transactions)})}_deleteTransaction(e){const{transactions:t}=this.store.getState();delete t[e],this.store.updateState({transactions:t})}_deleteTransactions(e){const{transactions:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({transactions:t})}}r.default=g}}},{package:"$root$",file:"app/scripts/controllers/transactions/tx-state-manager.js"}],[36,{"../../shared/constants/app":3203,"./lib/util":87,"webextension-polyfill":3187},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.onMessageReceived=r.checkForMultipleVersionsRunning=void 0;var n,s=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n},a=e("../../shared/constants/app"),i=e("./lib/util");const o="isRunning";r.onMessageReceived=e=>{e===o&&console.warn("Warning! You have multiple instances of MetaMask running!")};r.checkForMultipleVersionsRunning=async()=>{if((0,i.getPlatform)()!==a.PLATFORM_CHROME&&(0,i.getPlatform)()!==a.PLATFORM_FIREFOX)return;const e=(0,i.getPlatform)()===a.PLATFORM_CHROME?a.CHROME_BUILD_IDS:a.FIREFOX_BUILD_IDS,t=s.default.runtime.id;for(const r of e)if(r!==t)try{await s.default.runtime.sendMessage(r,o)}catch(e){}}}}},{package:"$root$",file:"app/scripts/detect-multiple-instances.js"}],[37,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={config:{},PreferencesController:{frequentRpcListDetail:[{rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}]}};r.default=n}}},{package:"$root$",file:"app/scripts/first-time-state.js"}],[38,{"@metamask/base-controller":991,"@metamask/obs-store":1139},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store"),s=e("@metamask/base-controller");function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class i extends n.ObservableStore{constructor({config:e,controllerMessenger:t,state:r,persist:n}){super(r),a(this,"config",{}),this.persist=n,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();for(const t of Object.keys(e)){if(!e[t])throw new Error(`Undefined '${t}'`);const r=e[t];r.subscribe?e[t].subscribe((e=>{this.updateState({[t]:e})})):this.controllerMessenger.subscribe(`${r.name}:stateChange`,(r=>{let n=r;this.persist&&(n=(0,s.getPersistentState)(r,e[t].metadata)),this.updateState({[t]:n})}))}}getFlatState(){if(!this.config)return{};let e={};for(const t of Object.keys(this.config)){const r=this.config[t],n=r.getState?r.getState():r.state;e={...e,...n}}return e}}r.default=i}}},{package:"$root$",file:"app/scripts/lib/ComposableObservableStore.js"}],[39,{"../../../shared/constants/network":3209,"../constants/contracts":5,"./util":87,"@ethersproject/contracts":370,"@ethersproject/providers":409,"@metamask/obs-store":1139,"eth-query":1990,loglevel:2743,pify:2823,"single-call-balance-checker-abi":3077},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=p(e("eth-query")),s=e("@metamask/obs-store"),a=p(e("loglevel")),i=p(e("pify")),o=e("@ethersproject/providers"),c=e("@ethersproject/contracts"),u=p(e("single-call-balance-checker-abi")),d=e("../../../shared/constants/network"),l=e("../constants/contracts"),h=e("./util");function p(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(e={}){const t={accounts:{},currentBlockGasLimit:""};this.store=new s.ObservableStore(t),this.resetState=()=>{this.store.updateState(t)},this._provider=e.provider,this._query=(0,i.default)(new n.default(this._provider)),this._blockTracker=e.blockTracker,this._currentBlockNumber=this._blockTracker.getCurrentBlock(),this._blockTracker.once("latest",(e=>{this._currentBlockNumber=e})),this._updateForBlock=this._updateForBlock.bind(this),this.getCurrentChainId=e.getCurrentChainId,this.getNetworkIdentifier=e.getNetworkIdentifier,this.preferencesController=e.preferencesController,this.onboardingController=e.onboardingController,this.onboardingController.store.subscribe((0,h.previousValueComparator)((async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n}=t;!r&&n&&this._updateAccounts()}),this.onboardingController.store.getState())),this.preferencesController.store.subscribe((0,h.previousValueComparator)((async(e,t)=>{const{selectedAddress:r}=e,{selectedAddress:n,useMultiAccountBalanceChecker:s}=t;r===n||s||this._updateAccounts()}),this.onboardingController.store.getState())),this.ethersProvider=new o.Web3Provider(this._provider)}start(){this._blockTracker.removeListener("latest",this._updateForBlock),this._blockTracker.addListener("latest",this._updateForBlock),this._updateAccounts()}stop(){this._blockTracker.removeListener("latest",this._updateForBlock)}syncWithAddresses(e){const{accounts:t}=this.store.getState(),r=Object.keys(t),n=[];e.forEach((e=>{r.includes(e)||n.push(e)}));const s=[];r.forEach((t=>{e.includes(t)||s.push(t)})),this.addAccounts(n),this.removeAccount(s)}addAccounts(e){const{accounts:t}=this.store.getState();e.forEach((e=>{t[e]={}})),this.store.updateState({accounts:t}),this._currentBlockNumber&&this._updateAccounts()}removeAccount(e){const{accounts:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({accounts:t})}clearAccounts(){this.store.updateState({accounts:{}})}async _updateForBlock(e){this._currentBlockNumber=e;const t=await this._query.getBlockByNumber(e,!1);if(!t)return;const r=t.gasLimit;this.store.updateState({currentBlockGasLimit:r});try{await this._updateAccounts()}catch(e){a.default.error(e)}}async _updateAccounts(){const{completedOnboarding:e}=this.onboardingController.store.getState();if(!e)return;const{useMultiAccountBalanceChecker:t}=this.preferencesController.store.getState();let r=[];if(t){const{accounts:e}=this.store.getState();r=Object.keys(e)}else{r=[this.preferencesController.getSelectedAddress()]}const n=this.getCurrentChainId(),s=this.getNetworkIdentifier();if(s===d.LOCALHOST_RPC_URL||"http://127.0.0.1:8545"===s)await Promise.all(r.map(this._updateAccount.bind(this)));else switch(n){case d.CHAIN_IDS.MAINNET:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS);break;case d.CHAIN_IDS.GOERLI:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_GOERLI);break;case d.CHAIN_IDS.SEPOLIA:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA);break;case d.CHAIN_IDS.BSC:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_BSC);break;case d.CHAIN_IDS.OPTIMISM:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM);break;case d.CHAIN_IDS.POLYGON:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_POLYGON);break;case d.CHAIN_IDS.AVALANCHE:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE);break;case d.CHAIN_IDS.FANTOM:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_FANTOM);break;case d.CHAIN_IDS.ARBITRUM:await this._updateAccountsViaBalanceChecker(r,l.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM);break;default:await Promise.all(r.map(this._updateAccount.bind(this)))}}async _updateAccount(e){const{useMultiAccountBalanceChecker:t}=this.preferencesController.store.getState();let r="0x0";try{r=await this._query.getBalance(e)}catch(e){var n,s;if("eth_getBalance"!==(null===(n=e.data)||void 0===n||null===(s=n.request)||void 0===s?void 0:s.method))throw e}const a={address:e,balance:r},{accounts:i}=this.store.getState();if(!i[e])return;let o=i;t||(o={},Object.keys(i).forEach((t=>{e!==t&&(o[t]={address:t,balance:null})}))),o[e]=a,this.store.updateState({accounts:o})}async _updateAccountsViaBalanceChecker(e,t){const{accounts:r}=this.store.getState(),n={};Object.keys(r).forEach((t=>{e.includes(t)||(n[t]={address:t,balance:null})})),this.ethersProvider=new o.Web3Provider(this._provider);const s=await new c.Contract(t,u.default,this.ethersProvider),i=["0x0000000000000000000000000000000000000000"];try{const t=await s.balances(e,i);e.forEach(((e,r)=>{const s=t[r]?t[r].toHexString():"0x0";n[e]={address:e,balance:s}})),this.store.updateState({accounts:n})}catch(t){a.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),Promise.all(e.map(this._updateAccount.bind(this)))}}}}}},{package:"$root$",file:"app/scripts/lib/account-tracker.js"}],[41,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let{name:t}=e;t=t===undefined?"Error":String(t);let r=e.message;r=r===undefined?"":String(r),""===t?e.stack=e.message:""===r?e.stack=e.name:e.stack||(e.stack=`${e.name}: ${e.message}`);return e}}}},{package:"$root$",file:"app/scripts/lib/cleanErrorStack.js"}],[42,{loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){const e=[];return function(t,r,n,a){return e.indexOf(t.id)>=0?(s.default.info(`RPC request with id ${t.id} already seen.`),a()):(e.push(t.id),n())}};var n,s=(n=e("loglevel"))&&n.__esModule?n:{default:n}}}},{package:"$root$",file:"app/scripts/lib/createDupeReqFilterMiddleware.js"}],[43,{loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){n((n=>{r.error&&s.default.error("Error in RPC response:\n",r),t.isMetamaskInternal||(s.default.info(`RPC (${e.origin}):`,t,"->",r),n())}))}};var n,s=(n=e("loglevel"))&&n.__esModule?n:{default:n}}}},{package:"$root$",file:"app/scripts/lib/createLoggerMiddleware.js"}],[44,{"../../../shared/modules/mv3.utils":3235,"eth-rpc-errors":1994},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../shared/modules/mv3.utils");var a=(e,t,r,a)=>async i=>{if(t._writableState.ended)return;if(!e[i.method])return void t.write({jsonrpc:"2.0",error:n.ethErrors.rpc.methodNotFound({message:`${i.method} not found`}),id:i.id});let o,c;try{o=await e[i.method](...i.params)}catch(e){c=e}finally{s.isManifestV3&&r&&"getState"!==i.method&&a.set(r.getState())}t._writableState.ended?c&&console.error(c):c?t.write({jsonrpc:"2.0",error:(0,n.serializeError)(c,{shouldIncludeStack:!0}),id:i.id}):t.write({jsonrpc:"2.0",result:o,id:i.id})};r.default=a}}},{package:"$root$",file:"app/scripts/lib/createMetaRPCHandler.js"}],[45,{"./middleware/pending":63,"eth-json-rpc-middleware":1964,"json-rpc-engine":2523},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({version:e,getAccounts:t,processTransaction:r,processEthSignMessage:i,processTypedMessage:o,processTypedMessageV3:c,processTypedMessageV4:u,processPersonalMessage:d,processDecryptMessage:l,processEncryptionPublicKey:h,getPendingNonce:p,getPendingTransactionByHash:f}){return(0,n.mergeMiddleware)([(0,n.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,s.createWalletMiddleware)({getAccounts:t,processTransaction:r,processEthSignMessage:i,processTypedMessage:o,processTypedMessageV3:c,processTypedMessageV4:u,processPersonalMessage:d,processDecryptMessage:l,processEncryptionPublicKey:h}),(0,a.createPendingNonceMiddleware)({getPendingNonce:p}),(0,a.createPendingTxMiddleware)({getPendingTransactionByHash:f})])};var n=e("json-rpc-engine"),s=e("eth-json-rpc-middleware"),a=e("./middleware/pending")}}},{package:"$root$",file:"app/scripts/lib/createMetamaskMiddleware.js"}],[46,{loglevel:2743,"webextension-polyfill":3187},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({location:e,registerOnboarding:t}){return async function(r,a,i,o){try{if("wallet_registerOnboarding"!==r.method)return void i();r.tabId&&r.tabId!==s.default.tabs.TAB_ID_NONE?await t(e,r.tabId):n.default.debug(`'wallet_registerOnboarding' message from ${e} ignored due to missing tabId`),a.result=!0,o()}catch(e){o(e)}}};var n=a(e("loglevel")),s=a(e("webextension-polyfill"));function a(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$",file:"app/scripts/lib/createOnboardingMiddleware.js"}],[468,{"@ethereumjs/tx":303,"@ethereumjs/util":314,"@keystonehq/bc-ur-registry-eth":474,buffer:1768,hdkey:2482,rlp:471,uuid:3153},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(r,"__esModule",{value:!0});var s=n(e("hdkey")),a=e("@ethereumjs/util"),i=n(e("rlp")),o=e("@ethereumjs/tx"),c=e("@keystonehq/bc-ur-registry-eth"),u=e("uuid");const d="QR Hardware Wallet Device",l="m",h="0/*";var p,f;!function(e){e.hd="hd",e.pubkey="pubkey"}(p||(p={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(f||(f={}));class m{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type=d,this.requestSignature=async(e,t,r,n)=>{const s=await this.getInteraction().requestSignature(t,r,n),a=s.getRequestId(),i=s.getSignature();if(a){if(u.stringify(a)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId")}return{r:i.slice(0,32),s:i.slice(32,64),v:i.slice(64)}},this.__readCryptoHDKey=e=>{var t,r;const n=`m/${e.getOrigin().getPath()}`,s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),a=(null==(r=e.getChildren())?void 0:r.getPath())||h,i=e.getName();if(e.getNote()===f.standard?this.keyringAccount=f.standard:e.getNote()===f.ledger_legacy&&(this.keyringAccount=f.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const o=e.getBip32Key();this.xfp=s,this.xpub=o,this.hdPath=n,this.childrenPath=a,i!==undefined&&""!==i&&(this.name=i),this.initialized=!0},this.__readCryptoAccount=e=>{var t,r;const n=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!n)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=n,this.initialized=!0;let s=!1;const i=e.getOutputDescriptors();if(!i||0===i.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(i.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(r=e.getOutputDescriptors())||r.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),r=`M/${t.getOrigin().getPath()}`,n="0x"+a.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===f.ledger_live&&(this.keyringAccount=f.ledger_live),this.paths[a.toChecksumAddress(n)]===undefined&&(s=!0),this.paths[a.toChecksumAddress(n)]=r}}catch(e){throw new Error(`KeystoneError#invalid_data: ${e}`)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(l,e);n.push({address:t,balance:null,index:e}),this.indexes[a.toChecksumAddress(t)]=e}return n},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(l,e);n.push({address:t,balance:null,index:e})}return this.page+=e,n},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===p.hd){this.checkKeyring(),this.hdk||(this.hdk=s.fromExtendedKey(this.xpub));const r=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),n=this.hdk.derive(`${e}/${r}`),i="0x"+a.publicToAddress(n.publicKey,!0).toString("hex");return a.toChecksumAddress(i)}{const e=Object.keys(this.paths)[t];if(e)return a.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=p.hd,this.keyringAccount=f.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath=h,this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===c.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=p.hd,this.__readCryptoHDKey(e)):(this.keyringMode=p.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||p.hd,this.keyringAccount=e.keyringAccount||f.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||h)}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,r=t+e,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(l,e);n.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(n),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===p.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){const n=0===r.type?c.DataType.transaction:c.DataType.typedTransaction;let s;s=0===r.type?t.from(i.encode(r.getMessageToSign(!1))):r.getMessageToSign(!1);const a=await this._pathFromAddress(e),d=r.common.chainId(),l=u.v4(),h=c.EthSignRequest.constructETHRequest(s,n,a,this.xfp,l,d),{r:p,s:f,v:m}=await this.requestSignature(l,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return o.TransactionFactory.fromTxData({...r.toJSON(),type:r.type,r:p,s:f,v:m},{common:r.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,r){const n=a.stripHexPrefix(r),s=await this._pathFromAddress(e),i=u.v4(),o=c.EthSignRequest.constructETHRequest(t.from(n,"hex"),c.DataType.personalMessage,s,this.xfp,i,undefined,e),{r:d,s:l,v:h}=await this.requestSignature(i,o,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([d,l,h]).toString("hex")}async signTypedData(e,r){const n=await this._pathFromAddress(e),s=u.v4(),a=c.EthSignRequest.constructETHRequest(t.from(JSON.stringify(r),"utf-8"),c.DataType.typedData,n,this.xfp,s,undefined,e),{r:i,s:o,v:d}=await this.requestSignature(s,a,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([i,o,d]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===p.hd){const t=a.toChecksumAddress(e);let r=this.indexes[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex(l,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",r.toString()).replace(/\*/g,"0")}`}{const t=a.toChecksumAddress(e),r=this.paths[t];if(void 0===r)throw new Error("Unknown address");return r}}}m.type=d,r.BaseKeyring=m}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.development.js"}],[469,{"@ethereumjs/tx":303,"@ethereumjs/util":314,"@keystonehq/bc-ur-registry-eth":474,buffer:1768,hdkey:2482,rlp:471,uuid:3153},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(r,"__esModule",{value:!0});var s,a,i=n(e("hdkey")),o=e("@ethereumjs/util"),c=n(e("rlp")),u=e("@ethereumjs/tx"),d=e("@keystonehq/bc-ur-registry-eth"),l=e("uuid");!function(e){e.hd="hd",e.pubkey="pubkey"}(s||(s={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(a||(a={}));class h{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type="QR Hardware Wallet Device",this.requestSignature=async(e,t,r,n)=>{const s=await this.getInteraction().requestSignature(t,r,n),a=s.getRequestId(),i=s.getSignature();if(a&&l.stringify(a)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId");return{r:i.slice(0,32),s:i.slice(32,64),v:i.slice(64)}},this.__readCryptoHDKey=e=>{var t,r;const n="m/"+e.getOrigin().getPath(),s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),i=(null==(r=e.getChildren())?void 0:r.getPath())||"0/*",o=e.getName();if(e.getNote()===a.standard?this.keyringAccount=a.standard:e.getNote()===a.ledger_legacy&&(this.keyringAccount=a.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const c=e.getBip32Key();this.xfp=s,this.xpub=c,this.hdPath=n,this.childrenPath=i,void 0!==o&&""!==o&&(this.name=o),this.initialized=!0},this.__readCryptoAccount=e=>{var t,r;const n=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!n)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=n,this.initialized=!0;let s=!1;const i=e.getOutputDescriptors();if(!i||0===i.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(i.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(r=e.getOutputDescriptors())||r.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),r="M/"+t.getOrigin().getPath(),n="0x"+o.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===a.ledger_live&&(this.keyringAccount=a.ledger_live),void 0===this.paths[o.toChecksumAddress(n)]&&(s=!0),this.paths[o.toChecksumAddress(n)]=r}}catch(e){throw new Error("KeystoneError#invalid_data: "+e)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push({address:t,balance:null,index:e}),this.indexes[o.toChecksumAddress(t)]=e}return n},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push({address:t,balance:null,index:e})}return this.page+=e,n},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===s.hd){this.checkKeyring(),this.hdk||(this.hdk=i.fromExtendedKey(this.xpub));const r=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),n=this.hdk.derive(`${e}/${r}`),s="0x"+o.publicToAddress(n.publicKey,!0).toString("hex");return o.toChecksumAddress(s)}{const e=Object.keys(this.paths)[t];if(e)return o.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=s.hd,this.keyringAccount=a.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath="0/*",this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===d.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=s.hd,this.__readCryptoHDKey(e)):(this.keyringMode=s.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||s.hd,this.keyringAccount=e.keyringAccount||a.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||"0/*")}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,r=t+e,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(n),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===s.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){const n=0===r.type?d.DataType.transaction:d.DataType.typedTransaction;let s;s=0===r.type?t.from(c.encode(r.getMessageToSign(!1))):r.getMessageToSign(!1);const a=await this._pathFromAddress(e),i=r.common.chainId(),o=l.v4(),h=d.EthSignRequest.constructETHRequest(s,n,a,this.xfp,o,i),{r:p,s:f,v:m}=await this.requestSignature(o,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return u.TransactionFactory.fromTxData({...r.toJSON(),type:r.type,r:p,s:f,v:m},{common:r.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,r){const n=o.stripHexPrefix(r),s=await this._pathFromAddress(e),a=l.v4(),i=d.EthSignRequest.constructETHRequest(t.from(n,"hex"),d.DataType.personalMessage,s,this.xfp,a,void 0,e),{r:c,s:u,v:h}=await this.requestSignature(a,i,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([c,u,h]).toString("hex")}async signTypedData(e,r){const n=await this._pathFromAddress(e),s=l.v4(),a=d.EthSignRequest.constructETHRequest(t.from(JSON.stringify(r),"utf-8"),d.DataType.typedData,n,this.xfp,s,void 0,e),{r:i,s:o,v:c}=await this.requestSignature(s,a,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([i,o,c]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===s.hd){const t=o.toChecksumAddress(e);let r=this.indexes[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex("m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",r.toString()).replace(/\*/g,"0")}`}{const t=o.toChecksumAddress(e),r=this.paths[t];if(void 0===r)throw new Error("Unknown address");return r}}}h.type="QR Hardware Wallet Device",r.BaseKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.production.min.js"}],[47,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){t.origin=e.origin,n()}}}}},{package:"$root$",file:"app/scripts/lib/createOriginMiddleware.js"}],[470,{"./base-eth-keyring.cjs.development.js":468,"./base-eth-keyring.cjs.production.min.js":469},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./base-eth-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/index.js"}],[471,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(n(e[r]));const r=p(...t);return p(i(r.length,192),r)}const t=y(e);return 1===t.length&&t[0]<128?t:p(i(t.length,128),t)}function s(e,t,r){if(r>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,r)}function a(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return l(d(e))}function i(e,t){if(e<56)return Uint8Array.from([e+t]);const r=m(e),n=m(t+55+r.length/2);return Uint8Array.from(h(n+r))}function o(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const r=c(y(e));if(t)return r;if(0!==r.remainder.length)throw new Error("invalid RLP: remainder must be zero");return r.data}function c(e){let t,r,n,i,o;const u=[],d=e[0];if(d<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(d<=183){if(t=d-127,n=128===d?Uint8Array.from([]):s(e,1,t),2===t&&n[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:n,remainder:e.slice(t)}}if(d<=191){if(r=d-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=a(s(e,1,r)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return n=s(e,r,t+r),{data:n,remainder:e.slice(t+r)}}if(d<=247){for(t=d-191,i=s(e,1,t);i.length;)o=c(i),u.push(o.data),i=o.remainder;return{data:u,remainder:e.slice(t)}}{if(r=d-246,t=a(s(e,1,r)),t<56)throw new Error("invalid RLP: encoded list too short");const n=r+t;if(n>e.length)throw new Error("invalid RLP: total length is larger than the data");for(i=s(e,r,n);i.length;)o=c(i),u.push(o.data),i=o.remainder;return{data:u,remainder:e.slice(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.decode=r.encode=void 0,r.encode=n,r.decode=o;const u=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function d(e){let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t}function l(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r;t[r]=l(e.slice(n,n+2))}return t}function p(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}function f(e){return(new TextEncoder).encode(e)}function m(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function g(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function y(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return g(e)?h((t="string"!=typeof(r=e)?r:g(r)?r.slice(2):r).length%2?`0${t}`:t):f(e);var t,r;if("number"==typeof e||"bigint"==typeof e)return e?h(m(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}r.utils={bytesToHex:d,concatBytes:p,hexToBytes:h,utf8ToBytes:f};const E={encode:n,decode:o};r.default=E}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring>rlp",file:"node_modules/@keystonehq/base-eth-keyring/node_modules/rlp/dist/index.js"}],[48,{"../../../shared/constants/app":3203,"../../../shared/constants/metametrics":3208,"../../../shared/constants/time":3214,"../../../shared/modules/siwe":3240},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({trackEvent:e,getMetricsState:t,rateLimitSeconds:r=300}){return function(u,p,f){var m;const{origin:g,method:y}=u,E=null!==(m=d[y])&&void 0!==m?m:o,b=E===o&&void 0!==h[y],T=!0===t().participateInMetaMetrics,_=l[y],v=g!==n.ORIGIN_METAMASK&&E!==c&&!1===b&&!0===T;if(v){const t=_?_.REQUESTED:i.EVENT_NAMES.PROVIDER_METHOD_CALLED,o={};if(t===i.EVENT_NAMES.SIGNATURE_REQUESTED?o.signature_type=y:o.method=y,y===n.MESSAGE_TYPE.PERSONAL_SIGN){var w;const e=null==u||null===(w=u.params)||void 0===w?void 0:w[0],{isSIWEMessage:t}=(0,a.detectSIWE)({data:e});t&&(o.ui_customizations=[i.METAMETRIC_KEY_OPTIONS[i.METAMETRIC_KEY.UI_CUSTOMIZATIONS].SIWE])}e({event:t,category:i.EVENT.CATEGORIES.INPAGE_PROVIDER,referrer:{url:g},properties:o}),h[y]=setTimeout((()=>{delete h[y]}),s.SECOND*r)}f((t=>{var r;if(!1===v||void 0===_)return t();const s=4001===(null===(r=p.error)||void 0===r?void 0:r.code)?_.REJECTED:_.APPROVED,o={};if(_.REQUESTED===i.EVENT_NAMES.SIGNATURE_REQUESTED?o.signature_type=y:o.method=y,y===n.MESSAGE_TYPE.PERSONAL_SIGN){var c;const e=null==u||null===(c=u.params)||void 0===c?void 0:c[0],{isSIWEMessage:t}=(0,a.detectSIWE)({data:e});t&&(o.ui_customizations=[i.METAMETRIC_KEY_OPTIONS[i.METAMETRIC_KEY.UI_CUSTOMIZATIONS].SIWE])}return e({event:s,category:i.EVENT.CATEGORIES.INPAGE_PROVIDER,referrer:{url:g},properties:o}),t()}))}};var n=e("../../../shared/constants/app"),s=e("../../../shared/constants/time"),a=e("../../../shared/modules/siwe"),i=e("../../../shared/constants/metametrics");const o="rate_limited",c="blocked",u="non_rate_limited",d={[n.MESSAGE_TYPE.ETH_SIGN]:u,[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:u,[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:u,[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:u,[n.MESSAGE_TYPE.PERSONAL_SIGN]:u,[n.MESSAGE_TYPE.ETH_DECRYPT]:u,[n.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:u,[n.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:o,[n.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:o,[n.MESSAGE_TYPE.SEND_METADATA]:c,[n.MESSAGE_TYPE.GET_PROVIDER_STATE]:c},l={[n.MESSAGE_TYPE.ETH_SIGN]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.PERSONAL_SIGN]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_DECRYPT]:{APPROVED:i.EVENT_NAMES.DECRYPTION_APPROVED,REJECTED:i.EVENT_NAMES.DECRYPTION_REJECTED,REQUESTED:i.EVENT_NAMES.DECRYPTION_REQUESTED},[n.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:{APPROVED:i.EVENT_NAMES.ENCRYPTION_PUBLIC_KEY_APPROVED,REJECTED:i.EVENT_NAMES.ENCRYPTION_PUBLIC_KEY_REJECTED,REQUESTED:i.EVENT_NAMES.ENCRYPTION_PUBLIC_KEY_REQUESTED},[n.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:{APPROVED:i.EVENT_NAMES.PERMISSIONS_APPROVED,REJECTED:i.EVENT_NAMES.PERMISSIONS_REJECTED,REQUESTED:i.EVENT_NAMES.PERMISSIONS_REQUESTED},[n.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:{APPROVED:i.EVENT_NAMES.PERMISSIONS_APPROVED,REJECTED:i.EVENT_NAMES.PERMISSIONS_REJECTED,REQUESTED:i.EVENT_NAMES.PERMISSIONS_REQUESTED}},h={}}}},{package:"$root$",file:"app/scripts/lib/createRPCMethodTrackingMiddleware.js"}],[49,{"promise-to-callback":2827,"readable-stream":2990},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return new i(e,t)};var n,s=e("readable-stream"),a=(n=e("promise-to-callback"))&&n.__esModule?n:{default:n};class i extends s.Writable{constructor(e,t){super({objectMode:!0,...t}),this._asyncWriteFn=e}_write(e,t,r){(0,a.default)(this._asyncWriteFn(e,t))(r)}}}}},{package:"$root$",file:"app/scripts/lib/createStreamSink.js"}],[497,{"./metamask-airgapped-keyring.cjs.development.js":498,"./metamask-airgapped-keyring.cjs.production.min.js":499},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./metamask-airgapped-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/index.js"}],[498,{"@ethereumjs/tx":303,"@keystonehq/base-eth-keyring":470,"@keystonehq/bc-ur-registry-eth":474,"@metamask/obs-store":504,buffer:1768,events:1769,rlp:3006,uuid:3153},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/base-eth-keyring"),a=e("events"),i=e("@metamask/obs-store"),o=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),u=e("@ethereumjs/tx"),d=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class l extends a.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(`${e}-signed`),this.removeAllListeners(`${e}-canceled`)},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=o.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=o.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,a)=>{const i=e.toUR(),u=e.getRequestId(),d=c.stringify(u),l={requestId:d,payload:{type:i.type,cbor:i.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:l}}),this.once(`${d}-signed`,(e=>{const r=o.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(`${d}-canceled`,(()=>{this.resetState(),a(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(`${e}-signed`,t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(`${t}-canceled`)}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},l.instance)return l.instance;this.memStore=new i.ObservableStore({sync:{reading:!1},sign:{},_version:1}),l.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new l,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=undefined,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const r=0===t.type?o.DataType.transaction:o.DataType.typedTransaction;let n;n=0===t.type?d.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),a=t.common.chainId(),i=c.v4(),l=o.EthSignRequest.constructETHRequest(n,r,s,this.xfp,i,a,e),{r:h,s:p,v:f}=await this.requestSignature(i,l,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),m=t.toJSON();m.v=f,m.s=p,m.r=h,m.type=t.type;return u.TransactionFactory.fromTxData(m,{common:t.common})}}h.type=s.BaseKeyring.type,r.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.development.js"}],[499,{"@ethereumjs/tx":303,"@keystonehq/base-eth-keyring":470,"@keystonehq/bc-ur-registry-eth":474,"@metamask/obs-store":504,buffer:1768,events:1769,rlp:3006,uuid:3153},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/base-eth-keyring"),a=e("events"),i=e("@metamask/obs-store"),o=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),u=e("@ethereumjs/tx"),d=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class l extends a.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(e+"-signed"),this.removeAllListeners(e+"-canceled")},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=o.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=o.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,a)=>{const i=e.toUR(),u=e.getRequestId(),d=c.stringify(u),l={requestId:d,payload:{type:i.type,cbor:i.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:l}}),this.once(d+"-signed",(e=>{const r=o.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(d+"-canceled",(()=>{this.resetState(),a(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(e+"-signed",t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(t+"-canceled")}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},l.instance)return l.instance;this.memStore=new i.ObservableStore({sync:{reading:!1},sign:{},_version:1}),l.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new l,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=void 0,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const r=0===t.type?o.DataType.transaction:o.DataType.typedTransaction;let n;n=0===t.type?d.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),a=t.common.chainId(),i=c.v4(),l=o.EthSignRequest.constructETHRequest(n,r,s,this.xfp,i,a,e),{r:h,s:p,v:f}=await this.requestSignature(i,l,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),m=t.toJSON();return m.v=f,m.s=p,m.r=h,m.type=t.type,u.TransactionFactory.fromTxData(m,{common:t.common})}}h.type=s.BaseKeyring.type,r.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.production.min.js"}],[5,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA=r.SINGLE_CALL_BALANCES_ADDRESS_POLYGON=r.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM=r.SINGLE_CALL_BALANCES_ADDRESS_GOERLI=r.SINGLE_CALL_BALANCES_ADDRESS_FANTOM=r.SINGLE_CALL_BALANCES_ADDRESS_BSC=r.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE=r.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39";r.SINGLE_CALL_BALANCES_ADDRESS_GOERLI="0x9788C4E93f9002a7ad8e72633b11E8d1ecd51f9b";r.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA="";r.SINGLE_CALL_BALANCES_ADDRESS_BSC="0x2352c63A83f9Fd126af8676146721Fa00924d7e4";r.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM="0xB1c568e9C3E6bdaf755A60c7418C269eb11524FC";r.SINGLE_CALL_BALANCES_ADDRESS_POLYGON="0x2352c63A83f9Fd126af8676146721Fa00924d7e4";r.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE="0xD023D153a0DFa485130ECFdE2FAA7e612EF94818";r.SINGLE_CALL_BALANCES_ADDRESS_FANTOM="0x07f697424ABe762bB808c109860c04eA488ff92B";r.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM="0x151E24A486D7258dd7C33Fb67E4bB01919B7B32c"}}},{package:"$root$",file:"app/scripts/constants/contracts.ts"}],[50,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){t.tabId=e.tabId,n()}}}}},{package:"$root$",file:"app/scripts/lib/createTabIdMiddleware.js"}],[500,{"./ObservableStore":502},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ComposedStore=void 0;const n=e("./ObservableStore");class s extends n.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const r=t=>{const r=this.getState();r[e]=t,this.putState(r)};t.subscribe(r),r(t.getState())}}r.ComposedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ComposedStore.js"}],[501,{"./ObservableStore":502},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MergedStore=void 0;const n=e("./ObservableStore");class s extends n.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}r.MergedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/MergedStore.js"}],[502,{"@metamask/safe-event-emitter":1162},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ObservableStore=void 0;const s=n(e("@metamask/safe-event-emitter"));class a extends s.default{constructor(e){super(),this._state=e||{}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}r.ObservableStore=a}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ObservableStore.js"}],[503,{stream:1771},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeAsStream=void 0;const n=e("stream");class s extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}r.storeAsStream=function(e){return new s(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/asStream.js"}],[504,{"./ComposedStore":500,"./MergedStore":501,"./ObservableStore":502,"./asStream":503,"./transform":505},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./asStream"),r),s(e("./ComposedStore"),r),s(e("./MergedStore"),r),s(e("./ObservableStore"),r),s(e("./transform"),r)}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/index.js"}],[505,{through2:506},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeTransformStream=void 0;const n=e("through2");r.storeTransformStream=function(e){return n.obj(((t,r,n)=>{try{return n(null,e(t)),undefined}catch(e){return n(e),undefined}}))}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/transform.js"}],[506,{_process:2826,"readable-stream":2990,util:1774,xtend:3191},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,s=e("util").inherits,a=e("xtend");function i(e){n.call(this,e),this._destroyed=!1}function o(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=o),"function"!=typeof n&&(n=null),e(t,r,n)}}s(i,n),i.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new i(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=a(e,t),i.call(this,this.options)}return s(n,i),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new i(a({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/through2/through2.js"}],[51,{"../../../shared/constants/app":3203,"../../../shared/constants/metametrics":3208,"../../../shared/modules/hexstring-utils":3234,"../../../shared/modules/random-id":3238,"../metamask-controller":88,"./util":87,"@metamask/obs-store":1139,buffer:1768,"eth-rpc-errors":1994,"ethereumjs-util":2038,events:1769,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=f(e("events")),s=e("@metamask/obs-store"),a=e("ethereumjs-util"),i=e("eth-rpc-errors"),o=f(e("loglevel")),c=e("../../../shared/constants/app"),u=e("../../../shared/constants/metametrics"),d=e("../metamask-controller"),l=f(e("../../../shared/modules/random-id")),h=e("../../../shared/modules/hexstring-utils"),p=e("./util");function f(e){return e&&e.__esModule?e:{default:e}}const m=/^[0-9A-Fa-f]+$/gu;class g extends n.default{constructor(e){super(),this.memStore=new s.ObservableStore({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}),this.resetState=()=>{this.memStore.updateState({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0})},this.messages=[],this.metricsEvent=e.metricsEvent}get unapprovedDecryptMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{if(!e.from)return void n(new Error("MetaMask Decryption: from field is required."));const s=this.addUnapprovedMessage(e,t);this.once(`${s}:finished`,(t=>{switch(t.status){case"decrypted":return void r(t.rawData);case"rejected":return void n(i.ethErrors.provider.userRejectedRequest("MetaMask Decryption: User denied message decryption."));case"errored":return void n(new Error("This message cannot be decrypted"));default:n(new Error(`MetaMask Decryption: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){o.default.debug(`DecryptMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`),t&&(e.origin=t.origin),e.data=this.normalizeMsgData(e.data);const r=(new Date).getTime(),n=(0,l.default)(),s={id:n,msgParams:e,time:r,status:"unapproved",type:c.MESSAGE_TYPE.ETH_DECRYPT};return this.addMsg(s),this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForDecryption(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusDecrypted(e,t){const r=this.getMsg(e);r.rawData=t,this._updateMsg(r),this._setMsgStatus(e,"decrypted")}async prepMsgForDecryption(e){return delete e.metamaskId,e}rejectMsg(e,t=undefined){t&&this.metricsEvent({event:t,category:u.EVENT.CATEGORIES.MESSAGES,properties:{action:"Decrypt Message Request"}}),this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`DecryptMessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"decrypted"!==t&&"errored"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedDecryptMsgs:e,unapprovedDecryptMsgCount:t}),this.emit(d.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}normalizeMsgData(e){try{const t=(0,h.stripHexPrefix)(e);if(t.match(m))return(0,p.addHexPrefix)(t)}catch(e){o.default.debug("Message was not hex encoded, interpreting as utf8.")}return(0,a.bufferToHex)(t.from(e,"utf8"))}}r.default=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/lib/decrypt-message-manager.js"}],[52,{"../../../shared/constants/app":3203,"../../../shared/constants/metametrics":3208,"../../../shared/modules/random-id":3238,"../metamask-controller":88,"@metamask/obs-store":1139,"eth-rpc-errors":1994,events:1769,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("events")),s=e("@metamask/obs-store"),a=e("eth-rpc-errors"),i=l(e("loglevel")),o=e("../../../shared/constants/app"),c=e("../../../shared/constants/metametrics"),u=e("../metamask-controller"),d=l(e("../../../shared/modules/random-id"));function l(e){return e&&e.__esModule?e:{default:e}}class h extends n.default{constructor(e){super(),this.memStore=new s.ObservableStore({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}),this.resetState=()=>{this.memStore.updateState({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0})},this.messages=[],this.metricsEvent=e.metricsEvent}get unapprovedEncryptionPublicKeyMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{if(!e)return void n(new Error("MetaMask Message: address field is required."));const s=this.addUnapprovedMessage(e,t);this.once(`${s}:finished`,(t=>{switch(t.status){case"received":return void r(t.rawData);case"rejected":return void n(a.ethErrors.provider.userRejectedRequest("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:n(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){i.default.debug("EncryptionPublicKeyManager addUnapprovedMessage: address");const r=(new Date).getTime(),n=(0,d.default)(),s={id:n,msgParams:e,time:r,status:"unapproved",type:o.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY};return t&&(s.origin=t.origin),this.addMsg(s),this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForEncryptionPublicKey(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusReceived(e,t){const r=this.getMsg(e);r.rawData=t,this._updateMsg(r),this._setMsgStatus(e,"received")}async prepMsgForEncryptionPublicKey(e){return delete e.metamaskId,e}rejectMsg(e,t=undefined){t&&this.metricsEvent({event:t,category:c.EVENT.CATEGORIES.MESSAGES,properties:{action:"Encryption public key Request"}}),this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`EncryptionPublicKeyManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"received"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedEncryptionPublicKeyMsgs:e,unapprovedEncryptionPublicKeyMsgCount:t}),this.emit(u.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}r.default=h}}},{package:"$root$",file:"app/scripts/lib/encryption-public-key-manager.js"}],[53,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}];r.default=n}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/registry.js"}],[54,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}];r.default=n}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[55,{"./contracts/registry":53,"./contracts/resolver":54,"@ensdomains/content-hash":233,"eth-ens-namehash":1948,"ethjs-contract":2069,"ethjs-query":2073},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=async function({provider:e,name:t}){const r=new s.default(e),u=n.default.hash(t),l=new a.default(r),h=Number.parseInt(await r.net_version(),10),p=function(e){switch(e){case 1:case 3:case 4:case 5:case 6:return"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";default:return null}}(h);if(!p)throw new Error(`EnsIpfsResolver - no known ens-ipfs registry for chainId "${h}"`);const f=l(o.default).at(p),m=(await f.resolver(u))[0];if(d(m))throw new Error(`EnsIpfsResolver - no resolver found for name "${t}"`);const g=l(c.default).at(m),y=await g.supportsInterface("0xbc1c58d1"),E=await g.supportsInterface("0xd8389dc5");if(y[0]){const e=(await g.contenthash(u))[0];let t=i.default.decode(e);const r=i.default.getCodec(e);return"ipfs-ns"!==r&&"ipns-ns"!==r||(t=i.default.helpers.cidV0ToV1Base32(t)),{type:r,hash:t}}if(E[0]){const e=(await g.content(u))[0];if(d(e))throw new Error(`EnsIpfsResolver - no content ID found for name "${t}"`);return{type:"swarm-ns",hash:e.slice(2)}}throw new Error(`EnsIpfsResolver - the resolver for name "${t}" is not standard, it should either supports contenthash() or content()`)};var n=u(e("eth-ens-namehash")),s=u(e("ethjs-query")),a=u(e("ethjs-contract")),i=u(e("@ensdomains/content-hash")),o=u(e("./contracts/registry")),c=u(e("./contracts/resolver"));function u(e){return e&&e.__esModule?e:{default:e}}function d(e){return[undefined,null,"0x","0x0","0x0000000000000000000000000000000000000000000000000000000000000000"].includes(e)}}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/resolver.js"}],[56,{"../../../../shared/modules/fetch-with-timeout":3232,"./resolver":55,"base32-encode":1675,"base64-js":1676,"webextension-polyfill":3187},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({provider:e,getCurrentChainId:t,getIpfsGateway:r}){const i=d.map((e=>`*://*.${e}/*`));return a.default.webRequest.onErrorOccurred.addListener(c,{urls:i,types:["main_frame"]}),{remove(){a.default.webRequest.onErrorOccurred.removeListener(c)}};async function c(i){const{tabId:c,url:l}=i;if(-1===c||"0x1"!==t())return;const{hostname:h,pathname:p,search:f,hash:m}=new URL(l),g=h.split("."),y=g[g.length-1];d.includes(y)&&async function({tabId:t,name:i,pathname:c,search:d,fragment:l}){const h=r();a.default.tabs.update(t,{url:"loading.html"});let p=`https://app.ens.domains/name/${i}`;try{const{type:r,hash:f}=await(0,o.default)({provider:e,name:i});if("ipfs-ns"===r||"ipns-ns"===r){const e=`https://${f}.${r.slice(0,4)}.${h}${c}${d||""}${l||""}`;try{200===(await u(e,{method:"HEAD"})).status&&(p=e)}catch(e){console.warn(e)}}else if("swarm-ns"===r)p=`https://swarm-gateways.net/bzz:/${f}${c}${d||""}${l||""}`;else if("onion"===r||"onion3"===r)p=`http://${f}.onion${c}${d||""}${l||""}`;else if("zeronet"===r)p=`http://127.0.0.1:43110/${f}${c}${d||""}${l||""}`;else if("skynet-ns"===r){const e=f.padEnd(f.length+4-f.length%4,"="),t=s.default.toByteArray(e),r={padding:!1};p=`https://${(0,n.default)(t,"RFC4648-HEX",r).toLowerCase()}.siasky.net${c}${d||""}${l||""}`}}catch(e){console.warn(e)}finally{a.default.tabs.update(t,{url:p})}}({tabId:c,name:h,pathname:p,search:f,fragment:m})}};var n=c(e("base32-encode")),s=c(e("base64-js")),a=c(e("webextension-polyfill")),i=c(e("../../../../shared/modules/fetch-with-timeout")),o=c(e("./resolver"));function c(e){return e&&e.__esModule?e:{default:e}}const u=(0,i.default)(),d=["eth"]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/setup.js"}],[59,{lodash:2731},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return s((0,n.cloneDeep)(e),(e=>null===e?"null":typeof e))};var n=e("lodash");function s(e={},t){return Object.entries(e).forEach((([r,n])=>{e[r]="object"==typeof n&&null!==n?s(n,t):t(n)})),e}}}},{package:"$root$",file:"app/scripts/lib/getObjStructure.js"}],[60,{"../../../shared/modules/browser-runtime.utils":3227,"@sentry/browser":1228,loglevel:2743,"webextension-polyfill":3187},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("webextension-polyfill")),s=o(e("loglevel")),a=e("@sentry/browser"),i=e("../../../shared/modules/browser-runtime.utils");function o(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(){this.isSupported=Boolean(n.default.storage.local),this.isSupported||s.default.error("Storage local API not available."),this.dataPersistenceFailing=!1}setMetadata(e){this.metadata=e}async set(e){if(!this.isSupported)throw new Error("Metamask- cannot persist state to local store as this browser does not support this action");if(!e)throw new Error("MetaMask - updated state is missing");if(!this.metadata)throw new Error('MetaMask - metadata must be set on instance of ExtensionStore before calling "set"');try{await this._set({data:e,meta:this.metadata}),this.dataPersistenceFailing&&(this.dataPersistenceFailing=!1)}catch(e){this.dataPersistenceFailing||(this.dataPersistenceFailing=!0,(0,a.captureException)(e)),s.default.error("error setting state in local store:",e)}}async get(){if(!this.isSupported)return undefined;const e=await this._get();return t=e,0===Object.keys(t).length?undefined:e;var t}_get(){const{local:e}=n.default.storage;return new Promise(((t,r)=>{e.get(null).then((e=>{const n=(0,i.checkForLastError)();n?r(n):t(e)}))}))}_set(e){const{local:t}=n.default.storage;return new Promise(((r,n)=>{t.set(e).then((()=>{const e=(0,i.checkForLastError)();e?n(e):r()}))}))}}}}},{package:"$root$",file:"app/scripts/lib/local-store.js"}],[61,{"../../../shared/constants/app":3203,"../../../shared/constants/metametrics":3208,"../../../shared/modules/random-id":3238,"../metamask-controller":88,"@metamask/obs-store":1139,buffer:1768,"eth-rpc-errors":1994,"ethereumjs-util":2038,events:1769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.normalizeMsgData=p;var n=l(e("events")),s=e("@metamask/obs-store"),a=e("ethereumjs-util"),i=e("eth-rpc-errors"),o=e("../../../shared/constants/app"),c=e("../metamask-controller"),u=l(e("../../../shared/modules/random-id")),d=e("../../../shared/constants/metametrics");function l(e){return e&&e.__esModule?e:{default:e}}class h extends n.default{constructor({metricsEvent:e,securityProviderRequest:t}){super(),this.memStore=new s.ObservableStore({unapprovedMsgs:{},unapprovedMsgCount:0}),this.resetState=()=>{this.memStore.updateState({unapprovedMsgs:{},unapprovedMsgCount:0})},this.messages=[],this.metricsEvent=e,this.securityProviderRequest=t}get unapprovedMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}async addUnapprovedMessageAsync(e,t){const r=await this.addUnapprovedMessage(e,t);return await new Promise(((t,n)=>{this.once(`${r}:finished`,(r=>{switch(r.status){case"signed":return t(r.rawSig);case"rejected":return n(i.ethErrors.provider.userRejectedRequest("MetaMask Message Signature: User denied message signature."));case"errored":return n(new Error(`MetaMask Message Signature: ${r.error}`));default:return n(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}async addUnapprovedMessage(e,t){t&&(e.origin=t.origin),e.data=p(e.data);const r=(new Date).getTime(),n=(0,u.default)(),s={id:n,msgParams:e,time:r,status:"unapproved",type:o.MESSAGE_TYPE.ETH_SIGN};this.addMsg(s);const a=await this.securityProviderRequest(s,s.type);return s.securityProviderResponse=a,this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){const r=this.getMsg(e);r.rawSig=t,this._updateMsg(r),this._setMsgStatus(e,"signed")}async prepMsgForSigning(e){return delete e.metamaskId,e}rejectMsg(e,t=undefined){if(t){const r=this.getMsg(e);this.metricsEvent({event:t,category:d.EVENT.CATEGORIES.TRANSACTIONS,properties:{action:"Sign Request",type:r.type}})}this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`MessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"signed"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedMsgs:e,unapprovedMsgCount:t}),this.emit(c.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}function p(e){return"0x"===e.slice(0,2)?e:(0,a.bufferToHex)(t.from(e,"utf8"))}r.default=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/lib/message-manager.js"}],[63,{"../util":87,"json-rpc-engine":2523},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createPendingNonceMiddleware=function({getPendingNonce:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:s,params:a}=t;if("eth_getTransactionCount"!==s)return void n();const[i,o]=a;"pending"===o?r.result=await e(i):n()}))},r.createPendingTxMiddleware=function({getPendingTransactionByHash:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:a,params:i}=t;if("eth_getTransactionByHash"!==a)return void n();const[o]=i,c=e(o);c?r.result=(0,s.formatTxMetaForRpcResult)(c):n()}))};var n=e("json-rpc-engine"),s=e("../util")}}},{package:"$root$",file:"app/scripts/lib/middleware/pending.js"}],[64,{events:1769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("events"))&&n.__esModule?n:{default:n};class a extends s.default{constructor(e={}){super();const t=e.migrations||[];this.migrations=t.sort(((e,t)=>e.version-t.version));const r=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||r&&r.version||0}async migrateData(e=this.generateInitialState()){const t=this.migrations.filter((function(t){return t.version>e.meta.version}));for(const r of t)try{const t=await r.migrate(e);if(!t.data)throw new Error("Migrator - migration returned empty data");if(t.version!==undefined&&t.meta.version!==r.version)throw new Error("Migrator - Migration did not update version number correctly");e=t}catch(t){const n=t.message;return t.message=`MetaMask Migration Error #${r.version}: ${n}`,this.emit("error",t),e}return e}generateInitialState(e){return{meta:{version:this.defaultVersion},data:e}}}r.default=a}}},{package:"$root$",file:"app/scripts/lib/migrator/index.js"}],[65,{"../../../shared/modules/fetch-with-timeout":3232,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("loglevel"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const i=(0,s(e("../../../shared/modules/fetch-with-timeout")).default)();r.default=class{constructor(){a(this,"isSupported",!0),this._initialized=!1,this._initializing=this._init(),this._state=undefined}async _init(){try{const e=await i("http://localhost:12345/state.json");e.ok&&(this._state=await e.json())}catch(e){n.default.debug(`Error loading network state: '${e.message}'`)}finally{this._initialized=!0}}async get(){return this._initialized||await this._initializing,this._state}setMetadata(e){this.metadata=e}async set(e){if(!this.isSupported)throw new Error("Metamask- cannot persist state to local store as this browser does not support this action");if(!e)throw new Error("MetaMask - updated state is missing");if(!this.metadata)throw new Error('MetaMask - metadata must be set on instance of ExtensionStore before calling "set"');this._initialized||await this._initializing,this._state={data:e,meta:this._metadata}}}}}},{package:"$root$",file:"app/scripts/lib/network-store.js"}],[66,{"../platforms/extension":168,"safe-event-emitter":3009},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.NOTIFICATION_MANAGER_EVENTS=void 0;var n=a(e("safe-event-emitter")),s=a(e("../platforms/extension"));function a(e){return e&&e.__esModule?e:{default:e}}const i={POPUP_CLOSED:"onPopupClosed"};r.NOTIFICATION_MANAGER_EVENTS=i;class o extends n.default{constructor(){super(),this.platform=new s.default,this.platform.addOnRemovedListener(this._onWindowClosed.bind(this))}markAsAutomaticallyClosed(){this._popupAutomaticallyClosed=!0}async showPopup(){const e=await this._getPopup();if(e)await this.platform.focusWindow(e.id);else{let e=0,t=0;try{const r=await this.platform.getLastFocusedWindow();t=r.top,e=r.left+(r.width-360)}catch(r){const{screenX:n,screenY:s,outerWidth:a}=window;t=Math.max(s,0),e=Math.max(n+(a-360),0)}const r=await this.platform.openWindow({url:"notification.html",type:"popup",width:360,height:620,left:e,top:t});r.left!==e&&"fullscreen"!==r.state&&await this.platform.updateWindowPosition(r.id,e,t),this._popupId=r.id}}_onWindowClosed(e){e===this._popupId&&(this._popupId=undefined,this.emit(i.POPUP_CLOSED,{automaticallyClosed:this._popupAutomaticallyClosed}),this._popupAutomaticallyClosed=undefined)}async _getPopup(){const e=await this.platform.getAllWindows();return this._getPopupIn(e)}_getPopupIn(e){return e?e.find((e=>e&&"popup"===e.type&&e.id===this._popupId)):null}}r.default=o}}},{package:"$root$",file:"app/scripts/lib/notification-manager.js"}],[67,{"../../../shared/constants/app":3203,"../../../shared/constants/metametrics":3208,"../../../shared/modules/hexstring-utils":3234,"../../../shared/modules/random-id":3238,"../../../shared/modules/siwe":3240,"../metamask-controller":88,"./util":87,"@metamask/obs-store":1139,buffer:1768,"eth-rpc-errors":1994,"ethereumjs-util":2038,events:1769,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=m(e("events")),s=e("@metamask/obs-store"),a=e("ethereumjs-util"),i=e("eth-rpc-errors"),o=m(e("loglevel")),c=e("../../../shared/constants/app"),u=e("../metamask-controller"),d=m(e("../../../shared/modules/random-id")),l=e("../../../shared/constants/metametrics"),h=e("../../../shared/modules/siwe"),p=e("../../../shared/modules/hexstring-utils"),f=e("./util");function m(e){return e&&e.__esModule?e:{default:e}}const g=/^[0-9A-Fa-f]+$/gu;class y extends n.default{constructor({metricsEvent:e,securityProviderRequest:t}){super(),this.memStore=new s.ObservableStore({unapprovedPersonalMsgs:{},unapprovedPersonalMsgCount:0}),this.resetState=()=>{this.memStore.updateState({unapprovedPersonalMsgs:{},unapprovedPersonalMsgCount:0})},this.messages=[],this.metricsEvent=e,this.securityProviderRequest=t}get unapprovedPersonalMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{e.from?this.addUnapprovedMessage(e,t).then((t=>{this.once(`${t}:finished`,(t=>{switch(t.status){case"signed":return void r(t.rawSig);case"rejected":return void n(i.ethErrors.provider.userRejectedRequest("MetaMask Message Signature: User denied message signature."));case"errored":return void n(new Error(`MetaMask Message Signature: ${t.error}`));default:n(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))})):n(new Error("MetaMask Message Signature: from field is required."))}))}async addUnapprovedMessage(e,t){o.default.debug(`PersonalMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`),t&&(e.origin=t.origin),e.data=this.normalizeMsgData(e.data);const r=(0,h.detectSIWE)(e);e.siwe=r;const n=(new Date).getTime(),s=(0,d.default)(),a={id:s,msgParams:e,time:n,status:"unapproved",type:c.MESSAGE_TYPE.PERSONAL_SIGN};this.addMsg(a);const i=await this.securityProviderRequest(a,a.type);return a.securityProviderResponse=i,this.emit("update"),s}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){const r=this.getMsg(e);r.rawSig=t,this._updateMsg(r),this._setMsgStatus(e,"signed")}async prepMsgForSigning(e){return delete e.metamaskId,e}rejectMsg(e,t=undefined){if(t){const r=this.getMsg(e);this.metricsEvent({event:t,category:l.EVENT.CATEGORIES.TRANSACTIONS,properties:{action:"Sign Request",type:r.type}})}this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`PersonalMessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"signed"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedPersonalMsgs:e,unapprovedPersonalMsgCount:t}),this.emit(u.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}normalizeMsgData(e){try{const t=(0,p.stripHexPrefix)(e);if(t.match(g))return(0,f.addHexPrefix)(t)}catch(e){o.default.debug("Message was not hex encoded, interpreting as utf8.")}return(0,a.bufferToHex)(t.from(e,"utf8"))}}r.default=y}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/lib/personal-message-manager.js"}],[68,{"../../../../shared/constants/network":3209,"./handlers":72,"@metamask/permission-controller":1146,"@metamask/rpc-methods/dist/utils":1161,"eth-rpc-errors":1994,lodash:2731},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createMethodMiddleware=function(e){const t=l.filter((t=>!Object.hasOwnProperty.call(e,t)));if(t.length>0)throw new Error(`Missing expected hooks:\n\n${t.join("\n")}\n`);return async function(t,r,n,s){if(c.UNSUPPORTED_RPC_METHODS.has(t.method))return s(i.ethErrors.rpc.methodNotSupported());const o=d.get(t.method);if(o){const{implementation:i,hookNames:c}=o;try{return await i(t,r,n,s,(0,a.selectHooks)(e,c))}catch(e){return console.error(e),s(e)}}return n()}};var n,s=e("@metamask/permission-controller"),a=e("@metamask/rpc-methods/dist/utils"),i=e("eth-rpc-errors"),o=e("lodash"),c=e("../../../../shared/constants/network");const u=[...((n=e("./handlers"))&&n.__esModule?n:{default:n}).default,...s.permissionRpcMethods.handlers],d=u.reduce(((e,t)=>{for(const r of t.methodNames)e.set(r,t);return e}),new Map),l=Array.from(new Set((0,o.flatten)(u.map((({hookNames:e})=>Object.keys(e))))).values())}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createMethodMiddleware.js"}],[69,{"../../../../../shared/constants/app":3203,"../../../../../shared/constants/metametrics":3208,"../../../../../shared/modules/network.utils":3236,"../../../../../shared/modules/rpc.utils":3239,"eth-rpc-errors":1994,lodash:2731,"valid-url":3168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=e("eth-rpc-errors"),a=(n=e("valid-url"))&&n.__esModule?n:{default:n},i=e("lodash"),o=e("../../../../../shared/constants/app"),c=e("../../../../../shared/constants/metametrics"),u=e("../../../../../shared/modules/network.utils"),d=e("../../../../../shared/modules/rpc.utils");var l={methodNames:[o.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,r,n,{addCustomRpc:l,getCurrentChainId:h,getCurrentRpcUrl:p,findCustomRpcBy:f,updateRpcTarget:m,requestUserApproval:g,sendMetrics:y}){var E;if(null===(E=e.params)||void 0===E||!E[0]||"object"!=typeof e.params[0])return n(s.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:b}=e,{chainId:T,chainName:_=null,blockExplorerUrls:v=null,nativeCurrency:w=null,rpcUrls:S}=e.params[0],k=Object.keys((0,i.omit)(e.params[0],["chainId","chainName","blockExplorerUrls","iconUrls","rpcUrls","nativeCurrency"]));if(k.length>0)return n(s.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${k}`}));const A=e=>{try{const t=new URL(e);return"localhost"===t.hostname||"127.0.0.1"===t.hostname}catch(e){return!1}},P=Array.isArray(S)?S.find((e=>A(e)||a.default.isHttpsUri(e))):null,x=null!==v&&Array.isArray(v)?v.find((e=>A(e)||a.default.isHttpsUri(e))):null;if(!P)return n(s.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${S}`}));if(null!==v&&!x)return n(s.ethErrors.rpc.invalidParams({message:`Expected null or array with at least one valid string HTTPS URL 'blockExplorerUrl'. Received: ${v}`}));const M="string"==typeof T&&T.toLowerCase();if(!(0,u.isPrefixedFormattedHexString)(M))return n(s.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${T}`}));if(!(0,u.isSafeChainId)(parseInt(M,16)))return n(s.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${M}": numerical value greater than max safe value. Received:\n${T}`}));const R=f({chainId:M});if(R&&R.rpcUrl===P){t.result=null;const e=h(),r=p();if(e===M&&r===P)return n();try{await m(await g({origin:b,type:o.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,requestData:{rpcUrl:R.rpcUrl,chainId:R.chainId,nickname:R.nickname,ticker:R.ticker}})),t.result=null}catch(e){if(e.code!==s.errorCodes.provider.userRejectedRequest)return n(e)}return n()}let I;try{I=await(0,d.jsonRpcRequest)(P,"eth_chainId")}catch(e){return n(s.ethErrors.rpc.internal({message:`Request for method 'eth_chainId on ${P} failed`,data:{networkErr:e}}))}if(M!==I)return n(s.ethErrors.rpc.invalidParams({message:`Chain ID returned by RPC URL ${P} does not match ${M}`,data:{chainId:I}}));if("string"!=typeof _||!_)return n(s.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${_}`}));const O=_.length>100?_.substring(0,100):_;if(null!==w){if("object"!=typeof w||Array.isArray(w))return n(s.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${w}`}));if(18!==w.decimals)return n(s.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${w.decimals}`}));if(!w.symbol||"string"!=typeof w.symbol)return n(s.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${w.symbol}`}))}const C=(null==w?void 0:w.symbol)||o.UNKNOWN_TICKER_SYMBOL;if(C!==o.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof C||C.length<2||C.length>6))return n(s.ethErrors.rpc.invalidParams({message:`Expected 2-6 character string 'nativeCurrency.symbol'. Received:\n${C}`}));if(R&&R.chainId===M&&R.ticker!==C)return n(s.ethErrors.rpc.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${C}`}));try{await l(await g({origin:b,type:o.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN,requestData:{chainId:M,blockExplorerUrl:x,chainName:O,rpcUrl:P,ticker:C}})),y({event:"Custom Network Added",category:c.EVENT.CATEGORIES.NETWORK,referrer:{url:b},properties:{chain_id:M,symbol:C,source:c.EVENT.SOURCE.TRANSACTION.DAPP}}),t.result=null}catch(e){return n(e)}try{await m(await g({origin:b,type:o.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,requestData:{rpcUrl:P,chainId:M,nickname:O,ticker:C}}))}catch(e){if(e.code!==s.errorCodes.provider.userRejectedRequest)return n(e)}return n()},hookNames:{addCustomRpc:!0,getCurrentChainId:!0,getCurrentRpcUrl:!0,findCustomRpcBy:!0,updateRpcTarget:!0,requestUserApproval:!0,sendMetrics:!0}};r.default=l}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/add-ethereum-chain.js"}],[7,{"../../../shared/constants/alerts":3202,"@metamask/obs-store":1139},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store"),s=e("../../../shared/constants/alerts");const a={alertEnabledness:s.TOGGLEABLE_ALERT_TYPES.reduce(((e,t)=>(e[t]=!0,e)),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}};r.default=class{constructor(e={}){const{initState:t={},preferencesStore:r}=e,s={...a,alertEnabledness:{...a.alertEnabledness,...t.alertEnabledness}};this.store=new n.ObservableStore(s),this.selectedAddress=r.getState().selectedAddress,r.subscribe((({selectedAddress:e})=>{this.store.getState().unconnectedAccountAlertShownOrigins&&this.selectedAddress!==e&&(this.selectedAddress=e,this.store.updateState({unconnectedAccountAlertShownOrigins:{}}))}))}setAlertEnabledness(e,t){let{alertEnabledness:r}=this.store.getState();r={...r},r[e]=t,this.store.updateState({alertEnabledness:r})}setUnconnectedAccountAlertShown(e){let{unconnectedAccountAlertShownOrigins:t}=this.store.getState();t={...t},t[e]=!0,this.store.updateState({unconnectedAccountAlertShownOrigins:t})}getWeb3ShimUsageState(e){return this.store.getState().web3ShimUsageOrigins[e]}setWeb3ShimUsageRecorded(e){this._setWeb3ShimUsageState(e,s.Web3ShimUsageAlertStates.recorded)}setWeb3ShimUsageAlertDismissed(e){this._setWeb3ShimUsageState(e,s.Web3ShimUsageAlertStates.dismissed)}_setWeb3ShimUsageState(e,t){let{web3ShimUsageOrigins:r}=this.store.getState();r={...r},r[e]=t,this.store.updateState({web3ShimUsageOrigins:r})}}}}},{package:"$root$",file:"app/scripts/controllers/alert.js"}],[70,{"../../../../../shared/constants/app":3203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,r,n,{getAccounts:s}){return t.result=await s(),n()},hookNames:{getAccounts:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/eth-accounts.js"}],[71,{"../../../../../shared/constants/app":3203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,r,n,{getProviderState:s}){return t.result={...await s(e.origin)},n()},hookNames:{getProviderState:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/get-provider-state.js"}],[72,{"./add-ethereum-chain":69,"./eth-accounts":70,"./get-provider-state":71,"./log-web3-shim-usage":73,"./request-accounts":74,"./send-metadata":75,"./switch-ethereum-chain":76,"./watch-asset":77},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("./add-ethereum-chain")),s=l(e("./eth-accounts")),a=l(e("./get-provider-state")),i=l(e("./log-web3-shim-usage")),o=l(e("./request-accounts")),c=l(e("./send-metadata")),u=l(e("./switch-ethereum-chain")),d=l(e("./watch-asset"));function l(e){return e&&e.__esModule?e:{default:e}}var h=[n.default,s.default,a.default,i.default,o.default,c.default,u.default,d.default];r.default=h}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/index.js"}],[73,{"../../../../../shared/constants/app":3203,"../../../../../shared/constants/metametrics":3208},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("../../../../../shared/constants/app"),s=e("../../../../../shared/constants/metametrics");var a={methodNames:[n.MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,r,n,{sendMetrics:a,getWeb3ShimUsageState:i,setWeb3ShimUsageRecorded:o}){const{origin:c}=e;i(c)===undefined&&(o(c),a({event:"Website Accessed window.web3 Shim",category:s.EVENT.CATEGORIES.INPAGE_PROVIDER,referrer:{url:c}},{excludeMetaMetricsId:!0}));return t.result=!0,n()},hookNames:{sendMetrics:!0,getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};r.default=a}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/log-web3-shim-usage.js"}],[74,{"../../../../../shared/constants/app":3203,"eth-rpc-errors":1994},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app");var a={methodNames:[s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,r,a,{origin:o,getAccounts:c,getUnlockPromise:u,hasPermission:d,requestAccountsPermission:l}){if(i.has(o))return t.error=n.ethErrors.rpc.resourceUnavailable(`Already processing ${s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),a();if(d(s.MESSAGE_TYPE.ETH_ACCOUNTS)){try{i.add(o),await u(!0),t.result=await c(),a()}catch(e){a(e)}finally{i.delete(o)}return undefined}try{await l()}catch(e){return t.error=e,a()}const h=await c();h.length>0?t.result=h:t.error=n.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return a()},hookNames:{origin:!0,getAccounts:!0,getUnlockPromise:!0,hasPermission:!0,requestAccountsPermission:!0}};r.default=a;const i=new Set}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/request-accounts.js"}],[75,{"../../../../../shared/constants/app":3203,"eth-rpc-errors":1994},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors");var s={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,r,s,{addSubjectMetadata:a,subjectType:i}){const{origin:o,params:c}=e;if(!c||"object"!=typeof c||Array.isArray(c))return s(n.ethErrors.rpc.invalidParams({data:c}));{const{icon:e=null,name:t=null,...r}=c;a({...r,iconUrl:e,name:t,subjectType:i,origin:o})}return t.result=!0,s()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};r.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.js"}],[76,{"../../../../../shared/constants/app":3203,"../../../../../shared/constants/network":3209,"../../../../../shared/modules/network.utils":3236,"eth-rpc-errors":1994,lodash:2731},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("lodash"),a=e("../../../../../shared/constants/app"),i=e("../../../../../shared/constants/network"),o=e("../../../../../shared/modules/network.utils");var c={methodNames:[a.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,r,c,{getCurrentChainId:u,findCustomRpcBy:d,setProviderType:l,updateRpcTarget:h,requestUserApproval:p}){var f;if(null===(f=e.params)||void 0===f||!f[0]||"object"!=typeof e.params[0])return c(n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:m}=e,{chainId:g}=e.params[0],y=Object.keys((0,s.omit)(e.params[0],["chainId"]));if(y.length>0)return c(n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${y}`}));const E="string"==typeof g&&g.toLowerCase();if(!(0,o.isPrefixedFormattedHexString)(E))return c(n.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${g}`}));if(!(0,o.isSafeChainId)(parseInt(E,16)))return c(n.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${E}": numerical value greater than max safe value. Received:\n${g}`}));const b=function(e,t){if(e in i.CHAIN_ID_TO_TYPE_MAP)return{chainId:e,ticker:i.CURRENCY_SYMBOLS.ETH,nickname:i.NETWORK_TO_NAME_MAP[e],rpcUrl:i.CHAIN_ID_TO_RPC_URL_MAP[e],type:i.CHAIN_ID_TO_TYPE_MAP[e]};return t({chainId:e})}(E,d);if(b){if(u()===E)return t.result=null,c();try{const e=await p({origin:m,type:a.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,requestData:b});g in i.CHAIN_ID_TO_TYPE_MAP&&e.type!==i.NETWORK_TYPES.LOCALHOST&&e.type!==i.NETWORK_TYPES.LINEA_TESTNET?l(e.type):await h(e),t.result=null}catch(e){return c(e)}return c()}return c(n.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${g}". Try adding the chain using ${a.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}))},hookNames:{getCurrentChainId:!0,findCustomRpcBy:!0,setProviderType:!0,updateRpcTarget:!0,requestUserApproval:!0}};r.default=c}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[77,{"../../../../../shared/constants/app":3203,"eth-rpc-errors":1994},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app");var a={methodNames:[s.MESSAGE_TYPE.WATCH_ASSET,s.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,r,s,{handleWatchAssetRequest:a}){try{const{options:r,type:n}=e.params,i=await a(r,n);return await i.result,t.result=!0,s()}catch(e){return"User rejected to watch the asset."===e.message?s(n.ethErrors.provider.userRejectedRequest()):s(e)}},hookNames:{handleWatchAssetRequest:!0}};r.default=a}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.js"}],[78,{"./createMethodMiddleware":68},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./createMethodMiddleware");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}))}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[79,{"../../../shared/constants/app":3203},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.securityProviderCheck=async function(e,t,r,s){let a;a=t===n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA?{host_name:e.msgParams.origin,rpc_method_name:t,chain_id:r,data:e.msgParams.data,currentLocale:s}:t===n.MESSAGE_TYPE.ETH_SIGN||t===n.MESSAGE_TYPE.PERSONAL_SIGN?{host_name:e.msgParams.origin,rpc_method_name:t,chain_id:r,data:{signer_address:e.msgParams.from,msg_to_sign:e.msgParams.data},currentLocale:s}:{host_name:e.origin,rpc_method_name:t,chain_id:r,data:{from_address:e.txParams.from,to_address:e.txParams.to,gas:e.txParams.gas,gasPrice:e.txParams.gasPrice,value:e.txParams.value,data:e.txParams.data},currentLocale:s};const i=await fetch("https://eos9d7dmfj.execute-api.us-east-1.amazonaws.com/metamask/validate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-API-KEY":"NKYIN6cXkFaNnVIfzNx7s1z0p3b0B4SB6k29qA7n"},body:JSON.stringify(a)});return await i.json()};var n=e("../../../shared/constants/app")}}},{package:"$root$",file:"app/scripts/lib/security-provider-helpers.js"}],[8,{"../../../shared/constants/alarms":3201,"../../../shared/constants/app":3203,"../../../shared/constants/time":3214,"../../../shared/modules/mv3.utils":3235,"../../../ui/helpers/utils/build-types":3855,"../metamask-controller":88,"@metamask/obs-store":1139,events:1769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("events"))&&n.__esModule?n:{default:n},a=e("@metamask/obs-store"),i=e("../metamask-controller"),o=e("../../../shared/constants/time"),c=e("../../../shared/constants/alarms"),u=e("../../../shared/modules/mv3.utils"),d=e("../../../ui/helpers/utils/build-types"),l=e("../../../shared/constants/app");class h extends s.default{constructor(e={}){const{addUnlockListener:t,isUnlocked:r,initState:n,onInactiveTimeout:s,showUnlockRequest:i,preferencesStore:o,qrHardwareStore:c}=e;super(),this.onInactiveTimeout=s||(()=>undefined),this.store=new a.ObservableStore({timeoutMinutes:0,connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,browserEnvironment:{},popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[],recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),outdatedBrowserWarningLastShown:(new Date).getTime(),collectiblesDetectionNoticeDismissed:!1,showTestnetMessageInDropdown:!0,showPortfolioTooltip:!0,showBetaHeader:(0,d.isBeta)(),trezorModel:null,...n,qrHardware:{},collectiblesDropdownState:{},usedNetworks:{"0x1":!0,"0x5":!0,"0x539":!0}}),this.timer=null,this.isUnlocked=r,this.waitingForUnlock=[],t(this.handleUnlock.bind(this)),this._showUnlockRequest=i,o.subscribe((({preferences:e})=>{this.store.getState().timeoutMinutes!==e.autoLockTimeLimit&&this._setInactiveTimeout(e.autoLockTimeLimit)})),c.subscribe((e=>{this.store.updateState({qrHardware:e})}));const{preferences:u}=o.getState();this._setInactiveTimeout(u.autoLockTimeLimit)}getUnlockPromise(e){return new Promise((t=>{this.isUnlocked()?t():this.waitForUnlock(t,e)}))}waitForUnlock(e,t){this.waitingForUnlock.push({resolve:e}),this.emit(i.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE),t&&this._showUnlockRequest()}handleUnlock(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;)this.waitingForUnlock.shift().resolve();this.emit(i.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}setDefaultHomeActiveTabName(e){this.store.updateState({defaultHomeActiveTabName:e})}setConnectedStatusPopoverHasBeenShown(){this.store.updateState({connectedStatusPopoverHasBeenShown:!0})}setRecoveryPhraseReminderHasBeenShown(){this.store.updateState({recoveryPhraseReminderHasBeenShown:!0})}setRecoveryPhraseReminderLastShown(e){this.store.updateState({recoveryPhraseReminderLastShown:e})}setOutdatedBrowserWarningLastShown(e){this.store.updateState({outdatedBrowserWarningLastShown:e})}setLastActiveTime(){this._resetTimer()}_setInactiveTimeout(e){this.store.updateState({timeoutMinutes:e}),this._resetTimer()}_resetTimer(){const{timeoutMinutes:e}=this.store.getState();this.timer?clearTimeout(this.timer):u.isManifestV3&&chrome.alarms.clear(c.AUTO_LOCK_TIMEOUT_ALARM),e&&(u.isManifestV3?(chrome.alarms.create(c.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:e,periodInMinutes:e}),chrome.alarms.onAlarm.addListener((e=>{e.name===c.AUTO_LOCK_TIMEOUT_ALARM&&(this.onInactiveTimeout(),chrome.alarms.clear(c.AUTO_LOCK_TIMEOUT_ALARM))}))):this.timer=setTimeout((()=>this.onInactiveTimeout()),e*o.MINUTE))}setBrowserEnvironment(e,t){this.store.updateState({browserEnvironment:{os:e,browser:t}})}addPollingToken(e,t){if(t!==l.POLLING_TOKEN_ENVIRONMENT_TYPES[l.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.store.getState()[t];this.store.updateState({[t]:[...r,e]})}}removePollingToken(e,t){if(t!==l.POLLING_TOKEN_ENVIRONMENT_TYPES[l.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.store.getState()[t];this.store.updateState({[t]:r.filter((t=>t!==e))})}}clearPollingTokens(){this.store.updateState({popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[]})}setShowTestnetMessageInDropdown(e){this.store.updateState({showTestnetMessageInDropdown:e})}setShowPortfolioTooltip(e){this.store.updateState({showPortfolioTooltip:e})}setShowBetaHeader(e){this.store.updateState({showBetaHeader:e})}setTrezorModel(e){this.store.updateState({trezorModel:e})}updateCollectibleDropDownState(e){this.store.updateState({collectiblesDropdownState:e})}setFirstTimeUsedNetwork(e){const t=this.store.getState(),{usedNetworks:r}=t;r[e]=!0,this.store.updateState({usedNetworks:r})}}r.default=h}}},{package:"$root$",file:"app/scripts/controllers/app-state.js"}],[80,{"../../../shared/constants/hardware-wallets":3206,"@metamask/eth-keyring-controller":1033,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=e("@metamask/eth-keyring-controller"),a=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../shared/constants/hardware-wallets");var o={async verifyAccounts(e,t){if(!e||e.length<1)throw new Error("No created accounts defined.");const r=new s.KeyringController({}).getKeyringBuilderForType(i.HardwareKeyringTypes.hdKeyTree)(),n={mnemonic:t,numberOfAccounts:e.length};await r.deserialize(n);const o=await r.getAccounts();if(a.default.debug(`Created accounts: ${JSON.stringify(e)}`),a.default.debug(`Restored accounts: ${JSON.stringify(o)}`),o.length!==e.length)throw new Error("Wrong number of accounts");for(let t=0;t<o.length;t++)if(o[t].toLowerCase()!==e[t].toLowerCase())throw new Error(`Not identical accounts! Original: ${e[t]}, Restored: ${o[t]}`)}};r.default=o}}},{package:"$root$",file:"app/scripts/lib/seed-phrase-verifier.js"}],[81,{"../util":87,"@segment/loosely-validate-event":1222,buffer:1768,"is-retry-allowed":2505,lodash:2731,"remove-trailing-slash":3e3,timers:3087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=u(e("remove-trailing-slash")),a=u(e("@segment/loosely-validate-event")),i=e("lodash"),o=u(e("is-retry-allowed")),c=e("../util");function u(e){return e&&e.__esModule?e:{default:e}}const d=()=>({});r.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,s.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,a.default)(e,t)}_message(e,t,r){return this._validate(t,e),this.enqueue(e,t,r),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,r=d){if(!this.enable)return void n(r);const s={...t,type:e};if(s.context={...s.context,library:{name:"analytics-node"}},s.timestamp||(s.timestamp=new Date),s.messageId||(s.messageId=(0,c.generateRandomId)()),s.anonymousId&&!(0,i.isString)(s.anonymousId)&&(s.anonymousId=JSON.stringify(s.anonymousId)),s.userId&&!(0,i.isString)(s.userId)&&(s.userId=JSON.stringify(s.userId)),this.queue.push({message:s,callback:r}),!this.flushed)return this.flushed=!0,void this.flush();const a=this.queue.length>=this.flushAt,o=this.queue.reduce(((e,t)=>e+JSON.stringify(t).length),0)>=this.maxQueueSize;(a||o)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=d){if(!this.enable)return n(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return n(e),Promise.resolve();const r=this.queue.splice(0,this.flushAt),s=r.map((e=>e.callback)),a={batch:r.map((e=>e.message)),timestamp:new Date,sentAt:new Date},i={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(a),headers:i},(t=>{n((()=>{s.forEach((e=>e(t,a))),e(t,a)}))}),0)}_retryRequest(e,t,r,n){const s=100*Math.pow(2,n);setTimeout((()=>{this._sendRequest(e,t,r,n+1)}),s)}async _sendRequest(e,t,r,n){return fetch(e,t).then((async s=>{if(s.ok)r();else if(this._isErrorRetryable({response:s})&&n<=this.retryCount)this._retryRequest(e,t,r,n);else{const e=new Error(s.statusText);r(e)}})).catch((s=>{this._isErrorRetryable(s)&&n<=this.retryCount?this._retryRequest(e,t,r,n):r(s)}))}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,o.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[82,{"../../../../shared/constants/time":3214,"./analytics":81,_process:2826},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.segment=r.createSegmentMock=void 0;var n,s,a,i=e("../../../../shared/constants/time"),o=(n=e("./analytics"))&&n.__esModule?n:{default:n};const c=null!==(s="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP")?s:null,u=null!==(a=t.env.SEGMENT_HOST)&&void 0!==a?a:null,d=undefined,l=5*i.SECOND,h=(e=d)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(r,n=(()=>undefined)){t.queue.push([r,n]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};r.createSegmentMock=h;const p=c?new o.default(c,{host:u,flushAt:d,flushInterval:l}):h(d);r.segment=p}).call(this)}).call(this,e("_process"))}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[86,{"../../../shared/constants/app":3203,"../../../shared/constants/metametrics":3208,"../../../shared/modules/hexstring-utils":3234,"../../../shared/modules/random-id":3238,"../metamask-controller":88,"@metamask/obs-store":1139,assert:1535,"eth-rpc-errors":1994,"eth-sig-util":1996,events:1769,jsonschema:2535,loglevel:2743},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=m(e("events")),s=e("assert"),a=e("@metamask/obs-store"),i=e("eth-rpc-errors"),o=e("eth-sig-util"),c=m(e("loglevel")),u=m(e("jsonschema")),d=e("../../../shared/constants/app"),l=e("../metamask-controller"),h=m(e("../../../shared/modules/random-id")),p=e("../../../shared/constants/metametrics"),f=e("../../../shared/modules/hexstring-utils");function m(e){return e&&e.__esModule?e:{default:e}}class g extends n.default{constructor({getCurrentChainId:e,metricsEvent:t,securityProviderRequest:r}){super(),this._getCurrentChainId=e,this.memStore=new a.ObservableStore({unapprovedTypedMessages:{},unapprovedTypedMessagesCount:0}),this.resetState=()=>{this.memStore.updateState({unapprovedTypedMessages:{},unapprovedTypedMessagesCount:0})},this.messages=[],this.metricsEvent=t,this.securityProviderRequest=r}get unapprovedTypedMessagesCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}async addUnapprovedMessageAsync(e,t,r){return new Promise(((n,s)=>{this.addUnapprovedMessage(e,t,r).then((t=>{this.once(`${t}:finished`,(t=>{switch(t.status){case"signed":return n(t.rawSig);case"rejected":return s(i.ethErrors.provider.userRejectedRequest("MetaMask Message Signature: User denied message signature."));case"errored":return s(new Error(`MetaMask Message Signature: ${t.error}`));default:return s(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}))}async addUnapprovedMessage(e,t,r){e.version=r,t&&(e.origin=t.origin),this.validateParams(e),c.default.debug(`TypedMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`);const n=(new Date).getTime(),s=(0,h.default)(),a={id:s,msgParams:e,time:n,status:"unapproved",type:d.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA};this.addMsg(a);const i=await this.securityProviderRequest(a,a.type);return a.securityProviderResponse=i,this.emit("update"),s}validateParams(e){switch(s.strict.ok(e&&"object"==typeof e,"Params must be an object."),s.strict.ok("data"in e,'Params must include a "data" field.'),s.strict.ok("from"in e,'Params must include a "from" field.'),s.strict.ok("string"==typeof e.from&&(0,f.isValidHexAddress)(e.from,{allowNonPrefixed:!1}),'"from" field must be a valid, lowercase, hexadecimal Ethereum address string.'),e.version){case"V1":s.strict.ok(Array.isArray(e.data),'"params.data" must be an array.'),s.strict.doesNotThrow((()=>{(0,o.typedSignatureHash)(e.data)}),"Signing data must be valid EIP-712 typed data.");break;case"V3":case"V4":{let t;s.strict.equal(typeof e.data,"string",'"params.data" must be a string.'),s.strict.doesNotThrow((()=>{t=JSON.parse(e.data)}),'"data" must be a valid JSON string.');const r=u.default.validate(t,o.TYPED_MESSAGE_SCHEMA);if(0!==r.errors.length)throw i.ethErrors.rpc.invalidParams({message:"Signing data must conform to EIP-712 schema. See https://git.io/fNtcx.",data:r.errors.map((e=>e.message.toString()))});s.strict.ok(t.primaryType in t.types,`Primary type of "${t.primaryType}" has no type definition.`);let{chainId:n}=t.domain;if(n){const e=parseInt(this._getCurrentChainId(),16);s.strict.ok(!Number.isNaN(e),`Cannot sign messages for chainId "${n}", because MetaMask is switching networks.`),"string"==typeof n&&(n=parseInt(n,n.startsWith("0x")?16:10)),s.strict.equal(n,e,`Provided chainId "${n}" must match the active chainId "${e}"`)}break}default:s.strict.fail(`Unknown typed data version "${e.version}"`)}}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){const r=this.getMsg(e);r.rawSig=t,this._updateMsg(r),this._setMsgStatus(e,"signed")}async prepMsgForSigning(e){return delete e.metamaskId,delete e.version,e}rejectMsg(e,t=undefined){if(t){const r=this.getMsg(e);this.metricsEvent({event:t,category:p.EVENT.CATEGORIES.TRANSACTIONS,properties:{action:"Sign Request",version:r.msgParams.version,type:r.type}})}this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`TypedMessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"signed"!==t&&"errored"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedTypedMessages:e,unapprovedTypedMessagesCount:t}),this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}r.default=g}}},{package:"$root$",file:"app/scripts/lib/typed-message-manager.js"}]],[],{});