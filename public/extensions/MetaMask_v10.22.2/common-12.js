LavaPack.loadBundle([[6966,{"../../app/scripts/lib/util":225,"../../shared/constants/multichain/assets":4987,"../../shared/constants/multichain/networks":4988,"../../shared/constants/network":4989,"../../shared/modules/Numeric":5074,"../../shared/modules/selectors/networks":5096,"../../shared/modules/selectors/util":5098,"../ducks/metamask/metamask":6143,"./accounts":6950,"./multichain/networks":6967,"./selectors":6973,"@metamask/keyring-api":1560,"@metamask/network-controller":1752,"@metamask/utils":2359,"prop-types":4255,reselect:4538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainNetworkPropType=n.InternalAccountPropType=void 0,n.getImageForChainId=function(e){return{...T.CHAIN_ID_TO_NETWORK_IMAGE_URL_MAP,...u.MULTICHAIN_TOKEN_IMAGE_MAP}[e]},n.getLastSelectedNonEvmAccount=function(e){const t=(0,p.getInternalAccounts)(e).filter(e=>!(0,r.isEvmAccountType)(e.type)).sort((e,t)=>(t.metadata.lastSelected??0)-(e.metadata.lastSelected??0));return t.length>0?t[0]:undefined},n.getLastSelectedSolanaAccount=function(e){const t=(0,p.getInternalAccounts)(e).filter(e=>(0,p.isSolanaAccount)(e)).sort((e,t)=>(t.metadata.lastSelected??0)-(e.metadata.lastSelected??0));return t.length>0?t[0]:undefined},n.getMemoizedMultichainNetworkConfigurationsByChainId=void 0,n.getMultichainBalances=O,n.getMultichainCoinRates=void 0,n.getMultichainConversionRate=function(e,t){var n;const{conversionRates:a}=e.metamask,{chainId:r}=_(e,t),o=null===(n=(0,m.getConversionRatesForNativeAsset)({conversionRates:a,chainId:r}))||void 0===n?void 0:n.rate;return I(e,t)?(0,l.getConversionRate)(e):o},n.getMultichainCurrencyImage=k,n.getMultichainCurrentChainId=function(e){const{chainId:t}=N(e);return t},n.getMultichainCurrentCurrency=function(e){return(0,l.getCurrentCurrency)(e)},n.getMultichainCurrentNetwork=function(e,t){return N(e,t)},n.getMultichainDefaultToken=y,n.getMultichainIsBitcoin=function(e,t){const n=I(e,t),{symbol:a}=y(e,t);return!n&&"BTC"===a},n.getMultichainIsEvm=I,n.getMultichainIsMainnet=function(e,t){const n=t??(0,p.getSelectedInternalAccount)(e),a=N(e,n);if(I(e,t))return(0,f.getIsMainnet)(e);const r=u.MULTICHAIN_ACCOUNT_TYPE_TO_MAINNET[n.type];return a.chainId===r},n.getMultichainIsSolana=function(e,t){const n=I(e,t),{symbol:a}=y(e,t);return!n&&"SOL"===a},n.getMultichainIsTestnet=w,n.getMultichainNativeCurrency=function(e,t){return I(e,t)?(0,l.getNativeCurrency)(e):N(e,t).ticker},n.getMultichainNativeCurrencyImage=function(e,t){return k(e,t)},n.getMultichainNetwork=_,n.getMultichainNetworkConfigurationsByChainId=void 0,n.getMultichainNetworkProviders=h,n.getMultichainProviderConfig=N,n.getMultichainSelectedAccountCachedBalance=R,n.getMultichainSelectedAccountCachedBalanceIsZero=void 0,n.getMultichainShouldShowFiat=C,n.getMultichainTransactions=function(e){return e.metamask.nonEvmTransactions},n.getSelectedAccountMultichainTransactions=function(e){const t=(0,p.getSelectedInternalAccount)(e);if((0,r.isEvmAccountType)(t.type))return undefined;return e.metamask.nonEvmTransactions[t.id]},n.isChainIdMainnet=function(e){return e===T.CHAIN_IDS.MAINNET},n.makeGetMultichainShouldShowFiatByChainId=void 0;var a,r=e("@metamask/keyring-api"),o=e("@metamask/network-controller"),s=e("@metamask/utils"),i=(a=e("prop-types"))&&a.__esModule?a:{default:a},c=e("reselect"),u=e("../../shared/constants/multichain/networks"),d=e("../../shared/modules/Numeric"),l=e("../ducks/metamask/metamask"),g=e("../../shared/constants/multichain/assets"),T=e("../../shared/constants/network"),S=e("../../shared/modules/selectors/networks"),m=e("../../app/scripts/lib/util"),E=e("../../shared/modules/selectors/util"),p=e("./accounts"),f=e("./selectors"),A=e("./multichain/networks");n.MultichainNetworkPropType=i.default.shape({nickname:i.default.string.isRequired,isEvmNetwork:i.default.bool.isRequired,chainId:i.default.string,network:i.default.oneOfType([i.default.shape({rpcUrl:i.default.string,type:i.default.string.isRequired,chainId:i.default.string.isRequired,ticker:i.default.string.isRequired,rpcPrefs:i.default.shape({blockExplorerUrl:i.default.string,imageUrl:i.default.string}),nickname:i.default.string,id:i.default.string}),i.default.shape({chainId:i.default.string.isRequired,ticker:i.default.string.isRequired,rpcPrefs:i.default.shape({blockExplorerUrl:i.default.string,imageUrl:i.default.string})})]).isRequired}),n.InternalAccountPropType=i.default.shape({id:i.default.string.isRequired,address:i.default.string.isRequired,metadata:i.default.shape({name:i.default.string.isRequired,snap:i.default.shape({id:i.default.string.isRequired,name:i.default.string,enabled:i.default.bool}),keyring:i.default.shape({type:i.default.string.isRequired}).isRequired}).isRequired,type:i.default.string.isRequired});function h(e){return Object.values(u.MULTICHAIN_PROVIDER_CONFIGS)}function _(e,t){if(I(e,t)){var n;const t=(0,S.getCurrentChainId)(e),a=(0,S.getProviderConfig)(e),r=t;a.rpcPrefs={...a.rpcPrefs,imageUrl:T.CHAIN_ID_TO_NETWORK_IMAGE_URL_MAP[r]};return{nickname:(null===(n=(0,S.getNetworkConfigurationsByChainId)(e)[t])||void 0===n?void 0:n.name)??a.rpcUrl,isEvmNetwork:!0,chainId:`${s.KnownCaipNamespace.Eip155}:${Number(t)}`,network:a}}const a=t??(0,p.getSelectedInternalAccount)(e),r=h().find(e=>a.scopes.includes(e.chainId));if(!r)throw new Error("Could not find non-EVM provider for the current configuration. This should never happen.");return{nickname:r.nickname,isEvmNetwork:!1,chainId:null==r?void 0:r.chainId,network:r}}function I(e,t){const n=(0,l.getCompletedOnboarding)(e),a=t??(0,f.getMaybeSelectedInternalAccount)(e);return!n||!a||(0,r.isEvmAccountType)(a.type)}function N(e,t){return _(e,t).network}function k(e,t){var n;if(I(e,t))return(0,f.getNativeCurrencyImage)(e);return null===(n=N(e,t).rpcPrefs)||void 0===n?void 0:n.imageUrl}function C(e,t,n){const a=t??(0,p.getSelectedInternalAccount)(e),r=w(e,a),o=!r,s=(0,f.getUseCurrencyRateCheck)(e);return I(e,a)?(0,f.getShouldShowFiat)(e,n):s&&o||s&&r&&(0,f.getShowFiatInTestnets)(e)}function y(e,t){var n;return{symbol:I(e,t)?(null===(n=(0,S.getProviderConfig)(e))||void 0===n?void 0:n.ticker)??"ETH":N(e,t).ticker}}function w(e,t){const n=N(e,t??(0,p.getSelectedInternalAccount)(e));return I(e,t)?T.TEST_NETWORK_IDS.includes(n.chainId):[u.MultichainNetworks.BITCOIN_TESTNET,u.MultichainNetworks.BITCOIN_SIGNET,u.MultichainNetworks.SOLANA_DEVNET,u.MultichainNetworks.SOLANA_TESTNET].includes(n.chainId)}function O(e){return e.metamask.balances}n.makeGetMultichainShouldShowFiatByChainId=e=>(t,n)=>C(t,n,e);function R(e){return I(e)?(0,f.getSelectedAccountCachedBalance)(e):function(e,t){var n;const a=O(e),r=t??(0,p.getSelectedInternalAccount)(e),o=(0,A.getSelectedMultichainNetworkConfiguration)(e),s=null===(n=g.MULTICHAIN_NETWORK_TO_ASSET_TYPES[o.chainId])||void 0===n?void 0:n[0];s||console.warn("Could not find asset type for network:",o);const i=null==a?void 0:a[r.id];i||console.warn("Could not find balances for account:",r);const c=null==i?void 0:i[s];return c||console.warn("Could not find balance for asset:",s),(null==c?void 0:c.amount)??0}(e)}n.getMultichainCoinRates=e=>e.metamask.rates;n.getMultichainSelectedAccountCachedBalanceIsZero=(0,c.createSelector)([I,R],(e,t)=>{const n=e?16:10;return new d.Numeric(t,n).isZero()});const M=e=>({...(0,S.getNetworkConfigurationsByChainId)(e),[u.MultichainNetworks.SOLANA]:{...u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.SOLANA],blockExplorerUrls:[],name:u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.SOLANA].nickname??"",nativeCurrency:"sol",rpcEndpoints:[{url:"",type:o.RpcEndpointType.Custom,networkClientId:""}],defaultRpcEndpointIndex:0,chainId:u.MultichainNetworks.SOLANA},[u.MultichainNetworks.BITCOIN]:{...u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.BITCOIN],blockExplorerUrls:[],name:u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.BITCOIN].nickname??"",nativeCurrency:"BTC",rpcEndpoints:[{url:"",type:o.RpcEndpointType.Custom,networkClientId:""}],defaultRpcEndpointIndex:0,chainId:u.MultichainNetworks.BITCOIN},[u.MultichainNetworks.BITCOIN_TESTNET]:{...u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.BITCOIN_TESTNET],blockExplorerUrls:[],name:u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.BITCOIN_TESTNET].nickname??"",nativeCurrency:"tBTC",rpcEndpoints:[{url:"",type:o.RpcEndpointType.Custom,networkClientId:""}],defaultRpcEndpointIndex:0,chainId:u.MultichainNetworks.BITCOIN_TESTNET},[u.MultichainNetworks.BITCOIN_SIGNET]:{...u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.BITCOIN_SIGNET],blockExplorerUrls:[],name:u.MULTICHAIN_PROVIDER_CONFIGS[u.MultichainNetworks.BITCOIN_SIGNET].nickname??"",nativeCurrency:"sBTC",rpcEndpoints:[{url:"",type:o.RpcEndpointType.Custom,networkClientId:""}],defaultRpcEndpointIndex:0,chainId:u.MultichainNetworks.BITCOIN_SIGNET}});n.getMultichainNetworkConfigurationsByChainId=M;n.getMemoizedMultichainNetworkConfigurationsByChainId=(0,E.createDeepEqualSelector)([M],e=>e)}}},{package:"$root$",file:"ui/selectors/multichain.ts"}],[6967,{"../../../shared/modules/selectors/networks":5096,"../../../shared/modules/selectors/util":5098,"../accounts":6950,"../selectors":6973,"@metamask/keyring-api":1560,"@metamask/multichain-network-controller":1644,"@metamask/utils":2359},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSelectedMultichainNetworkConfiguration=n.getSelectedMultichainNetworkChainId=n.getNonEvmMultichainNetworkConfigurationsByChainId=n.getNetworksWithTransactionActivity=n.getNetworksWithActivity=n.getMultichainNetworkConfigurationsByChainId=n.getIsNonEvmNetworksEnabled=n.getIsEvmMultichainNetworkSelected=n.getEnabledNetworksByNamespace=n.getEnabledNetworkClientIds=n.getEnabledChainIds=void 0;var a=e("@metamask/multichain-network-controller"),r=e("@metamask/keyring-api"),o=e("@metamask/utils"),s=e("../../../shared/modules/selectors/networks"),i=e("../../../shared/modules/selectors/util"),c=e("../selectors"),u=e("../accounts");const d=n.getIsNonEvmNetworksEnabled=(0,i.createDeepEqualSelector)(c.getIsBitcoinSupportEnabled,c.getIsSolanaSupportEnabled,u.getInternalAccounts,(e,t,n)=>{if(e&&t)return{bitcoinEnabled:!0,solanaEnabled:!0};let a=e,o=t;for(const{scopes:e}of n)if(null!=e&&e.includes(r.BtcScope.Mainnet||r.BtcScope.Testnet||r.BtcScope.Signet)&&(a=!0),null!=e&&e.includes(r.SolScope.Mainnet)&&(o=!0),a&&o)break;return{bitcoinEnabled:a,solanaEnabled:o}}),l=n.getNonEvmMultichainNetworkConfigurationsByChainId=(0,i.createDeepEqualSelector)(e=>e.metamask.multichainNetworkConfigurationsByChainId,d,e=>(0,c.getIsSolanaTestnetSupportEnabled)(e),(e,t,n)=>{const a={},{bitcoinEnabled:o,solanaEnabled:s}=t;return o&&(a[r.BtcScope.Mainnet]=e[r.BtcScope.Mainnet],a[r.BtcScope.Testnet]=e[r.BtcScope.Testnet],a[r.BtcScope.Signet]=e[r.BtcScope.Signet]),s&&(a[r.SolScope.Mainnet]=e[r.SolScope.Mainnet]),s&&n&&(a[r.SolScope.Devnet]=e[r.SolScope.Devnet]),a}),g=n.getMultichainNetworkConfigurationsByChainId=(0,i.createDeepEqualSelector)(l,s.getNetworkConfigurationsByChainId,(e,t)=>[{...e,...Object.entries(t).reduce((e,[,t])=>({...e,[(0,a.toEvmCaipChainId)(t.chainId)]:{...(0,a.toMultichainNetworkConfiguration)(t),name:t.name||t.rpcEndpoints[t.defaultRpcEndpointIndex].url}}),{})},t]),T=e=>e.metamask.isEvmSelected;n.getIsEvmMultichainNetworkSelected=T;const S=e=>{if(T(e)){const t=(0,s.getProviderConfig)(e);return(0,a.toEvmCaipChainId)(t.chainId)}return e.metamask.selectedMultichainNetworkChainId};n.getSelectedMultichainNetworkChainId=S;n.getSelectedMultichainNetworkConfiguration=e=>{const t=S(e),[n]=g(e);return n[t]};const m=e=>e.metamask.networksWithTransactionActivity;n.getNetworksWithActivity=m;n.getNetworksWithTransactionActivity=(0,i.createDeepEqualSelector)(m,e=>e),n.getEnabledNetworksByNamespace=(0,i.createDeepEqualSelector)(c.getEnabledNetworks,S,(e,t)=>{const{namespace:n}=(0,o.parseCaipChainId)(t);return e[n]??{}}),n.getEnabledChainIds=(0,i.createDeepEqualSelector)(s.getNetworkConfigurationsByChainId,c.getEnabledNetworks,S,(e,t,n)=>{const{namespace:a}=(0,o.parseCaipChainId)(n),r=t[a]||{};return Object.keys(e).filter(e=>r[e])}),n.getEnabledNetworkClientIds=(0,i.createDeepEqualSelector)(s.getNetworkConfigurationsByChainId,c.getEnabledNetworks,S,(e,t,n)=>{const{namespace:a}=(0,o.parseCaipChainId)(n),r=t[a]||{};return Object.entries(e).reduce((e,[t,n])=>(r[t]&&e.push(n.rpcEndpoints[n.defaultRpcEndpointIndex].networkClientId),e),[])})}}},{package:"$root$",file:"ui/selectors/multichain/networks.ts"}],[6969,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.selectThrottledOrigins=void 0;n.selectThrottledOrigins=e=>e.metamask.throttledOrigins}}},{package:"$root$",file:"ui/selectors/origin-throttling.ts"}],[6970,{"../../shared/lib/manifestFlags":5054,"lodash/merge":4087,reselect:4538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRemoteFeatureFlags=void 0;var a,r=(a=e("lodash/merge"))&&a.__esModule?a:{default:a},o=e("reselect"),s=e("../../shared/lib/manifestFlags");n.getRemoteFeatureFlags=(0,o.createSelector)(()=>(0,s.getManifestFlags)().remoteFeatureFlags,e=>e.metamask.remoteFeatureFlags,(e,t)=>(0,r.default)({},t,e))}}},{package:"$root$",file:"ui/selectors/remote-feature-flags.ts"}],[6971,{"./social-sync":6972},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=e("./social-sync");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))})}}},{package:"$root$",file:"ui/selectors/seedless-onboarding/index.ts"}],[6972,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function a(e){return e.metamask.authConnection}function r(e){return e.metamask.socialLoginEmail}Object.defineProperty(n,"__esModule",{value:!0}),n.getIsSocialLoginFlowInitialized=function(e){const t=Boolean(a(e)),n=Boolean(r(e)),o=Array.isArray(e.metamask.nodeAuthTokens)&&"string"==typeof e.metamask.userId&&"string"==typeof e.metamask.accessToken&&"string"==typeof e.metamask.refreshToken;return t&&n&&o},n.getSocialLoginEmail=r,n.getSocialLoginType=a}}},{package:"$root$",file:"ui/selectors/seedless-onboarding/social-sync.ts"}],[6973,{"../../app/scripts/lib/util":225,"../../shared/constants/app":4973,"../../shared/constants/bridge":4974,"../../shared/constants/hardware-wallets":4981,"../../shared/constants/keyring":4982,"../../shared/constants/labels":4983,"../../shared/constants/multichain/assets":4987,"../../shared/constants/network":4989,"../../shared/constants/swaps":5002,"../../shared/constants/terms":5003,"../../shared/constants/time":5004,"../../shared/constants/tokens":5005,"../../shared/constants/transaction":5006,"../../shared/modules/conversion.utils":5079,"../../shared/modules/hexstring-utils":5085,"../../shared/modules/selectors/networks":5096,"../../shared/modules/selectors/util":5098,"../../shared/modules/string-utils":5099,"../../shared/modules/transaction.utils":5101,"../ducks/app/app":6128,"../ducks/metamask/metamask":6143,"../helpers/constants/design-system":6156,"../helpers/utils/snaps":6202,"../helpers/utils/util":6209,"../pages/confirmations/confirmation/templates":6597,"./accounts":6950,"./approvals":6952,"./multichain":6966,"./multichain/networks":6967,"./remote-feature-flags":6970,"./transactions":6979,"@metamask/bridge-controller":1248,"@metamask/chain-agnostic-permission":1296,"@metamask/controller-utils":1316,"@metamask/keyring-api":1560,"@metamask/keyring-controller":1567,"@metamask/name-controller":1740,"@metamask/network-controller":1752,"@metamask/permission-controller":1816,"@metamask/snaps-rpc-methods":2072,"@metamask/snaps-utils":2242,"@metamask/transaction-controller":2314,"@metamask/utils":2359,lodash:4086,"punycode/punycode.js":4316,reselect:4538,semver:4802},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.accountSupportsSmartTx=function(e){const t=ee(e);return Boolean("snap"!==t)},n.accountsWithSendEtherInfoSelector=Ce,n.activeTabHasPermissions=function(e){var t;const{activeTab:n,metamask:a}=e,{subjects:r={}}=a;return Boolean(Object.keys((null===(t=r[n.origin])||void 0===t?void 0:t.permissions)||{}).length>0)},n.checkIfMethodIsEnabled=function(e,t){const n=(0,V.getSelectedInternalAccount)(e);return Boolean(n.methods.includes(t))},n.checkNetworkAndAccountSupports1559=function(e,t){return(0,P.isEIP1559Network)(e,t)},n.checkNetworkOrAccountNotSupports1559=function(e){return(0,P.isNotEIP1559Network)(e)},n.doesAddressRequireLedgerHidConnection=function(e,t){const n=(0,P.isAddressLedger)(e,t),a=(0,P.getLedgerTransportType)(e)===N.LedgerTransportTypes.webhid,r=(0,B.getLedgerWebHidConnectedStatus)(e)!==N.WebHIDConnectedStatuses.connected,o=(0,B.getLedgerTransportStatus)(e)!==N.HardwareTransportStates.verified;return n&&a&&(r||o)},n.getAccountName=function(e,t){const n=e.find(e=>(0,L.isEqualCaseInsensitive)(e.address,t));return n&&""!==n.metadata.name?n.metadata.name:""},n.getAccountToConnectToActiveTab=function(e){const t=(0,V.getSelectedInternalAccount)(e),n=Ut(e),{metamask:{internalAccounts:{accounts:a}}}=e,r=Object.keys(a).length;if(n.length&&n.length!==r&&-1===n.findIndex(e=>e===t.address))return oe(e,t.id);return undefined},n.getAccountType=ee,n.getAccountTypeForKeyring=te,n.getAccountsWithLabels=function(e){return fe(e).map(e=>{const{address:t,metadata:{name:n},balance:a}=e;return{...e,addressLabel:`${n.length<C.TRUNCATED_NAME_CHAR_LIMIT?n:`${n.slice(0,C.TRUNCATED_NAME_CHAR_LIMIT-1)}...`} (${(0,R.shortenAddress)(t)})`,label:n,balance:a}})},n.getAddressBook=function(e){const t=(0,h.getCurrentChainId)(e);if(!e.metamask.addressBook[t])return[];return Object.values(e.metamask.addressBook[t])},n.getAddressBookEntry=ke,n.getAddressBookEntryOrAccountName=function(e,t){const n=ke(e,t);if(n&&""!==n.name)return n.name;const a=Object.values((0,V.getInternalAccounts)(e)).find(e=>(0,L.isEqualCaseInsensitive)(e.address,t));return(null==a?void 0:a.metadata.name)||t},n.getAddressConnectedSubjectMap=function(e){const t=Ht(e),n=Wt(e),a={};return Object.keys(n).forEach(e=>{const{iconUrl:r,name:o}=t[e]||{};n[e].forEach(t=>{const n=o||e;a[t]=a[t]?{...a[t],[e]:{iconUrl:r,name:n}}:{[e]:{iconUrl:r,name:n}}})}),a},n.getAddressSecurityAlertResponse=function(e,t){var n;if(!t)return undefined;return null===(n=e.metamask.addressSecurityAlertResponses)||void 0===n?void 0:n[t.toLowerCase()]},n.getAdvancedGasFeeValues=function(e){return e.metamask.advancedGasFee[(0,h.getCurrentChainId)(e)]},n.getAdvancedInlineGasShown=function(e){return Boolean(e.metamask.featureFlags.advancedInlineGas)},n.getAllAccountsOnNetworkAreEmpty=function(e){const t=Te(e)??{},n=Object.values(t).every(e=>"0x0"===e||"0x00"===e),a=0===ue(e);return n&&a},n.getAllConnectedAccounts=n.getAllChainsToPoll=void 0,n.getAllDetectedTokens=function(e){return e.metamask.allDetectedTokens},n.getAllDetectedTokensForSelectedAddress=function(e){if(!(0,P.getCompletedOnboarding)(e))return{};const{address:t}=(0,V.getSelectedInternalAccount)(e);return Object.entries(e.metamask.allDetectedTokens||{}).reduce((e,[n,a])=>{const r=a[t];return r&&(e[n]=r.map(e=>({...e,chainId:n}))),e},{})},n.getAllDomains=_e,n.getAllEnabledNetworks=void 0,n.getAllPermittedAccounts=Bt,n.getAllPermittedAccountsForCurrentTab=qt,n.getAllPermittedAccountsForSelectedTab=function(e,t){return Bt(e,t)},n.getAllPermittedChainsForSelectedTab=function(e,t){return Lt(e,t).filter(e=>{try{const{namespace:t}=(0,A.parseCaipChainId)(e);return t!==A.KnownCaipNamespace.Wallet}catch(e){return!1}})},n.getAllPermittedScopes=Lt,n.getAllSnapAvailableUpdates=void 0,n.getAllTokens=he,n.getAnySnapUpdateAvailable=void 0,n.getAppIsLoading=function(e){return e.appState.isLoading},n.getBlockExplorerLinkText=function(e,t=!1){const n=wt(e),a=ze(e);let r={firstPart:"addBlockExplorer",secondPart:""};a.blockExplorerUrl?r=t?{firstPart:"blockExplorerView",secondPart:(0,R.getURLHostName)(a.blockExplorerUrl)}:{firstPart:"viewinExplorer",secondPart:"blockExplorerAccountAction"}:!1===n&&(r=t?{firstPart:"etherscanViewOn",secondPart:""}:{firstPart:"viewOnEtherscan",secondPart:"blockExplorerAccountAction"});return r},n.getChainIdsToPoll=void 0,n.getCompleteAddressBook=Ne,n.getConnectedSubjectsForAllAddresses=n.getConnectedSitesListWithNetworkInfo=n.getConnectedSitesList=n.getConfirmationExchangeRates=void 0,n.getConnectedSubjectsForSelectedAddress=function(e){const t=(0,V.getSelectedInternalAccount)(e),n=Dt(e),a=Ht(e),r=[];return Object.entries(n).forEach(([e,n])=>{if(!Kt(n).includes(t.address))return;const{extensionId:o,name:s,iconUrl:i}=a[e]||{};r.push({extensionId:o,origin:e,name:s,iconUrl:i})}),r},n.getCrossChainMetaMaskCachedBalances=function(e){const t=e.metamask.accountsByChainId;return Object.keys(t).reduce((e,n)=>(e[n]=Object.keys(t[n]).reduce((e,a)=>(e[a]=t[n][a].balance,e),{}),e),{})},n.getCrossChainTokenExchangeRates=void 0,n.getCurrencyRates=Ze,n.getCurrentAccountWithSendEtherInfo=ye,n.getCurrentEthBalance=function(e){var t;return null===(t=ye(e))||void 0===t?void 0:t.balance},n.getCurrentKeyring=Z,n.getCurrentNetwork=void 0,n.getCurrentQRHardwareState=function(e){const{qrHardware:t}=e.metamask;return t||{}},n.getCustomNonceValue=function(e){return String(e.appState.customNonceValue)},n.getCustomTokenAmount=function(e){return e.appState.customTokenAmount},n.getDefaultHomeActiveTabName=function(e){return e.metamask.defaultHomeActiveTabName},n.getDetectedTokensInCurrentNetwork=function(e){var t;const n=(0,h.getCurrentChainId)(e),{address:a}=(0,V.getSelectedInternalAccount)(e);return null===(t=e.metamask.allDetectedTokens)||void 0===t||null===(t=t[n])||void 0===t?void 0:t[a]},n.getEditedNetwork=function(e){return e.appState.editedNetwork},n.getEnabledNetworks=At,n.getEnabledSnaps=void 0,n.getEnsResolutionByAddress=function(e,t){if(e.metamask.ensResolutionsByAddress[t]){const n=e.metamask.ensResolutionsByAddress[t];return(0,r.toUnicode)(n)}const n=ke(e,t)||re(e,t);return(null==n?void 0:n.name)||""},n.getEthereumAddressNames=function(e){var t;return(null===(t=e.metamask.names)||void 0===t?void 0:t[l.NameType.ETHEREUM_ADDRESS])||{}},n.getEvmInternalAccounts=void 0,n.getExternalServicesOnboardingToggleState=function(e){return e.appState.externalServicesOnboardingToggleState},n.getFeatureFlags=function(e){return e.metamask.featureFlags},n.getFeatureNotificationsEnabled=function(e){const{featureNotificationsEnabled:t=!1}=be(e);return t},n.getFirstPermissionRequest=function(e){const t=Qt(e);return t&&t[0]?t[0]:null},n.getFirstSnapInstallOrUpdateRequest=function(e){var t;return(null===(t=zt(e))||void 0===t?void 0:t[0])??null},n.getFullTxData=void 0,n.getHDEntropyIndex=function(e){const t=ae(e),n=de(e);let a=n.filter(e=>e.type===k.KeyringType.hdKeyTree).findIndex(e=>e.accounts.includes(t));if(-1===a){const t=(0,V.getSelectedInternalAccount)(e);if(t){const{entropySource:e}=t.options;a=n.findIndex(({metadata:t})=>t.id===e)}}return-1===a?undefined:a},n.getHardwareWalletType=function(e){const t=Z(e);return J(e)?t.type:undefined},n.getHdKeyringOfSelectedAccountOrPrimaryKeyring=n.getHdKeyringIndexByIdOrDefault=void 0,n.getHiddenAccountsList=_t,n.getInterfaceContent=n.getInterface=n.getInsightSnaps=n.getInsightSnapIds=n.getHideSnapBranding=void 0,n.getInternalAccount=oe,n.getInternalAccountsSortedByKeyring=n.getInternalAccountByAddress=void 0,n.getIpfsGateway=function(e){return e.metamask.ipfsGateway},n.getIsAccessedFromDappConnectedSitePopover=function(e){return e.appState.isAccessedFromDappConnectedSitePopover},n.getIsAddSnapAccountEnabled=function(e){return e.metamask.addSnapAccountEnabled},n.getIsAddingNewNetwork=function(e){return e.appState.isAddingNewNetwork},n.getIsBitcoinSupportEnabled=function(e){const{addBitcoinAccount:t}=(0,z.getRemoteFeatureFlags)(e);return Boolean(t)},n.getIsBridgeChain=function(e,t){const n=(0,V.getSelectedInternalAccount)(e),{chainId:a,isEvmNetwork:r}=(0,Y.getMultichainNetwork)(e,n);let o=a;r&&(o=(0,h.getCurrentChainId)(e));const s=t??o;return w.ALLOWED_BRIDGE_CHAIN_IDS.includes(s)},n.getIsBridgeEnabled=void 0,n.getIsCustomNetwork=wt,n.getIsDefiPositionsEnabled=function(e){const{assetsDefiPositionsEnabled:t}=(0,z.getRemoteFeatureFlags)(e);return Boolean(t)},n.getIsDynamicTokenListAvailable=Ct,n.getIsLineaMainnet=function(e){return(0,h.getCurrentChainId)(e)===I.CHAIN_IDS.LINEA_MAINNET},n.getIsMainnet=ve,n.getIsMultiRpcOnboarding=function(e){return e.appState.isMultiRpcOnboarding},n.getIsNewSettingsEnabled=function(e){const{settingsRedesign:t}=(0,z.getRemoteFeatureFlags)(e);return Boolean(t)},n.getIsNonStandardEthChain=function(e){return!(ve(e)||De(e))},n.getIsRpcFailoverEnabled=void 0,n.getIsSecurityAlertsEnabled=function(e){return e.metamask.securityAlertsEnabled},n.getIsSigningQRHardwareTransaction=function(e){var t;return(null===(t=e.metamask.qrHardware)||void 0===t||null===(t=t.sign)||void 0===t?void 0:t.request)!==undefined},n.getIsSolanaSupportEnabled=function(e){const{addSolanaAccount:t}=(0,z.getRemoteFeatureFlags)(e);return Boolean(t)},n.getIsSolanaTestnetSupportEnabled=function(e){const{solanaTestnetsEnabled:t}=(0,z.getRemoteFeatureFlags)(e);return Boolean(t)},n.getIsSwapsChain=function(e,t){const n=(0,h.getCurrentChainId)(e),a=t??n;return y.ALLOWED_PROD_SWAPS_CHAIN_IDS.includes(a)},n.getIsTestnet=De,n.getIsTokenDetectionInactiveOnMainnet=yt,n.getIsTokenDetectionSupported=function(e){const t=kt(e),n=Ct(e);return t&&n},n.getIsTokenNetworkFilterEqualCurrentNetwork=Le,n.getIsWatchEthereumAccountEnabled=function(e){return e.metamask.watchEthereumAccountEnabled},n.getIstokenDetectionInactiveOnNonMainnetSupportedNetwork=function(e){const t=kt(e),n=ve(e);return Ct(e)&&!t&&!n},n.getKeyringOfSelectedAccount=void 0,n.getKeyringSnapAccounts=function(e){const t=(0,V.getInternalAccounts)(e);return Object.values(t).filter(e=>{const{keyring:t}=e.metadata;return t.type===k.KeyringType.snap})},n.getKeyringSnapRemovalResult=function(e){return e.appState.keyringRemovalSnapModal},n.getKnownMethodData=function(e,t){const{knownMethodData:n,use4ByteResolution:a}=e.metamask;if(!a||!(0,H.hasTransactionData)(t))return null;const r=(0,_.addHexPrefix)(t).slice(0,10);if(r.length<10)return null;return(null==n?void 0:n[r])??null},n.getLastConnectedInfo=function(e){const{permissionHistory:t={}}=e.metamask;return Object.keys(t).reduce((e,n)=>(t[n].eth_accounts&&(e[n]=JSON.parse(JSON.stringify(t[n].eth_accounts))),e),{})},n.getLastViewedUserSurvey=function(e){return e.metamask.lastViewedUserSurvey},n.getLocale=lt,n.getManageInstitutionalWallets=function(e){return e.metamask.manageInstitutionalWallets},n.getMarketData=void 0,n.getMaybeSelectedInternalAccount=function(e){var t,n;const a=null===(t=e.metamask.internalAccounts)||void 0===t?void 0:t.selectedAccount;return a?null===(n=e.metamask.internalAccounts)||void 0===n?void 0:n.accounts[a]:undefined},n.getMemoizedUnapprovedTemplatedConfirmations=n.getMemoizedUnapprovedConfirmations=n.getMemoizedTargetSubjectMetadata=n.getMemoizedMetadataContract=n.getMemoizedMetaMaskInternalAccounts=n.getMemoizedInterfaces=n.getMemoizedInterfaceContent=n.getMemoizedInterface=n.getMemoizedCurrentChainId=void 0,n.getMetaMaskAccountBalances=ge,n.getMetaMaskAccountsOrdered=n.getMetaMaskAccountsConnected=n.getMetaMaskAccounts=void 0,n.getMetaMaskCachedBalances=Te,n.getMetaMaskHdKeyrings=le,n.getMetaMaskKeyrings=de,n.getMetaMetricsDataDeletionId=function(e){return e.metamask.metaMetricsDataDeletionId},n.getMetaMetricsDataDeletionStatus=function(e){return e.metamask.metaMetricsDataDeletionStatus},n.getMetaMetricsDataDeletionTimestamp=function(e){return e.metamask.metaMetricsDataDeletionTimestamp},n.getMetaMetricsId=function(e){const{metaMetricsId:t}=e.metamask;return t},n.getNameLookupSnapsIds=n.getMultipleTargetsSubjectMetadata=n.getMetadataContractName=void 0,n.getNameSources=function(e){return e.metamask.nameSources||{}},n.getNames=function(e){return e.metamask.names||{}},n.getNativeCurrencyForChain=et,n.getNativeCurrencyImage=function(e){const t=(0,h.getCurrentChainId)(e);return I.CHAIN_ID_TOKEN_IMAGE_MAP[t]},n.getNativeTokenCachedBalanceByChainIdByAccountAddress=me,n.getNativeTokenCachedBalanceByChainIdSelector=void 0,n.getNativeTokenInfo=pe,n.getNetworkConfigurationIdByChainId=n.getNetworkClientIdsToPoll=void 0,n.getNetworkDiscoverButtonEnabled=function(e){const{neNetworkDiscoverButton:t}=(0,z.getRemoteFeatureFlags)(e);return t},n.getNetworkIdentifier=function(e){const{type:t,nickname:n,rpcUrl:a}=(0,h.getProviderConfig)(e);return n||a||t},n.getNetworkToAutomaticallySwitchTo=function(e){const t=It(e),n=Qe(e);if((0,_.getEnvironmentType)()===q.ENVIRONMENT_TYPE_POPUP&&(0,P.getIsUnlocked)(e)&&n&&0===t){const t=_e(e)[n],a=Nt(e);if(t&&a.id!==t)return t}return null},n.getNetworksTabSelectedNetworkConfigurationId=function(e){return e.appState.selectedNetworkConfigurationId},n.getNewNetworkAdded=function(e){return e.appState.newNetworkAddedName},n.getNewNftAddedMessage=function(e){return e.appState.newNftAddedMessage},n.getNewTokensImported=function(e){return e.appState.newTokensImported},n.getNewTokensImportedError=function(e){return e.appState.newTokensImportedError},n.getNextSuggestedNonce=function(e){return Number(e.appState.nextNonce)},n.getNftIsStillFetchingIndication=function(e){return e.appState.isNftStillFetchingIndication},n.getNotifySnaps=void 0,n.getNumberOfAllUnapprovedTransactionsAndMessages=It,n.getNumberOfTokens=ue,n.getOnboardedInThisUISession=function(e){return e.appState.onboardedInThisUISession},n.getOnboardingDate=function(e){return e.metamask.onboardingDate},n.getOpenSeaEnabled=function(e){return Boolean(e.metamask.openSeaEnabled)},n.getOrderedConnectedAccountsForActiveTab=void 0,n.getOrderedConnectedAccountsForConnectedDapp=$t,n.getOrderedNetworksList=function(e){return e.metamask.orderedNetworkList},n.getOrigin=Vt,n.getOriginOfCurrentTab=Qe,n.getPendingTokens=void 0,n.getPermissionSubjects=Dt,n.getPermissionSubjectsDeepEqual=void 0,n.getPermissions=function(e,t){var n;return null===(n=Dt(e)[t])||void 0===n?void 0:n.permissions},n.getPermissionsForActiveTab=function(e){var t;const{activeTab:n,metamask:a}=e,{subjects:r={}}=a,o=(null===(t=r[n.origin])||void 0===t?void 0:t.permissions)??{};return Object.keys(o).map(e=>({key:e,value:o[e]}))},n.getPermissionsRequests=Qt,n.getPermittedAccountsByOrigin=Wt,n.getPermittedEVMAccounts=bt,n.getPermittedEVMAccountsForCurrentTab=Ut,n.getPermittedEVMAccountsForSelectedTab=Ft,n.getPermittedEVMChains=Pt,n.getPermittedEVMChainsByOrigin=function(e){const t=Dt(e);return Object.keys(t).reduce((e,n)=>{const a=jt(Gt(t[n]));return a.length>0&&(e[n]=a),e},{})},n.getPermittedEVMChainsForSelectedTab=function(e,t){return Pt(e,t)},n.getPinnedAccountsList=ht,n.getPreferences=be,n.getPreinstalledSnaps=void 0,n.getRemoveNftMessage=function(e){return e.appState.removeNftMessage},n.getRequestState=function(e,t){var n;return null===(n=e.metamask.pendingApprovals[t])||void 0===n?void 0:n.requestState},n.getRequestType=function(e,t){var n;return null===(n=e.metamask.pendingApprovals[t])||void 0===n?void 0:n.type},n.getRequestingNetworkInfo=function(e,t){let n=t===undefined?[]:t;"string"==typeof n&&(n=[n]);const a=n.flat();return Object.values((0,h.getNetworkConfigurationsByChainId)(e)).filter(e=>a.includes(e.chainId))},n.getRpcPrefsForCurrentProvider=ze,n.getSelectedAccount=void 0,n.getSelectedAccountCachedBalance=Ae,n.getSelectedAccountNativeTokenCachedBalanceByChainId=Se,n.getSelectedAccountTokensAcrossChains=function(e){const{allTokens:t}=e.metamask,n=ie(e).address,a={},r=Se(e);return new Set([...Object.keys(t||{}),...Object.keys(r||{})]).forEach(o=>{var s;a[o]||(a[o]=[]),null!==(s=t[o])&&void 0!==s&&s[n]&&t[o][n].forEach(e=>{const t={...e,chainId:o,isNative:!1};a[o].push(t)});const i=r[o];if(i){const t=pe(e,o);a[o].push({...t,address:"",balance:i,chainId:o,isNative:!0})}}),a},n.getSelectedAddress=ae,n.getSelectedEvmInternalAccount=void 0,n.getSelectedInternalAccountWithBalance=function(e){const t=(0,V.getSelectedInternalAccount)(e),n=ge(e)[t.address];return{...t,balance:n?n.balance:"0x0"}},n.getSelectedNetwork=n.getSelectedKeyringByIdOrDefault=void 0,n.getSendInputCurrencySwitched=function({appState:e}){return e.sendInputCurrencySwitched},n.getSettingsPageSnapsIds=n.getSettingsPageSnaps=void 0,n.getShouldHideZeroBalanceTokens=function(e){const{hideZeroBalanceTokens:t}=be(e);return t},n.getShouldShowFiat=function(e,t){let n,a;if(t){var r,o;n=t;const s=I.CHAIN_ID_TO_CURRENCY_SYMBOL_MAP[t]??I.CHAIN_ID_TO_CURRENCY_SYMBOL_MAP_NETWORK_COLLISION[t]??(null===(r=we(e,t))||void 0===r?void 0:r.nativeCurrency);a=null===(o=Ze(e))||void 0===o||null===(o=o[s])||void 0===o?void 0:o.conversionRate}else n=(0,h.getCurrentChainId)(e),a=(0,P.getConversionRate)(e);const s=I.TEST_NETWORK_IDS.includes(n),{showFiatInTestnets:i}=be(e),c=Mt(e),u=Boolean(c&&a);if(s)return i&&u;return u},n.getShowAccountBanner=function(e){return e.metamask.showAccountBanner},n.getShowBasicFunctionalityModal=function(e){return e.appState.showBasicFunctionalityModal},n.getShowBetaHeader=function(e){return e.metamask.showBetaHeader},n.getShowConnectionsRemovedModal=function(e){return e.appState.showConnectionsRemovedModal},n.getShowDataDeletionErrorModal=function(e){return e.appState.showDataDeletionErrorModal},n.getShowDeleteMetaMetricsDataModal=function(e){return e.appState.showDeleteMetaMetricsDataModal},n.getShowDownloadMobileAppSlide=function(e){return e.metamask.showDownloadMobileAppSlide},n.getShowExtensionInFullSizeView=function(e){const{showExtensionInFullSizeView:t}=be(e);return Boolean(t)},n.getShowFiatInTestnets=function(e){const{showFiatInTestnets:t}=be(e);return t},n.getShowNetworkBanner=function(e){return e.metamask.showNetworkBanner},n.getShowOutdatedBrowserWarning=function(e){const{outdatedBrowserWarningLastShown:t}=e.metamask;if(!t)return!0;return(new Date).getTime()-t>=2*D.DAY},n.getShowPermissionsTour=function(e){return e.metamask.showPermissionsTour},n.getShowPermittedNetworkToastOpen=function(e){return e.appState.showPermittedNetworkToastOpen},n.getShowRecoveryPhraseReminder=function(e){const{recoveryPhraseReminderLastShown:t,recoveryPhraseReminderHasBeenShown:n}=e.metamask,a=(new Date).getTime(),r=n?90*D.DAY:2*D.DAY;return a-t>=r},n.getShowTermsOfUse=function(e){const{termsOfUseLastAgreed:t}=e.metamask;if(!t)return!0;return new Date(t).getTime()<new Date(b.TERMS_OF_USE_LAST_UPDATED).getTime()},n.getShowTestNetworks=Pe,n.getShowUpdateModal=function(e){var t;const{metamask:{isUpdateAvailable:n,updateModalLastDismissedAt:a,lastUpdatedAt:r}}=e,o=(0,z.getRemoteFeatureFlags)(e),s=u.default.valid(u.default.coerce(null===(t=global.platform)||void 0===t?void 0:t.getVersion())),i=u.default.valid(u.default.coerce(o.extensionUpdatePromptMinimumVersion)),c=!(!s||!i)&&u.default.lt(s,i),d=Date.now(),l=864e5,g=!a||d-a>l,T=!r||d-r>l;return c&&n&&g&&T},n.getShowWhatsNewPopup=function(e){return e.appState.showWhatsNewPopup},n.getSignatureInsightSnaps=n.getSignatureInsightSnapIds=void 0,n.getSlides=function(e){return e.metamask.slides||[]},n.getSnapInsights=n.getSnap=void 0,n.getSnapInstallOrUpdateRequests=zt,n.getSnapMetadata=n.getSnapLatestVersion=void 0,n.getSnapRegistry=function(e){const{snapRegistryList:t}=e.metamask;return t},n.getSnapRegistryData=void 0,n.getSnaps=dt,n.getSnapsInstallPrivacyWarningShown=function(e){const{snapsInstallPrivacyWarningShown:t}=e.metamask;if(t===undefined||null===t)return!1;return t},n.getSnapsList=function(e){const t=dt(e);return Object.entries(t).filter(([e,t])=>t.status!==i.SnapStatus.Installing&&(!t.preinstalled||!1===t.hidden)).map(([t,n])=>{const a=Fe(e,null==n?void 0:n.id);return{key:t,id:n.id,iconUrl:null==a?void 0:a.iconUrl,subjectType:null==a?void 0:a.subjectType,packageName:(0,i.stripSnapPrefix)(n.id),name:Tt(e,n.id).name}})},n.getSnapsMetadata=void 0,n.getSortedAnnouncementsToShow=function(e){const t=Object.values(e.metamask.announcements),n={},a=t.filter(e=>!e.isShown&&n[e.id]);return a.sort((e,t)=>new Date(t.date)-new Date(e.date))},n.getSubjectMetadata=Ht,n.getSubjectMetadataDeepEqual=void 0,n.getSubjectsWithPermission=function(e,t){const n=Dt(e),a=[];return Object.entries(n).forEach(([n,{permissions:r}])=>{if(r[t]){const{extensionId:t,name:r,iconUrl:o}=Fe(e,n)||{};a.push({extensionId:t,origin:n,name:r,iconUrl:o})}}),a},n.getSubjectsWithSnapPermission=function(e,t){const n=Dt(e);return Object.entries(n).filter(([e,{permissions:n}])=>{var a;return null===(a=n[m.WALLET_SNAP_PERMISSION_KEY])||void 0===a?void 0:a.caveats[0].value[t]}).map(([t,n])=>{const{extensionId:a,name:r,iconUrl:o}=Fe(e,t)||{};return{extensionId:a,origin:t,name:r,iconUrl:o}})},n.getSuggestedNfts=function(e){var t;return(null===(t=Re(e))||void 0===t?void 0:t.filter(({requestData:e,type:t})=>{var n;return t===s.ApprovalType.WatchAsset&&(null==e||null===(n=e.asset)||void 0===n?void 0:n.tokenId)!==undefined}))||[]},n.getSuggestedTokens=function(e){var t;return(null===(t=Re(e))||void 0===t?void 0:t.filter(({type:e,requestData:t})=>{var n;return e===s.ApprovalType.WatchAsset&&(null==t||null===(n=t.asset)||void 0===n?void 0:n.tokenId)===undefined}))||[]},n.getSwapsDefaultToken=function(e,t=null){const n=Ie(e),a=null==n?void 0:n.balance,r=(0,h.getCurrentChainId)(e),o=t??r;return{...y.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[o],chainId:o,balance:(0,U.hexToDecimal)(a),string:(0,U.getValueFromWeiHex)({value:a,numberOfDecimals:4,toDenomination:"ETH"})}},n.getTargetAccount=function(e,t){return ne(e)[t]},n.getTargetAccountWithSendEtherInfo=function(e,t){const n=Ce(e);return(0,R.getAccountByAddress)(n,t)},n.getTargetSubjectMetadata=Fe,n.getTestNetworkBackgroundColor=function(e){const t=(0,h.getProviderConfig)(e).ticker;switch(!0){case null==t?void 0:t.includes(I.GOERLI_DISPLAY_NAME):return F.BackgroundColor.goerli;case null==t?void 0:t.includes(I.SEPOLIA_DISPLAY_NAME):return F.BackgroundColor.sepolia;default:return undefined}},n.getTheme=function(e){return e.metamask.theme},n.getTokenSortConfig=n.getTokenNetworkFilter=n.getTokenList=n.getTokenExchangeRates=n.getTokenDetectionSupportNetworkByChainId=n.getThirdPartyNotifySnaps=void 0,n.getTokensAcrossChainsByAccountAddress=Ee,n.getTokensMarketData=n.getTokensAcrossChainsByAccountAddressSelector=void 0,n.getTotalUnapprovedCount=function(e){return e.metamask.pendingApprovalCount??0},n.getTxData=n.getTransaction=void 0,n.getUSDConversionRate=function(e){var t;return null===(t=e.metamask.currencyRates[(0,h.getProviderConfig)(e).ticker])||void 0===t?void 0:t.usdConversionRate},n.getUnapprovedConfirmations=n.getUSDConversionRateByChainId=void 0,n.getUnapprovedTemplatedConfirmations=Me,n.getUnapprovedTransaction=void 0,n.getUnapprovedTxCount=function(e){const t=(0,j.getUnapprovedTransactions)(e);return Object.keys(t).length},n.getUnconnectedAccounts=function(e,t){const n=fe(e),a=$t(e,t);return n.filter(e=>!a.some(t=>t.address===e.address))},n.getUpdatedAndSortedAccountsWithCaipAccountId=n.getUpdatedAndSortedAccounts=void 0,n.getUrlScanCacheResult=function(e,t){var n;if(!t)return undefined;return null===(n=e.metamask.urlScanCache)||void 0===n?void 0:n[t]},n.getUseBlockie=function(e){return Boolean(e.metamask.useBlockie)},n.getUseCurrencyRateCheck=Mt,n.getUseExternalNameSources=function(e){return e.metamask.useExternalNameSources},n.getUseExternalServices=Xe,n.getUseNftDetection=function(e){return Boolean(e.metamask.useNftDetection)},n.getUseTokenDetection=kt,n.getUseTransactionSimulations=function(e){return Boolean(e.metamask.useTransactionSimulations)},n.getWatchedToken=void 0,n.getWeb3ShimUsageStateForOrigin=function(e,t){return e.metamask.web3ShimUsageOrigins[t]},n.getsnapsAddSnapAccountModalDismissed=function(e){const{snapsAddSnapAccountModalDismissed:t}=e.metamask;return t},n.isAccountConnectedToCurrentTab=void 0,n.isBalanceCached=function(e){var t;const{address:n}=(0,V.getSelectedInternalAccount)(e),a=null===(t=ge(e))||void 0===t||null===(t=t[n])||void 0===t?void 0:t.balance,r=Ae(e);return Boolean(!a&&r)},n.isCurrentProviderCustom=function(e){const t=(0,h.getProviderConfig)(e);return t.type===I.NETWORK_TYPES.RPC&&!Object.values(I.CHAIN_IDS).includes(t.chainId)},n.isGlobalNetworkSelectorRemoved=void 0,n.isHardwareWallet=J,n.useSafeChainsListValidationSelector=n.selectNftsByChainId=n.selectNetworkIdentifierByChainId=n.selectNetworkConfigurationByChainId=n.selectInstalledSnaps=n.selectERC20TokensByChain=n.selectERC20Tokens=n.selectDefaultRpcEndpointByChainId=n.selectConversionRateByChainId=n.selectAllTokensFlat=n.rawStateSelector=void 0;var a,r=e("punycode/punycode.js"),o=e("@metamask/permission-controller"),s=e("@metamask/controller-utils"),i=e("@metamask/snaps-utils"),c=e("lodash"),u=(a=e("semver"))&&a.__esModule?a:{default:a},d=e("reselect"),l=e("@metamask/name-controller"),g=e("@metamask/transaction-controller"),T=e("@metamask/keyring-api"),S=e("@metamask/network-controller"),m=e("@metamask/snaps-rpc-methods"),E=e("@metamask/chain-agnostic-permission"),p=e("@metamask/keyring-controller"),f=e("@metamask/bridge-controller"),A=e("@metamask/utils"),h=e("../../shared/modules/selectors/networks"),_=e("../../app/scripts/lib/util"),I=e("../../shared/constants/network"),N=e("../../shared/constants/hardware-wallets"),k=e("../../shared/constants/keyring"),C=e("../../shared/constants/labels"),y=e("../../shared/constants/swaps"),w=e("../../shared/constants/bridge"),O=e("../../shared/constants/transaction"),R=e("../helpers/utils/util"),M=e("../pages/confirmations/confirmation/templates"),v=e("../../shared/constants/tokens"),D=e("../../shared/constants/time"),b=e("../../shared/constants/terms"),P=e("../ducks/metamask/metamask"),B=e("../ducks/app/app"),L=e("../../shared/modules/string-utils"),U=e("../../shared/modules/conversion.utils"),F=e("../helpers/constants/design-system"),q=e("../../shared/constants/app"),W=e("../../shared/constants/multichain/assets"),H=e("../../shared/modules/transaction.utils"),G=e("../../shared/modules/hexstring-utils"),K=e("../../shared/modules/selectors/util"),x=e("../helpers/utils/snaps"),j=e("./transactions"),V=e("./accounts"),Y=e("./multichain"),$=e("./multichain/networks"),z=e("./remote-feature-flags"),Q=e("./approvals");const X=n.isGlobalNetworkSelectorRemoved=!0;n.getConfirmationExchangeRates=e=>e.appState.confirmationExchangeRates;function Z(e){var t;const n=(0,V.getSelectedInternalAccount)(e);return n?null===(t=n.metadata)||void 0===t?void 0:t.keyring:null}function J(e){var t;const n=Z(e);return Boolean(null==n||null===(t=n.type)||void 0===t?void 0:t.includes("Hardware"))}function ee(e){return te(Z(e))}function te(e){if(!e)return"";const{type:t}=e;switch(t){case k.KeyringType.trezor:case k.KeyringType.oneKey:case k.KeyringType.ledger:case k.KeyringType.lattice:case k.KeyringType.qr:return"hardware";case k.KeyringType.imported:return"imported";case k.KeyringType.snap:return"snap";default:return"default"}}n.getPendingTokens=e=>e.appState.pendingTokens;const ne=n.getMetaMaskAccounts=(0,K.createDeepEqualSelector)(V.getInternalAccounts,ge,Te,Y.getMultichainBalances,Y.getMultichainNetworkProviders,h.getCurrentChainId,(e,t)=>t,(e,t,n,a,r,o,s)=>Object.values(e).reduce((e,i)=>{let c=i;if(s===undefined||o===s){if((0,T.isEvmAccountType)(i.type))null!=t&&t[i.address]&&(c={...c,...t[i.address]});else{var u;const e=r.find(e=>e.isAddressCompatible(i.address));c={...c,balance:(null==a||null===(u=a[i.id])||void 0===u||null===(u=u[W.MULTICHAIN_NETWORK_TO_ASSET_TYPES[e.chainId]])||void 0===u?void 0:u.amount)??"0"}}null!==c.balance&&c.balance!==undefined||(c={...c,balance:(n&&n[i.address])??"0x0"})}else c={...c,balance:(n&&n[i.address])??"0x0"};return{...e,[i.address]:c}},{}));function ae(e){var t;return null===(t=(0,V.getSelectedInternalAccount)(e))||void 0===t?void 0:t.address}const re=n.getInternalAccountByAddress=(0,d.createSelector)(e=>e.metamask.internalAccounts.accounts,(e,t)=>t,(e,t)=>Object.values(e).find(e=>(0,L.isEqualCaseInsensitive)(e.address,t)));function oe(e,t){return e.metamask.internalAccounts.accounts[t]}const se=n.getEvmInternalAccounts=(0,d.createSelector)(V.getInternalAccounts,e=>e.filter(e=>(0,T.isEvmAccountType)(e.type))),ie=n.getSelectedEvmInternalAccount=(0,d.createSelector)(se,e=>{const[t]=(0,R.sortSelectedInternalAccounts)(e);return t}),ce=n.getInternalAccountsSortedByKeyring=(0,K.createDeepEqualSelector)(de,ne,(e,t)=>{const n="thirdPartySnaps",a=Object.values(t).reduce((e,t)=>{var a;if((null===(a=t.metadata)||void 0===a||null===(a=a.keyring)||void 0===a?void 0:a.type)===p.KeyringTypes.snap){const{entropySource:a=n}=t.options||{};e[a]||(e[a]=[]),e[a].push(t)}return e},{});return e.reduce((e,r)=>{const o=r.accounts.map(e=>t[e]);if(r.type===p.KeyringTypes.hd){const t=a[r.metadata.id]||[];return e.push(...o,...t),e}if(r.type===p.KeyringTypes.snap){const t=(a[n]||[]).filter(t=>!e.some(e=>e.id===t.id));return e.push(...t),e}return e.push(...o),e},[])});function ue(e){const{tokens:t}=e.metamask;return t?t.length:0}function de(e){return e.metamask.keyrings}function le(e){return e.metamask.keyrings.filter(e=>e.type===p.KeyringTypes.hd)}function ge(e){var t;const n=(0,h.getCurrentChainId)(e);return(null===(t=e.metamask)||void 0===t||null===(t=t.accountsByChainId)||void 0===t?void 0:t[n])??{}}function Te(e,t){var n;const a=t??(0,h.getCurrentChainId)(e);return null!==(n=e.metamask.accountsByChainId)&&void 0!==n&&n[a]?Object.entries(e.metamask.accountsByChainId[a]).reduce((e,[t,n])=>(e[t]=n.balance,e),{}):{}}function Se(e){const{accountsByChainId:t}=e.metamask,{address:n}=ie(e),a={};for(const[e,r]of Object.entries(t||{}))r[n]&&(a[e]=r[n].balance);return a}n.getNativeTokenCachedBalanceByChainIdSelector=(0,d.createSelector)(e=>e,(e,t)=>t,(e,t)=>me(e,t)),n.getTokensAcrossChainsByAccountAddressSelector=(0,d.createSelector)(e=>e,(e,t)=>t,(e,t)=>Ee(e,t));function me(e,t){const{accountsByChainId:n}=e.metamask,a={};for(const[e,r]of Object.entries(n||{}))r[t]&&(a[e]=r[t].balance);return a}function Ee(e,t){const{allTokens:n}=e.metamask,a={},r=me(e,t);return new Set([...Object.keys(n||{}),...Object.keys(r||{})]).forEach(o=>{var s;a[o]||(a[o]=[]),null!==(s=n[o])&&void 0!==s&&s[t]&&n[o][t].forEach(e=>{const t={...e,chainId:o,isNative:!1};a[o].push(t)});const i=r[o];if(i){const t=pe(e,o);a[o].push({...t,address:"",balance:i,chainId:o,isNative:!0,image:et(o)})}}),a}function pe(e,t){const{networkConfigurationsByChainId:n}=e.metamask,a=null==n?void 0:n[t];if(a){return{symbol:a.nativeCurrency||O.AssetType.native,decimals:18,name:a.name||"Native Token"}}const{provider:r}=e.metamask;if((null==r?void 0:r.chainId)===t){var o;return{symbol:r.ticker||O.AssetType.native,decimals:(null===(o=r.nativeCurrency)||void 0===o?void 0:o.decimals)||18,name:r.nickname||"Native Token"}}const s=I.CHAIN_ID_TO_CURRENCY_SYMBOL_MAP[t],i=I.NETWORK_TO_NAME_MAP[t];return s&&i?{symbol:s,decimals:18,name:i}:{symbol:O.AssetType.native,decimals:18,name:"Native Token"}}const fe=n.getMetaMaskAccountsOrdered=(0,K.createDeepEqualSelector)(ce,ne,(e,t)=>e.map(e=>({...e,...t[e.address]})));n.getMetaMaskAccountsConnected=(0,d.createSelector)(fe,e=>e.map(({address:e})=>e.toLowerCase()));function Ae(e){const t=Te(e),{address:n}=(0,V.getSelectedInternalAccount)(e);return null==t?void 0:t[n]}function he(e){return e.metamask.allTokens}n.selectAllTokensFlat=(0,d.createSelector)(he,e=>Object.values(e).reduce((e,t)=>{const n=Object.values(t);return e.concat(...n)},[]));function _e(e){return e.metamask.domains}const Ie=n.getSelectedAccount=(0,K.createDeepEqualSelector)(ne,V.getSelectedInternalAccount,(e,t)=>t?{...t,...e[t.address]}:undefined);n.getWatchedToken=e=>(0,d.createSelector)([Ie,he],(t,n)=>{var a;const{chainId:r}=e;return null==n||null===(a=n[r])||void 0===a||null===(a=a[t.address])||void 0===a?void 0:a.find(t=>(0,G.toChecksumHexAddress)(t.address)===(0,G.toChecksumHexAddress)(e.txParams.to))});n.getTokenExchangeRates=(0,d.createSelector)(e=>(0,h.getCurrentChainId)(e),e=>e.metamask.marketData,(e,t)=>{const n=(null==t?void 0:t[e])??{};return Object.entries(n).reduce((e,[t,n])=>(e[t]=(null==n?void 0:n.price)??null,e),{})});n.getCrossChainTokenExchangeRates=e=>{const t=e.metamask.marketData??{};return Object.keys(t).reduce((e,n)=>(e[n]=Object.keys(t[n]).reduce((e,a)=>{var r;return e[a]=null===(r=t[n][a])||void 0===r?void 0:r.price,e},{}),e),{})};n.getTokensMarketData=e=>{var t;const n=(0,h.getCurrentChainId)(e);return null===(t=e.metamask.marketData)||void 0===t?void 0:t[n]};function Ne(e){const t=e.metamask.addressBook;return Object.entries(t).filter(([e,t])=>"*"!==e).map(([e,t])=>Object.values(t).map(t=>({...t,chainId:e}))).flat()}function ke(e,t){return Ne(e).find(e=>(0,L.isEqualCaseInsensitive)(e.address,t))}function Ce(e){const t=ne(e),n=(0,V.getInternalAccounts)(e);return Object.values(n).map(e=>({...e,...t[e.address]}))}function ye(e){const{address:t}=(0,V.getSelectedInternalAccount)(e),n=Ce(e);return(0,R.getAccountByAddress)(n,t)}n.getMarketData=e=>e.metamask.marketData;n.getNetworkConfigurationIdByChainId=(0,K.createDeepEqualSelector)(e=>e.metamask.networkConfigurationsByChainId,e=>Object.entries(e).reduce((e,[t,n])=>{const a=n.rpcEndpoints[n.defaultRpcEndpointIndex];return e[t]=a.networkClientId,e},{}));const we=n.selectNetworkConfigurationByChainId=(0,d.createSelector)(h.getNetworkConfigurationsByChainId,(e,t)=>t,(e,t)=>e[t]),Oe=n.selectDefaultRpcEndpointByChainId=(0,d.createSelector)(we,e=>{if(!e)return undefined;const{defaultRpcEndpointIndex:t,rpcEndpoints:n}=e;return n[t]});n.getIsRpcFailoverEnabled=(0,d.createSelector)(z.getRemoteFeatureFlags,e=>e.walletFrameworkRpcFailoverEnabled??!1),n.selectConversionRateByChainId=(0,d.createSelector)(we,e=>e,(e,t)=>{var n;if(!e)return undefined;const{nativeCurrency:a}=e;return null===(n=t.metamask.currencyRates[a])||void 0===n?void 0:n.conversionRate}),n.selectNftsByChainId=(0,d.createSelector)(V.getSelectedInternalAccount,e=>e.metamask.allNfts,(e,t)=>t,(e,t,n)=>{var a;return(null==t||null===(a=t[e.address])||void 0===a?void 0:a[n])??[]}),n.selectNetworkIdentifierByChainId=(0,d.createSelector)(we,Oe,(e,t)=>{const{name:n}=e??{},{url:a,networkClientId:r}=t??{};return n||a||r});const Re=n.getUnapprovedConfirmations=(0,K.createDeepEqualSelector)(e=>e.metamask.pendingApprovals||{},e=>Object.values(e));function Me(e){return Re(e).filter(e=>M.TEMPLATED_CONFIRMATION_APPROVAL_TYPES.includes(e.type))}function ve(e){return(0,h.getCurrentChainId)(e)===I.CHAIN_IDS.MAINNET}function De(e){const t=(0,h.getCurrentChainId)(e);return I.TEST_CHAINS.includes(t)}function be({metamask:e}){return e.preferences??{}}function Pe(e){const{showTestNetworks:t}=be(e);return Boolean(t)}n.getTokenSortConfig=(0,K.createDeepEqualSelector)(be,({tokenSortConfig:e})=>e);const Be=n.getTokenNetworkFilter=(0,K.createDeepEqualSelector)(h.getCurrentChainId,be,$.getIsEvmMultichainNetworkSelected,$.getSelectedMultichainNetworkChainId,(e,{tokenNetworkFilter:t},n,a)=>n?I.FEATURED_NETWORK_CHAIN_IDS.includes(e)?Object.entries(t||{}).reduce((e,[t,n])=>(I.FEATURED_NETWORK_CHAIN_IDS.includes(t)&&(e[t]=n),e),{}):{[e]:!0}:{[a]:!0});function Le(e){const t=(0,h.getCurrentChainId)(e),n=At(e),a=Be(e),r=(0,$.getSelectedMultichainNetworkChainId)(e),{namespace:o}=(0,A.parseCaipChainId)(r),s=X?(null==n?void 0:n[o])??{}:a;return 1===Object.keys(s).length&&Object.keys(s)[0]===t}const Ue=(0,c.memoize)(e=>`data:image/svg+xml;utf8,${encodeURIComponent(e)}`);function Fe(e,t){const n=Ht(e)[t];if((null==n?void 0:n.subjectType)===o.SubjectType.Snap){const{svgIcon:e,...t}=n;return{...t,iconUrl:e?Ue(e):null}}return n}const qe=e=>e;n.rawStateSelector=qe;const We=(e,t)=>t,He=e=>e.metamask.snaps;n.selectInstalledSnaps=He;const Ge=n.getSnapRegistryData=(0,d.createSelector)([e=>{var t;return null===(t=e.metamask.database)||void 0===t?void 0:t.verifiedSnaps},We],(e,t)=>e?e[t]:null),Ke=n.getSnapLatestVersion=(0,d.createSelector)([Ge],e=>e?Object.keys(e.versions).reduce((e,t)=>u.default.gt(t,e)?t:e,"0.0.0"):null),xe=n.getAllSnapAvailableUpdates=(0,d.createSelector)([He,qe],(e,t)=>{const n=new Map;return Object.keys(e).forEach(a=>{const r=Ke(t,a);n.set(a,!!r&&u.default.gt(r,e[a].version))}),n}),je=(n.getAnySnapUpdateAvailable=(0,d.createSelector)([xe],e=>[...e.values()].some(e=>!0===e)),n.getHideSnapBranding=(0,K.createDeepEqualSelector)([He,We],(e,t)=>{var n;return null===(n=e[t])||void 0===n?void 0:n.hideSnapBranding}),n.getMemoizedTargetSubjectMetadata=(0,K.createDeepEqualSelector)(Fe,e=>e),n.getMemoizedUnapprovedConfirmations=(0,K.createDeepEqualSelector)(Re,e=>e),n.getMemoizedUnapprovedTemplatedConfirmations=(0,K.createDeepEqualSelector)(Me,e=>e),(e,t)=>t),Ve=n.getMemoizedInterfaces=(0,K.createDeepEqualSelector)(e=>e.metamask.interfaces,e=>e),Ye=n.getInterface=(0,d.createSelector)([Ve,je],(e,t)=>e[t]),$e=(n.getMemoizedInterface=(0,K.createDeepEqualSelector)(Ye,e=>e),n.getInterfaceContent=(0,d.createSelector)([Ve,je],(e,t)=>{var n;return null===(n=e[t])||void 0===n?void 0:n.content}));n.getMemoizedInterfaceContent=(0,K.createDeepEqualSelector)($e,e=>e),n.getMultipleTargetsSubjectMetadata=(0,K.createDeepEqualSelector)([qe,(e,t)=>t],(e,t)=>Object.keys(t??{}).reduce((t,n)=>(t[n]=Fe(e,n),t),{}));function ze(e){const{rpcPrefs:t}=(0,h.getProviderConfig)(e);return t}function Qe(e){return e.activeTab.origin}function Xe(e){return e.metamask.useExternalServices}function Ze(e){return e.metamask.currencyRates}n.getUSDConversionRateByChainId=e=>(0,d.createSelector)(Ze,t=>we(t,e),(e,t)=>{var n;if(!t)return undefined;const{nativeCurrency:a}=t;return null===(n=e[a])||void 0===n?void 0:n.usdConversionRate});const Je=(0,K.createDeepEqualSelector)([e=>(0,z.getRemoteFeatureFlags)(e).bridgeConfig],e=>(0,f.selectBridgeFeatureFlags)({remoteFeatureFlags:{bridgeConfig:e}}));n.getIsBridgeEnabled=(0,d.createSelector)([Je,Xe],(e,t)=>(t&&(null==e?void 0:e.support))??!1);function et(e){return I.CHAIN_ID_TOKEN_IMAGE_MAP[e]??undefined}n.getMemoizedMetaMaskInternalAccounts=(0,K.createDeepEqualSelector)(V.getInternalAccounts,e=>e),n.selectERC20TokensByChain=(0,K.createDeepEqualSelector)(e=>e.metamask.tokensChainsCache,e=>e);const tt=n.selectERC20Tokens=(0,K.createDeepEqualSelector)(h.getCurrentChainId,e=>e.metamask.tokensChainsCache,(e,t)=>{var n;return(null==t||null===(n=t[e])||void 0===n?void 0:n.data)||{}}),nt=n.getTokenList=(0,d.createSelector)(tt,yt,(e,t)=>t?v.STATIC_MAINNET_TOKEN_LIST:e),at=n.getMemoizedMetadataContract=(0,d.createSelector)((e,t)=>nt(e),(e,t)=>t,(e,t)=>e[null==t?void 0:t.toLowerCase()]),rt=(n.getMetadataContractName=(0,d.createSelector)(at,e=>(null==e?void 0:e.name)??""),e=>e.confirmTransaction.txData);n.getTxData=rt;const ot=n.getUnapprovedTransaction=(0,K.createDeepEqualSelector)(e=>(0,j.getUnapprovedTransactions)(e),(e,t)=>t,(e,t)=>Object.values(e).find(({id:e})=>e===t)),st=n.getTransaction=(0,K.createDeepEqualSelector)(e=>(0,j.getCurrentNetworkTransactions)(e),(e,t)=>t,(e,t)=>Object.values(e).find(({id:e})=>e===t)||{}),it=(n.getFullTxData=(0,K.createDeepEqualSelector)(rt,(e,t,n)=>n===g.TransactionStatus.unapproved?ot(e,t)??{}:st(e,t),(e,t,n,a,r)=>({customTxParamsData:a,hexTransactionAmount:r}),(e,t,{customTxParamsData:n,hexTransactionAmount:a})=>{let r={...e,...t};return t&&t.simulationFails&&(r.simulationFails={...t.simulationFails}),n&&(r={...r,txParams:{...r.txParams,data:n}}),a&&(r={...r,txParams:{...r.txParams,value:a}}),r}),n.getConnectedSubjectsForAllAddresses=(0,K.createDeepEqualSelector)(Dt,Ht,(e,t)=>{const n={};return Object.entries(e).forEach(([e,a])=>{Kt(a).forEach(a=>{n[a]||(n[a]=[]);const r=t[e];n[a].push({origin:e,...r})})}),n})),ct=n.getAllConnectedAccounts=(0,K.createDeepEqualSelector)(it,e=>Object.keys(e)),ut=n.getConnectedSitesList=(0,K.createDeepEqualSelector)(it,V.getInternalAccounts,ct,(e,t,n)=>{const a={};return n.forEach(n=>{e[n].forEach(e=>{const r=e.origin,o=t.find(e=>(0,L.isEqualCaseInsensitive)(e.address,n));a[r]?(a[r].addresses.push(n),a[r].addressToNameMap[n]=(null==o?void 0:o.metadata.name)||""):a[r]={...e,addresses:[n],addressToNameMap:{[n]:(null==o?void 0:o.metadata.name)||""}}})}),a});n.getMemoizedCurrentChainId=(0,K.createDeepEqualSelector)(h.getCurrentChainId,e=>e);function dt(e){return e.metamask.snaps}function lt(e){return e.metamask.currentLocale}n.getSnap=(0,K.createDeepEqualSelector)(dt,(e,t)=>t,(e,t)=>e[t]);const gt=n.getSnapsMetadata=(0,K.createDeepEqualSelector)(lt,dt,(e,t)=>Object.values(t).reduce((t,n)=>{const a=n.id,r=n.localizationFiles?(0,i.getLocalizedSnapManifest)(n.manifest,e,n.localizationFiles):n.manifest;return t[a]={name:r.proposedName,description:r.description,hidden:n.hidden},t},{})),Tt=n.getSnapMetadata=(0,K.createDeepEqualSelector)(gt,(e,t)=>t,(e,t)=>e[t]??{name:t?(0,i.stripSnapPrefix)(t):null}),St=n.getEnabledSnaps=(0,K.createDeepEqualSelector)(dt,e=>Object.values(e).reduce((e,t)=>(t.enabled&&(e[t.id]=t),e),{})),mt=(n.getPreinstalledSnaps=(0,K.createDeepEqualSelector)(dt,e=>Object.values(e).reduce((e,t)=>(t.preinstalled&&(e[t.id]=t),e),{})),n.getInsightSnaps=(0,K.createDeepEqualSelector)(St,Dt,(e,t)=>Object.values(e).filter(({id:e})=>{var n;return null===(n=t[e])||void 0===n?void 0:n.permissions["endowment:transaction-insight"]}))),Et=n.getSettingsPageSnaps=(0,K.createDeepEqualSelector)(St,Dt,(e,t)=>Object.values(e).filter(({id:e,preinstalled:n})=>{var a;return(null===(a=t[e])||void 0===a?void 0:a.permissions[m.SnapEndowments.SettingsPage])&&n&&!(0,x.isSnapIgnoredInProd)(e)})),pt=n.getSignatureInsightSnaps=(0,K.createDeepEqualSelector)(St,Dt,(e,t)=>Object.values(e).filter(({id:e})=>{var n;return null===(n=t[e])||void 0===n?void 0:n.permissions["endowment:signature-insight"]})),ft=(n.getSignatureInsightSnapIds=(0,K.createDeepEqualSelector)(pt,e=>e.map(e=>e.id)),n.getInsightSnapIds=(0,K.createDeepEqualSelector)(mt,e=>e.map(e=>e.id)),n.getNameLookupSnapsIds=(0,K.createDeepEqualSelector)(St,Dt,(e,t)=>Object.values(e).filter(({id:e})=>{var n;return null===(n=t[e])||void 0===n?void 0:n.permissions["endowment:name-lookup"]}).map(e=>e.id)),n.getSettingsPageSnapsIds=(0,K.createDeepEqualSelector)(Et,e=>e.map(e=>e.id)),n.getNotifySnaps=(0,K.createDeepEqualSelector)(St,Dt,(e,t)=>Object.values(e).filter(({id:e})=>{var n;return null===(n=t[e])||void 0===n?void 0:n.permissions.snap_notify})));n.getThirdPartyNotifySnaps=(0,K.createDeepEqualSelector)(ft,e=>e.filter(e=>!e.preinstalled));n.getSnapInsights=(0,K.createDeepEqualSelector)(function(e){return e.metamask.insights},(e,t)=>t,(e,t)=>null==e?void 0:e[t]);function At(e){return e.metamask.enabledNetworkMap}function ht(e){return e.metamask.pinnedAccountList}function _t(e){return e.metamask.hiddenAccountList}function It(e){const t={...(0,j.getAllUnapprovedTransactions)(e),...e.metamask.unapprovedDecryptMsgs,...e.metamask.unapprovedPersonalMsgs,...e.metamask.unapprovedEncryptionPublicKeyMsgs,...e.metamask.unapprovedTypedMessages};return Object.keys(t).length}const Nt=n.getCurrentNetwork=(0,K.createDeepEqualSelector)(h.getNetworkConfigurationsByChainId,h.getCurrentChainId,(e,t)=>{var n;const a=e[t],r=a.rpcEndpoints[a.defaultRpcEndpointIndex],o=null===(n=a.blockExplorerUrls)||void 0===n?void 0:n[a.defaultBlockExplorerUrlIndex];return{chainId:a.chainId,id:r.networkClientId,nickname:a.name,rpcUrl:r.url,ticker:a.nativeCurrency,blockExplorerUrl:o,rpcPrefs:{blockExplorerUrl:o,imageUrl:I.CHAIN_ID_TO_NETWORK_IMAGE_URL_MAP[a.chainId]},...r.type===S.RpcEndpointType.Infura&&{providerType:r.networkClientId}}});n.getSelectedNetwork=(0,K.createDeepEqualSelector)(h.getSelectedNetworkClientId,h.getNetworkConfigurationsByChainId,(e,t)=>{if(e===undefined)throw new Error("No network is selected");const n=Object.values(t).find(t=>t.rpcEndpoints.some(t=>t.networkClientId===e));if(n===undefined)throw new Error("Could not find network configuration for selected network client");return{configuration:n,clientId:e}}),n.getConnectedSitesListWithNetworkInfo=(0,K.createDeepEqualSelector)(ut,_e,h.getNetworkConfigurationsByChainId,Nt,(e,t,n,a)=>(Object.keys(e).forEach(r=>{const o=Object.values(n).find(e=>e.rpcEndpoints.some(e=>e.networkClientId===t[r]));e[r].networkIconUrl=I.CHAIN_ID_TO_NETWORK_IMAGE_URL_MAP[null==o?void 0:o.chainId]||"",e[r].networkName=(null==o?void 0:o.name)||(null==a?void 0:a.nickname)||""}),e));function kt(e){return Boolean(e.metamask.useTokenDetection)}n.getAllEnabledNetworks=(0,K.createDeepEqualSelector)(h.getNetworkConfigurationsByChainId,Pe,(e,t)=>Object.entries(e).reduce((e,[n,a])=>(!t&&I.TEST_CHAINS.includes(n)||(e[n]=a),e),{})),n.getAllChainsToPoll=(0,K.createDeepEqualSelector)(h.getNetworkConfigurationsByChainId,h.getCurrentChainId,(e,t)=>Object.keys(e).filter(e=>e===t||I.FEATURED_NETWORK_CHAIN_IDS.includes(e))),n.getChainIdsToPoll=(0,K.createDeepEqualSelector)(h.getNetworkConfigurationsByChainId,h.getCurrentChainId,Le,(e,t,n)=>n?[t]:Object.keys(e).filter(e=>e===t||I.FEATURED_NETWORK_CHAIN_IDS.includes(e))),n.getNetworkClientIdsToPoll=(0,K.createDeepEqualSelector)(h.getNetworkConfigurationsByChainId,h.getCurrentChainId,Le,(e,t,n)=>{if(n){const n=e[t];return[n.rpcEndpoints[n.defaultRpcEndpointIndex].networkClientId]}return Object.entries(e).reduce((e,[n,a])=>((n===t||I.FEATURED_NETWORK_CHAIN_IDS.includes(n))&&e.push(a.rpcEndpoints[a.defaultRpcEndpointIndex].networkClientId),e),[])});function Ct(e){const t=(0,h.getCurrentChainId)(e);return[I.CHAIN_IDS.MAINNET,I.CHAIN_IDS.BSC,I.CHAIN_IDS.POLYGON,I.CHAIN_IDS.AVALANCHE,I.CHAIN_IDS.LINEA_GOERLI,I.CHAIN_IDS.LINEA_SEPOLIA,I.CHAIN_IDS.LINEA_MAINNET,I.CHAIN_IDS.ARBITRUM,I.CHAIN_IDS.OPTIMISM,I.CHAIN_IDS.BASE,I.CHAIN_IDS.ZKSYNC_ERA,I.CHAIN_IDS.CRONOS,I.CHAIN_IDS.CELO,I.CHAIN_IDS.GNOSIS,I.CHAIN_IDS.FANTOM,I.CHAIN_IDS.POLYGON_ZKEVM,I.CHAIN_IDS.MOONBEAM,I.CHAIN_IDS.MOONRIVER,I.CHAIN_IDS.SEI].includes(t)}function yt(e){const t=ve(e);return!kt(e)&&t}function wt(e){const t=(0,h.getCurrentChainId)(e);return!I.CHAIN_ID_TO_RPC_URL_MAP[t]}n.getTokenDetectionSupportNetworkByChainId=e=>{switch((0,h.getCurrentChainId)(e)){case I.CHAIN_IDS.MAINNET:return I.MAINNET_DISPLAY_NAME;case I.CHAIN_IDS.BSC:return I.BSC_DISPLAY_NAME;case I.CHAIN_IDS.POLYGON:return I.POLYGON_DISPLAY_NAME;case I.CHAIN_IDS.AVALANCHE:return I.AVALANCHE_DISPLAY_NAME;case I.CHAIN_IDS.LINEA_GOERLI:return I.LINEA_GOERLI_DISPLAY_NAME;case I.CHAIN_IDS.LINEA_SEPOLIA:return I.LINEA_SEPOLIA_DISPLAY_NAME;case I.CHAIN_IDS.LINEA_MAINNET:return I.LINEA_MAINNET_DISPLAY_NAME;case I.CHAIN_IDS.ARBITRUM:return I.ARBITRUM_DISPLAY_NAME;case I.CHAIN_IDS.OPTIMISM:return I.OPTIMISM_DISPLAY_NAME;case I.CHAIN_IDS.BASE:return I.BASE_DISPLAY_NAME;case I.CHAIN_IDS.ZKSYNC_ERA:return I.ZK_SYNC_ERA_DISPLAY_NAME;case I.CHAIN_IDS.CRONOS:return I.CRONOS_DISPLAY_NAME;case I.CHAIN_IDS.CELO:return I.CELO_DISPLAY_NAME;case I.CHAIN_IDS.GNOSIS:return I.GNOSIS_DISPLAY_NAME;case I.CHAIN_IDS.FANTOM:return I.FANTOM_DISPLAY_NAME;case I.CHAIN_IDS.POLYGON_ZKEVM:return I.POLYGON_ZKEVM_DISPLAY_NAME;case I.CHAIN_IDS.MOONBEAM:return I.MOONBEAM_DISPLAY_NAME;case I.CHAIN_IDS.MOONRIVER:return I.MOONRIVER_DISPLAY_NAME;default:return""}};const Ot=n.getOrderedConnectedAccountsForActiveTab=(0,K.createDeepEqualSelector)(e=>e.activeTab,e=>e.metamask.permissionHistory,fe,qt,(e,t,n,a)=>{var r;const o=(null===(r=t[e.origin])||void 0===r||null===(r=r.eth_accounts)||void 0===r?void 0:r.accounts)||{},s=a.map(e=>{const{address:t}=(0,A.parseCaipAccountId)(e);return t});return n.filter(e=>s.includes(e.address)).map(e=>({...e,metadata:{...e.metadata,lastActive:null==o?void 0:o[e.address]}})).sort(({lastSelected:e},{lastSelected:t})=>e===t?0:e===undefined?1:t===undefined?-1:t-e)}),Rt=n.getUpdatedAndSortedAccounts=(0,K.createDeepEqualSelector)(fe,ht,_t,Ot,(e,t,n,a)=>{a.forEach(t=>{const n=e.find(e=>e.id===t.id);n&&t.metadata&&(n.connections=!0,n.lastSelected=t.metadata.lastSelected)});const r=e.filter(e=>e.connections&&e.lastSelected),o=r.length>0?r.reduce((e,t)=>e.lastSelected>t.lastSelected?e:t):null;e.forEach(e=>{e.pinned=Boolean(t.includes(e.address)),e.hidden=Boolean(n.includes(e.address)),e.active=Boolean(o&&e.id===o.id)});return[...null==t?void 0:t.map(t=>e.find(e=>e.address===t)).filter(e=>Boolean(e&&t.includes(e.address)&&!(null!=n&&n.includes(e.address)))),...e.filter(e=>!t.includes(e.address)&&!n.includes(e.address)),...e.filter(e=>n.includes(e.address))]});n.getUpdatedAndSortedAccountsWithCaipAccountId=(0,K.createDeepEqualSelector)(Rt,e=>e.map(e=>{const{namespace:t,reference:n}=(0,A.parseCaipChainId)(e.scopes[0]);return{...e,caipAccountId:`${t}:${n}:${e.address}`}}));function Mt(e){return Boolean(e.metamask.useCurrencyRateCheck)}n.useSafeChainsListValidationSelector=e=>e.metamask.useSafeChainsListValidation;n.getSelectedKeyringByIdOrDefault=(0,d.createSelector)(de,(e,t)=>t,(e,t)=>e.find(e=>e.metadata.id===t)??e[0]),n.getHdKeyringIndexByIdOrDefault=(0,d.createSelector)(le,(e,t)=>t,(e,t)=>e.findIndex(e=>e.metadata.id===t)??0);const vt=n.getKeyringOfSelectedAccount=(0,d.createSelector)(V.getSelectedInternalAccount,de,(e,t)=>t.find(t=>t.accounts.some(t=>(0,L.isEqualCaseInsensitive)(t,e.address))));n.getHdKeyringOfSelectedAccountOrPrimaryKeyring=(0,d.createSelector)(vt,le,(e,t)=>e.type===p.KeyringTypes.hd?e:t[0]),n.getPermissionSubjectsDeepEqual=(0,K.createDeepEqualSelector)(e=>e.metamask.subjects||{},e=>e),n.getSubjectMetadataDeepEqual=(0,K.createDeepEqualSelector)(e=>e.metamask.subjectMetadata,e=>e);function Dt(e){return e.metamask.subjects||{}}function bt(e,t){return xt(Gt(Yt(e,t)))}function Pt(e,t){return jt(Gt(Yt(e,t)))}function Bt(e,t){const n=Gt(Yt(e,t)),a=(0,E.getCaip25CaveatFromPermission)(n);return a?(0,E.getCaipAccountIdsFromCaip25CaveatValue)(a.value):[]}function Lt(e,t){const n=Gt(Yt(e,t));return n?(0,E.getAllScopesFromPermission)(n):[]}function Ut(e){return bt(e,Qe(e))}function Ft(e,t){return bt(e,t)}function qt(e){return Bt(e,Qe(e))}function Wt(e){const t=Dt(e);return Object.keys(t).reduce((e,n)=>{const a=Kt(t[n]);return a.length>0&&(e[n]=a),e},{})}function Ht(e){return e.metamask.subjectMetadata}n.isAccountConnectedToCurrentTab=(0,K.createDeepEqualSelector)(Ut,(e,t)=>t,(e,t)=>e.some(e=>e===t));function Gt(e={}){var t;return null===(t=e.permissions)||void 0===t?void 0:t[E.Caip25EndowmentPermissionName]}function Kt(e){return xt(Gt(e))}function xt(e){if(!e)return[];const t=(0,E.getCaip25CaveatFromPermission)(e);return t?(0,E.getEthAccounts)(t.value):[]}function jt(e){if(!e)return[];const t=(0,E.getCaip25CaveatFromPermission)(e);return t?(0,E.getPermittedEthChainIds)(t.value):[]}function Vt(e){for(const t of Object.keys(e.metamask.subjects))if("file://"===t||"http://localhost:5173"===t)return t;return null}function Yt(e,t){var n;const a=Vt(e);var r;return a?null===(r=e.metamask.subjects)||void 0===r?void 0:r[a]:t&&(null===(n=e.metamask.subjects)||void 0===n?void 0:n[t])}function $t(e,t){var n;const{metamask:{permissionHistory:a}}=e,r=null===(n=a[t.origin])||void 0===n||null===(n=n.eth_accounts)||void 0===n?void 0:n.accounts,o=fe(e),s=Ft(e,t);return o.filter(e=>s.includes(e.address)).filter(e=>(0,T.isEvmAccountType)(e.type)).map(e=>({...e,metadata:{...e.metadata,lastActive:null==r?void 0:r[e.address]}})).sort(({lastSelected:e},{lastSelected:t})=>e===t?0:e===undefined?1:t===undefined?-1:t-e)}function zt(e){return Object.values(e.metamask.pendingApprovals).filter(({type:e})=>"wallet_installSnap"===e||"wallet_updateSnap"===e||"wallet_installSnapResult"===e).map(({requestData:e})=>e)}function Qt(e){var t;return null===(t=(0,Q.getApprovalRequestsByType)(e,s.ApprovalType.WalletRequestPermissions))||void 0===t?void 0:t.map(({requestData:e})=>e)}}}},{package:"$root$",file:"ui/selectors/selectors.js"}],[6979,{"../../shared/constants/network":4989,"../../shared/constants/transaction":5006,"../../shared/modules/conversion.utils":5079,"../../shared/modules/selectors/networks":5096,"../../shared/modules/selectors/util":5098,"../helpers/constants/transactions":6167,"../helpers/utils/tx-helper":6208,"./accounts":6950,"./approvals":6952,"@metamask/controller-utils":1316,"@metamask/smart-transactions-controller/dist/types":1992,"@metamask/transaction-controller":2314,reselect:4538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.groupAndSortTransactionsByNonce=n.getUnapprovedTransactions=n.getTransactions=n.getCurrentNetworkTransactions=n.getApprovedAndSignedTransactions=n.getAllUnapprovedTransactions=n.getAllNetworkTransactions=void 0,n.hasTransactionPendingApprovals=function(e){return(0,E.getApprovalRequestsByType)(e,r.ApprovalType.Transaction).length>0||(0,E.hasPendingApprovals)(e,W)},n.nonceSortedTransactionsSelectorAllChains=n.nonceSortedTransactionsSelector=n.nonceSortedPendingTransactionsSelectorAllChains=n.nonceSortedPendingTransactionsSelector=n.nonceSortedCompletedTransactionsSelectorAllChains=n.nonceSortedCompletedTransactionsSelector=n.incomingTxListSelectorAllChains=n.incomingTxListSelector=void 0,n.selectTransactionMetadata=H,n.unapprovedTypedMessagesSelector=n.unapprovedPersonalMsgsSelector=n.unapprovedMessagesSelector=n.unapprovedEncryptionPublicKeyMsgsSelector=n.unapprovedDecryptMsgsSelector=n.transactionsSelectorAllChains=n.transactionsSelector=n.transactionSubSelectorAllChains=n.transactionSubSelector=n.submittedPendingTransactionsSelector=n.smartTransactionsListSelector=n.selectedAddressTxListSelectorAllChain=n.selectedAddressTxListSelector=n.selectTransactionSender=void 0;var a,r=e("@metamask/controller-utils"),o=e("reselect"),s=e("@metamask/transaction-controller"),i=e("@metamask/smart-transactions-controller/dist/types"),c=e("../helpers/constants/transactions"),u=(a=e("../helpers/utils/tx-helper"))&&a.__esModule?a:{default:a},d=e("../../shared/constants/transaction"),l=e("../../shared/modules/conversion.utils"),g=e("../../shared/modules/selectors/networks"),T=e("../../shared/modules/selectors/util"),S=e("../../shared/constants/network"),m=e("./accounts"),E=e("./approvals");const p=[s.TransactionType.cancel,s.TransactionType.retry],f=[i.SmartTransactionStatuses.PENDING,i.SmartTransactionStatuses.UNKNOWN,i.SmartTransactionStatuses.RESOLVED,i.SmartTransactionStatuses.CANCELLED],A=n.getTransactions=(0,T.createDeepEqualSelector)(e=>{const{transactions:t}=e.metamask??{};return null!=t&&t.length?[...t].sort((e,t)=>e.time-t.time):[]},e=>e),h=n.getAllNetworkTransactions=(0,T.createDeepEqualSelector)(A,e=>{if(!e.length)return[];const t=S.FEATURED_NETWORK_CHAIN_IDS;return e.filter(e=>t.includes(e.chainId))}),_=n.getCurrentNetworkTransactions=(0,T.createDeepEqualSelector)(e=>{const t=A(e);if(!t.length)return[];const{chainId:n}=(0,g.getProviderConfig)(e);return t.filter(e=>e.chainId===n)},e=>e),I=n.incomingTxListSelectorAllChains=(0,T.createDeepEqualSelector)(e=>{const t=h(e),{address:n}=(0,m.getSelectedInternalAccount)(e);return t.filter(e=>e.type===s.TransactionType.incoming&&e.txParams.to===n)},e=>e),N=(n.getUnapprovedTransactions=(0,T.createDeepEqualSelector)(e=>{const t=A(e);return(0,T.filterAndShapeUnapprovedTransactions)(t)},e=>e),n.getAllUnapprovedTransactions=(0,T.createDeepEqualSelector)(e=>{const{transactions:t}=e.metamask||[];if(null==t||!t.length)return[];const n=[...t].sort((e,t)=>e.time-t.time);return(0,T.filterAndShapeUnapprovedTransactions)(n)},e=>e),n.getApprovedAndSignedTransactions=(0,T.createDeepEqualSelector)(e=>A(e).filter(e=>[s.TransactionStatus.approved,s.TransactionStatus.signed].includes(e.status)),e=>e),n.incomingTxListSelector=(0,T.createDeepEqualSelector)(e=>{const t=_(e),{address:n}=(0,m.getSelectedInternalAccount)(e);return t.filter(e=>e.type===s.TransactionType.incoming&&e.txParams.to===n)},e=>e)),k=e=>e.metamask.unapprovedPersonalMsgs;n.unapprovedPersonalMsgsSelector=k;const C=e=>e.metamask.unapprovedDecryptMsgs;n.unapprovedDecryptMsgsSelector=C;const y=e=>e.metamask.unapprovedEncryptionPublicKeyMsgs;n.unapprovedEncryptionPublicKeyMsgsSelector=y;const w=e=>e.metamask.unapprovedTypedMessages;n.unapprovedTypedMessagesSelector=w;const O=e=>{var t;const{address:n}=(0,m.getSelectedInternalAccount)(e);return null===(t=e.metamask.smartTransactionsState)||void 0===t||null===(t=t.smartTransactions)||void 0===t||null===(t=t[(0,g.getCurrentChainId)(e)])||void 0===t?void 0:t.filter(e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.from)===n&&!e.confirmed&&(e.status===i.SmartTransactionStatuses.PENDING||(e.type===s.TransactionType.swap||e.type===s.TransactionType.swapApproval)&&f.includes(e.status))}).map(e=>{var t;return{...e,isSmartTransaction:!0,status:null!==(t=e.status)&&void 0!==t&&t.startsWith("cancelled")?d.SmartTransactionStatus.cancelled:e.status}})};n.smartTransactionsListSelector=O;const R=n.selectedAddressTxListSelectorAllChain=(0,o.createSelector)(m.getSelectedInternalAccount,h,O,(e,t=[],n=[])=>t.filter(({txParams:t})=>t.from===e.address).filter(({type:e})=>e!==s.TransactionType.incoming).concat(n)),M=n.selectedAddressTxListSelector=(0,o.createSelector)(m.getSelectedInternalAccount,_,O,(e,t=[],n=[])=>t.filter(({txParams:t})=>t.from===e.address).filter(({type:e})=>e!==s.TransactionType.incoming).concat(n)),v=n.unapprovedMessagesSelector=(0,o.createSelector)(k,C,y,w,g.getCurrentChainId,(e={},t={},n={},a={},r)=>(0,u.default)({},e,t,n,a,r)||[]),D=n.transactionSubSelectorAllChains=(0,o.createSelector)(v,I,(e=[],t=[])=>e.concat(t)),b=n.transactionSubSelector=(0,o.createSelector)(v,N,(e=[],t=[])=>e.concat(t)),P=n.transactionsSelector=(0,o.createSelector)(b,M,(e=[],t=[])=>[...t.concat(e)].sort((e,t)=>t.time-e.time)),B=n.transactionsSelectorAllChains=(0,o.createSelector)(D,R,(e=[],t=[])=>[...t.concat(e)].sort((e,t)=>t.time-e.time)),L=(e,t)=>{const{primaryTransaction:{time:n}={}}=t;let a=e.length;for(let t=0;t<e.length;t++){const r=e[t],{primaryTransaction:{time:o}={}}=r;if(o>n){a=t;break}}e.splice(a,0,t)},U=e=>{const t=[],n=[],a=[],r={};e.forEach(e=>{const{txParams:{nonce:o}={},status:i,type:u,time:d,txReceipt:g}=e;if(void 0===o||u===s.TransactionType.incoming){const a={transactions:[e],initialTransaction:e,primaryTransaction:e,hasRetried:!1,hasCancelled:!1,nonce:o};u===s.TransactionType.incoming?n.push(a):L(t,a)}else if(o in r){var T,S;const t=r[o];((e,t)=>{const{time:n}=t;let a=e.length;for(let t=0;t<e.length;t++)if(e[t].time>n){a=t;break}e.splice(a,0,t)})(t.transactions,e);const{primaryTransaction:{time:n=0}={},initialTransaction:{time:a=0}={}}=t,l={isOnChainFailure:"0x0"===(null==g?void 0:g.status),isEphemeral:i===s.TransactionStatus.failed&&"0x0"!==(null==g?void 0:g.status),isRetryOrCancel:p.includes(u),occurredAfterPrimary:d>n,hasPriorityStatus:i in c.PRIORITY_STATUS_HASH,isConfirmed:i===s.TransactionStatus.confirmed,occurredBeforeInitial:d<a,isValidRetry:u===s.TransactionType.retry&&(i in c.PRIORITY_STATUS_HASH||i===s.TransactionStatus.dropped),isValidCancel:u===s.TransactionType.cancel&&(i in c.PRIORITY_STATUS_HASH||i===s.TransactionStatus.dropped),eligibleForInitial:!p.includes(u)&&i!==s.TransactionStatus.failed,shouldBePrimary:i===s.TransactionStatus.confirmed||"0x0"===(null==g?void 0:g.status)},m={isEphemeral:t.primaryTransaction.status===s.TransactionStatus.failed&&"0x0"!==(null===(T=t.primaryTransaction)||void 0===T||null===(T=T.txReceipt)||void 0===T?void 0:T.status)},E={isEphemeral:t.initialTransaction.status===s.TransactionStatus.failed&&"0x0"!==(null===(S=t.initialTransaction.txReceipt)||void 0===S?void 0:S.status)};(l.shouldBePrimary||m.isEphemeral||l.occurredAfterPrimary&&l.hasPriorityStatus)&&(t.primaryTransaction=e),(l.occurredBeforeInitial&&l.eligibleForInitial||E.isEphemeral&&l.eligibleForInitial)&&(t.initialTransaction=e),l.isValidRetry&&(t.hasRetried=!0),l.isValidCancel&&(t.hasCancelled=!0)}else r[o]={nonce:o,transactions:[e],initialTransaction:e,primaryTransaction:e,hasRetried:u===s.TransactionType.retry&&(i in c.PRIORITY_STATUS_HASH||i===s.TransactionStatus.dropped),hasCancelled:u===s.TransactionType.cancel&&(i in c.PRIORITY_STATUS_HASH||i===s.TransactionStatus.dropped)},((e,t)=>{let n=e.length;for(let a=0;a<e.length;a++){const r=e[a];if(Number((0,l.hexToDecimal)(r))>Number((0,l.hexToDecimal)(t))){n=a;break}}e.splice(n,0,t)})(a,o)});const o=a.map(e=>r[e]);return((e,t)=>{t.forEach(t=>{L(e,t)})})(o,n),t.concat(o).map(e=>{var t;if(p.includes(null===(t=e.initialTransaction)||void 0===t?void 0:t.type)){const t=e.transactions.find(e=>!p.includes(e.type));if(t)return{...e,initialTransaction:t}}return e})};n.groupAndSortTransactionsByNonce=U;const F=n.nonceSortedTransactionsSelector=(0,o.createSelector)(P,(e=[])=>U(e)),q=n.nonceSortedTransactionsSelectorAllChains=(0,o.createSelector)(B,(e=[])=>U(e)),W=(n.nonceSortedPendingTransactionsSelectorAllChains=(0,o.createSelector)(q,(e=[])=>e.filter(({primaryTransaction:e})=>e.status in c.PENDING_STATUS_HASH)),n.nonceSortedCompletedTransactionsSelectorAllChains=(0,o.createSelector)(q,(e=[])=>e.filter(({primaryTransaction:e})=>!(e.status in c.PENDING_STATUS_HASH)).reverse()),n.nonceSortedPendingTransactionsSelector=(0,o.createSelector)(F,(e=[])=>e.filter(({primaryTransaction:e})=>e.status in c.PENDING_STATUS_HASH)),n.nonceSortedCompletedTransactionsSelector=(0,o.createSelector)(F,(e=[])=>e.filter(({primaryTransaction:e})=>!(e.status in c.PENDING_STATUS_HASH)).reverse()),n.submittedPendingTransactionsSelector=(0,o.createSelector)(P,(e=[])=>e.filter(e=>e.status===s.TransactionStatus.submitted)),[r.ApprovalType.EthDecrypt,r.ApprovalType.EthGetEncryptionPublicKey,r.ApprovalType.EthSignTypedData,r.ApprovalType.PersonalSign]);function H(e,t){return e.metamask.transactions.find(e=>e.id===t)}n.selectTransactionSender=(0,o.createSelector)((e,t)=>H(e,t),e=>{var t;return null==e||null===(t=e.txParams)||void 0===t?void 0:t.from})}}},{package:"$root$",file:"ui/selectors/transactions.js"}],[6980,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TOGGLE_NETWORK_MENU=n.TOGGLE_GAS_LOADING_ANIMATION=n.TOGGLE_CURRENCY_INPUT_SWITCH=n.TOGGLE_ACCOUNT_MENU=n.SHOW_SETTINGS_PAGE_ERROR=n.SHOW_SEND_TOKEN_PAGE=n.SHOW_PRIVATE_KEY=n.SHOW_PERMITTED_NETWORK_TOAST_OPEN=n.SHOW_PERMITTED_NETWORK_TOAST_CLOSE=n.SHOW_NFT_STILL_FETCHING_INDICATION=n.SHOW_NFT_DETECTION_ENABLEMENT_TOAST=n.SHOW_LOADING=n.SHOW_KEYRING_SNAP_REMOVAL_RESULT=n.SHOW_IPFS_MODAL_OPEN=n.SHOW_IPFS_MODAL_CLOSE=n.SHOW_CONF_TX_PAGE=n.SHOW_BASIC_FUNCTIONALITY_MODAL_OPEN=n.SHOW_BASIC_FUNCTIONALITY_MODAL_CLOSE=n.SHOW_ACCOUNTS_PAGE=n.SET_WEBHID_CONNECTED_STATUS=n.SET_SMART_TRANSACTIONS_ERROR=n.SET_SLIDES=n.SET_SHOW_SUPPORT_DATA_CONSENT_MODAL=n.SET_SHOW_PASSWORD_CHANGE_TOAST=n.SET_SHOW_NFT_AUTO_DETECT_MODAL_UPGRADE=n.SET_SHOW_NEW_SRP_ADDED_TOAST=n.SET_SHOW_COPY_ADDRESS_TOAST=n.SET_SHOW_CONNECTIONS_REMOVED=n.SET_SELECTED_NETWORK_CONFIGURATION_ID=n.SET_SELECTED_NETWORKS_FOR_DAPP_CONNECTIONS=n.SET_SELECTED_ACCOUNTS_FOR_DAPP_CONNECTIONS=n.SET_REQUEST_ACCOUNT_TABS=n.SET_REMOVE_NFT_MESSAGE=n.SET_PENDING_TOKENS=n.SET_PARTICIPATE_IN_METAMETRICS=n.SET_OPEN_METAMASK_TAB_IDS=n.SET_NEXT_NONCE=n.SET_NEW_TOKENS_IMPORTED_ERROR=n.SET_NEW_TOKENS_IMPORTED=n.SET_NEW_NFT_ADDED_MESSAGE=n.SET_NEW_NETWORK_ADDED=n.SET_LEDGER_TRANSPORT_STATUS=n.SET_HARDWARE_WALLET_DEFAULT_HD_PATH=n.SET_FIRST_TIME_FLOW_TYPE=n.SET_EDIT_NETWORK=n.SET_DATA_COLLECTION_FOR_MARKETING=n.SET_CUSTOM_TOKEN_AMOUNT=n.SET_CURRENT_LOCALE=n.SET_CONFIRMATION_EXCHANGE_RATES=n.SET_ACCOUNT_LABEL=n.SET_ACCOUNT_DETAILS_ADDRESS=n.SELECTED_ADDRESS_CHANGED=n.SELECTED_ACCOUNT_CHANGED=n.RESET_SOCIAL_LOGIN_ONBOARDING=n.RESET_ONBOARDING=n.QR_CODE_DETECTED=n.ONBOARDING_TOGGLE_BASIC_FUNCTIONALITY_ON=n.ONBOARDING_TOGGLE_BASIC_FUNCTIONALITY_OFF=n.ONBOARDED_IN_THIS_UI_SESSION=n.NETWORK_DROPDOWN_OPEN=n.NETWORK_DROPDOWN_CLOSE=n.MODAL_OPEN=n.MODAL_CLOSE=n.LOCK_METAMASK=n.LOADING_METHOD_DATA_STARTED=n.LOADING_METHOD_DATA_FINISHED=n.IMPORT_TOKENS_POPOVER_OPEN=n.IMPORT_TOKENS_POPOVER_CLOSE=n.IMPORT_NFTS_MODAL_OPEN=n.IMPORT_NFTS_MODAL_CLOSE=n.HIDE_WHATS_NEW_POPUP=n.HIDE_WARNING=n.HIDE_SETTINGS_PAGE_ERROR=n.HIDE_NFT_STILL_FETCHING_INDICATION=n.HIDE_LOADING=n.HIDE_KEYRING_SNAP_REMOVAL_RESULT=n.GO_HOME=n.GAS_FEE_ESTIMATES_UPDATED=n.DISPLAY_WARNING=n.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE=n.DEPRECATED_NETWORK_POPOVER_OPEN=n.DEPRECATED_NETWORK_POPOVER_CLOSE=n.DELETE_METAMETRICS_DATA_MODAL_OPEN=n.DELETE_METAMETRICS_DATA_MODAL_CLOSE=n.DATA_DELETION_ERROR_MODAL_OPEN=n.DATA_DELETION_ERROR_MODAL_CLOSE=n.CONNECT_ACCOUNTS_MODAL_OPEN=n.CONNECT_ACCOUNTS_MODAL_CLOSE=n.COMPLETE_ONBOARDING=n.COMPLETED_TX=n.CLOSE_WELCOME_SCREEN=n.CLEAR_SWAP_AND_SEND_STATE=n.CLEAR_PENDING_TOKENS=n.CLEAR_ACCOUNT_DETAILS=n.CHAIN_CHANGED=n.CAPTURE_SINGLE_EXCEPTION=n.ALERT_OPEN=n.ALERT_CLOSE=n.ADDRESS_BOOK_UPDATED=n.ACCOUNT_CHANGED=void 0,n.UPDATE_TRANSACTION_PARAMS=n.UPDATE_METAMASK_STATE=n.UPDATE_CUSTOM_NONCE=n.UNLOCK_SUCCEEDED=n.UNLOCK_IN_PROGRESS=n.UNLOCK_FAILED=n.TRANSACTION_ERROR=n.TOKEN_SORT_CRITERIA=void 0;n.GO_HOME="GO_HOME",n.MODAL_OPEN="UI_MODAL_OPEN",n.MODAL_CLOSE="UI_MODAL_CLOSE",n.SET_CONFIRMATION_EXCHANGE_RATES="SET_CONFIRMATION_EXCHANGE_RATES",n.ALERT_OPEN="UI_ALERT_OPEN",n.ALERT_CLOSE="UI_ALERT_CLOSE",n.QR_CODE_DETECTED="UI_QR_CODE_DETECTED",n.NETWORK_DROPDOWN_OPEN="UI_NETWORK_DROPDOWN_OPEN",n.NETWORK_DROPDOWN_CLOSE="UI_NETWORK_DROPDOWN_CLOSE",n.IMPORT_NFTS_MODAL_OPEN="UI_IMPORT_NFTS_MODAL_OPEN",n.IMPORT_NFTS_MODAL_CLOSE="UI_IMPORT_NFTS_MODAL_CLOSE",n.SHOW_IPFS_MODAL_OPEN="UI_IPFS_MODAL_OPEN",n.SHOW_PERMITTED_NETWORK_TOAST_OPEN="UI_PERMITTED_NETWORK_TOAST_OPEN",n.SHOW_PERMITTED_NETWORK_TOAST_CLOSE="UI_PERMITTED_NETWORK_TOAST_CLOSE",n.SHOW_IPFS_MODAL_CLOSE="UI_IPFS_MODAL_CLOSE",n.IMPORT_TOKENS_POPOVER_OPEN="UI_IMPORT_TOKENS_POPOVER_OPEN",n.IMPORT_TOKENS_POPOVER_CLOSE="UI_IMPORT_TOKENS_POPOVER_CLOSE",n.SHOW_BASIC_FUNCTIONALITY_MODAL_OPEN="SHOW_BASIC_FUNCTIONALITY_MODAL_OPEN",n.SHOW_BASIC_FUNCTIONALITY_MODAL_CLOSE="SHOW_BASIC_FUNCTIONALITY_MODAL_CLOSE",n.ONBOARDING_TOGGLE_BASIC_FUNCTIONALITY_ON="ONBOARDING_TOGGLE_BASIC_FUNCTIONALITY_ON",n.ONBOARDING_TOGGLE_BASIC_FUNCTIONALITY_OFF="ONBOARDING_TOGGLE_BASIC_FUNCTIONALITY_OFF",n.UPDATE_METAMASK_STATE="UPDATE_METAMASK_STATE",n.SELECTED_ADDRESS_CHANGED="SELECTED_ADDRESS_CHANGED",n.SELECTED_ACCOUNT_CHANGED="SELECTED_ACCOUNT_CHANGED",n.ACCOUNT_CHANGED="ACCOUNT_CHANGED",n.CHAIN_CHANGED="CHAIN_CHANGED",n.ADDRESS_BOOK_UPDATED="ADDRESS_BOOK_UPDATED",n.GAS_FEE_ESTIMATES_UPDATED="GAS_FEE_ESTIMATES_UPDATED",n.CLOSE_WELCOME_SCREEN="CLOSE_WELCOME_SCREEN",n.CLEAR_SWAP_AND_SEND_STATE="CLEAR_SWAP_AND_SEND_STATE",n.UNLOCK_IN_PROGRESS="UNLOCK_IN_PROGRESS",n.UNLOCK_FAILED="UNLOCK_FAILED",n.UNLOCK_SUCCEEDED="UNLOCK_SUCCEEDED",n.LOCK_METAMASK="LOCK_METAMASK",n.DISPLAY_WARNING="DISPLAY_WARNING",n.HIDE_WARNING="HIDE_WARNING",n.SHOW_SETTINGS_PAGE_ERROR="SHOW_SETTINGS_PAGE_ERROR",n.HIDE_SETTINGS_PAGE_ERROR="HIDE_SETTINGS_PAGE_ERROR",n.CAPTURE_SINGLE_EXCEPTION="CAPTURE_SINGLE_EXCEPTION",n.SHOW_ACCOUNTS_PAGE="SHOW_ACCOUNTS_PAGE",n.SHOW_CONF_TX_PAGE="SHOW_CONF_TX_PAGE",n.SHOW_SEND_TOKEN_PAGE="SHOW_SEND_TOKEN_PAGE",n.SHOW_PRIVATE_KEY="SHOW_PRIVATE_KEY",n.SET_ACCOUNT_LABEL="SET_ACCOUNT_LABEL",n.CLEAR_ACCOUNT_DETAILS="CLEAR_ACCOUNT_DETAILS",n.SET_ACCOUNT_DETAILS_ADDRESS="SET_ACCOUNT_DETAILS_ADDRESS",n.COMPLETED_TX="COMPLETED_TX",n.TRANSACTION_ERROR="TRANSACTION_ERROR",n.UPDATE_TRANSACTION_PARAMS="UPDATE_TRANSACTION_PARAMS",n.SET_NEXT_NONCE="SET_NEXT_NONCE",n.SET_HARDWARE_WALLET_DEFAULT_HD_PATH="SET_HARDWARE_WALLET_DEFAULT_HD_PATH",n.SHOW_LOADING="SHOW_LOADING_INDICATION",n.HIDE_LOADING="HIDE_LOADING_INDICATION",n.SHOW_NFT_STILL_FETCHING_INDICATION="SHOW_NFT_STILL_FETCHING_INDICATION",n.HIDE_NFT_STILL_FETCHING_INDICATION="HIDE_NFT_STILL_FETCHING_INDICATION",n.SHOW_NFT_DETECTION_ENABLEMENT_TOAST="SHOW_NFT_DETECTION_ENABLEMENT_TOAST",n.TOGGLE_ACCOUNT_MENU="TOGGLE_ACCOUNT_MENU",n.TOGGLE_NETWORK_MENU="TOGGLE_NETWORK_MENU",n.SET_SELECTED_ACCOUNTS_FOR_DAPP_CONNECTIONS="SET_SELECTED_ACCOUNTS_FOR_DAPP_CONNECTIONS",n.SET_SELECTED_NETWORKS_FOR_DAPP_CONNECTIONS="SET_SELECTED_NETWORKS_FOR_DAPP_CONNECTIONS",n.DEPRECATED_NETWORK_POPOVER_OPEN="DEPRECATED_NETWORK_POPOVER_OPEN",n.DEPRECATED_NETWORK_POPOVER_CLOSE="DEPRECATED_NETWORK_POPOVER_CLOSE",n.UPDATE_CUSTOM_NONCE="UPDATE_CUSTOM_NONCE",n.SET_PARTICIPATE_IN_METAMETRICS="SET_PARTICIPATE_IN_METAMETRICS",n.SET_DATA_COLLECTION_FOR_MARKETING="SET_DATA_COLLECTION_FOR_MARKETING",n.DELETE_METAMETRICS_DATA_MODAL_OPEN="DELETE_METAMETRICS_DATA_MODAL_OPEN",n.DELETE_METAMETRICS_DATA_MODAL_CLOSE="DELETE_METAMETRICS_DATA_MODAL_CLOSE",n.DATA_DELETION_ERROR_MODAL_OPEN="DELETE_METAMETRICS_DATA_ERROR_MODAL_OPEN",n.DATA_DELETION_ERROR_MODAL_CLOSE="DELETE_METAMETRICS_DATA_ERROR_MODAL_CLOSE",n.SET_CURRENT_LOCALE="SET_CURRENT_LOCALE",n.COMPLETE_ONBOARDING="COMPLETE_ONBOARDING",n.RESET_ONBOARDING="RESET_ONBOARDING",n.ONBOARDED_IN_THIS_UI_SESSION="ONBOARDED_IN_THIS_UI_SESSION",n.RESET_SOCIAL_LOGIN_ONBOARDING="RESET_SOCIAL_LOGIN_ONBOARDING",n.SET_WEBHID_CONNECTED_STATUS="SET_WEBHID_CONNECTED_STATUS",n.SET_LEDGER_TRANSPORT_STATUS="SET_LEDGER_TRANSPORT_STATUS",n.SET_PENDING_TOKENS="SET_PENDING_TOKENS",n.CLEAR_PENDING_TOKENS="CLEAR_PENDING_TOKENS",n.SET_FIRST_TIME_FLOW_TYPE="SET_FIRST_TIME_FLOW_TYPE",n.SET_SELECTED_NETWORK_CONFIGURATION_ID="SET_SELECTED_NETWORK_CONFIGURATION_ID",n.SET_NEW_NETWORK_ADDED="SET_NEW_NETWORK_ADDED",n.SET_EDIT_NETWORK="SET_EDIT_NETWORK",n.SET_NEW_NFT_ADDED_MESSAGE="SET_NEW_NFT_ADDED_MESSAGE",n.SET_REMOVE_NFT_MESSAGE="SET_REMOVE_NFT_MESSAGE",n.LOADING_METHOD_DATA_STARTED="LOADING_METHOD_DATA_STARTED",n.LOADING_METHOD_DATA_FINISHED="LOADING_METHOD_DATA_FINISHED",n.SET_REQUEST_ACCOUNT_TABS="SET_REQUEST_ACCOUNT_TABS",n.SET_OPEN_METAMASK_TAB_IDS="SET_OPEN_METAMASK_TAB_IDS",n.HIDE_WHATS_NEW_POPUP="HIDE_WHATS_NEW_POPUP",n.TOGGLE_GAS_LOADING_ANIMATION="TOGGLE_GAS_LOADING_ANIMATION",n.SET_SMART_TRANSACTIONS_ERROR="SET_SMART_TRANSACTIONS_ERROR",n.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE="DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE",n.TOGGLE_CURRENCY_INPUT_SWITCH="TOGGLE_CURRENCY_INPUT_SWITCH",n.SET_NEW_TOKENS_IMPORTED="SET_NEW_TOKENS_IMPORTED",n.SET_NEW_TOKENS_IMPORTED_ERROR="SET_NEW_TOKENS_IMPORTED_ERROR",n.SET_CUSTOM_TOKEN_AMOUNT="SET_CUSTOM_TOKEN_AMOUNT",n.CONNECT_ACCOUNTS_MODAL_OPEN="UI_CONNECT_ACCOUNTS_MODAL_OPEN",n.CONNECT_ACCOUNTS_MODAL_CLOSE="UI_CONNECT_ACCOUNTS_MODAL_CLOSE",n.SHOW_KEYRING_SNAP_REMOVAL_RESULT="SHOW_KEYRING_SNAP_REMOVAL_RESULT",n.HIDE_KEYRING_SNAP_REMOVAL_RESULT="HIDE_KEYRING_SNAP_REMOVAL_RESULT",n.SET_SHOW_NFT_AUTO_DETECT_MODAL_UPGRADE="SET_SHOW_NFT_AUTO_DETECT_MODAL_UPGRADE",n.TOKEN_SORT_CRITERIA="TOKEN_SORT_CRITERIA",n.SET_SLIDES="SET_SLIDES",n.SET_SHOW_NEW_SRP_ADDED_TOAST="SET_SHOW_NEW_SRP_ADDED_TOAST",n.SET_SHOW_PASSWORD_CHANGE_TOAST="SET_SHOW_PASSWORD_CHANGE_TOAST",n.SET_SHOW_COPY_ADDRESS_TOAST="SET_SHOW_COPY_ADDRESS_TOAST",n.SET_SHOW_SUPPORT_DATA_CONSENT_MODAL="SET_SHOW_SUPPORT_DATA_CONSENT_MODAL",n.SET_SHOW_CONNECTIONS_REMOVED="SET_SHOW_CONNECTIONS_REMOVED"}}},{package:"$root$",file:"ui/store/actionConstants.ts"}],[6981,{"../../app/scripts/lib/util":225,"../../shared/constants/app":4973,"../../shared/constants/hardware-wallets":4981,"../../shared/constants/metametrics":4986,"../../shared/lib/four-byte":5051,"../../shared/lib/sentry":5061,"../../shared/lib/switch-direction":5065,"../../shared/lib/trace":5067,"../../shared/modules/conversion.utils":5079,"../../shared/modules/error":5081,"../../shared/modules/hexstring-utils":5085,"../../shared/modules/i18n":5086,"../../shared/modules/selectors":5095,"../../shared/modules/selectors/networks":5096,"../../shared/modules/string-utils":5099,"../components/app/toast-master/utils":5537,"../ducks/alerts/unconnected-account":6127,"../ducks/metamask/metamask":6143,"../ducks/send":6148,"../helpers/constants/notifications":6159,"../pages/confirmations/selectors/preferences":6681,"../pages/swaps/swaps.util":6939,"../selectors":6959,"./actionConstants":6980,"./background-connection":6982,"@metamask/chain-agnostic-permission":1296,"@metamask/profile-sync-controller/sdk":1882,"@metamask/rpc-errors":1955,"@metamask/snaps-utils":2242,buffer:3316,lodash:4086,loglevel:4094,"webextension-polyfill":4949},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.abortTransactionSigning=function(e){return async t=>{try{await(0,P.submitRequestToBackground)("abortTransactionSigning",[e])}catch(e){t(le(e))}}},n.accountTrackerStartPolling=async function(e){const t=await(0,P.submitRequestToBackground)("accountTrackerStartPolling",[e]);return await Ie(t),t},n.accountTrackerStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("accountTrackerStopPollingByPollingToken",[e]),await Ne(e)},n.addImportedTokens=function(e,t){return async n=>{try{await(0,P.submitRequestToBackground)("addImportedTokens",[e,t])}catch(e){(0,w.logErrorWithMessage)(e)}finally{await Ee(n)}}},n.addNetwork=function(e){return async t=>{r.default.debug("background.addNetwork",e);try{return await(0,P.submitRequestToBackground)("addNetwork",[e])}catch(e){(0,w.logErrorWithMessage)(e),t(le("Had a problem adding networks!"))}return undefined}},n.addNewAccount=function(e,t=!0){return r.default.debug("background.addNewAccount"),async(n,a)=>{const o=(0,S.getMetaMaskHdKeyrings)(a()),[s]=o;let i=s;if(e&&(i=o.find(t=>t.metadata.id===e)),!i)throw r.default.error("Should never reach this. There is always a keyring"),new Error("Keyring not found");const c=i.accounts;let u;t&&n(ie());try{const t=await(0,P.submitRequestToBackground)("addNewAccount",[c.length,e]);await Ee(n);const r=a();u=(0,S.getInternalAccountByAddress)(r,t)}catch(e){throw n(le(e)),e}finally{t&&n(ue())}return u}},n.addNft=function(e,t,n,a){return async r=>{if(!e)throw new Error("MetaMask - Cannot add NFT without address");if(!t)throw new Error("MetaMask - Cannot add NFT without tokenID");a||r(ie());try{await(0,P.submitRequestToBackground)("addNft",[e,t,n])}catch(e){(0,w.logErrorWithMessage)(e),r(le(e))}finally{await Ee(r),r(ue())}}},n.addNftVerifyOwnership=function(e,t,n,a){return async r=>{if(!e)throw new Error("MetaMask - Cannot add NFT without address");if(!t)throw new Error("MetaMask - Cannot add NFT without tokenID");if(!n)throw new Error("MetaMask - Cannot add NFT without a networkClientId");a||r(ie());try{await(0,P.submitRequestToBackground)("addNftVerifyOwnership",[e,t,n])}catch(e){if((0,w.isErrorWithMessage)(e)){const t=(0,w.getErrorMessage)(e);if(t.includes("This NFT is not owned by the user")||t.includes("Unable to verify ownership"))throw e;(0,w.logErrorWithMessage)(e),r(le(e))}}finally{await Ee(r),r(ue())}}},n.addPermittedAccount=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("addPermittedAccount",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.addPermittedAccounts=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("addPermittedAccounts",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.addPermittedChain=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("addPermittedChain",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.addPermittedChains=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("addPermittedChains",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.addPollingTokenToAppState=Ie,n.addToAddressBook=function(e,t="",n="",a){return r.default.debug("background.addToAddressBook"),async(r,o)=>{const s=a||(0,m.getProviderConfig)(o()).chainId;let i;try{i=await(0,P.submitRequestToBackground)("setAddressBook",[(0,A.toChecksumHexAddress)(e),t,s,n]),await Ee(r)}catch(e){throw(0,w.logErrorWithMessage)(e),r(le("Address book failed to update")),e}i||r(le("Address book failed to update"))}},n.addToken=function({address:e,symbol:t,decimals:n,image:a,networkClientId:r},o){return async s=>{if(!e)throw new Error("MetaMask - Cannot add token without address");o||s(ie());try{await(0,P.submitRequestToBackground)("addToken",[{address:e,symbol:t,decimals:n,image:a,networkClientId:r}])}catch(e){(0,w.logErrorWithMessage)(e),s(le(e))}finally{await Ee(s),s(ue())}}},n.addTransaction=async function(e,t){r.default.debug("background.addTransaction");const n=(0,P.generateActionId)();return await(0,P.submitRequestToBackground)("addTransaction",[e,{...t,origin:g.ORIGIN_METAMASK,actionId:n}])},n.addTransactionAndRouteToConfirmationPage=function(e,t){return async n=>{const a=(0,P.generateActionId)();try{r.default.debug("background.addTransaction");const o=await(0,P.submitRequestToBackground)("addTransaction",[e,{...t,actionId:a,origin:g.ORIGIN_METAMASK}]);return n(ae()),o}catch(e){throw n(ue()),n(le(e)),e}}},n.addTransactionAndWaitForPublish=async function(e,t){r.default.debug("background.addTransactionAndWaitForPublish");const n=(0,P.generateActionId)();return await(0,P.submitRequestToBackground)("addTransactionAndWaitForPublish",[e,{...t,origin:g.ORIGIN_METAMASK,actionId:n}])},n.applyTransactionContainersExisting=async function(e,t){return await(0,P.submitRequestToBackground)("applyTransactionContainersExisting",[e,t])},n.approvePermissionsRequest=function(e){return t=>{(0,P.callBackgroundMethod)("approvePermissionsRequest",[e],e=>{e&&t(le(e)),Ee(t)})}},n.attemptCloseNotificationPopup=ke,n.attemptLedgerTransportCreation=async function(){return await(0,P.submitRequestToBackground)("attemptLedgerTransportCreation")},n.automaticallySwitchNetwork=function(e){return async t=>{await t(re(e)),await Ee(t)}},n.backupUserData=async function(){let e;try{e=await(0,P.submitRequestToBackground)("backupUserData")}catch(e){throw(0,w.logErrorWithMessage)(e),e}return e},n.cancelDecryptMsg=function(e){return async t=>{t(ie());try{await(0,P.submitRequestToBackground)("cancelDecryptMessage",[e.id])}finally{t(ue())}return await Ee(t),t(j(e.id)),t(se()),e}},n.cancelEncryptionPublicKeyMsg=function(e){return async t=>{t(ie());try{await(0,P.submitRequestToBackground)("cancelEncryptionPublicKey",[e.id])}finally{t(ue())}return await Ee(t),t(j(e.id)),t(se()),e}},n.cancelQRHardwareSignRequest=function(){return async e=>{e(ue()),await(0,P.submitRequestToBackground)("cancelQRHardwareSignRequest")}},n.cancelSmartTransaction=function(e){return async t=>{try{await(0,P.submitRequestToBackground)("cancelSmartTransaction",[e])}catch(e){if((0,w.logErrorWithMessage)(e),(0,w.isErrorWithMessage)(e)){const n=(0,w.getErrorMessage)(e);if(n.startsWith("Fetch error:")){const e=(0,I.parseSmartTransactionsError)(n);t({type:b.SET_SMART_TRANSACTIONS_ERROR,payload:e})}}throw e}}},n.cancelSyncQRHardware=function(){return async e=>{e(ue()),await(0,P.submitRequestToBackground)("cancelSyncQRHardware")}},n.cancelTx=function(e,t=!0){return n=>(t&&n(ie()),new Promise((t,n)=>{(0,P.callBackgroundMethod)("rejectPendingApproval",[String(e.id),s.providerErrors.userRejectedRequest().serialize()],e=>{e?n(e):t()})}).then(()=>Ee(n)).then(()=>(n((0,E.resetSendState)()),n(j(e.id)),n(ue()),n(se()),e)).catch(e=>{throw n(ue()),e}))},n.cancelTxs=function(e){return async t=>{t(ie());try{const n=e.map(({id:e})=>e),a=n.map(e=>new Promise((t,n)=>{(0,P.callBackgroundMethod)("rejectPendingApproval",[String(e),s.providerErrors.userRejectedRequest().serialize()],e=>{e?n(e):t()})}));await Promise.all(a),await Ee(t),t((0,E.resetSendState)()),n.forEach(e=>{t(j(e))})}finally{(0,T.getEnvironmentType)()===g.ENVIRONMENT_TYPE_NOTIFICATION?ke():t(ue())}}},n.captureSingleException=function(e){return async(t,n)=>{const{singleExceptions:a}=n().appState;e in a||(t({type:b.CAPTURE_SINGLE_EXCEPTION,value:e}),(0,d.captureException)(Error(e)))}},n.captureTestBackgroundError=async function(e){await(0,P.submitRequestToBackground)("captureTestError",[e])},n.changePassword=function(e,t){return async n=>{try{await(0,P.submitRequestToBackground)("changePassword",[e,t])}catch(e){throw n(le(e)),e}}},n.checkAccountsPresence=function(e){return async()=>{try{return await(0,P.submitRequestToBackground)("checkAccountsPresence",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.checkAndUpdateAllNftsOwnershipStatus=async function(e){await(0,P.submitRequestToBackground)("checkAndUpdateAllNftsOwnershipStatus",[e])},n.checkAndUpdateSingleNftOwnershipStatus=async function(e,t){await(0,P.submitRequestToBackground)("checkAndUpdateSingleNftOwnershipStatus",[e,!1,t])},n.checkHardwareStatus=function(e,t){return r.default.debug("background.checkHardwareStatus",e,t),async n=>{n(ie());let a=!1;try{a=await(0,P.submitRequestToBackground)("checkHardwareStatus",[e,t])}catch(e){throw(0,w.logErrorWithMessage)(e),n(le(e)),e}finally{n(ue())}return await Ee(n),a}},n.checkIsSeedlessPasswordOutdated=function(e=!0){return async t=>{let n=!1;try{n=await(0,P.submitRequestToBackground)("checkIsSeedlessPasswordOutdated",[e]),n&&await Ee(t)}catch(e){r.default.warn("checkIsSeedlessPasswordOutdated error",e)}return n}},n.clearAccountDetails=function(){return{type:b.CLEAR_ACCOUNT_DETAILS}},n.clearPendingTokens=function(){return{type:b.CLEAR_PENDING_TOKENS}},n.clearSmartTransactionFees=function(){(0,P.submitRequestToBackground)("clearSmartTransactionFees")},n.clearSwapsQuotes=function(){return async e=>{await(0,P.submitRequestToBackground)("clearSwapsQuotes"),await Ee(e)}},n.closeCurrentNotificationWindow=se,n.closeWelcomeScreen=function(){return{type:b.CLOSE_WELCOME_SCREEN}},n.completeOnboarding=Se,n.completedTx=j,n.connectHardware=function(e,t,n,a,s){return r.default.debug("background.connectHardware",e,t,n),async(r,i)=>{const{ledgerTransportType:c}=i().metamask;let u;r(ie(`Looking for your ${(0,o.capitalize)(e)}...`));try{if(a&&e===h.HardwareDeviceNames.ledger&&c===h.LedgerTransportTypes.webhid){const e=!1;let t=[];e||(t=await window.navigator.hid.requestDevice({filters:[{vendorId:h.LEDGER_USB_VENDOR_ID}]}));if(!(e||t.some(e=>e.vendorId===Number(h.LEDGER_USB_VENDOR_ID))))throw new Error(s("ledgerWebHIDNotConnectedErrorMessage"))}u=await(0,P.submitRequestToBackground)("connectHardware",[e,t,n])}catch(t){(0,w.logErrorWithMessage)(t);const n=(0,w.getErrorMessage)(t);throw e===h.HardwareDeviceNames.ledger&&c===h.LedgerTransportTypes.webhid&&(0,w.isErrorWithMessage)(t)&&n.match("Failed to open the device")?(r(le(s("ledgerDeviceOpenFailureMessage"))),new Error(s("ledgerDeviceOpenFailureMessage"))):(e!==h.HardwareDeviceNames.qr&&r(le(t)),t)}finally{r(ue())}return await Ee(r),u}},n.createCancelTransaction=function(e,t,n={}){let a;return r.default.debug("background.createCancelTransaction"),r=>{const o=(0,P.generateActionId)();return new Promise((s,i)=>{(0,P.callBackgroundMethod)("createCancelTransaction",[e,t,{...n,actionId:o}],(t,n)=>{var o;if(t)return null!=t&&null!==(o=t.message)&&void 0!==o&&o.includes("Previous transaction is already confirmed")&&r(oe({name:"TRANSACTION_ALREADY_CONFIRMED",originalTransactionId:e})),r(le(t)),void i(t);if(n){const e=(0,S.getCurrentNetworkTransactions)({metamask:n}),{id:t}=e[e.length-1];a=t,s()}})}).then(()=>Ee(r)).then(()=>a)}},n.createEventFragment=function(e){const t=(0,P.generateActionId)();return(0,P.submitRequestToBackground)("createEventFragment",[{...e,actionId:t}])},n.createMetaMetricsDataDeletionTask=async function(){return await(0,P.submitRequestToBackground)("createMetaMetricsDataDeletionTask")},n.createNewVault=H,n.createNewVaultAndGetSeedPhrase=function(e){return async t=>{try{await H(e);return await K(e)}catch(e){throw t(le(e)),(0,w.isErrorWithMessage)(e)?new Error((0,w.getErrorMessage)(e)):e}}},n.createNewVaultAndRestore=function(e,n){return a=>{a(ie()),r.default.debug("background.createNewVaultAndRestore");const o=Array.from(t.from(n,"utf8").values());return new Promise((t,n)=>{(0,P.callBackgroundMethod)("createNewVaultAndRestore",[e,o],e=>{e?n(e):t()})}).then(()=>a($())).then(()=>{a(ne()),a(ue())}).catch(e=>(a(le(e)),a(ue()),Promise.reject(e)))}},n.createNewVaultAndSyncWithSocial=function(e){return async t=>{try{const n=await H(e);if(!n)throw new Error("No keyring found");const a=await K(e);return await W(e,a,n.metadata.id),t(ge()),a}catch(e){throw t(le(e)),(0,w.isErrorWithMessage)(e)?new Error((0,w.getErrorMessage)(e)):e}}},n.createOnChainTriggers=function(){return async()=>{try{await(0,P.submitRequestToBackground)("createOnChainTriggers")}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.createRetryTransaction=function(e,t){let n;return a=>new Promise((r,o)=>{const s=(0,P.generateActionId)();(0,P.callBackgroundMethod)("createSpeedUpTransaction",[e,t,{actionId:s}],(e,t)=>{if(e)return a(le(e)),void o(e);if(t){const e=(0,S.getCurrentNetworkTransactions)(t);n=e[e.length-1],r()}})}).then(()=>Ee(a)).then(()=>n)},n.createSeedPhraseBackup=W,n.createSnapAccount=async function(e,t,n){return await(0,P.submitRequestToBackground)("createSnapAccount",[e,t,n])},n.createSpeedUpTransaction=function(e,t,n={}){let a;return r.default.debug("background.createSpeedUpTransaction"),r=>{const o=(0,P.generateActionId)();return new Promise((s,i)=>{(0,P.callBackgroundMethod)("createSpeedUpTransaction",[e,t,{...n,actionId:o}],(e,t)=>{if(e)return r(le(e)),void i(e);if(t){const e=(0,S.getCurrentNetworkTransactions)(t);a=e[e.length-1],s()}})}).then(()=>Ee(r)).then(()=>a)}},n.createTransactionEventFragment=function(e){const t=(0,P.generateActionId)();return(0,P.submitRequestToBackground)("createTransactionEventFragment",[{transactionId:e,actionId:t}])},n.currencyRateStartPolling=async function(e){const t=await(0,P.submitRequestToBackground)("currencyRateStartPolling",[{nativeCurrencies:e}]);return await Ie(t),t},n.currencyRateStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("currencyRateStopPollingByPollingToken",[e]),await Ne(e)},n.decodeTransactionData=async function({transactionData:e,contractAddress:t,chainId:n}){return await(0,P.submitRequestToBackground)("decodeTransactionData",[{transactionData:e,contractAddress:t,chainId:n}])},n.decryptMsg=function(e){return r.default.debug("action - decryptMsg"),async t=>{t(ie()),r.default.debug("actions calling background.decryptMessage");try{await(0,P.submitRequestToBackground)("decryptMessage",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),t(le(e)),e}finally{t(ue())}return await Ee(t),t(j(e.metamaskId)),t(se()),e}},n.decryptMsgInline=function(e){return r.default.debug("action - decryptMsgInline"),async t=>{r.default.debug("actions calling background.decryptMessageInline");try{await(0,P.submitRequestToBackground)("decryptMessageInline",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),t(le(e)),e}return(await Ee(t)).unapprovedDecryptMsgs[e.metamaskId]}},n.deleteAccountSyncingDataFromUserStorage=function(){return async()=>{try{return await(0,P.submitRequestToBackground)("deleteAccountSyncingDataFromUserStorage",[i.USER_STORAGE_FEATURE_NAMES.accounts])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.deleteExpiredNotifications=function(){return async(e,t)=>{const n=t().metamask.metamaskNotificationsList.filter(e=>{const t=new Date(Date.now()-M.NOTIFICATIONS_EXPIRATION_DELAY);return Boolean(e.readDate&&new Date(e.readDate)<t)}).map(({id:e})=>e);n.length&&(await(0,P.submitRequestToBackground)("deleteNotificationsById",[n]),await Ee(e))}},n.deleteInterface=function(e){return async t=>{await(0,P.submitRequestToBackground)("deleteInterface",[e]),await Ee(t)}},n.deleteNotificationsById=function(e){return async()=>{try{return await(0,P.submitRequestToBackground)("deleteNotificationsById",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.detectNfts=function(e){return async t=>{t(ce()),r.default.debug("background.detectNfts");try{await(0,P.submitRequestToBackground)("detectNfts",[e])}finally{t(de())}await Ee(t)}},n.detectTokens=function(){return async e=>{e(ie()),r.default.debug("background.detectTokens"),await(0,P.submitRequestToBackground)("detectTokens"),e(ue()),await Ee(e)}},n.disableAccounts=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("disableAccounts",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.disableMetamaskNotifications=function(){return async()=>{try{await(0,P.submitRequestToBackground)("disableMetamaskNotifications")}catch(e){throw r.default.error(e),e}}},n.disableSnap=function(e){return async t=>{await(0,P.submitRequestToBackground)("disableSnap",[e]),await Ee(t)}},n.disconnectOriginFromSnap=function(e,t){return async n=>{await(0,P.submitRequestToBackground)("disconnectOriginFromSnap",[e,t]),await Ee(n)}},n.dismissSmartTransactionsErrorMessage=function(){return{type:b.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE}},n.displayWarning=le,n.enableAccounts=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("enableAccounts",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.enableMetamaskNotifications=function(){return async()=>{try{await(0,P.submitRequestToBackground)("enableMetamaskNotifications")}catch(e){throw r.default.error(e),e}}},n.enableSnap=function(e){return async t=>{await(0,P.submitRequestToBackground)("enableSnap",[e]),await Ee(t)}},n.encryptionPublicKeyMsg=function(e){return r.default.debug("action - encryptionPublicKeyMsg"),async t=>{t(ie()),r.default.debug("actions calling background.encryptionPublicKey");try{await(0,P.submitRequestToBackground)("encryptionPublicKey",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),t(le(e)),e}finally{t(ue())}return await Ee(t),t(j(e.metamaskId)),t(se()),e}},n.endBackgroundTrace=async function(e){const t=e.timestamp||performance.timeOrigin+performance.now();await(0,P.submitRequestToBackground)("endTrace",[{...e,timestamp:t}])},n.estimateGas=function(e){return(0,P.submitRequestToBackground)("estimateGas",[e])},n.exportAccount=function(e,t,n,a){return function(o){return o(ie()),r.default.debug("background.verifyPassword"),new Promise((s,i)=>{(0,P.callBackgroundMethod)("verifyPassword",[e],function(c){if(c)return r.default.error("Error in verifying password."),o(ue()),o(le("Incorrect Password.")),void i(c);r.default.debug("background.exportAccount"),(0,P.callBackgroundMethod)("exportAccount",[t,e],function(e,t){if(o(ue()),e)return(0,w.logErrorWithMessage)(e),o(le("Had a problem exporting the account.")),void i(e);n(t),a(!0),s(t)})})})}},n.exportAccounts=function(e,t){return function(n){return r.default.debug("background.verifyPassword"),new Promise((a,o)=>{(0,P.callBackgroundMethod)("verifyPassword",[e],function(s){if(s)return r.default.error("Error in submitting password."),void o(s);r.default.debug("background.exportAccounts");const i=t.map(t=>new Promise((a,r)=>(0,P.callBackgroundMethod)("exportAccount",[t,e],function(e,t){if(e)return(0,w.logErrorWithMessage)(e),n(le("Had a problem exporting the account.")),void r(e);a(t)})));a(Promise.all(i))})})}},n.fetchAndSetQuotes=function(e,t){return async n=>{const[a,r]=await(0,R.trace)({name:R.TraceName.SwapQuotesFetched},async()=>await(0,P.submitRequestToBackground)("fetchAndSetQuotes",[e,t]));return await Ee(n),[a,r]}},n.fetchAndUpdateMetamaskNotifications=function(e){return async()=>{try{return await(0,P.submitRequestToBackground)("fetchAndUpdateMetamaskNotifications",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.fetchHistoricalPricesForAsset=function(e){return async t=>{r.default.debug("background.fetchHistoricalPricesForAsset"),await(0,P.submitRequestToBackground)("fetchHistoricalPricesForAsset",[e]),await Ee(t)}},n.fetchSmartTransactionFees=function(e,t){return async n=>{t&&(t.value="0x0");try{const a=await await(0,P.submitRequestToBackground)("fetchSmartTransactionFees",[e,t]);return n({type:b.SET_SMART_TRANSACTIONS_ERROR,payload:null}),a}catch(e){if((0,w.logErrorWithMessage)(e),(0,w.isErrorWithMessage)(e)){const t=(0,w.getErrorMessage)(e);if(t.startsWith("Fetch error:")){const e=(0,I.parseSmartTransactionsError)(t);n({type:b.SET_SMART_TRANSACTIONS_ERROR,payload:e})}}throw e}}},n.fetchSmartTransactionsLiveness=function({networkClientId:e}={}){return async()=>{try{await(0,P.submitRequestToBackground)("fetchSmartTransactionsLiveness",[{networkClientId:e}])}catch(e){(0,w.logErrorWithMessage)(e)}}},n.finalizeEventFragment=function(e,t){return(0,P.submitRequestToBackground)("finalizeEventFragment",[e,t])},n.forceUpdateMetamaskState=Ee,n.forgetDevice=function(e){return r.default.debug("background.forgetDevice",e),async t=>{t(ie());try{await(0,P.submitRequestToBackground)("forgetDevice",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),t(le(e)),e}finally{t(ue())}await Ee(t)}},n.gasFeeStartPollingByNetworkClientId=async function(e){const t=await(0,P.submitRequestToBackground)("gasFeeStartPolling",[{networkClientId:e}]);return await Ie(t),t},n.gasFeeStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("gasFeeStopPollingByPollingToken",[e]),await Ne(e)},n.generateNewMnemonicAndAddToVault=function(){return e=>(e(ie()),r.default.debug("background.generateNewMnemonicAndAddToVault"),new Promise((e,t)=>{(0,P.callBackgroundMethod)("generateNewMnemonicAndAddToVault",[],n=>{n?t(n):e()})}).then(async()=>{e(ue())}).catch(t=>(e(le(t)),e(ue()),Promise.reject(t))))},n.getBalancesInSingleCall=async function(e,t,n){return await(0,P.submitRequestToBackground)("getBalancesInSingleCall",[e,t,n])},n.getCode=async function(e,t){return await(0,P.submitRequestToBackground)("getCode",[e,t])},n.getContractMethodData=function(e=""){return async(t,n)=>{const a=(0,T.addHexPrefix)(e).slice(0,10);if(a.length<10)return{};const{knownMethodData:o,use4ByteResolution:s}=n().metamask;if(null!=o&&o[a]&&0!==Object.keys(o[a]).length)return o[a];r.default.debug("loadingMethodData");const{name:i,params:c}=await(0,O.getMethodDataAsync)(a,s);return(0,P.callBackgroundMethod)("addKnownMethodData",[a,{name:i,params:c}],e=>{e&&t(le(e))}),{name:i,params:c}}},n.getCurrentNetworkEIP1559Compatibility=async function(){let e;try{e=await(0,P.submitRequestToBackground)("getCurrentNetworkEIP1559Compatibility")}catch(e){console.error(e)}return e},n.getGasFeeTimeEstimate=function(e,t){return(0,P.submitRequestToBackground)("getGasFeeTimeEstimate",[e,t])},n.getLastInteractedConfirmationInfo=async function(){return await(0,P.submitRequestToBackground)("getLastInteractedConfirmationInfo")},n.getLayer1GasFee=function({chainId:e,networkClientId:t,transactionParams:n}){return async()=>await(0,P.submitRequestToBackground)("getLayer1GasFee",[{chainId:e,networkClientId:t,transactionParams:n}])},n.getNFTContractInfo=async function(e,t){return await(0,P.submitRequestToBackground)("getNFTContractInfo",[e,t])},n.getNetworkConfigurationByNetworkClientId=async function(e){let t;try{t=await(0,P.submitRequestToBackground)("getNetworkConfigurationByNetworkClientId",[e])}catch(e){console.error(e)}return t},n.getNetworksWithTransactionActivityByAccounts=function(){return async()=>{r.default.debug("background.getNetworksWithTransactionActivityByAccounts");try{return await(0,P.submitRequestToBackground)("getNetworksWithTransactionActivityByAccounts")}catch(e){throw(0,w.logErrorWithMessage)(e),new Error("Had a problem getting networks with activity by accounts!")}}},n.getNextAvailableAccountName=async function(e){return await(0,P.submitRequestToBackground)("getNextAvailableAccountName",[e])},n.getNextNonce=function(e){return async(t,n)=>{const a=(0,m.getSelectedNetworkClientId)(n());let r;try{r=await(0,P.submitRequestToBackground)("getNextNonce",[e,a])}catch(e){throw t(le(e)),e}return t(Ae(r)),r}},n.getOpenMetamaskTabsIds=function(){return async e=>{e(_e(await(0,P.submitRequestToBackground)("getOpenMetamaskTabsIds")))}},n.getPhishingResult=async function(e){return await(0,P.submitRequestToBackground)("getPhishingResult",[e])},n.getRequestAccountTabIds=function(){return async e=>{e(he(await(0,P.submitRequestToBackground)("getRequestAccountTabIds")))}},n.getRpcMethodPreferences=function(){return async e=>{e(ie()),await(0,P.submitRequestToBackground)("getRpcMethodPreferences",[]),e(ue())}},n.getSeedPhrase=K,n.getSnapAccountsById=async function(e){return await(0,P.submitRequestToBackground)("getAccountsBySnapId",[e])},n.getTokenStandardAndDetails=async function(e,t,n){return await(0,P.submitRequestToBackground)("getTokenStandardAndDetails",[e,t,n])},n.getTokenStandardAndDetailsByChain=async function(e,t,n,a){return await(0,P.submitRequestToBackground)("getTokenStandardAndDetailsByChain",[e,t,n,a])},n.getTokenSymbol=async function(e){return await(0,P.submitRequestToBackground)("getTokenSymbol",[e])},n.getTransactions=async function(e={}){return await(0,P.submitRequestToBackground)("getTransactions",[e])},n.getUserProfileMetaMetrics=async function(){try{return await(0,P.submitRequestToBackground)("getUserProfileMetaMetrics")}catch(e){return(0,w.logErrorWithMessage)(e),undefined}},n.goHome=U,n.handleSnapRequest=Y,n.hideAccountBanner=function(){return(0,P.submitRequestToBackground)("setShowAccountBanner",[!1])},n.hideAlert=function(){return{type:b.ALERT_CLOSE}},n.hideBetaHeader=function(){return(0,P.submitRequestToBackground)("setShowBetaHeader",[!1])},n.hideDeprecatedNetworkModal=function(){return{type:b.DEPRECATED_NETWORK_POPOVER_CLOSE}},n.hideImportNftsModal=function(){return{type:b.IMPORT_NFTS_MODAL_CLOSE}},n.hideImportTokensModal=function(){return{type:b.IMPORT_TOKENS_POPOVER_CLOSE}},n.hideIpfsModal=function(){return{type:b.SHOW_IPFS_MODAL_CLOSE}},n.hideKeyringRemovalResultModal=function(){return{type:b.HIDE_KEYRING_SNAP_REMOVAL_RESULT}},n.hideLoadingIndication=ue,n.hideModal=function(){return{type:b.MODAL_CLOSE}},n.hideNetworkBanner=function(){return(0,P.submitRequestToBackground)("setShowNetworkBanner",[!1])},n.hideNetworkDropdown=function(){return{type:b.NETWORK_DROPDOWN_CLOSE}},n.hideNftStillFetchingIndication=de,n.hidePermissionsTour=function(){return(0,P.submitRequestToBackground)("setShowPermissionsTour",[!1])},n.hidePermittedNetworkToast=function(){return{type:b.SHOW_PERMITTED_NETWORK_TOAST_CLOSE}},n.hideTestNetMessage=function(){return(0,P.submitRequestToBackground)("setShowTestnetMessageInDropdown",[!1])},n.hideWarning=ge,n.ignoreTokens=function({tokensToIgnore:e,dontShowLoadingIndicator:t=!1,networkClientId:n=null}){const a=Array.isArray(e)?e:[e];return async e=>{t||e(ie());try{await(0,P.submitRequestToBackground)("ignoreTokens",[a,n])}catch(t){(0,w.logErrorWithMessage)(t),e(le(t))}finally{await Ee(e),e(ue())}}},n.importMnemonicToVault=function(e){return async t=>(t(ie()),r.default.debug("background.importMnemonicToVault"),new Promise((t,n)=>{(0,P.callBackgroundMethod)("importMnemonicToVault",[e],(e,a)=>{e?n(e):t(a)})}).then(async e=>(t(ue()),t(ge()),t((0,D.setShowNewSrpAddedToast)(!0)),e)).catch(e=>(t(le(e)),t(ue()),Promise.reject(e))))},n.importNewAccount=function(e,t,n){return async a=>{a(ie(n));try{r.default.debug("background.importAccountWithStrategy"),await(0,P.submitRequestToBackground)("importAccountWithStrategy",[e,t])}finally{a(ue())}return await Ee(a)}},n.isNftOwner=async function(e,t,n,a){return await(0,P.submitRequestToBackground)("isNftOwner",[e,t,n,a])},n.isRelaySupported=async function(e){return await(0,P.submitRequestToBackground)("isRelaySupported",[e])},n.lockAccountSyncing=function(){return async()=>{try{await(0,P.submitRequestToBackground)("setIsAccountSyncingReadyToBeDispatched",[!1]),await(0,P.submitRequestToBackground)("setHasAccountSyncingSyncedAtLeastOnce",[!1])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.lockMetamask=function(){return r.default.debug("background.setLocked"),e=>(e(ie()),ee().then(()=>Ee(e)).catch(t=>(e(le((0,w.getErrorMessage)(t))),Promise.reject(t))).then(()=>{e(ue()),e({type:b.LOCK_METAMASK})}).catch(()=>{e(ue()),e({type:b.LOCK_METAMASK})}))},n.markMetamaskNotificationsAsRead=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("markMetamaskNotificationsAsRead",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.markPasswordForgotten=function(){return async e=>{try{await new Promise((e,t)=>{(0,P.callBackgroundMethod)("markPasswordForgotten",[],n=>{n?t(n):e()})})}finally{e(ue()),await Ee(e)}}},n.multichainUpdateBalance=async function(e){return await(0,P.submitRequestToBackground)("multichainUpdateBalance",[e])},n.multichainUpdateTransactions=async function(e){return await(0,P.submitRequestToBackground)("multichainUpdateTransactions",[e])},n.openUpdateTabAndReload=async function(){return await(0,P.submitRequestToBackground)("openUpdateTabAndReload")},n.performSignIn=function(){return async()=>{try{await(0,P.submitRequestToBackground)("performSignIn")}catch(e){const t=e instanceof Error?e.message:"Unknown error occurred during sign-in.";throw(0,w.logErrorWithMessage)(t),e}}},n.performSignOut=function(){return async()=>{try{await(0,P.submitRequestToBackground)("performSignOut")}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.qrCodeDetected=function(e){return async t=>{await t({type:b.QR_CODE_DETECTED,value:e}),t((0,E.computeEstimatedGasLimit)())}},n.rejectAllApprovals=function(){return async e=>{await(0,P.submitRequestToBackground)("rejectAllPendingApprovals");const{pendingApprovals:t}=await Ee(e);0===Object.values(t).length&&e(se())}},n.rejectAllMessages=function(e){return async t=>{const n=(0,s.serializeError)(s.providerErrors.userRejectedRequest());await Promise.all(e.map(async({id:e})=>await(0,P.submitRequestToBackground)("rejectPendingApproval",[e,n])));const{pendingApprovals:a}=await Ee(t);0===Object.values(a).length&&t(se())}},n.rejectPendingApproval=function(e,t){return async n=>{await(0,P.submitRequestToBackground)("rejectPendingApproval",[e,t]);const{pendingApprovals:a}=await Ee(n);0===Object.values(a).length&&n(se())}},n.rejectPermissionsRequest=function(e){return t=>new Promise((n,a)=>{(0,P.callBackgroundMethod)("rejectPermissionsRequest",[e],e=>{if(e)return t(le(e)),void a(e);Ee(t).then(n).catch(a)})})},n.removeAccount=function(e){return async t=>{t(ie());try{await new Promise((t,n)=>{(0,P.callBackgroundMethod)("removeAccount",[e],(e,a)=>{e?n(e):t(a)})}),await Ee(t)}catch(e){throw t(le(e)),e}finally{t(ue())}r.default.info(`Account removed: ${e}`),t(ne())}},n.removeAndIgnoreNft=function(e,t,n,a){return async r=>{if(!e)throw new Error("MetaMask - Cannot ignore NFT without address");if(!t)throw new Error("MetaMask - Cannot ignore NFT without tokenID");a||r(ie());try{await(0,P.submitRequestToBackground)("removeAndIgnoreNft",[e,t,n])}catch(e){throw(0,w.logErrorWithMessage)(e),r(le(e)),e}finally{await Ee(r),r(ue())}}},n.removeFromAddressBook=function(e,t){return r.default.debug("background.removeFromAddressBook"),async n=>{await(0,P.submitRequestToBackground)("removeFromAddressBook",[e,(0,A.toChecksumHexAddress)(t)]),await Ee(n)}},n.removeNetwork=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("removeNetwork",[e])}catch(e){(0,w.logErrorWithMessage)(e)}}},n.removeNft=function(e,t,n,a){return async r=>{if(!e)throw new Error("MetaMask - Cannot remove NFT without address");if(!t)throw new Error("MetaMask - Cannot remove NFT without tokenID");a||r(ie());try{await(0,P.submitRequestToBackground)("removeNft",[e,t,n])}catch(e){(0,w.logErrorWithMessage)(e),r(le(e))}finally{await Ee(r),r(ue())}}},n.removePermissionsFor=function(e){return t=>{(0,P.callBackgroundMethod)("removePermissionsFor",[e],e=>{e&&t(le(e))})}},n.removePermittedAccount=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("removePermittedAccount",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.removePermittedChain=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("removePermittedChain",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.removePollingTokenFromAppState=Ne,n.removeSlide=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("removeSlide",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.removeSnap=function(e){return async(t,n)=>{var a;t(ie());const r=(null===(a=(0,S.getPermissionSubjects)(n())[e])||void 0===a||null===(a=a.permissions)||void 0===a?void 0:a.snap_manageAccounts)!==undefined;try{if(r){const t=await(0,P.submitRequestToBackground)("getAccountsBySnapId",[e]);for(const e of t)await(0,P.submitRequestToBackground)("removeAccount",[e])}await(0,P.submitRequestToBackground)("removeSnap",[e]),await Ee(t)}catch(e){throw t(le(e)),e}finally{t(ue())}}},n.requestAccountsAndChainPermissionsWithId=function(e){return async t=>{const n=await(0,P.submitRequestToBackground)("requestAccountsAndChainPermissionsWithId",[e]);return await Ee(t),n}},n.requestRevealSeedWords=function(e,t){return async n=>{n(ie()),r.default.debug("background.verifyPassword");try{await G(e);return await K(e,t)}finally{n(ue())}}},n.requestSafeReload=async function(){return await(0,P.submitRequestToBackground)("requestSafeReload")},n.requestUserApproval=function({origin:e,type:t,requestData:n}){return async a=>{try{await(0,P.submitRequestToBackground)("requestUserApproval",[{origin:e,type:t,requestData:n}])}catch(e){(0,w.logErrorWithMessage)(e),a(le("Had trouble requesting user approval"))}}},n.resetAccount=function(){return e=>(e(ie()),new Promise((t,n)=>{(0,P.callBackgroundMethod)("resetAccount",[],(a,o)=>{if(e(ue()),a)return(0,w.isErrorWithMessage)(a)&&e(le(a)),void n(a);r.default.info(`Transaction history reset for ${o}`),e(ne()),t(o)})}))},n.resetBackgroundSwapsState=function(){return async e=>{await(0,P.submitRequestToBackground)("resetSwapsState"),await Ee(e)}},n.resetOAuthLoginState=F,n.resetOnboarding=function(){return async(e,t)=>{try{const n=(0,S.getIsSocialLoginFlow)(t());e(me()),n&&await e(F())}catch(e){console.error(e)}}},n.resetOnboardingAction=me,n.resetSwapsPostFetchState=function(){return async e=>{await(0,P.submitRequestToBackground)("resetPostFetchState"),await Ee(e)}},n.resetViewedNotifications=function(){return(0,P.submitRequestToBackground)("resetViewedNotifications")},n.resolvePendingApproval=function(e,t){return async n=>{await(0,P.submitRequestToBackground)("resolvePendingApproval",[e,t]);const{pendingApprovals:a}=await Ee(n);0===Object.values(a).length&&n(se())}},n.restoreSocialBackupAndGetSeedPhrase=function(e){return async t=>{try{const n=await(0,P.submitRequestToBackground)("restoreSocialBackupAndGetSeedPhrase",[e]);return t(ge()),await Ee(t),n}catch(e){throw r.default.error("[restoreSocialBackupAndGetSeedPhrase] error",e),t(le(e.message)),e}}},n.restoreUserData=async function(e){try{await(0,P.submitRequestToBackground)("restoreUserData",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}return!0},n.revokeDynamicSnapPermissions=function(e,t){return async n=>{await(0,P.submitRequestToBackground)("revokeDynamicSnapPermissions",[e,t]),await Ee(n)}},n.rollbackToPreviousProvider=function(){return async e=>{try{await(0,P.submitRequestToBackground)("rollbackToPreviousProvider")}catch(t){(0,w.logErrorWithMessage)(t),e(le("Had a problem changing networks!"))}}},n.safeRefetchQuotes=function(){return async e=>{await(0,P.submitRequestToBackground)("safeRefetchQuotes"),await Ee(e)}},n.sendMultichainTransaction=async function(e,{account:t,scope:n,assetType:a}){await Y({snapId:e,origin:"metamask",handler:c.HandlerType.OnRpcRequest,request:{method:"startSendTransactionFlow",params:{account:t,scope:n,assetId:a}}})},n.setAccountDetailsAddress=function(e){return{type:b.SET_ACCOUNT_DETAILS_ADDRESS,payload:e}},n.setAccountLabel=function(e,t){return n=>(n(ie()),r.default.debug("background.setAccountLabel"),new Promise((a,r)=>{(0,P.callBackgroundMethod)("setAccountLabel",[e,t],o=>{if(n(ue()),o)return n(le(o)),void r(o);n({type:b.SET_ACCOUNT_LABEL,value:{account:e,label:t}}),a(e)})}))},n.setActiveNetwork=function(e){return async t=>{r.default.debug(`background.setActiveNetwork: ${e}`);try{await(0,P.submitRequestToBackground)("setActiveNetwork",[e])}catch(e){(0,w.logErrorWithMessage)(e),t(le("Had a problem changing networks!"))}}},n.setActiveNetworkConfigurationId=re,n.setActiveNetworkWithError=function(e){return async t=>{r.default.debug(`background.setActiveNetwork: ${e}`);try{await(0,P.submitRequestToBackground)("setActiveNetwork",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),t(le("Had a problem changing networks!")),new Error("Had a problem changing networks!")}}},n.setAddSnapAccountEnabled=async function(e){try{await(0,P.submitRequestToBackground)("setAddSnapAccountEnabled",[e])}catch(e){(0,w.logErrorWithMessage)(e)}},n.setAdvancedGasFee=function(e){return t=>{t(ie()),r.default.debug("background.setAdvancedGasFee"),(0,P.callBackgroundMethod)("setAdvancedGasFee",[e],e=>{t(ue()),e&&t(le(e))})}},n.setAlertEnabledness=async function(e,t){await(0,P.submitRequestToBackground)("setAlertEnabledness",[e,t])},n.setAutoLockTimeLimit=function(e){return Te("autoLockTimeLimit",e)},n.setBackgroundSwapRouteState=function(e){return async t=>{await(0,P.submitRequestToBackground)("setBackgroundSwapRouteState",[e]),await Ee(t)}},n.setCompletedOnboarding=function(){return async e=>{e(ie());try{await(0,P.submitRequestToBackground)("completeOnboarding"),e(Se())}catch(t){throw e(le(t)),t}finally{e(ue())}}},n.setConfirmationAdvancedDetailsOpen=function(e){return Te("showConfirmationAdvancedDetails",e)},n.setConfirmationExchangeRates=function(e){return{type:b.SET_CONFIRMATION_EXCHANGE_RATES,value:e}},n.setConnectedStatusPopoverHasBeenShown=function(){return()=>{(0,P.callBackgroundMethod)("setConnectedStatusPopoverHasBeenShown",[],e=>{if((0,w.isErrorWithMessage)(e))throw new Error((0,w.getErrorMessage)(e))})}},n.setCurrentCurrency=function(e){return async t=>{t(ie()),r.default.debug("background.setCurrentCurrency");try{await(0,P.submitRequestToBackground)("setCurrentCurrency",[e]),await Ee(t)}catch(e){return(0,w.logErrorWithMessage)(e),void t(le(e))}finally{t(ue())}}},n.setCurrentExtensionPopupId=function(e){return async t=>{await(0,P.submitRequestToBackground)("setCurrentExtensionPopupId",[e]),await Ee(t)}},n.setCurrentLocale=fe,n.setCustomApproveTxData=function(e){return async t=>{await(0,P.submitRequestToBackground)("setCustomApproveTxData",[e]),await Ee(t)}},n.setDataCollectionForMarketing=function(e){return async t=>{r.default.debug("background.setDataCollectionForMarketing"),await(0,P.submitRequestToBackground)("setDataCollectionForMarketing",[e]),t({type:b.SET_DATA_COLLECTION_FOR_MARKETING,value:e})}},n.setDefaultHomeActiveTabName=function(e){return async t=>{await(0,P.submitRequestToBackground)("setDefaultHomeActiveTabName",[e]),await Ee(t)}},n.setDismissSeedBackUpReminder=function(e){return async t=>{t(ie()),await(0,P.submitRequestToBackground)("setDismissSeedBackUpReminder",[e]),t(ue())}},n.setDismissSmartAccountSuggestionEnabled=function(e){return async(t,n)=>{const a=(0,v.getDismissSmartAccountSuggestionEnabled)(n());Ce({category:_.MetaMetricsEventCategory.Settings,event:_.MetaMetricsEventName.SettingsUpdated,properties:{dismiss_smt_acc_suggestion_enabled:e,prev_dismiss_smt_acc_suggestion_enabled:a}}),await t(Te("dismissSmartAccountSuggestionEnabled",e)),await Ee(t)}},n.setEditedNetwork=function(e=undefined){return{type:b.SET_EDIT_NETWORK,payload:e}},n.setEnableEnforcedSimulationsForTransaction=async function(e,t){try{await(0,P.submitRequestToBackground)("setEnableEnforcedSimulationsForTransaction",[e,t])}catch(e){throw(0,w.logErrorWithMessage)(e),e}},n.setEnabledNetworks=function(e,t){return async()=>{await(0,P.submitRequestToBackground)("setEnabledNetworks",[e,t])}},n.setEnforcedSimulationsSlippageForTransaction=async function(e,t){try{await(0,P.submitRequestToBackground)("setEnforcedSimulationsSlippageForTransaction",[e,t])}catch(e){throw(0,w.logErrorWithMessage)(e),e}},n.setFeatureAnnouncementsEnabled=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("setFeatureAnnouncementsEnabled",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.setFeatureFlag=function(e,t,n){return a=>(a(ie()),new Promise((r,o)=>{(0,P.callBackgroundMethod)("setFeatureFlag",[e,t],(e,t)=>{if(a(ue()),e)return a(le(e)),void o(e);n&&a(oe({name:n})),r(t)})}))},n.setFeatureNotificationsEnabled=function(e){return Te("featureNotificationsEnabled",e)},n.setFirstTimeFlowType=function(e){return async t=>{try{r.default.debug("background.setFirstTimeFlowType"),await(0,P.submitRequestToBackground)("setFirstTimeFlowType",[e]),t({type:b.SET_FIRST_TIME_FLOW_TYPE,value:e})}catch(e){t(le(e))}}},n.setHardwareWalletDefaultHdPath=function({device:e,path:t}){return{type:b.SET_HARDWARE_WALLET_DEFAULT_HD_PATH,payload:{device:e,path:t}}},n.setHideZeroBalanceTokens=function(e){return Te("hideZeroBalanceTokens",e)},n.setInitialGasEstimate=function(e){return async t=>{await(0,P.submitRequestToBackground)("setInitialGasEstimate",[e]),await Ee(t)}},n.setIpfsGateway=function(e){return t=>{r.default.debug("background.setIpfsGateway"),(0,P.callBackgroundMethod)("setIpfsGateway",[e],e=>{e&&t(le(e))})}},n.setIsBackupAndSyncFeatureEnabled=function(e,t){return async()=>{try{await(0,P.submitRequestToBackground)("setIsBackupAndSyncFeatureEnabled",[e,t])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.setIsIpfsGatewayEnabled=function(e){return t=>{r.default.debug("background.setIsIpfsGatewayEnabled"),(0,P.callBackgroundMethod)("setIsIpfsGatewayEnabled",[e],e=>{e&&t(le(e))})}},n.setLastActiveTime=function(){return e=>{(0,P.callBackgroundMethod)("setLastActiveTime",[],t=>{t&&e(le(t))})}},n.setLastInteractedConfirmationInfo=async function(e){return await(0,P.submitRequestToBackground)("setLastInteractedConfirmationInfo",[e])},n.setLastViewedUserSurvey=function(e){return async()=>{await(0,P.submitRequestToBackground)("setLastViewedUserSurvey",[e])}},n.setManageInstitutionalWallets=function(e){return async t=>{t(ie()),await(0,P.submitRequestToBackground)("setManageInstitutionalWallets",[e]),t(ue())}},n.setName=function(e){return async()=>{await(0,P.submitRequestToBackground)("setName",[e])}},n.setNetworkClientIdForDomain=function(e,t){return(0,P.submitRequestToBackground)("setNetworkClientIdForDomain",[e,t])},n.setNewNetworkAdded=function({networkConfigurationId:e,nickname:t}){return{type:b.SET_NEW_NETWORK_ADDED,payload:{networkConfigurationId:e,nickname:t}}},n.setNewNftAddedMessage=function(e){return{type:b.SET_NEW_NFT_ADDED_MESSAGE,payload:e}},n.setNewTokensImported=function(e){return{type:b.SET_NEW_TOKENS_IMPORTED,payload:e}},n.setNewTokensImportedError=function(e){return{type:b.SET_NEW_TOKENS_IMPORTED_ERROR,payload:e}},n.setNextNonce=Ae,n.setOpenMetamaskTabsIDs=_e,n.setOpenSeaEnabled=function(e){return async t=>{t(ie()),r.default.debug("background.setOpenSeaEnabled");try{await(0,P.submitRequestToBackground)("setOpenSeaEnabled",[e])}finally{t(ue())}}},n.setOutdatedBrowserWarningLastShown=function(e){return async()=>{await(0,P.submitRequestToBackground)("setOutdatedBrowserWarningLastShown",[e])}},n.setOverrideContentSecurityPolicyHeader=function(e){return async t=>{t(ie()),await(0,P.submitRequestToBackground)("setOverrideContentSecurityPolicyHeader",[e]),t(ue())}},n.setParticipateInMetaMetrics=function(e){return t=>(r.default.debug("background.setParticipateInMetaMetrics"),new Promise((n,a)=>{(0,P.callBackgroundMethod)("setParticipateInMetaMetrics",[e],(o,s)=>{if(r.default.debug(o),o)return t(le(o)),void a(o);t({type:b.SET_PARTICIPATE_IN_METAMETRICS,value:e}),n([e,s])})}))},n.setPendingTokens=function(e){const{customToken:t,selectedTokens:n={},tokenAddressList:a=[]}=e,r=null!=t&&t.address&&null!=t&&t.symbol&&Boolean((null==t?void 0:t.decimals)>=0&&(null==t?void 0:t.decimals)<=36)?{...n,[t.address]:{...t,isCustom:!0}}:n;return Object.keys(r).forEach(e=>{const t=a.find(t=>(0,N.isEqualCaseInsensitive)(t,e));r[e]={...r[e],unlisted:!t}}),{type:b.SET_PENDING_TOKENS,payload:r}},n.setPermittedAccounts=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("setPermittedAccounts",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.setPermittedChains=function(e,t){return async n=>{await new Promise((n,a)=>{(0,P.callBackgroundMethod)("setPermittedChains",[e,t],e=>{e?a(e):n()})}),await Ee(n)}},n.setPreference=Te,n.setPrivacyMode=function(e){return Te("privacyMode",e,!1)},n.setRecoveryPhraseReminderHasBeenShown=function(){return()=>{(0,P.callBackgroundMethod)("setRecoveryPhraseReminderHasBeenShown",[],e=>{if((0,w.isErrorWithMessage)(e))throw new Error((0,w.getErrorMessage)(e))})}},n.setRecoveryPhraseReminderLastShown=function(e){return()=>{(0,P.callBackgroundMethod)("setRecoveryPhraseReminderLastShown",[e],e=>{if((0,w.isErrorWithMessage)(e))throw new Error((0,w.getErrorMessage)(e))})}},n.setRemoveNftMessage=function(e){return{type:b.SET_REMOVE_NFT_MESSAGE,payload:e}},n.setRequestAccountTabIds=he,n.setSecurityAlertsEnabled=function(e){try{(0,P.submitRequestToBackground)("setSecurityAlertsEnabled",[e])}catch(e){(0,w.logErrorWithMessage)(e)}},n.setSeedPhraseBackedUp=function(e){return t=>(r.default.debug("background.setSeedPhraseBackedUp"),new Promise((n,a)=>{(0,P.callBackgroundMethod)("setSeedPhraseBackedUp",[e],e=>{if(e)return t(le(e)),void a(e);Ee(t).then(n).catch(a)})}))},n.setSelectedAccount=function(e){return async(t,n)=>{t(ie()),r.default.debug("background.setSelectedAccount");const a=n(),o=(0,f.getUnconnectedAccountAlertEnabledness)(a),s=a.activeTab.origin,i=(0,S.getSelectedInternalAccount)(a),c=(0,S.getInternalAccountByAddress)(a,e),d=(0,S.getAllPermittedAccountsForCurrentTab)(a),l=(0,u.isInternalAccountInPermittedAccountIds)(i,d),g=(0,u.isInternalAccountInPermittedAccountIds)(c,d),T=Boolean(s)&&l&&!g;try{await te(c.id),await Ee(t)}catch(e){return void t(le(e))}finally{t(ue())}o&&T&&(t((0,p.switchedToUnconnectedAccount)()),await ye(s))}},n.setSelectedInternalAccount=function(e){return async t=>{t(ie()),r.default.debug("background.setSelectedInternalAccount");try{await te(e)}catch(e){return void t(le(e))}finally{t(ue())}}},n.setSelectedInternalAccountWithoutLoading=function(e){return async t=>{try{await te(e),await Ee(t)}catch(e){t(le(e))}}},n.setSelectedNetworkConfigurationId=function(e){return{type:b.SET_SELECTED_NETWORK_CONFIGURATION_ID,payload:e}},n.setSelectedQuoteAggId=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSelectedQuoteAggId",[e]),await Ee(t)}},n.setServiceWorkerKeepAlivePreference=function(e){return async t=>{t(ie()),r.default.debug("background.setServiceWorkerKeepAlivePreference");try{await(0,P.submitRequestToBackground)("setServiceWorkerKeepAlivePreference",[e])}catch(e){t(le(e))}finally{t(ue())}}},n.setShowConnectionsRemovedModal=Z,n.setShowExtensionInFullSizeView=function(e){return Te("showExtensionInFullSizeView",e)},n.setShowFiatConversionOnTestnetsPreference=function(e){return Te("showFiatInTestnets",e)},n.setShowMultiRpcModal=function(e){return Te("showMultiRpcModal",e)},n.setShowNativeTokenAsMainBalancePreference=function(e){return Te("showNativeTokenAsMainBalance",e)},n.setShowSupportDataConsentModal=function(e){return{type:b.SET_SHOW_SUPPORT_DATA_CONSENT_MODAL,payload:e}},n.setShowTestNetworks=function(e){return Te("showTestNetworks",e)},n.setSkipDeepLinkInterstitial=function(e){return Te("skipDeepLinkInterstitial",e,!1)},n.setSlides=function(e){return{type:b.SET_SLIDES,slides:e}},n.setSmartAccountOptIn=function(e){return async(t,n)=>{const a=(0,v.getUseSmartAccount)(n());Ce({category:_.MetaMetricsEventCategory.Settings,event:_.MetaMetricsEventName.SettingsUpdated,properties:{use_smart_account:e,prev_use_smart_account:a}}),await t(Te("smartAccountOptIn",e)),await Ee(t)}},n.setSmartTransactionsPreferenceEnabled=function(e){return async(t,n)=>{const a=(0,k.getSmartTransactionsOptInStatusInternal)(n());Ce({category:_.MetaMetricsEventCategory.Settings,event:_.MetaMetricsEventName.SettingsUpdated,properties:{stx_opt_in:e,prev_stx_opt_in:a}}),await t(Te("smartTransactionsOptInStatus",e)),await Ee(t)}},n.setSmartTransactionsRefreshInterval=function(e){return async()=>{if(e!==undefined&&null!==e)try{await(0,P.submitRequestToBackground)("setStatusRefreshInterval",[e])}catch(e){(0,w.logErrorWithMessage)(e)}}},n.setSnapsAddSnapAccountModalDismissed=async function(){await(0,P.submitRequestToBackground)("setSnapsAddSnapAccountModalDismissed",[!0])},n.setSnapsInstallPrivacyWarningShownStatus=function(e){return async()=>{await(0,P.submitRequestToBackground)("setSnapsInstallPrivacyWarningShownStatus",[e])}},n.setSwapsErrorKey=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsErrorKey",[e]),await Ee(t)}},n.setSwapsFeatureFlags=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsFeatureFlags",[e]),await Ee(t)}},n.setSwapsLiveness=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsLiveness",[e]),await Ee(t)}},n.setSwapsQuotesPollingLimitEnabled=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsQuotesPollingLimitEnabled",[e]),await Ee(t)}},n.setSwapsTokens=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsTokens",[e]),await Ee(t)}},n.setSwapsTxGasLimit=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsTxGasLimit",[e,!0]),await Ee(t)}},n.setSwapsTxGasPrice=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsTxGasPrice",[e]),await Ee(t)}},n.setTermsOfUseLastAgreed=function(e){return async()=>{await(0,P.submitRequestToBackground)("setTermsOfUseLastAgreed",[e])}},n.setTheme=function(e){return async t=>{t(ie()),r.default.debug("background.setTheme");try{await(0,P.submitRequestToBackground)("setTheme",[e])}finally{t(ue())}}},n.setTokenNetworkFilter=function(e){return Te("tokenNetworkFilter",e,!1)},n.setTokenSortConfig=function(e){return Te("tokenSortConfig",e,!1)},n.setTransactionActive=function(e,t){return async()=>{await(0,P.submitRequestToBackground)("setTransactionActive",[e,t])}},n.setUnconnectedAccountAlertShown=ye,n.setUpdateModalLastDismissedAt=async function(e){await(0,P.submitRequestToBackground)("setUpdateModalLastDismissedAt",[e])},n.setUse4ByteResolution=function(e){return async t=>{t(ie()),r.default.debug("background.setUse4ByteResolution");try{await(0,P.submitRequestToBackground)("setUse4ByteResolution",[e])}catch(e){t(le(e))}finally{t(ue())}}},n.setUseAddressBarEnsResolution=function(e){return t=>{r.default.debug("background.setUseAddressBarEnsResolution"),(0,P.callBackgroundMethod)("setUseAddressBarEnsResolution",[e],e=>{e&&t(le(e))})}},n.setUseBlockie=function(e){return t=>{t(ie()),r.default.debug("background.setUseBlockie"),(0,P.callBackgroundMethod)("setUseBlockie",[e],e=>{t(ue()),e&&t(le(e))})}},n.setUseCurrencyRateCheck=function(e){return t=>{t(ie()),r.default.debug("background.setUseCurrencyRateCheck"),(0,P.callBackgroundMethod)("setUseCurrencyRateCheck",[e],e=>{t(ue()),e&&t(le(e))})}},n.setUseExternalNameSources=function(e){try{(0,P.submitRequestToBackground)("setUseExternalNameSources",[e])}catch(e){(0,w.logErrorWithMessage)(e)}},n.setUseMultiAccountBalanceChecker=function(e){return t=>{t(ie()),r.default.debug("background.setUseMultiAccountBalanceChecker"),(0,P.callBackgroundMethod)("setUseMultiAccountBalanceChecker",[e],e=>{t(ue()),e&&t(le(e))})}},n.setUseNftDetection=function(e){return async t=>{t(ie()),r.default.debug("background.setUseNftDetection");try{await(0,P.submitRequestToBackground)("setUseNftDetection",[e])}finally{t(ue())}}},n.setUsePhishDetect=function(e){return t=>{t(ie()),r.default.debug("background.setUsePhishDetect"),(0,P.callBackgroundMethod)("setUsePhishDetect",[e],e=>{t(ue()),e&&t(le(e))})}},n.setUseSafeChainsListValidation=function(e){return t=>{t(ie()),r.default.debug("background.setUseSafeChainsListValidation"),(0,P.callBackgroundMethod)("setUseSafeChainsListValidation",[e],e=>{t(ue()),e&&t(le(e))})}},n.setUseTokenDetection=function(e){return t=>{t(ie()),r.default.debug("background.setUseTokenDetection"),(0,P.callBackgroundMethod)("setUseTokenDetection",[e],e=>{t(ue()),e&&t(le(e))})}},n.setUseTransactionSimulations=function(e){try{(0,P.submitRequestToBackground)("setUseTransactionSimulations",[e])}catch(e){(0,w.logErrorWithMessage)(e)}},n.setWatchEthereumAccountEnabled=async function(e){try{await(0,P.submitRequestToBackground)("setWatchEthereumAccountEnabled",[e])}catch(e){(0,w.logErrorWithMessage)(e)}},n.setWeb3ShimUsageAlertDismissed=async function(e){await(0,P.submitRequestToBackground)("setWeb3ShimUsageAlertDismissed",[e])},n.showAccountsPage=ne,n.showAlert=function(e){return{type:b.ALERT_OPEN,payload:e}},n.showConfTxPage=ae,n.showConfirmTurnOnMetamaskNotifications=function(){return e=>{e(oe({name:"TURN_ON_METAMASK_NOTIFICATIONS"}))}},n.showDeprecatedNetworkModal=function(){return{type:b.DEPRECATED_NETWORK_POPOVER_OPEN}},n.showImportNftsModal=function(e){return{type:b.IMPORT_NFTS_MODAL_OPEN,payload:e}},n.showImportTokensModal=function(){return{type:b.IMPORT_TOKENS_POPOVER_OPEN}},n.showIpfsModal=function(){return{type:b.SHOW_IPFS_MODAL_OPEN}},n.showKeyringSnapRemovalModal=function(e){return{type:b.SHOW_KEYRING_SNAP_REMOVAL_RESULT,payload:e}},n.showLoadingIndication=ie,n.showModal=oe,n.showNetworkDropdown=function(){return{type:b.NETWORK_DROPDOWN_OPEN}},n.showNftStillFetchingIndication=ce,n.showPermittedNetworkToast=function(){return{type:b.SHOW_PERMITTED_NETWORK_TOAST_OPEN}},n.showPrivateKey=function(e){return{type:b.SHOW_PRIVATE_KEY,payload:e}},n.showQrScanner=function(){return e=>{e(oe({name:"QR_SCANNER"}))}},n.showSendTokenPage=function(){return{type:b.SHOW_SEND_TOKEN_PAGE}},n.signAndSendSmartTransaction=function({unsignedTransaction:e,smartTransactionFees:t}){return async n=>{const a=await we(e,t.fees);try{return(await(0,P.submitRequestToBackground)("submitSignedTransactions",[{signedTransactions:a,signedCanceledTransactions:[],txParams:e}])).uuid}catch(e){if((0,w.logErrorWithMessage)(e),(0,w.isErrorWithMessage)(e)){const t=(0,w.getErrorMessage)(e);if(t.startsWith("Fetch error:")){const e=(0,I.parseSmartTransactionsError)(t);n({type:b.SET_SMART_TRANSACTIONS_ERROR,payload:e})}}throw e}}},n.startOAuthLogin=function(e,t,n){return async a=>{a(ie());try{const a=await(0,P.submitRequestToBackground)("startOAuthLogin",[e]);let r=!1,o=!1;try{null==t||t({name:R.TraceName.OnboardingOAuthSeedlessAuthenticate,op:R.TraceOperation.OnboardingSecurityOp}),({isNewUser:o}=await(0,P.submitRequestToBackground)("authenticate",[a])),r=!0}catch(e){const a=e instanceof Error?e.message:"Unknown error";throw null==t||t({name:R.TraceName.OnboardingOAuthSeedlessAuthenticateError,op:R.TraceOperation.OnboardingError,tags:{errorMessage:a}}),null==n||n({name:R.TraceName.OnboardingOAuthSeedlessAuthenticateError}),e}finally{null==n||n({name:R.TraceName.OnboardingOAuthSeedlessAuthenticate,data:{success:r}})}return o}catch(e){throw a(le(e)),(0,w.isErrorWithMessage)(e)?new Error((0,w.getErrorMessage)(e)):e}finally{a(ue())}}},n.stopPollingForQuotes=function(){return async e=>{await(0,P.submitRequestToBackground)("stopPollingForQuotes"),await Ee(e)}},n.storeKeyringEncryptionKey=function(e){return(0,P.submitRequestToBackground)("storeKeyringEncryptionKey",[e])},n.submitPassword=q,n.submitQRHardwareCryptoAccount=async function(e){await(0,P.submitRequestToBackground)("submitQRHardwareCryptoAccount",[e])},n.submitQRHardwareCryptoHDKey=async function(e){await(0,P.submitRequestToBackground)("submitQRHardwareCryptoHDKey",[e])},n.submitQRHardwareSignature=async function(e,t){await(0,P.submitRequestToBackground)("submitQRHardwareSignature",[e,t])},n.syncContactsWithUserStorage=function(){return async()=>{try{return await(0,P.submitRequestToBackground)("syncContactsWithUserStorage")}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.syncInternalAccountsWithUserStorage=function(){return async()=>{try{return await(0,P.submitRequestToBackground)("syncInternalAccountsWithUserStorage")}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.syncSeedPhrases=function(){return async e=>{try{await(0,P.submitRequestToBackground)("syncSeedPhrases"),e(ge()),await Ee(e)}catch(t){throw r.default.error("[syncSeedPhrases] error",t),e(le(t.message)),t}}},n.throwTestBackgroundError=async function(e){await(0,P.submitRequestToBackground)("throwTestError",[e])},n.toggleAccountMenu=function(){return{type:b.TOGGLE_ACCOUNT_MENU}},n.toggleExternalServices=function(e){return async t=>{r.default.debug("background.toggleExternalServices");try{await(0,P.submitRequestToBackground)("toggleExternalServices",[e]),await Ee(t)}catch(e){t(le(e))}}},n.toggleNetworkMenu=function(e){return{type:b.TOGGLE_NETWORK_MENU,payload:e}},n.tokenBalancesStartPolling=async function(e){const t=await(0,P.submitRequestToBackground)("tokenBalancesStartPolling",[{chainId:e}]);return await Ie(t),t},n.tokenBalancesStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("tokenBalancesStopPollingByPollingToken",[e]),await Ne(e)},n.tokenDetectionStartPolling=async function(e){const t=await(0,P.submitRequestToBackground)("tokenDetectionStartPolling",[{chainIds:e}]);return await Ie(t),t},n.tokenDetectionStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("tokenDetectionStopPollingByPollingToken",[e]),await Ne(e)},n.tokenListStartPolling=async function(e){const t=await(0,P.submitRequestToBackground)("tokenListStartPolling",[{chainId:e}]);return await Ie(t),t},n.tokenListStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("tokenListStopPollingByPollingToken",[e]),await Ne(e)},n.tokenRatesStartPolling=async function(e){const t=await(0,P.submitRequestToBackground)("tokenRatesStartPolling",[{chainIds:e}]);return await Ie(t),t},n.tokenRatesStopPollingByPollingToken=async function(e){await(0,P.submitRequestToBackground)("tokenRatesStopPollingByPollingToken",[e]),await Ne(e)},n.trackInsightSnapUsage=function(e){return async()=>{await(0,P.submitRequestToBackground)("trackInsightSnapView",[e])}},n.trackMetaMetricsEvent=Ce,n.trackMetaMetricsPage=function(e,t){return(0,P.submitRequestToBackground)("trackMetaMetricsPage",[{...e,actionId:(0,P.generateActionId)()},t])},n.tryReverseResolveAddress=function(e){return()=>new Promise(t=>{(0,P.callBackgroundMethod)("tryReverseResolveAddress",[e],e=>{e&&(0,w.logErrorWithMessage)(e),t()})})},n.tryUnlockMetamask=function(e){return t=>(t(ie()),t(z()),r.default.debug("background.syncPasswordAndUnlockWallet"),new Promise((n,a)=>{(0,P.callBackgroundMethod)("syncPasswordAndUnlockWallet",[e],(e,r)=>{e?a(e):(r||t(Z(!0)),n())})}).then(()=>(t(X()),Ee(t))).then(()=>{t(ue()),t(ge())}).catch(e=>(t(Q((0,w.getErrorMessage)(e))),t(ue()),Promise.reject(e))))},n.unMarkPasswordForgotten=$,n.unlockAccountSyncing=function(){return async()=>{try{return await(0,P.submitRequestToBackground)("setHasAccountSyncingSyncedAtLeastOnce",[!0]),await(0,P.submitRequestToBackground)("setIsAccountSyncingReadyToBeDispatched",[!0])}catch(e){return(0,w.getErrorMessage)(e)}}},n.unlockAndGetSeedPhrase=function(e){return async t=>{try{await q(e);const n=await K(e);return await Ee(t),n}catch(e){throw t(le(e)),(0,w.isErrorWithMessage)(e)?new Error((0,w.getErrorMessage)(e)):e}}},n.unlockFailed=Q,n.unlockHardwareWalletAccounts=function(e,t,n,a){return r.default.debug("background.unlockHardwareWalletAccount",e,t,n,a),async r=>{r(ie());for(const o of e)try{await(0,P.submitRequestToBackground)("unlockHardwareWalletAccount",[o,t,n,a])}catch(e){throw(0,w.logErrorWithMessage)(e),r(le(e)),r(ue()),e}return r(ue()),undefined}},n.unlockInProgress=z,n.unlockSucceeded=X,n.updateAccountsList=function(e){return async()=>{await(0,P.submitRequestToBackground)("updateAccountsList",[e])}},n.updateAndApproveTx=function(e,t,n){return(a,r)=>{!t&&a(ie(n));const o=()=>Boolean(r().send.stage!==E.SEND_STAGES.INACTIVE);return new Promise((t,n)=>{const r=(0,P.generateActionId)();(0,P.callBackgroundMethod)("resolvePendingApproval",[String(e.id),{txMeta:e,actionId:r},{waitForResult:!0}],r=>{if(a(V(e.id,e.txParams)),o()||a((0,E.resetSendState)()),r)return a(U()),(0,w.logErrorWithMessage)(r),void n(r);t(e)})}).then(()=>Ee(a)).then(()=>(o()||a((0,E.resetSendState)()),a(j(e.id)),a(ue()),a(x("")),a(se()),e)).catch(e=>(a(ue()),Promise.reject(e)))}},n.updateCurrentLocale=pe,n.updateCustomNonce=x,n.updateCustomSwapsEIP1559GasParams=function({gasLimit:e,maxFeePerGas:t,maxPriorityFeePerGas:n}){return async a=>{await Promise.all([(0,P.submitRequestToBackground)("setSwapsTxGasLimit",[e]),(0,P.submitRequestToBackground)("setSwapsTxMaxFeePerGas",[t]),(0,P.submitRequestToBackground)("setSwapsTxMaxFeePriorityPerGas",[n])]),await Ee(a)}},n.updateDataDeletionTaskStatus=async function(){return await(0,P.submitRequestToBackground)("updateDataDeletionTaskStatus")},n.updateEditableParams=function(...e){return async t=>{let n;try{n=await(0,P.submitRequestToBackground)("updateEditableParams",e)}catch(e){throw(0,w.logErrorWithMessage)(e),e}return await Ee(t),n}},n.updateEventFragment=function(e,t){return(0,P.submitRequestToBackground)("updateEventFragment",[e,t])},n.updateHiddenAccountsList=function(e){return async()=>{await(0,P.submitRequestToBackground)("updateHiddenAccountsList",[e])}},n.updateIncomingTransactions=function(){return async e=>{r.default.debug("background.updateIncomingTransactions");try{await(0,P.submitRequestToBackground)("updateIncomingTransactions")}catch(t){(0,w.logErrorWithMessage)(t),e(le("Had a problem updating incoming transactions!"))}}},n.updateInterfaceState=function(e,t){return async n=>{await(0,P.submitRequestToBackground)("updateInterfaceState",[e,t]),await Ee(n)}},n.updateMetamaskState=J,n.updateNetwork=function(e,t={}){return async n=>{r.default.debug("background.updateNetwork",e);try{return await(0,P.submitRequestToBackground)("updateNetwork",[e.chainId,e,t])}catch(e){(0,w.logErrorWithMessage)(e),n(le("Had a problem updading networks!"))}return undefined}},n.updateNetworksList=function(e){return async()=>{await(0,P.submitRequestToBackground)("updateNetworksList",[e])}},n.updateNftDropDownState=function(e){return async t=>{await(0,P.submitRequestToBackground)("updateNftDropDownState",[e]),await Ee(t)}},n.updatePreviousGasParams=function(e,t){return async()=>{let n;try{n=await(0,P.submitRequestToBackground)("updatePreviousGasParams",[e,t])}catch(e){throw(0,w.logErrorWithMessage)(e),e}return n}},n.updateProposedNames=function(e){return async()=>await(0,P.submitRequestToBackground)("updateProposedNames",[e])},n.updateSlides=function(e){return async()=>{try{await(0,P.submitRequestToBackground)("updateSlides",[e])}catch(e){throw(0,w.logErrorWithMessage)(e),e}}},n.updateSmartTransaction=function(e,t){return async n=>{try{await(0,P.submitRequestToBackground)("updateSmartTransaction",[{uuid:e,...t}])}catch(e){if((0,w.logErrorWithMessage)(e),(0,w.isErrorWithMessage)(e)){const t=(0,w.getErrorMessage)(e);if(t.startsWith("Fetch error:")){const e=(0,I.parseSmartTransactionsError)(t);n({type:b.SET_SMART_TRANSACTIONS_ERROR,payload:e})}}throw e}}},n.updateSnap=function(e,t){return async(n,a)=>{await(0,P.submitRequestToBackground)("updateSnap",[e,t]),await Ee(n);const r=a(),o=(0,S.getFirstSnapInstallOrUpdateRequest)(r);return null==o?void 0:o.metadata.id}},n.updateSwapsUserFeeLevel=function(e){return async t=>{await(0,P.submitRequestToBackground)("setSwapsUserFeeLevel",[e]),await Ee(t)}},n.updateThrottledOriginState=function(e,t){return async()=>{await(0,P.submitRequestToBackground)("updateThrottledOriginState",[e,t])}},n.updateTokenType=async function(e){try{return await(0,P.submitRequestToBackground)("updateTokenType",[e])}catch(e){(0,w.logErrorWithMessage)(e)}return undefined},n.updateTransaction=function(e,t){return async n=>{!t&&n(ie());try{await(0,P.submitRequestToBackground)("updateTransaction",[e])}catch(t){throw n(V(e.id,e.txParams)),n(ue()),n(U()),(0,w.logErrorWithMessage)(t),t}try{return n(V(e.id,e.txParams)),await Ee(n),n(ae({id:e.id})),e}finally{n(ue())}}},n.updateTransactionGasFees=function(e,t){return async()=>{let n;try{n=await(0,P.submitRequestToBackground)("updateTransactionGasFees",[e,t])}catch(e){throw(0,w.logErrorWithMessage)(e),e}return n}},n.updateTransactionParams=V,n.updateTransactionSendFlowHistory=function(e,t,n){return async()=>{let a;try{a=await(0,P.submitRequestToBackground)("updateTransactionSendFlowHistory",[e,t,n])}catch(e){throw(0,w.logErrorWithMessage)(e),e}return a}},n.updateViewedNotifications=function(e){return(0,P.submitRequestToBackground)("updateViewedNotifications",[e])},n.verifyPassword=G;var a=L(e("webextension-polyfill")),r=L(e("loglevel")),o=e("lodash"),s=e("@metamask/rpc-errors"),i=e("@metamask/profile-sync-controller/sdk"),c=e("@metamask/snaps-utils"),u=e("@metamask/chain-agnostic-permission"),d=e("../../shared/lib/sentry"),l=e("../../shared/lib/switch-direction"),g=e("../../shared/constants/app"),T=e("../../app/scripts/lib/util"),S=e("../selectors"),m=e("../../shared/modules/selectors/networks"),E=e("../ducks/send"),p=e("../ducks/alerts/unconnected-account"),f=e("../ducks/metamask/metamask"),A=e("../../shared/modules/hexstring-utils"),h=e("../../shared/constants/hardware-wallets"),_=e("../../shared/constants/metametrics"),I=e("../pages/swaps/swaps.util"),N=e("../../shared/modules/string-utils"),k=e("../../shared/modules/selectors"),C=e("../../shared/modules/i18n"),y=e("../../shared/modules/conversion.utils"),w=e("../../shared/modules/error"),O=e("../../shared/lib/four-byte"),R=e("../../shared/lib/trace"),M=e("../helpers/constants/notifications"),v=e("../pages/confirmations/selectors/preferences"),D=e("../components/app/toast-master/utils"),b=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=B(t);if(n&&n.has(e))return n.get(e);var a={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=e[o]}return a.default=e,n&&n.set(e,a),a}(e("./actionConstants")),P=e("./background-connection");function B(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(B=function(e){return e?n:t})(e)}function L(e){return e&&e.__esModule?e:{default:e}}function U(){return{type:b.GO_HOME}}function F(){return async e=>{e(ie());try{await(0,P.submitRequestToBackground)("resetOAuthLoginState"),e({type:b.RESET_SOCIAL_LOGIN_ONBOARDING})}catch(t){throw e(le(t)),(0,w.isErrorWithMessage)(t)?new Error((0,w.getErrorMessage)(t)):t}finally{e(ue())}}}function q(e){return new Promise((t,n)=>{(0,P.callBackgroundMethod)("submitPassword",[e],e=>{e?n(e):t()})})}async function W(e,n,a){const r=Array.from(t.from(n,"utf8").values());await(0,P.submitRequestToBackground)("createSeedPhraseBackup",[e,r,a])}function H(e){return new Promise((t,n)=>{(0,P.callBackgroundMethod)("createNewVaultAndKeychain",[e],(e,a)=>{e?n(e):t(a)})})}function G(e){return new Promise((t,n)=>{(0,P.callBackgroundMethod)("verifyPassword",[e],e=>{e?n(e):t(!0)})})}async function K(e,n){const a=await(0,P.submitRequestToBackground)("getSeedPhrase",[e,n]);return t.from(a).toString("utf8")}function x(e){return{type:b.UPDATE_CUSTOM_NONCE,value:e}}function j(e){return t=>{t({type:b.COMPLETED_TX,value:{id:e}})}}function V(e,t){return{type:b.UPDATE_TRANSACTION_PARAMS,id:e,value:t}}async function Y(e){return(0,P.submitRequestToBackground)("handleSnapRequest",[e])}function $(){return e=>new Promise(e=>{(0,P.callBackgroundMethod)("unMarkPasswordForgotten",[],()=>{e()})}).then(()=>Ee(e))}function z(){return{type:b.UNLOCK_IN_PROGRESS}}function Q(e){return{type:b.UNLOCK_FAILED,value:e}}function X(e){return{type:b.UNLOCK_SUCCEEDED,value:e}}function Z(e){return{type:b.SET_SHOW_CONNECTIONS_REMOVED,value:e}}function J(e){return(t,n)=>{var a,r;const s=n(),i=(0,m.getProviderConfig)(s),{metamask:c}=s;if(null==e||!e.length)return c;const u=function(e,t){const n={...e};for(const e of t){const{op:t,path:a,value:r}=e;if("replace"!==t)throw new Error(`Unsupported patch operation: ${t}`);n[a[0]]=r}return n}(c,e),{currentLocale:d}=c,l=(0,S.getSelectedInternalAccount)(s),g=null==l?void 0:l.address,{currentLocale:T}=u,p=(0,m.getProviderConfig)({metamask:u}),f=(0,S.getSelectedInternalAccount)({metamask:u}),A=null==f?void 0:f.address;d&&T&&d!==T&&t(pe(T)),g!==A&&t({type:b.SELECTED_ADDRESS_CHANGED});const h=(null===(a=u.addressBook)||void 0===a?void 0:a[null==p?void 0:p.chainId])??{},_=(null===(r=c.addressBook)||void 0===r?void 0:r[null==i?void 0:i.chainId])??{},I=(0,S.getMetaMaskAccounts)({metamask:u}),N=(0,S.getMetaMaskAccounts)({metamask:c}),k=I[A],C=I[g];return Object.entries(N).forEach(([e,n])=>{(0,o.isEqual)(n,I[e])||t({type:b.ACCOUNT_CHANGED,payload:{account:I[e]}})}),!1===(0,o.isEqual)(C,k)&&t({type:b.SELECTED_ACCOUNT_CHANGED,payload:{account:k}}),!1===(0,o.isEqual)(_,h)&&t({type:b.ADDRESS_BOOK_UPDATED,payload:{addressBook:h}}),!1===(0,o.isEqual)(c.gasFeeEstimates,u.gasFeeEstimates)&&t({type:b.GAS_FEE_ESTIMATES_UPDATED,payload:{gasFeeEstimates:u.gasFeeEstimates,gasEstimateType:u.gasEstimateType}}),t({type:b.UPDATE_METAMASK_STATE,value:u}),i.chainId!==p.chainId&&(t({type:b.CHAIN_CHANGED,payload:p.chainId}),t((0,E.initializeSendState)({chainHasChanged:!0}))),u}}const ee=()=>new Promise((e,t)=>{(0,P.callBackgroundMethod)("setLocked",[],n=>{n?t(n):e()})});async function te(e){r.default.debug("background.setSelectedInternalAccount"),await(0,P.submitRequestToBackground)("setSelectedInternalAccount",[e])}function ne(){return{type:b.SHOW_ACCOUNTS_PAGE}}function ae({id:e}={}){return{type:b.SHOW_CONF_TX_PAGE,id:e}}function re(e){return async()=>{r.default.debug(`background.setActiveNetworkConfigurationId: ${e}`);try{await(0,P.submitRequestToBackground)("setActiveNetworkConfigurationId",[e])}catch(e){(0,w.logErrorWithMessage)(e)}}}function oe(e){return{type:b.MODAL_OPEN,payload:e}}function se(){return(e,t)=>{const n=t(),a=(0,S.getApprovalFlows)(n);(0,T.getEnvironmentType)()!==g.ENVIRONMENT_TYPE_NOTIFICATION||(0,S.hasTransactionPendingApprovals)(n)||(0,S.getIsSigningQRHardwareTransaction)(n)||0!==a.length||ke()}}function ie(e){return{type:b.SHOW_LOADING,payload:e}}function ce(){return{type:b.SHOW_NFT_STILL_FETCHING_INDICATION}}function ue(){return{type:b.HIDE_LOADING}}function de(){return{type:b.HIDE_NFT_STILL_FETCHING_INDICATION}}function le(e){var t;return(0,w.isErrorWithMessage)(e)?{type:b.DISPLAY_WARNING,payload:(null==e||null===(t=e.cause)||void 0===t?void 0:t.message)||e.message}:"string"==typeof e?{type:b.DISPLAY_WARNING,payload:e}:{type:b.DISPLAY_WARNING,payload:`${e}`}}function ge(){return{type:b.HIDE_WARNING}}function Te(e,t,n=!0){return a=>(n&&a(ie()),new Promise((r,o)=>{(0,P.callBackgroundMethod)("setPreference",[e,t],(e,t)=>{if(n&&a(ue()),e)return a(le(e)),void o(e);r(t)})}))}function Se(){return{type:b.COMPLETE_ONBOARDING}}function me(){return{type:b.RESET_ONBOARDING}}async function Ee(e){let t;try{t=await(0,P.submitRequestToBackground)("getStatePatches")}catch(t){throw e(le(t)),t}return e(J(t))}function pe(e){return async t=>{t(ie());try{await(0,C.loadRelativeTimeFormatLocaleData)(e);const n=await(0,C.fetchLocale)(e),a=await(0,P.submitRequestToBackground)("setCurrentLocale",[e]);(0,l.switchDirection)(a),t(fe(e,n))}catch(e){return void t(le(e))}finally{t(ue())}}}function fe(e,t){return{type:b.SET_CURRENT_LOCALE,payload:{locale:e,messages:t}}}function Ae(e){return{type:b.SET_NEXT_NONCE,payload:e}}function he(e){return{type:b.SET_REQUEST_ACCOUNT_TABS,payload:e}}function _e(e){return{type:b.SET_OPEN_METAMASK_TAB_IDS,payload:e}}async function Ie(e){return(0,P.submitRequestToBackground)("addPollingTokenToAppState",[e,g.POLLING_TOKEN_ENVIRONMENT_TYPES[(0,T.getEnvironmentType)()]])}async function Ne(e){return(0,P.submitRequestToBackground)("removePollingTokenFromAppState",[e,g.POLLING_TOKEN_ENVIRONMENT_TYPES[(0,T.getEnvironmentType)()]])}async function ke(){try{const e=await a.default.windows.getCurrent();if(e.type&&"popup"!==e.type)return void console.warn(`Not safe to close a window that is not a popup: It is of type: ${e.type}`)}catch(e){console.warn("attemptCloseNotificationPopup: Error encountered while checking window type",e)}await(0,P.submitRequestToBackground)("markNotificationPopupAsAutomaticallyClosed"),window.close();try{const e=await a.default.tabs.getCurrent();await a.default.tabs.remove(e.id)}catch(e){console.error("attemptCloseNotificationPopup: Failed to close tab",e)}}function Ce(e,t){return(0,P.submitRequestToBackground)("trackMetaMetricsEvent",[{...e,actionId:(0,P.generateActionId)()},t])}async function ye(e){await(0,P.submitRequestToBackground)("setUnconnectedAccountAlertShown",[e])}const we=async(e,t,n)=>{const a=t.map(t=>{const a={...e,maxFeePerGas:(0,y.decimalToHex)(t.maxFeePerGas),maxPriorityFeePerGas:(0,y.decimalToHex)(t.maxPriorityFeePerGas),gas:n?(0,y.decimalToHex)(21e3):e.gas,value:e.value};return n&&(a.to=a.from,a.data="0x"),a});return await(0,P.submitRequestToBackground)("approveTransactionsWithSameNonce",[a])}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"ui/store/actions.ts"}],[6982,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.generateActionId=n.callBackgroundMethod=void 0,n.setBackgroundConnection=async function(e){a=e},n.submitRequestToBackground=r;let a;function r(e,t){return a[e](...t??[])}n.generateActionId=()=>Date.now()+Math.random();n.callBackgroundMethod=(e,t,n)=>{r(e,t).then(e=>n(null,e),n)}}}},{package:"$root$",file:"ui/store/background-connection.ts"}],[7,{"../../../shared/modules/object.utils":5090},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SENTRY_UI_STATE=n.SENTRY_BACKGROUND_STATE=void 0;var a=e("../../../shared/modules/object.utils");const r=n.SENTRY_BACKGROUND_STATE={AccountTreeController:{accountTree:!1},AccountsController:{internalAccounts:{accounts:!1,selectedAccount:!1}},AccountTracker:{accounts:!1,accountsByChainId:!1,currentBlockGasLimit:!0,currentBlockGasLimitByChainId:!0},AddressBookController:{addressBook:!1},AlertController:{alertEnabledness:!0,unconnectedAccountAlertShownOrigins:!1,web3ShimUsageOrigins:!1},AnnouncementController:{announcements:!1},AuthenticationController:{isSignedIn:!1,srpSessionData:!1},NetworkOrderController:{orderedNetworkList:[],enabledNetworkMap:{}},AccountOrderController:{pinnedAccountList:[],hiddenAccountList:[]},AppMetadataController:{currentAppVersion:!0,currentMigrationVersion:!0,previousAppVersion:!0,previousMigrationVersion:!0},ApprovalController:{approvalFlows:!1,pendingApprovals:!1,pendingApprovalCount:!1},AppStateController:{browserEnvironment:!0,connectedStatusPopoverHasBeenShown:!0,currentPopupId:!1,onboardingDate:!1,currentExtensionPopupId:!1,defaultHomeActiveTabName:!0,enableEnforcedSimulations:!0,enableEnforcedSimulationsForTransactions:!1,fullScreenGasPollTokens:!0,hadAdvancedGasFeesSetPriorToMigration92_3:!0,isRampCardClosed:!0,nftsDetectionNoticeDismissed:!0,nftsDropdownState:!0,notificationGasPollTokens:!0,outdatedBrowserWarningLastShown:!0,popupGasPollTokens:!0,qrHardware:!0,recoveryPhraseReminderHasBeenShown:!0,recoveryPhraseReminderLastShown:!0,showBetaHeader:!0,showPermissionsTour:!0,showNetworkBanner:!0,showAccountBanner:!0,showTestnetMessageInDropdown:!0,surveyLinkLastClickedOrClosed:!0,snapsInstallPrivacyWarningShown:!0,termsOfUseLastAgreed:!0,throttledOrigins:!1,timeoutMinutes:!0,trezorModel:!0,isUpdateAvailable:!0,updateModalLastDismissedAt:!0,lastUpdatedAt:!0},MultichainBalancesController:{balances:!1},MultichainAssetsController:{accountsAssets:!1,assetsMetadata:!1},MultichainAssetsRatesController:{assetsRates:!1},BridgeController:{assetExchangeRates:!1,minimumBalanceForRentExemptionInLamports:!1,quoteRequest:{walletAddress:!1,srcTokenAddress:!0,slippage:!0,srcChainId:!0,destChainId:!0,destTokenAddress:!0,srcTokenAmount:!0},quotes:[],quotesInitialLoadTime:!0,quotesLastFetched:!0,quotesLoadingStatus:!0,quoteFetchError:!0,quotesRefreshCount:!0},BridgeStatusController:{txHistory:!1},CronjobController:{events:!1},CurrencyController:{currentCurrency:!0,currencyRates:!0},DecryptMessageController:{unapprovedDecryptMsgs:!1,unapprovedDecryptMsgCount:!0},EncryptionPublicKeyController:{unapprovedEncryptionPublicKeyMsgs:!1,unapprovedEncryptionPublicKeyMsgCount:!0},EnsController:{ensResolutionsByAddress:!1,ensEntries:!1},GasFeeController:{estimatedGasFeeTimeBounds:!0,gasEstimateType:!0,gasFeeEstimates:!0,gasFeeEstimatesByChainId:!0,nonRPCGasFeeApisDisabled:!1},KeyringController:{isUnlocked:!0,keyrings:!1},LoggingController:{logs:!1},NotificationServicesController:{subscriptionAccountsSeen:!1,isMetamaskNotificationsFeatureSeen:!1,isNotificationServicesEnabled:!1,isFeatureAnnouncementsEnabled:!1,metamaskNotificationsList:!1,metamaskNotificationsReadList:!1,isCheckingAccountsPresence:!1,isFetchingMetamaskNotifications:!1,isUpdatingMetamaskNotifications:!1,isUpdatingMetamaskNotificationsAccount:!1},MetaMetricsController:{eventsBeforeMetricsOptIn:!1,tracesBeforeMetricsOptIn:!1,fragments:!1,metaMetricsId:!0,participateInMetaMetrics:!0,segmentApiCalls:!1,traits:!1,dataCollectionForMarketing:!1,marketingCampaignCookieId:!0,latestNonAnonymousEventTimestamp:!0},MetaMetricsDataDeletionController:{metaMetricsDataDeletionId:!0,metaMetricsDataDeletionTimestamp:!0},NameController:{names:!1,nameSources:!1,useExternalNameSources:!1},NetworkController:{networkConfigurations:!1,networksMetadata:!0,selectedNetworkClientId:!1},NftController:{allNftContracts:!1,allNfts:!1,ignoredNfts:!1},OnboardingController:{completedOnboarding:!0,firstTimeFlowType:!0,onboardingTabs:!1,seedPhraseBackedUp:!0},PPOMController:{securityAlertsEnabled:!1,storageMetadata:[],versionInfo:[]},PermissionController:{subjects:!1},PermissionLogController:{permissionActivityLog:!1,permissionHistory:!1},PhishingController:{},PreferencesController:{advancedGasFee:!0,currentLocale:!0,dismissSeedBackUpReminder:!0,overrideContentSecurityPolicyHeader:!0,featureFlags:!0,forgottenPassword:!0,identities:!1,isIpfsGatewayEnabled:!1,ipfsGateway:!1,knownMethodData:!1,ledgerTransportType:!0,lostIdentities:!1,openSeaEnabled:!0,preferences:{autoLockTimeLimit:!0,hideZeroBalanceTokens:!0,showExtensionInFullSizeView:!0,showFiatInTestnets:!0,showTestNetworks:!0,smartTransactionsOptInStatus:!0,tokenNetworkFilter:{},showNativeTokenAsMainBalance:!0,showConfirmationAdvancedDetails:!0,privacyMode:!1},useExternalServices:!1,selectedAddress:!1,snapRegistryList:!1,theme:!0,signatureSecurityAlertResponses:!1,addressSecurityAlertResponses:!1,use4ByteResolution:!0,useAddressBarEnsResolution:!0,useBlockie:!0,useCurrencyRateCheck:!0,useMultiAccountBalanceChecker:!0,useNftDetection:!0,usePhishDetect:!0,useTokenDetection:!0,useTransactionSimulations:!0,enableMV3TimestampSave:!0},RemoteFeatureFlagController:{remoteFeatureFlags:!0,cacheTimestamp:!1},NotificationServicesPushController:{fcmToken:!1},MultichainRatesController:{fiatCurrency:!0,rates:!0,cryptocurrencies:!0},SelectedNetworkController:{domains:!1},SignatureController:{unapprovedPersonalMsgCount:!0,unapprovedPersonalMsgs:!1,unapprovedTypedMessages:!1,unapprovedTypedMessagesCount:!0},SmartTransactionsController:{smartTransactionsState:{fees:{approvalTxFees:!0,tradeTxFees:!0},liveness:!0,smartTransactions:!1,userOptIn:!0,userOptInV2:!0}},SnapController:{snaps:!1},SnapInterfaceController:{interfaces:!1},SnapInsightsController:{insights:!1},SnapsRegistry:{database:!1,lastUpdated:!1,databaseUnavailable:!1},SubjectMetadataController:{subjectMetadata:!1},SwapsController:{swapsState:{approveTxId:!1,customApproveTxData:!1,customGasPrice:!0,customMaxFeePerGas:!0,customMaxGas:!0,customMaxPriorityFeePerGas:!0,errorKey:!0,fetchParams:!0,quotes:!1,quotesLastFetched:!0,quotesPollingLimitEnabled:!0,routeState:!0,saveFetchedQuotes:!0,selectedAggId:!0,swapsFeatureFlags:!0,swapsFeatureIsLive:!0,swapsQuotePrefetchingRefreshTime:!0,swapsQuoteRefreshTime:!0,swapsStxBatchStatusRefreshTime:!0,swapsStxStatusDeadline:!0,swapsStxGetTransactionsRefreshTime:!0,swapsStxMaxFeeMultiplier:!0,swapsUserFeeLevel:!0,tokens:!1,topAggId:!1,tradeTxId:!1}},TokenDetectionController:{[a.AllProperties]:!1},TokenListController:{preventPollingOnNetworkRestart:!0,tokensChainsCache:{[a.AllProperties]:!1}},TokenBalancesController:{tokenBalances:!1},TokenRatesController:{marketData:!1},TokensController:{allDetectedTokens:{[a.AllProperties]:!1},allIgnoredTokens:{[a.AllProperties]:!1},allTokens:{[a.AllProperties]:!1}},TransactionController:{transactions:!1,lastFetchedBlockNumbers:!1,methodData:!1},TxController:{transactions:!1},UserOperationController:{userOperations:!1},UserStorageController:{isBackupAndSyncEnabled:!0,isBackupAndSyncUpdateLoading:!1,isAccountSyncingEnabled:!0,isContactSyncingEnabled:!0,hasAccountSyncingSyncedAtLeastOnce:!1,isAccountSyncingReadyToBeDispatched:!1}},o=Object.values(r).reduce((e,t)=>({...e,...t}),{});n.SENTRY_UI_STATE={gas:!0,history:!0,appState:{customNonceValue:!0,isAccountMenuOpen:!0,isNetworkMenuOpen:!0,nextNonce:!0,pendingTokens:!1,welcomeScreenSeen:!0,slides:!1,confirmationExchangeRates:!0},metamask:{...o,isInitialized:!0,useSafeChainsListValidation:!0,watchEthereumAccountEnabled:!1,addSnapAccountEnabled:!1,snapsAddSnapAccountModalDismissed:!1,newPrivacyPolicyToastClickedOrClosed:!1,newPrivacyPolicyToastShownDate:!1},unconnectedAccount:!0}}}},{package:"$root$",file:"app/scripts/constants/sentry-state.ts"}],[97,{"../../../../shared/modules/selectors/networks":5096,"@metamask/chain-agnostic-permission":1296,"@metamask/permission-controller":1816,"@metamask/snaps-utils":2242,"@metamask/utils":2359,nanoid:4196},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPermissionBackgroundApiMethods=function({permissionController:e,approvalController:t,accountsController:n,networkController:u,multichainNetworkController:d}){const l=t=>{let n;try{n=e.getCaveat(t,o.Caip25EndowmentPermissionName,o.Caip25CaveatType)}catch(e){if(!(e instanceof r.PermissionDoesNotExistError))throw e}return n},g=(t,a)=>{const r=l(t);if(!r)throw new Error(`Cannot set account permissions "${a.join(", ")}" for origin "${t}": no permission currently exists for this origin.`);if(0===a.length)return void e.revokePermission(t,o.Caip25EndowmentPermissionName);let s=[...(0,o.getAllScopesFromCaip25CaveatValue)(r.value)];const g=Object.keys((0,c.getNetworkConfigurationsByCaipChainId)({networkConfigurationsByChainId:u.state.networkConfigurationsByChainId,multichainNetworkConfigurationsByChainId:d.state.multichainNetworkConfigurationsByChainId,internalAccounts:n.state.internalAccounts}));a.forEach(e=>{const{chain:{namespace:t}}=(0,i.parseCaipAccountId)(e);if(!s.some(e=>{try{const{namespace:n}=(0,i.parseCaipChainId)(e);return t===n}catch(e){return!1}})){const e=g.filter(e=>{try{const{namespace:n}=(0,i.parseCaipChainId)(e);return t===n}catch(e){return!1}});s=[...s,...e]}});const T=(0,o.setChainIdsInCaip25CaveatValue)(r.value,s),S=(0,o.setNonSCACaipAccountIdsInCaip25CaveatValue)(T,a);e.updateCaveat(t,o.Caip25EndowmentPermissionName,o.Caip25CaveatType,S)},T=(t,n)=>{const a=l(t);if(!a)throw new Error(`Cannot set permission for chainIds "${n.join(", ")}": No permissions exist for origin "${t}".`);if(0!==n.length||(0,s.isSnapId)(t)){const r=(0,o.setChainIdsInCaip25CaveatValue)(a.value,n),s=(0,o.getCaipAccountIdsFromCaip25CaveatValue)(a.value),i=(0,o.setNonSCACaipAccountIdsInCaip25CaveatValue)(r,s);e.updateCaveat(t,o.Caip25EndowmentPermissionName,o.Caip25CaveatType,i)}else e.revokePermission(t,o.Caip25EndowmentPermissionName)},S=(e,t)=>{const a=l(e);if(!a)throw new Error(`Cannot add account permissions for origin "${e}": no permission currently exists for this origin.`);const r=t.map(e=>n.getAccountByAddress(e)).map(e=>`${e.scopes[0]}:${e.address}`),s=(0,o.getCaipAccountIdsFromCaip25CaveatValue)(a.value),i=Array.from(new Set([...s,...r]));g(e,i)},m=(e,t)=>{const n=l(e);if(!n)throw new Error(`Cannot add chain permissions for origin "${e}": no permission currently exists for this origin.`);const a=(0,o.getAllScopesFromCaip25CaveatValue)(n.value),r=Array.from(new Set([...a,...t]));T(e,r)};return{addPermittedAccount:(e,t)=>S(e,[t]),addPermittedAccounts:(e,t)=>S(e,t),removePermittedAccount:(e,t)=>{const a=l(e);if(!a)throw new Error(`Cannot remove account "${t}": No permissions exist for origin "${e}".`);const r=(0,o.getCaipAccountIdsFromCaip25CaveatValue)(a.value),s=n.getAccountByAddress(t),i=r.filter(e=>!(0,o.isInternalAccountInPermittedAccountIds)(s,[e]));r.length!==i.length&&g(e,i)},setPermittedAccounts:g,addPermittedChain:(e,t)=>m(e,[t]),addPermittedChains:(e,t)=>m(e,t),removePermittedChain:(e,t)=>{const n=l(e);if(!n)throw new Error(`Cannot remove permission for chainId "${t}": No permissions exist for origin "${e}".`);const a=(0,o.getAllScopesFromCaip25CaveatValue)(n.value),r=a.filter(e=>e!==t);a.length!==r.length&&T(e,r)},setPermittedChains:T,requestAccountsAndChainPermissionsWithId:n=>{const s=(0,a.nanoid)();return(async(n,a)=>{const{permissions:s}=await t.addAndShowApprovalRequest({id:a,origin:n,requestData:{metadata:{id:a,origin:n},permissions:{[o.Caip25EndowmentPermissionName]:{caveats:[{type:o.Caip25CaveatType,value:{requiredScopes:{},optionalScopes:{},isMultichainOrigin:!1}}]}}},type:r.MethodNames.RequestPermissions});e.grantPermissions({subject:{origin:n},approvedPermissions:s})})(n,s),s}}};var a=e("nanoid"),r=e("@metamask/permission-controller"),o=e("@metamask/chain-agnostic-permission"),s=e("@metamask/snaps-utils"),i=e("@metamask/utils"),c=e("../../../../shared/modules/selectors/networks")}}},{package:"$root$",file:"app/scripts/controllers/permissions/background-api.js"}],[98,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRemovedAuthorizations=n.getChangedAuthorizations=n.diffMap=void 0;n.diffMap=(e,t)=>{if(t===undefined)return e;const n=new Map;if(e===t)return n;const a=new Set([...e.keys()]);for(const r of t.keys()){const o=e.get(r)??[];o!==t.get(r)&&n.set(r,o),a.delete(r)}for(const t of a.keys())n.set(t,e.get(t));return n};n.getChangedAuthorizations=(e,t)=>{if(t===undefined)return e;const n=new Map;if(e===t)return n;const a=new Set([...e.keys()]);for(const r of t.keys()){const o=e.get(r)??{requiredScopes:{},optionalScopes:{}};t.get(r)!==o&&n.set(r,{requiredScopes:o.requiredScopes,optionalScopes:o.optionalScopes}),a.delete(r)}for(const t of a.keys())n.set(t,e.get(t));return n};n.getRemovedAuthorizations=(e,t)=>{const n=new Map;if(t===undefined||e===t)return n;for(const[a,r]of t.entries()){const t=e.get(a);if(!t){n.set(a,r);continue}const o={};Object.entries(r.requiredScopes).forEach(([e,n])=>{t.requiredScopes[e]||(o[e]=n)});const s={};Object.entries(r.optionalScopes).forEach(([e,n])=>{t.optionalScopes[e]||(s[e]=n)}),(Object.keys(o).length>0||Object.keys(s).length>0)&&n.set(a,{requiredScopes:o,optionalScopes:s})}return n}}}},{package:"$root$",file:"app/scripts/controllers/permissions/differs.ts"}],[99,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NOTIFICATION_NAMES=void 0;n.NOTIFICATION_NAMES=function(e){return e.accountsChanged="metamask_accountsChanged",e.chainChanged="metamask_chainChanged",e}({})}}},{package:"$root$",file:"app/scripts/controllers/permissions/enums.ts"}]],[],{});