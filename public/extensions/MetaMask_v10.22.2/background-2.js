LavaPack.loadBundle([[182,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:63,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=63;const i=function(e){var t,i,r,a,n,s,o,l;const c=null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.accountTokens,d=null==e||null===(i=e.PreferencesController)||void 0===i?void 0:i.accountHiddenTokens,u={};c&&Object.keys(c).forEach((e=>{Object.keys(c[e]).forEach((t=>{const i=c[e][t];u[t]===undefined?u[t]={[e]:i}:u[t]={...u[t],[e]:i}}))}));const h={};d&&Object.keys(d).forEach((e=>{Object.keys(d[e]).forEach((t=>{const i=d[e][t];h[t]===undefined?h[t]={[e]:i}:h[t]={...h[t],[e]:i}}))}));e.TokensController?(e.TokensController.allTokens=u,e.TokensController.allIgnoredTokens=h):e.TokensController={allTokens:u,allIgnoredTokens:h};return null==e||null===(r=e.PreferencesController)||void 0===r||delete r.accountHiddenTokens,null==e||null===(a=e.PreferencesController)||void 0===a||delete a.accountTokens,null==e||null===(n=e.PreferencesController)||void 0===n||delete n.assetImages,null==e||null===(s=e.PreferencesController)||void 0===s||delete s.hiddenTokens,null==e||null===(o=e.PreferencesController)||void 0===o||delete o.tokens,null==e||null===(l=e.PreferencesController)||void 0===l||delete l.suggestedTokens,e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/063.js"}],[1820,{"./chunk-UJFCPTF3.js":1822,"./chunk-Z4BLTVTB.js":1823},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,i.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,r,new Map),l.__privateAdd.call(void 0,this,a,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,r).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,r).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,r).delete(e)}clearActions(){l.__privateGet.call(void 0,this,r).clear()}call(e,...t){const i=l.__privateGet.call(void 0,this,r).get(e);if(!i)throw new Error(`A handler for ${e} has not been registered`);return i(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,n).set(e,t)}publish(e,...t){const i=l.__privateGet.call(void 0,this,a).get(e);if(i)for(const[e,r]of i.entries())try{if(r){const i=l.__privateGet.call(void 0,this,s).get(e),a=r(...t);a!==i&&(l.__privateGet.call(void 0,this,s).set(e,a),e(a,i))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,i){let r=l.__privateGet.call(void 0,this,a).get(e);if(r||(r=new Map,l.__privateGet.call(void 0,this,a).set(e,r)),r.set(t,i),i){const r=l.__privateGet.call(void 0,this,n).get(e);if(r){const e=i(...r());l.__privateGet.call(void 0,this,s).set(t,e)}}}unsubscribe(e,t){const i=l.__privateGet.call(void 0,this,a).get(e);if(!i||!i.has(t))throw new Error(`Subscription not found for event: ${e}`);i.get(t)&&l.__privateGet.call(void 0,this,s).delete(t),i.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,a).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,a).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:i}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:i})}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1821,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,i=!0){if(i){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const i=e[t];this.internalConfig[t]=i,this[t]=i}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},a=r;i.BaseControllerV1=r,i.BaseControllerV1_default=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1822,{"./chunk-Z4BLTVTB.js":1823},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,s);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,n);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,a)}:`)},i.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:i,allowedEvents:l}){p.__privateAdd.call(void 0,this,o),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,r,void 0),p.__privateAdd.call(void 0,this,a,void 0),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateSet.call(void 0,this,r,e),p.__privateSet.call(void 0,this,a,t),p.__privateSet.call(void 0,this,n,i),p.__privateSet.call(void 0,this,s,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,r).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).publish(e,...t)}subscribe(e,t,i){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return i?p.__privateGet.call(void 0,this,r).subscribe(e,t,i):p.__privateGet.call(void 0,this,r).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,r).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).clearEventSubscriptions(e)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1823,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1824,{"./chunk-Z4BLTVTB.js":1823,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-Z4BLTVTB.js"),n=e("immer");n.enablePatches.call(void 0);function s(e,t,i){return Object.keys(e).reduce(((r,a)=>{try{const n=t[a];if(!n)throw new Error(`No metadata found for '${String(a)}'`);const s=n[i],o=e[a];return"function"==typeof s?r[a]=s(o):s&&(r[a]=o),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}r=new WeakMap,i.BaseController=class{constructor({messenger:e,metadata:t,name:i,state:s}){a.__privateAdd.call(void 0,this,r,void 0),this.messagingSystem=e,this.name=i,a.__privateSet.call(void 0,this,r,n.freeze.call(void 0,s,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${i}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${i}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return a.__privateGet.call(void 0,this,r)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,i,s]=n.produceWithPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);return a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,i),{nextState:t,patches:i,inversePatches:s}}applyPatches(e){const t=n.applyPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},i.getAnonymizedState=function(e,t){return s(e,t,"anonymous")},i.getPersistentState=function(e,t){return s(e,t,"persist")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1825,{"./chunk-G42723LG.js":1820,"./chunk-NINOM2XQ.js":1821,"./chunk-UJFCPTF3.js":1822,"./chunk-Z4BLTVTB.js":1823,"./chunk-ZNOPSWMU.js":1824},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-NINOM2XQ.js"),a=e("./chunk-ZNOPSWMU.js"),n=e("./chunk-G42723LG.js"),s=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),i.BaseController=a.BaseController,i.BaseControllerV1=r.BaseControllerV1,i.ControllerMessenger=n.ControllerMessenger,i.RestrictedControllerMessenger=s.RestrictedControllerMessenger,i.getAnonymizedState=a.getAnonymizedState,i.getPersistentState=a.getPersistentState}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1826,{"./chunk-RKVNLW2C.js":1830,"@ethereumjs/util":1812,"@metamask/ethjs-unit":1336,"@metamask/utils":2255,"bn.js":2935,buffer:2983,"eth-ens-namehash":3173,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a=e("./chunk-RKVNLW2C.js"),n=e("@ethereumjs/util"),s=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=r(e("bn.js")),c=r(e("eth-ens-namehash")),d=r(e("fast-deep-equal")),u=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function m(e,t){const i=await fetch(e,t);if(!i.ok)throw new Error(`Fetch failed with status '${i.status}' for request '${String(e)}'`);return i}async function f(e,t){const i=await m(e,t);return await i.json()}i.PROTOTYPE_POLLUTION_BLOCKLIST=h,i.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},i.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=a.MAX_SAFE_CHAIN_ID},i.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},i.fractionBN=function(e,t,i){const r=new(0,l.default)(t),a=new(0,l.default)(i);return e.mul(r).div(a)},i.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),i=t[0]||"0";let r=t[1]||"";if(!r)return s.toWei.call(void 0,i,"gwei");if(r.length<=9)return s.toWei.call(void 0,`${i}.${r}`,"gwei");const a=r.slice(9)[0];r=r.slice(0,9);let n=s.toWei.call(void 0,`${i}.${r}`,"gwei");return Number(a)>=5&&(n=n.add(new(0,l.default)(1))),n},i.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return s.fromWei.call(void 0,t,"gwei")},i.getBuyURL=function(e="1",t,i=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${i}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},i.hexToBN=p,i.hexToText=function(e){try{const i=o.remove0x.call(void 0,e);return t.from(i,"hex").toString("utf8")}catch(t){return e}},i.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(p(e).toString(10))},i.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},i.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},i.safelyExecuteWithTimeout=async function(e,t=!1,i=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])}catch(e){return void(t&&console.error(e))}},i.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?n.toChecksumAddress.call(void 0,t):t},i.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const i=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,i)&&n.isValidAddress.call(void 0,i)},i.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},i.successfulFetch=m,i.handleFetch=f,i.fetchWithErrorHandling=async function({url:e,options:t,timeout:i,errorCodesToCatch:r}){let a;try{a=i?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==u)throw e;console.error(e)}(e,r)}return a},i.timeoutFetch=async function(e,t,i=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])},i.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},i.query=function(e,t,i=[]){return new Promise(((r,a)=>{const n=(e,t)=>{e?a(e):r(t)};t in e&&"function"==typeof e[t]?e[t](...i,n):e.sendAsync({method:t,params:i},n)}))},i.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,i.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},i.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},i.isValidJson=function(e){try{return d.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-7C4YHS6A.js"}],[1827,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=r.createProjectLogger.call(void 0,"controller-utils");i.createModuleLogger=r.createModuleLogger,i.projectLogger=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1828,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},a={...r,rpc:"rpc"};var n=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(n||{}),s={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});i.InfuraNetworkType=r,i.NetworkType=a,i.isNetworkType=function(e){return Object.values(a).includes(e)},i.isInfuraNetworkType=function(e){return Object.keys(r).includes(e)},i.BuiltInNetworkName=n,i.ChainId=s,i.NetworksTicker=o}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1829,{"./chunk-DBJSLKNR.js":1827,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-DBJSLKNR.js"),a=e("@metamask/utils"),n=e("@spruceid/siwe-parser"),s=r.createModuleLogger.call(void 0,r.projectLogger,"detect-siwe");function o(e){try{const r="string"!=typeof(i=e)?i:a.remove0x.call(void 0,i),n=t.from(r,"hex");return 32===n.length?e:n.toString("utf8")}catch(t){return s(t),e}var i}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);i.parseDomainParts=c,i.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:i}=e;if(!t||!i?.parsedMessage?.domain)return!1;const r=new URL(t),a=c(i.parsedMessage.domain,r.protocol);return 0===a.hostname.localeCompare(r.hostname,void 0,{sensitivity:"accent"})&&(""!==a.port&&a.port!==r.port?""===r.port&&a.port===l[r.protocol]:""===a.username||a.username===r.username)}catch(e){return s(e),!1}},i.detectSIWE=e=>{try{const{data:t}=e,i=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,n.ParsedMessage)(i)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[183,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash"),a=e("@metamask/transaction-controller");const n="sentEther";i.default={version:64,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=64;const i=function(e){var t;const i=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,r.isPlainObject)(i))for(const e of Object.values(i))e.type===n&&(e.type=a.TransactionType.simpleSend),e.history&&e.history.map((e=>(e.type&&e.type===n&&(e.type=a.TransactionType.simpleSend),e)));return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/064.js"}],[1830,{"./chunk-LGGBBU6G.js":1828},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LGGBBU6G.js"),a={[r.NetworkType.goerli]:{chainId:r.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.goerli}.etherscan.io`}},[r.NetworkType.sepolia]:{chainId:r.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.sepolia}.etherscan.io`}},[r.NetworkType.mainnet]:{chainId:r.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[r.NetworkType["linea-goerli"]]:{chainId:r.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[r.NetworkType["linea-sepolia"]]:{chainId:r.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[r.NetworkType["linea-mainnet"]]:{chainId:r.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[r.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},n=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(n||{}),s={[r.ChainId.goerli]:"goerli",[r.ChainId.sepolia]:"sepolia",[r.ChainId.mainnet]:"mainnet",[r.ChainId["linea-goerli"]]:"linea-goerli",[r.ChainId["linea-sepolia"]]:"linea-sepolia",[r.ChainId["linea-mainnet"]]:"linea-mainnet",[r.ChainId.aurora]:"aurora"};i.RPC="rpc",i.FALL_BACK_VS_CURRENCY="ETH",i.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",i.GANACHE_CHAIN_ID="0x539",i.MAX_SAFE_CHAIN_ID=0xfffffffffffec,i.ERC721="ERC721",i.ERC1155="ERC1155",i.ERC20="ERC20",i.ERC721_INTERFACE_ID="0x80ac58cd",i.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",i.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",i.ERC1155_INTERFACE_ID="0xd9b67a26",i.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",i.GWEI="gwei",i.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},i.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},i.BUILT_IN_NETWORKS=a,i.OPENSEA_PROXY_URL="https://proxy.api.cx.metamask.io/opensea/v1/api/v2",i.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",i.NFT_API_VERSION="1",i.NFT_API_TIMEOUT=15e3,i.ORIGIN_METAMASK="metamask",i.ApprovalType=n,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-RKVNLW2C.js"}],[1831,{"./chunk-7C4YHS6A.js":1826,"./chunk-DBJSLKNR.js":1827,"./chunk-LGGBBU6G.js":1828,"./chunk-M6G3ISXG.js":1829,"./chunk-RKVNLW2C.js":1830},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var a=e("./chunk-7C4YHS6A.js"),n=e("./chunk-RKVNLW2C.js"),s=e("./chunk-LGGBBU6G.js");i.ASSET_TYPES=n.ASSET_TYPES,i.ApprovalType=n.ApprovalType,i.BNToHex=a.BNToHex,i.BUILT_IN_NETWORKS=n.BUILT_IN_NETWORKS,i.BuiltInNetworkName=s.BuiltInNetworkName,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=n.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,i.ChainId=s.ChainId,i.ERC1155=n.ERC1155,i.ERC1155_INTERFACE_ID=n.ERC1155_INTERFACE_ID,i.ERC1155_METADATA_URI_INTERFACE_ID=n.ERC1155_METADATA_URI_INTERFACE_ID,i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=n.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,i.ERC20=n.ERC20,i.ERC721=n.ERC721,i.ERC721_ENUMERABLE_INTERFACE_ID=n.ERC721_ENUMERABLE_INTERFACE_ID,i.ERC721_INTERFACE_ID=n.ERC721_INTERFACE_ID,i.ERC721_METADATA_INTERFACE_ID=n.ERC721_METADATA_INTERFACE_ID,i.FALL_BACK_VS_CURRENCY=n.FALL_BACK_VS_CURRENCY,i.GANACHE_CHAIN_ID=n.GANACHE_CHAIN_ID,i.GWEI=n.GWEI,i.IPFS_DEFAULT_GATEWAY_URL=n.IPFS_DEFAULT_GATEWAY_URL,i.InfuraNetworkType=s.InfuraNetworkType,i.MAX_SAFE_CHAIN_ID=n.MAX_SAFE_CHAIN_ID,i.NFT_API_BASE_URL=n.NFT_API_BASE_URL,i.NFT_API_TIMEOUT=n.NFT_API_TIMEOUT,i.NFT_API_VERSION=n.NFT_API_VERSION,i.NetworkType=s.NetworkType,i.NetworksTicker=s.NetworksTicker,i.OPENSEA_PROXY_URL=n.OPENSEA_PROXY_URL,i.ORIGIN_METAMASK=n.ORIGIN_METAMASK,i.RPC=n.RPC,i.TESTNET_TICKER_SYMBOLS=n.TESTNET_TICKER_SYMBOLS,i.convertHexToDecimal=a.convertHexToDecimal,i.detectSIWE=r.detectSIWE,i.fetchWithErrorHandling=a.fetchWithErrorHandling,i.fractionBN=a.fractionBN,i.fromHex=a.fromHex,i.getBuyURL=a.getBuyURL,i.gweiDecToWEIBN=a.gweiDecToWEIBN,i.handleFetch=a.handleFetch,i.hexToBN=a.hexToBN,i.hexToText=a.hexToText,i.isInfuraNetworkType=s.isInfuraNetworkType,i.isNetworkType=s.isNetworkType,i.isNonEmptyArray=a.isNonEmptyArray,i.isPlainObject=a.isPlainObject,i.isSafeChainId=a.isSafeChainId,i.isSafeDynamicKey=a.isSafeDynamicKey,i.isSmartContractCode=a.isSmartContractCode,i.isValidHexAddress=a.isValidHexAddress,i.isValidJson=a.isValidJson,i.isValidSIWEOrigin=r.isValidSIWEOrigin,i.normalizeEnsName=a.normalizeEnsName,i.parseDomainParts=r.parseDomainParts,i.query=a.query,i.safelyExecute=a.safelyExecute,i.safelyExecuteWithTimeout=a.safelyExecuteWithTimeout,i.successfulFetch=a.successfulFetch,i.timeoutFetch=a.timeoutFetch,i.toChecksumHexAddress=a.toChecksumHexAddress,i.toHex=a.toHex,i.weiHexToGweiDec=a.weiHexToGweiDec}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1832,{"./chunk-LBXAXAXH.js":1833,"@metamask/base-controller":1825},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LBXAXAXH.js"),a=e("@metamask/base-controller");function n(e){var t,i;class a extends(r.AbstractPollingControllerBaseMixin.call(void 0,e)){constructor(){super(...arguments),r.__privateAdd.call(void 0,this,t,{}),r.__privateAdd.call(void 0,this,i,1e3)}setIntervalLength(e){r.__privateSet.call(void 0,this,i,e)}getIntervalLength(){return r.__privateGet.call(void 0,this,i)}_startPollingByNetworkClientId(e,a){if(!r.__privateGet.call(void 0,this,i))throw new Error("intervalLength must be defined and greater than 0");const n=r.getKey.call(void 0,e,a),s=r.__privateGet.call(void 0,this,t)[n];this._stopPollingByPollingTokenSetId(n);const o=r.__privateGet.call(void 0,this,t)[n]=setTimeout((async()=>{try{await this._executePoll(e,a)}catch(e){console.error(e)}o===r.__privateGet.call(void 0,this,t)[n]&&this._startPollingByNetworkClientId(e,a)}),s?r.__privateGet.call(void 0,this,i):0)}_stopPollingByPollingTokenSetId(e){const i=r.__privateGet.call(void 0,this,t)[e];i&&(clearTimeout(i),delete r.__privateGet.call(void 0,this,t)[e])}}return t=new WeakMap,i=new WeakMap,a}var s=n(class{}),o=n(a.BaseController),l=n(a.BaseControllerV1);i.StaticIntervalPollingControllerOnly=s,i.StaticIntervalPollingController=o,i.StaticIntervalPollingControllerV1=l}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/chunk-I2PH5XQP.js"}],[1833,{"fast-json-stable-stringify":3311,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},n=(e,t,i)=>(a(e,t,"read from private field"),i?i.call(e):t.get(e)),s=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},o=e("fast-json-stable-stringify"),l=(r=o)&&r.__esModule?r:{default:r},c=e("uuid"),d=(e,t)=>`${e}:${l.default.call(void 0,t)}`;i.__privateGet=n,i.__privateAdd=s,i.__privateSet=(e,t,i,r)=>(a(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),i.getKey=d,i.AbstractPollingControllerBaseMixin=function(e){var t,i;return t=new WeakMap,i=new WeakMap,class extends e{constructor(){super(...arguments),s(this,t,new Map),s(this,i,new Map)}startPollingByNetworkClientId(e,i={}){const r=c.v4.call(void 0),a=d(e,i),s=n(this,t).get(a)??new Set;return s.add(r),n(this,t).set(a,s),1===s.size&&this._startPollingByNetworkClientId(e,i),r}stopAllPolling(){n(this,t).forEach(((e,t)=>{e.forEach((e=>{this.stopPollingByPollingToken(e)}))}))}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");let r=null;for(const[i,a]of n(this,t))if(a.delete(e)){0===a.size&&(r=i);break}if(r){this._stopPollingByPollingTokenSetId(r),n(this,t).delete(r);const e=n(this,i).get(r);if(e){for(const t of e)t(r);e.clear()}}}onPollingCompleteByNetworkClientId(e,t,r={}){const a=d(e,r),s=n(this,i).get(a)??new Set;s.add(t),n(this,i).set(a,s)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/chunk-LBXAXAXH.js"}],[1834,{"./chunk-LBXAXAXH.js":1833,"@metamask/base-controller":1825},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LBXAXAXH.js"),a=e("@metamask/base-controller");function n(e){var t;class i extends(r.AbstractPollingControllerBaseMixin.call(void 0,e)){constructor(){super(...arguments),r.__privateAdd.call(void 0,this,t,{})}_startPollingByNetworkClientId(e,i){const a=r.getKey.call(void 0,e,i);if(r.__privateGet.call(void 0,this,t)[a])return;const n=this._getNetworkClientById(e);if(!n)throw new Error(`Unable to retrieve blockTracker for networkClientId ${e}`);{const s=this._executePoll.bind(this,e,i);n.blockTracker.addListener("latest",s),r.__privateGet.call(void 0,this,t)[a]=s}}_stopPollingByPollingTokenSetId(e){const[i]=e.split(":"),a=this._getNetworkClientById(i);if(a&&r.__privateGet.call(void 0,this,t)[e]){const i=r.__privateGet.call(void 0,this,t)[e];i&&(a.blockTracker.removeListener("latest",i),delete r.__privateGet.call(void 0,this,t)[e])}}}return t=new WeakMap,i}var s=n(class{}),o=n(a.BaseController),l=n(a.BaseControllerV1);i.BlockTrackerPollingControllerOnly=s,i.BlockTrackerPollingController=o,i.BlockTrackerPollingControllerV1=l}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/chunk-MUDX6BUY.js"}],[1835,{"./chunk-I2PH5XQP.js":1832,"./chunk-LBXAXAXH.js":1833,"./chunk-MUDX6BUY.js":1834},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-MUDX6BUY.js"),a=e("./chunk-I2PH5XQP.js");e("./chunk-LBXAXAXH.js"),i.BlockTrackerPollingController=r.BlockTrackerPollingController,i.BlockTrackerPollingControllerOnly=r.BlockTrackerPollingControllerOnly,i.BlockTrackerPollingControllerV1=r.BlockTrackerPollingControllerV1,i.StaticIntervalPollingController=a.StaticIntervalPollingController,i.StaticIntervalPollingControllerOnly=a.StaticIntervalPollingControllerOnly,i.StaticIntervalPollingControllerV1=a.StaticIntervalPollingControllerV1}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/index.js"}],[1836,{"./chunk-S6VGOPUY.js":1854,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-S6VGOPUY.js"),a=e("@metamask/utils").createModuleLogger.call(void 0,r.projectLogger,"layer-1-gas-fee-flow");async function n({layer1GasFeeFlows:e,provider:t,transactionMeta:i}){const r=function(e,t){return t.find((t=>t.matchesTransaction(e)))}(i,e);if(r){a("Found layer 1 gas fee flow",r.constructor.name,i.id);try{const{layer1Fee:e}=await r.getLayer1Fee({provider:t,transactionMeta:i});return e}catch(e){return void a("Failed to get layer 1 gas fee",i.id,e)}}}i.updateTransactionLayer1GasFee=async function(e){const t=await n(e);if(!t)return;const{transactionMeta:i}=e;i.layer1GasFee=t,a("Updated layer 1 gas fee",t,i.id)},i.getTransactionLayer1GasFee=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-2XKEAKQG.js"}],[1837,{"./chunk-DLOQPH4M.js":1841,"./chunk-S6VGOPUY.js":1854,"./chunk-UT4M4XI3.js":1860,"@metamask/controller-utils":1903,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-UT4M4XI3.js"),a=e("./chunk-DLOQPH4M.js"),n=e("./chunk-S6VGOPUY.js"),s=e("@metamask/controller-utils"),o=e("@metamask/utils"),l=o.createModuleLogger.call(void 0,n.projectLogger,"gas-fees");function c(e){return s.toHex.call(void 0,s.gweiDecToWEIBN.call(void 0,e))}i.updateGasFees=async function(e){const{txMeta:t}=e,i={...t.txParams},n=r.SWAP_TRANSACTION_TYPES.includes(t.type)?void 0:e.getSavedGasFees(t.chainId),d=await async function(e){const{eip1559:t,ethQuery:i,gasFeeFlows:r,getGasFeeEstimates:n,txMeta:c}=e,{networkClientId:d}=c;if(!t&&c.txParams.gasPrice||t&&c.txParams.maxFeePerGas&&c.txParams.maxPriorityFeePerGas)return{};const u=a.getGasFeeFlow.call(void 0,c,r);try{const e=await n({networkClientId:d}),t=await u.getGasFees({ethQuery:i,gasFeeControllerData:e,transactionMeta:c}),r=t.estimates?.type;switch(r){case"fee-market":return t.estimates.medium;case"legacy":return{gasPrice:t.estimates.medium};case"eth_gasPrice":return{gasPrice:t.estimates.gasPrice};default:throw new Error(`Unsupported gas fee estimate type returned from flow: ${r}`)}}catch(e){l("Failed to get suggested gas fees",e)}const h=await s.query.call(void 0,i,"gasPrice");return{gasPrice:h?o.add0x.call(void 0,h.toString(16)):void 0}}(e);l("Suggested gas fees",d);const u={...e,initialParams:i,savedGasFees:n,suggestedGasFees:d};t.txParams.maxFeePerGas=function(e){const{savedGasFees:t,eip1559:i,initialParams:r,suggestedGasFees:a}=e;if(!i)return;if(t){const e=c(t.maxBaseFee);return l("Using maxFeePerGas from savedGasFees",e),e}if(r.maxFeePerGas)return l("Using maxFeePerGas from request",r.maxFeePerGas),r.maxFeePerGas;if(r.gasPrice&&!r.maxPriorityFeePerGas)return l("Setting maxFeePerGas to gasPrice from request",r.gasPrice),r.gasPrice;if(a.maxFeePerGas)return l("Using suggested maxFeePerGas",a.maxFeePerGas),a.maxFeePerGas;if(a.gasPrice)return l("Setting maxFeePerGas to suggested gasPrice",a.gasPrice),a.gasPrice;return void l("maxFeePerGas not set")}(u),t.txParams.maxPriorityFeePerGas=function(e){const{eip1559:t,initialParams:i,savedGasFees:r,suggestedGasFees:a,txMeta:n}=e;if(!t)return;if(r){const e=c(r.priorityFee);return l("Using maxPriorityFeePerGas from savedGasFees.priorityFee",e),e}if(i.maxPriorityFeePerGas)return l("Using maxPriorityFeePerGas from request",i.maxPriorityFeePerGas),i.maxPriorityFeePerGas;if(i.gasPrice&&!i.maxFeePerGas)return l("Setting maxPriorityFeePerGas to gasPrice from request",i.gasPrice),i.gasPrice;if(a.maxPriorityFeePerGas)return l("Using suggested maxPriorityFeePerGas",a.maxPriorityFeePerGas),a.maxPriorityFeePerGas;if(n.txParams.maxFeePerGas)return l("Setting maxPriorityFeePerGas to maxFeePerGas",n.txParams.maxFeePerGas),n.txParams.maxFeePerGas;return void l("maxPriorityFeePerGas not set")}(u),t.txParams.gasPrice=function(e){const{eip1559:t,initialParams:i,suggestedGasFees:r}=e;if(t)return;if(i.gasPrice)return l("Using gasPrice from request",i.gasPrice),i.gasPrice;if(r.maxFeePerGas)return l("Using suggested maxFeePerGas",r.maxFeePerGas),r.maxFeePerGas;if(r.gasPrice)return l("Using suggested gasPrice",r.gasPrice),r.gasPrice;return void l("gasPrice not set")}(u),t.userFeeLevel=function(e){const{eip1559:t,initialParams:i,savedGasFees:r,suggestedGasFees:a,txMeta:n}=e;if(!t)return;if(r)return"custom";if(!i.maxFeePerGas&&!i.maxPriorityFeePerGas&&i.gasPrice)return n.origin===s.ORIGIN_METAMASK?"custom":"dappSuggested";if(!i.maxFeePerGas&&!i.maxPriorityFeePerGas&&a.maxFeePerGas&&a.maxPriorityFeePerGas)return"medium";if(n.origin===s.ORIGIN_METAMASK)return"medium";return"dappSuggested"}(u),l("Updated gas fee properties",{maxFeePerGas:t.txParams.maxFeePerGas,maxPriorityFeePerGas:t.txParams.maxPriorityFeePerGas,gasPrice:t.txParams.gasPrice}),(t.txParams.maxFeePerGas||t.txParams.maxPriorityFeePerGas)&&delete t.txParams.gasPrice,t.txParams.gasPrice&&(delete t.txParams.maxFeePerGas,delete t.txParams.maxPriorityFeePerGas),function(e){e.defaultGasEstimates||(e.defaultGasEstimates={});e.defaultGasEstimates.maxFeePerGas=e.txParams.maxFeePerGas,e.defaultGasEstimates.maxPriorityFeePerGas=e.txParams.maxPriorityFeePerGas,e.defaultGasEstimates.gasPrice=e.txParams.gasPrice,e.defaultGasEstimates.estimateType=e.userFeeLevel}(t)},i.gweiDecimalToWeiHex=c}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-3ZRHCVVS.js"}],[1838,{"./chunk-S6VGOPUY.js":1854,"./chunk-Z4BLTVTB.js":1866,"@metamask/controller-utils":1903,events:3276,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I,j,M,x,N,R,O,G,L,B,F,D,U,H,W,$,V,K,Y,q,X,J,z,Z,Q,ee,te,ie,re=e("./chunk-S6VGOPUY.js"),ae=e("./chunk-Z4BLTVTB.js"),ne=e("@metamask/controller-utils"),se=e("events"),oe=(r=se)&&r.__esModule?r:{default:r},le=e("lodash"),ce=["replacement transaction underpriced","known transaction","gas price too low to replace","transaction with the same hash was already imported","gateway timeout","nonce too low"],de=re.createModuleLogger.call(void 0,re.projectLogger,"pending-transactions");a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakSet,_=function(){ae.__privateGet.call(void 0,this,m)||(ae.__privateGet.call(void 0,this,n).on("latest",ae.__privateGet.call(void 0,this,u)),ae.__privateSet.call(void 0,this,m,!0),de("Started polling"))},k=new WeakSet,w=async function(e){const t=await ae.__privateGet.call(void 0,this,h).call(this);try{await ae.__privateMethod.call(void 0,this,y,T).call(this)}catch(e){de("Failed to check transactions",e)}finally{t()}try{await ae.__privateMethod.call(void 0,this,b,E).call(this,e)}catch(e){de("Failed to resubmit transactions",e)}},y=new WeakSet,T=async function(){de("Checking transactions");const e=ae.__privateMethod.call(void 0,this,F,D).call(this);e.length?(de("Found pending transactions to check",{count:e.length,ids:e.map((e=>e.id))}),await Promise.all(e.map((e=>ae.__privateMethod.call(void 0,this,M,x).call(this,e))))):de("No pending transactions to check")},b=new WeakSet,E=async function(e){if(!ae.__privateGet.call(void 0,this,d).call(this)||!ae.__privateGet.call(void 0,this,m))return;de("Resubmitting transactions");const t=ae.__privateMethod.call(void 0,this,F,D).call(this);if(t.length){de("Found pending transactions to resubmit",{count:t.length,ids:t.map((e=>e.id))});for(const i of t)try{await ae.__privateMethod.call(void 0,this,C,A).call(this,i,e)}catch(e){const t=e.value?.message?.toLowerCase()||e.message.toLowerCase();if(ae.__privateMethod.call(void 0,this,S,P).call(this,t))return void de("Ignoring known transaction error",t);ae.__privateMethod.call(void 0,this,U,H).call(this,i,e.message,"There was an error when resubmitting this transaction.")}}else de("No pending transactions to resubmit")},S=new WeakSet,P=function(e){return ce.some((t=>e.includes(t)))},C=new WeakSet,A=async function(e,t){if(!ae.__privateMethod.call(void 0,this,I,j).call(this,e,t))return;const{rawTx:i}=e;if(!ae.__privateGet.call(void 0,this,v).call(this,e))return;if(!i?.length)return de("Approving transaction as no raw value"),void await ae.__privateGet.call(void 0,this,a).call(this,e.id);const r=ae.__privateGet.call(void 0,this,l).call(this,e.networkClientId);await ae.__privateGet.call(void 0,this,p).call(this,r,i);const n=(e.retryCount??0)+1;ae.__privateMethod.call(void 0,this,Y,q).call(this,le.merge.call(void 0,{},e,{retryCount:n}),"PendingTransactionTracker:transaction-retry - Retry count increased")},I=new WeakSet,j=function(e,t){const i=le.cloneDeep.call(void 0,e);i.firstRetryBlockNumber||(i.firstRetryBlockNumber=t,ae.__privateMethod.call(void 0,this,Y,q).call(this,i,"PendingTransactionTracker:#isResubmitDue - First retry block number set"));const{firstRetryBlockNumber:r}=i,a=Number.parseInt(t,16)-Number.parseInt(r,16),n=e.retryCount||0;return a>=Math.min(50,Math.pow(2,n))},M=new WeakSet,x=async function(e){const{hash:t,id:i}=e;if(!t&&ae.__privateGet.call(void 0,this,f).call(this,e)){const t=new Error("We had an error while submitting this transaction, please try again.");return t.name="NoTxHashError",void ae.__privateMethod.call(void 0,this,W,$).call(this,e,t)}if(ae.__privateMethod.call(void 0,this,L,B).call(this,e))return de("Nonce already taken",i),void ae.__privateMethod.call(void 0,this,V,K).call(this,e);try{const i=await ae.__privateMethod.call(void 0,this,X,J).call(this,t),r="0x1"===i?.status;if("0x0"===i?.status)return de("Transaction receipt has failed status"),void ae.__privateMethod.call(void 0,this,W,$).call(this,e,new Error("Transaction dropped or replaced"));const{blockNumber:a,blockHash:n}=i||{};if(r&&a&&n)return void await ae.__privateMethod.call(void 0,this,N,R).call(this,e,{...i,blockNumber:a,blockHash:n})}catch(t){return de("Failed to check transaction",i,t),void ae.__privateMethod.call(void 0,this,U,H).call(this,e,t.message,"There was a problem loading this transaction.")}await ae.__privateMethod.call(void 0,this,O,G).call(this,e)&&ae.__privateMethod.call(void 0,this,V,K).call(this,e)},N=new WeakSet,R=async function(e,t){const{id:i}=e,{blockHash:r}=t;de("Transaction confirmed",i);const{baseFeePerGas:a,timestamp:n}=await ae.__privateMethod.call(void 0,this,z,Z).call(this,r,!1),s=le.cloneDeep.call(void 0,e);s.baseFeePerGas=a,s.blockTimestamp=n,s.status="confirmed",s.txParams={...s.txParams,gasUsed:t.gasUsed},s.txReceipt=t,s.verifiedOnBlockchain=!0,ae.__privateMethod.call(void 0,this,Y,q).call(this,s,"PendingTransactionTracker:#onTransactionConfirmed - Transaction confirmed"),this.hub.emit("transaction-confirmed",s)},O=new WeakSet,G=async function(e){const{hash:t,id:i,txParams:{nonce:r,from:a}}=e;if(!r||!t)return!1;const n=await ae.__privateMethod.call(void 0,this,Q,ee).call(this,a),o=parseInt(n,16);if(parseInt(r,16)>=o)return!1;let l=ae.__privateGet.call(void 0,this,s).get(t);return void 0===l&&(l=0,ae.__privateGet.call(void 0,this,s).set(t,l)),l<3?(de("Incrementing dropped block count",{id:i,droppedBlockCount:l}),ae.__privateGet.call(void 0,this,s).set(t,l+1),!1):(de("Hit dropped block count",i),ae.__privateGet.call(void 0,this,s).delete(t),!0)},L=new WeakSet,B=function(e){const{id:t,txParams:i}=e;return ae.__privateMethod.call(void 0,this,te,ie).call(this).some((e=>e.id!==t&&e.txParams.from===i.from&&"confirmed"===e.status&&e.txParams.nonce===i.nonce&&"incoming"!==e.type))},F=new WeakSet,D=function(){return ae.__privateMethod.call(void 0,this,te,ie).call(this).filter((e=>"submitted"===e.status&&!e.verifiedOnBlockchain&&!e.isUserOperation))},U=new WeakSet,H=function(e,t,i){ae.__privateMethod.call(void 0,this,Y,q).call(this,{...e,warning:{error:t,message:i}},"PendingTransactionTracker:#warnTransaction - Warning added")},W=new WeakSet,$=function(e,t){de("Transaction failed",e.id,t),this.hub.emit("transaction-failed",e,t)},V=new WeakSet,K=function(e){de("Transaction dropped",e.id),this.hub.emit("transaction-dropped",e)},Y=new WeakSet,q=function(e,t){this.hub.emit("transaction-updated",e,t)},X=new WeakSet,J=async function(e){return await ne.query.call(void 0,ae.__privateGet.call(void 0,this,l).call(this),"getTransactionReceipt",[e])},z=new WeakSet,Z=async function(e,t){return await ne.query.call(void 0,ae.__privateGet.call(void 0,this,l).call(this),"getBlockByHash",[e,t])},Q=new WeakSet,ee=async function(e){return await ne.query.call(void 0,ae.__privateGet.call(void 0,this,l).call(this),"getTransactionCount",[e])},te=new WeakSet,ie=function(){const e=ae.__privateGet.call(void 0,this,o).call(this);return ae.__privateGet.call(void 0,this,c).call(this).filter((t=>t.chainId===e))},i.PendingTransactionTracker=class{constructor({approveTransaction:e,blockTracker:t,getChainId:i,getEthQuery:r,getTransactions:T,isResubmitEnabled:E,getGlobalLock:P,publishTransaction:A,hooks:j}){ae.__privateAdd.call(void 0,this,g),ae.__privateAdd.call(void 0,this,k),ae.__privateAdd.call(void 0,this,y),ae.__privateAdd.call(void 0,this,b),ae.__privateAdd.call(void 0,this,S),ae.__privateAdd.call(void 0,this,C),ae.__privateAdd.call(void 0,this,I),ae.__privateAdd.call(void 0,this,M),ae.__privateAdd.call(void 0,this,N),ae.__privateAdd.call(void 0,this,O),ae.__privateAdd.call(void 0,this,L),ae.__privateAdd.call(void 0,this,F),ae.__privateAdd.call(void 0,this,U),ae.__privateAdd.call(void 0,this,W),ae.__privateAdd.call(void 0,this,V),ae.__privateAdd.call(void 0,this,Y),ae.__privateAdd.call(void 0,this,X),ae.__privateAdd.call(void 0,this,z),ae.__privateAdd.call(void 0,this,Q),ae.__privateAdd.call(void 0,this,te),ae.__privateAdd.call(void 0,this,a,void 0),ae.__privateAdd.call(void 0,this,n,void 0),ae.__privateAdd.call(void 0,this,s,void 0),ae.__privateAdd.call(void 0,this,o,void 0),ae.__privateAdd.call(void 0,this,l,void 0),ae.__privateAdd.call(void 0,this,c,void 0),ae.__privateAdd.call(void 0,this,d,void 0),ae.__privateAdd.call(void 0,this,u,void 0),ae.__privateAdd.call(void 0,this,h,void 0),ae.__privateAdd.call(void 0,this,p,void 0),ae.__privateAdd.call(void 0,this,m,void 0),ae.__privateAdd.call(void 0,this,f,void 0),ae.__privateAdd.call(void 0,this,v,void 0),this.startIfPendingTransactions=()=>{ae.__privateMethod.call(void 0,this,F,D).call(this).length?ae.__privateMethod.call(void 0,this,g,_).call(this):this.stop()},this.hub=new(0,oe.default),ae.__privateSet.call(void 0,this,a,e),ae.__privateSet.call(void 0,this,n,t),ae.__privateSet.call(void 0,this,s,new Map),ae.__privateSet.call(void 0,this,o,i),ae.__privateSet.call(void 0,this,l,r),ae.__privateSet.call(void 0,this,c,T),ae.__privateSet.call(void 0,this,d,E??(()=>!0)),ae.__privateSet.call(void 0,this,u,ae.__privateMethod.call(void 0,this,k,w).bind(this)),ae.__privateSet.call(void 0,this,h,P),ae.__privateSet.call(void 0,this,p,A),ae.__privateSet.call(void 0,this,m,!1),ae.__privateSet.call(void 0,this,v,j?.beforePublish??(()=>!0)),ae.__privateSet.call(void 0,this,f,j?.beforeCheckPendingTransaction??(()=>!0))}async forceCheckTransaction(e){const t=await ae.__privateGet.call(void 0,this,h).call(this);try{await ae.__privateMethod.call(void 0,this,M,x).call(this,e)}catch(e){de("Failed to check transaction",e)}finally{t()}}stop(){ae.__privateGet.call(void 0,this,m)&&(ae.__privateGet.call(void 0,this,n).removeListener("latest",ae.__privateGet.call(void 0,this,u)),ae.__privateSet.call(void 0,this,m,!1),de("Stopped polling"))}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-5KMU2IAT.js"}],[1839,{"@metamask/rpc-errors":1672},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/rpc-errors");i.validateConfirmedExternalTransaction=function(e,t,i){if(!e||!e.txParams)throw r.rpcErrors.invalidParams('"transactionMeta" or "transactionMeta.txParams" is missing');if("confirmed"!==e.status)throw r.rpcErrors.invalidParams('External transaction status should be "confirmed"');const a=e.txParams.nonce;if(i&&i.length>0){if(i.find((e=>e.txParams?.nonce===a)))throw r.rpcErrors.invalidParams("External transaction nonce should not be in pending txs")}if(t&&t.length>0){if(t.find((e=>e.txParams?.nonce===a)))throw r.rpcErrors.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-7LXE4KHV.js"}],[184,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:65,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=65;const i=function(e){if(e.PreferencesController){const{completedOnboarding:t,firstTimeFlowType:i}=e.PreferencesController;e.OnboardingController=e.OnboardingController??{},t!==undefined&&(e.OnboardingController.completedOnboarding=t,delete e.PreferencesController.completedOnboarding),i!==undefined&&(e.OnboardingController.firstTimeFlowType=i,delete e.PreferencesController.firstTimeFlowType)}return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/065.js"}],[1840,{"./chunk-2XKEAKQG.js":1836,"./chunk-DLOQPH4M.js":1841,"./chunk-S6VGOPUY.js":1854,"./chunk-Z4BLTVTB.js":1866,"@metamask/eth-query":1271,"@metamask/utils":2255,events:3276},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I,j=e("./chunk-2XKEAKQG.js"),M=e("./chunk-DLOQPH4M.js"),x=e("./chunk-S6VGOPUY.js"),N=e("./chunk-Z4BLTVTB.js"),R=r(e("@metamask/eth-query")),O=e("@metamask/utils"),G=r(e("events")),L=O.createModuleLogger.call(void 0,x.projectLogger,"gas-fee-poller");a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakSet,p=function(){N.__privateGet.call(void 0,this,u)||(N.__privateMethod.call(void 0,this,v,g).call(this),N.__privateSet.call(void 0,this,u,!0),L("Started polling"))},m=new WeakSet,f=function(){N.__privateGet.call(void 0,this,u)&&(clearTimeout(N.__privateGet.call(void 0,this,d)),N.__privateSet.call(void 0,this,d,void 0),N.__privateSet.call(void 0,this,u,!1),L("Stopped polling"))},v=new WeakSet,g=async function(){await N.__privateMethod.call(void 0,this,_,k).call(this),N.__privateSet.call(void 0,this,d,setTimeout((()=>N.__privateMethod.call(void 0,this,v,g).call(this)),1e4))},_=new WeakSet,k=async function(){const e=N.__privateMethod.call(void 0,this,P,C).call(this);if(!e.length)return;L("Found unapproved transactions",e.length);const t=await N.__privateMethod.call(void 0,this,A,I).call(this,e);L("Retrieved gas fee controller data",t),await Promise.all(e.flatMap((e=>{const{chainId:i}=e,r=t.get(i);return N.__privateMethod.call(void 0,this,w,y).call(this,e,r)})))},w=new WeakSet,y=async function(e,t){const{id:i}=e,[r,a]=await Promise.all([N.__privateMethod.call(void 0,this,T,b).call(this,e,t),N.__privateMethod.call(void 0,this,E,S).call(this,e)]);(r||a)&&this.hub.emit("transaction-updated",{transactionId:i,gasFeeEstimates:r?.gasFeeEstimates,gasFeeEstimatesLoaded:r?.gasFeeEstimatesLoaded,layer1GasFee:a})},T=new WeakSet,b=async function(e,t){const{chainId:i,networkClientId:r}=e,a=new(0,R.default)(N.__privateGet.call(void 0,this,o).call(this,i,r)),s=M.getGasFeeFlow.call(void 0,e,N.__privateGet.call(void 0,this,n));s&&L("Found gas fee flow",s.constructor.name,e.id);const l={ethQuery:a,gasFeeControllerData:t,transactionMeta:e};let c;if(s)try{c=(await s.getGasFees(l)).estimates}catch(t){L("Failed to get suggested gas fees",e.id,t)}if(c||!e.gasFeeEstimatesLoaded)return L("Updated gas fee estimates",{gasFeeEstimates:c,transaction:e.id}),{gasFeeEstimates:c,gasFeeEstimatesLoaded:!0}},E=new WeakSet,S=async function(e){const{chainId:t,networkClientId:i}=e,r=N.__privateGet.call(void 0,this,o).call(this,t,i),a=await j.getTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:N.__privateGet.call(void 0,this,c),provider:r,transactionMeta:e});return a&&L("Updated layer 1 gas fee",a,e.id),a},P=new WeakSet,C=function(){return N.__privateGet.call(void 0,this,l).call(this).filter((e=>"unapproved"===e.status))},A=new WeakSet,I=async function(e){const t=new Map;for(const i of e){const{chainId:e,networkClientId:r}=i;if(t.has(e))continue;const n=r??N.__privateGet.call(void 0,this,a).call(this,e);t.set(e,n)}L("Extracted network client IDs by chain ID",t);const i=Array.from(t.entries()).map((async([e,t])=>[e,await N.__privateGet.call(void 0,this,s).call(this,{networkClientId:t})]));return new Map(await Promise.all(i))},i.GasFeePoller=class{constructor({findNetworkClientIdByChainId:e,gasFeeFlows:t,getGasFeeControllerEstimates:i,getProvider:r,getTransactions:g,layer1GasFeeFlows:k,onStateChange:y}){N.__privateAdd.call(void 0,this,h),N.__privateAdd.call(void 0,this,m),N.__privateAdd.call(void 0,this,v),N.__privateAdd.call(void 0,this,_),N.__privateAdd.call(void 0,this,w),N.__privateAdd.call(void 0,this,T),N.__privateAdd.call(void 0,this,E),N.__privateAdd.call(void 0,this,P),N.__privateAdd.call(void 0,this,A),this.hub=new(0,G.default),N.__privateAdd.call(void 0,this,a,void 0),N.__privateAdd.call(void 0,this,n,void 0),N.__privateAdd.call(void 0,this,s,void 0),N.__privateAdd.call(void 0,this,o,void 0),N.__privateAdd.call(void 0,this,l,void 0),N.__privateAdd.call(void 0,this,c,void 0),N.__privateAdd.call(void 0,this,d,void 0),N.__privateAdd.call(void 0,this,u,!1),N.__privateSet.call(void 0,this,a,e),N.__privateSet.call(void 0,this,n,t),N.__privateSet.call(void 0,this,c,k),N.__privateSet.call(void 0,this,s,i),N.__privateSet.call(void 0,this,o,r),N.__privateSet.call(void 0,this,l,g),y((()=>{N.__privateMethod.call(void 0,this,P,C).call(this).length?N.__privateMethod.call(void 0,this,h,p).call(this):N.__privateMethod.call(void 0,this,m,f).call(this)}))}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-7MKQDZKY.js"}],[1841,{"./chunk-RAOYRJ25.js":1853,"@metamask/controller-utils":1903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-RAOYRJ25.js"),a=e("@metamask/controller-utils");function n(e,t){return a.weiHexToGweiDec.call(void 0,e[t])}i.getGasFeeFlow=function(e,t){return t.find((t=>t.matchesTransaction(e)))},i.mergeGasFeeEstimates=function({gasFeeControllerEstimates:e,transactionGasFeeEstimates:t}){const i=t.type;return"fee-market"===i?Object.values(r.GasFeeEstimateLevel).reduce(((i,r)=>{return{...i,[r]:(n=e?.[r],s=t[r],{...n,suggestedMaxFeePerGas:a.weiHexToGweiDec.call(void 0,s.maxFeePerGas),suggestedMaxPriorityFeePerGas:a.weiHexToGweiDec.call(void 0,s.maxPriorityFeePerGas)})};var n,s}),{...e}):"legacy"===i?Object.values(r.GasFeeEstimateLevel).reduce(((e,i)=>({...e,[i]:n(t,i)})),{}):"eth_gasPrice"===i?{gasPrice:(s=t,a.weiHexToGweiDec.call(void 0,s.gasPrice))}:e;var s}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-DLOQPH4M.js"}],[1842,{"./chunk-S6VGOPUY.js":1854,"./chunk-Z4BLTVTB.js":1866,"async-mutex":1907,events:3276},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I,j,M,x,N,R,O=e("./chunk-S6VGOPUY.js"),G=e("./chunk-Z4BLTVTB.js"),L=e("async-mutex"),B=e("events"),F=(r=B)&&r.__esModule?r:{default:r},D=[e=>e.status,e=>e.txParams.gasUsed];a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakSet,_=function(e){e.sort(((e,t)=>e.time<t.time?-1:1))},k=new WeakSet,w=function(e,t){return e.filter((e=>!t.some((({hash:t})=>t===e.hash))))},y=new WeakSet,T=function(e,t){return e.filter((e=>t.some((t=>e.hash===t.hash&&G.__privateMethod.call(void 0,this,b,E).call(this,e,t)))))},b=new WeakSet,E=function(e,t){return D.some((i=>i(e)!==i(t)))},S=new WeakSet,P=function(){const e=G.__privateGet.call(void 0,this,m).getLastBlockVariations?.()??[],t=G.__privateMethod.call(void 0,this,M,x).call(this,e);return G.__privateGet.call(void 0,this,s).call(this)[t]},C=new WeakSet,A=function(e){const t=G.__privateMethod.call(void 0,this,S,P).call(this);return t?t+1:G.__privateGet.call(void 0,this,p)?void 0:e-10},I=new WeakSet,j=function(e,t){let i=-1;for(const t of e){const e=t.blockNumber?parseInt(t.blockNumber,10):-1;i=Math.max(i,e)}if(-1===i)return;const r=G.__privateMethod.call(void 0,this,M,x).call(this,t),a=G.__privateGet.call(void 0,this,s).call(this);a[r]>=i||this.hub.emit("updatedLastFetchedBlockNumbers",{lastFetchedBlockNumbers:{...a,[r]:i},blockNumber:i})},M=new WeakSet,x=function(e){const t=G.__privateGet.call(void 0,this,l).call(this),i=G.__privateGet.call(void 0,this,n).call(this)?.toLowerCase();return[t,i,...e].join("#")},N=new WeakSet,R=function(){const e=G.__privateGet.call(void 0,this,c).call(this),t=G.__privateGet.call(void 0,this,l).call(this),i=G.__privateGet.call(void 0,this,m).isSupportedNetwork(t);return e&&i},i.IncomingTransactionHelper=class{constructor({blockTracker:e,getCurrentAccount:t,getLastFetchedBlockNumbers:i,getLocalTransactions:r,getChainId:_,isEnabled:w,queryEntireHistory:T,remoteTransactionSource:E,transactionLimit:P,updateTransactions:A}){G.__privateAdd.call(void 0,this,g),G.__privateAdd.call(void 0,this,k),G.__privateAdd.call(void 0,this,y),G.__privateAdd.call(void 0,this,b),G.__privateAdd.call(void 0,this,S),G.__privateAdd.call(void 0,this,C),G.__privateAdd.call(void 0,this,I),G.__privateAdd.call(void 0,this,M),G.__privateAdd.call(void 0,this,N),G.__privateAdd.call(void 0,this,a,void 0),G.__privateAdd.call(void 0,this,n,void 0),G.__privateAdd.call(void 0,this,s,void 0),G.__privateAdd.call(void 0,this,o,void 0),G.__privateAdd.call(void 0,this,l,void 0),G.__privateAdd.call(void 0,this,c,void 0),G.__privateAdd.call(void 0,this,d,void 0),G.__privateAdd.call(void 0,this,u,new(0,L.Mutex)),G.__privateAdd.call(void 0,this,h,void 0),G.__privateAdd.call(void 0,this,p,void 0),G.__privateAdd.call(void 0,this,m,void 0),G.__privateAdd.call(void 0,this,f,void 0),G.__privateAdd.call(void 0,this,v,void 0),this.hub=new(0,F.default),G.__privateSet.call(void 0,this,a,e),G.__privateSet.call(void 0,this,n,t),G.__privateSet.call(void 0,this,s,i),G.__privateSet.call(void 0,this,o,r||(()=>[])),G.__privateSet.call(void 0,this,l,_),G.__privateSet.call(void 0,this,c,w??(()=>!0)),G.__privateSet.call(void 0,this,d,!1),G.__privateSet.call(void 0,this,p,T??!0),G.__privateSet.call(void 0,this,m,E),G.__privateSet.call(void 0,this,f,P),G.__privateSet.call(void 0,this,v,A??!1),G.__privateSet.call(void 0,this,h,(async e=>{try{await this.update(e)}catch(e){console.error("Error while checking incoming transactions",e)}}))}start(){G.__privateGet.call(void 0,this,d)||G.__privateMethod.call(void 0,this,N,R).call(this)&&(G.__privateGet.call(void 0,this,a).addListener("latest",G.__privateGet.call(void 0,this,h)),G.__privateSet.call(void 0,this,d,!0))}stop(){G.__privateGet.call(void 0,this,a).removeListener("latest",G.__privateGet.call(void 0,this,h)),G.__privateSet.call(void 0,this,d,!1)}async update(e){const t=await G.__privateGet.call(void 0,this,u).acquire();O.incomingTransactionsLogger.call(void 0,"Checking for incoming transactions");try{if(!G.__privateMethod.call(void 0,this,N,R).call(this))return;const t=parseInt(e||await G.__privateGet.call(void 0,this,a).getLatestBlock(),16),i=G.__privateGet.call(void 0,this,m).getLastBlockVariations?.()??[],r=G.__privateMethod.call(void 0,this,C,A).call(this,t),s=G.__privateGet.call(void 0,this,n).call(this),c=G.__privateGet.call(void 0,this,l).call(this);let d=[];try{d=await G.__privateGet.call(void 0,this,m).fetchTransactions({address:s,currentChainId:c,fromBlock:r,limit:G.__privateGet.call(void 0,this,f)})}catch(e){return void O.incomingTransactionsLogger.call(void 0,"Error while fetching remote transactions",e)}G.__privateGet.call(void 0,this,v)||(d=d.filter((e=>e.txParams.to?.toLowerCase()===s.toLowerCase())));const u=G.__privateGet.call(void 0,this,v)?G.__privateGet.call(void 0,this,o).call(this):[],h=G.__privateMethod.call(void 0,this,k,w).call(this,d,u),p=G.__privateMethod.call(void 0,this,y,T).call(this,d,u);(h.length>0||p.length>0)&&(G.__privateMethod.call(void 0,this,g,_).call(this,h),G.__privateMethod.call(void 0,this,g,_).call(this,p),O.incomingTransactionsLogger.call(void 0,"Found incoming transactions",{new:h,updated:p}),this.hub.emit("transactions",{added:h,updated:p})),G.__privateMethod.call(void 0,this,I,j).call(this,d,i)}finally{t()}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-DTDTOMTB.js"}],[1843,{"./chunk-FDUCRHYT.js":1844,"./chunk-S6VGOPUY.js":1854,"./chunk-UGN7PBON.js":1859,"./chunk-Z4BLTVTB.js":1866,"@metamask/controller-utils":1903,"async-mutex":1907,"bn.js":2935,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k=e("./chunk-FDUCRHYT.js"),w=e("./chunk-UGN7PBON.js"),y=e("./chunk-S6VGOPUY.js"),T=e("./chunk-Z4BLTVTB.js"),b=e("@metamask/controller-utils"),E=e("async-mutex"),S=e("bn.js"),P=(r=S)&&r.__esModule?r:{default:r},C=e("uuid");a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(e,t){const i=Date.now()-e,r=Math.max(0,5e3-i);r>0?setTimeout(t,r):t()},c=new WeakMap,d=new WeakMap,u=new WeakSet,h=function(e){let t=e.result;return"0"===e.status&&(t=[],e.result.length&&y.incomingTransactionsLogger.call(void 0,"Ignored Etherscan request error",{message:e.result,type:T.__privateGet.call(void 0,this,n)?"token":"normal"})),t},p=new WeakSet,m=function(e,t){const i=T.__privateMethod.call(void 0,this,g,_).call(this,e,t);return{...i,txParams:{...i.txParams,data:e.input},..."0"===e.isError?{status:"confirmed"}:{error:new Error("Transaction failed"),status:"failed"}}},f=new WeakSet,v=function(e,t){return{...T.__privateMethod.call(void 0,this,g,_).call(this,e,t),isTransfer:!0,transferInformation:{contractAddress:e.contractAddress,decimals:Number(e.tokenDecimal),symbol:e.tokenSymbol}}},g=new WeakSet,_=function(e,t){const i=1e3*parseInt(e.timeStamp,10);return{blockNumber:e.blockNumber,chainId:t,hash:e.hash,id:C.v1.call(void 0,{msecs:i}),status:"confirmed",time:i,txParams:{chainId:t,from:e.from,gas:b.BNToHex.call(void 0,new(0,P.default)(e.gas)),gasPrice:b.BNToHex.call(void 0,new(0,P.default)(e.gasPrice)),gasUsed:b.BNToHex.call(void 0,new(0,P.default)(e.gasUsed)),nonce:b.BNToHex.call(void 0,new(0,P.default)(e.nonce)),to:e.to,value:b.BNToHex.call(void 0,new(0,P.default)(e.value))},type:"incoming",verifiedOnBlockchain:!1}},i.EtherscanRemoteTransactionSource=class{constructor({includeTokenTransfers:e}={}){T.__privateAdd.call(void 0,this,o),T.__privateAdd.call(void 0,this,u),T.__privateAdd.call(void 0,this,p),T.__privateAdd.call(void 0,this,f),T.__privateAdd.call(void 0,this,g),T.__privateAdd.call(void 0,this,a,void 0),T.__privateAdd.call(void 0,this,n,void 0),T.__privateAdd.call(void 0,this,s,new(0,E.Mutex)),T.__privateAdd.call(void 0,this,c,(async(e,t)=>{const{currentChainId:i}=e,r=await k.fetchEtherscanTransactions.call(void 0,t);return T.__privateMethod.call(void 0,this,u,h).call(this,r).map((e=>T.__privateMethod.call(void 0,this,p,m).call(this,e,i)))})),T.__privateAdd.call(void 0,this,d,(async(e,t)=>{const{currentChainId:i}=e,r=await k.fetchEtherscanTokenTransactions.call(void 0,t);return T.__privateMethod.call(void 0,this,u,h).call(this,r).map((e=>T.__privateMethod.call(void 0,this,f,v).call(this,e,i)))})),T.__privateSet.call(void 0,this,a,e??!0),T.__privateSet.call(void 0,this,n,!1)}isSupportedNetwork(e){return Object.keys(w.ETHERSCAN_SUPPORTED_NETWORKS).includes(e)}getLastBlockVariations(){return[T.__privateGet.call(void 0,this,n)?"token":"normal"]}async fetchTransactions(e){const t=await T.__privateGet.call(void 0,this,s).acquire(),i=Date.now(),r={...e,chainId:e.currentChainId};try{const t=T.__privateGet.call(void 0,this,n)?await T.__privateGet.call(void 0,this,d).call(this,e,r):await T.__privateGet.call(void 0,this,c).call(this,e,r);return T.__privateGet.call(void 0,this,a)&&T.__privateSet.call(void 0,this,n,!T.__privateGet.call(void 0,this,n)),t}finally{T.__privateMethod.call(void 0,this,o,l).call(this,i,t)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-EQT25RSP.js"}],[1844,{"./chunk-S6VGOPUY.js":1854,"./chunk-UGN7PBON.js":1859,"@metamask/controller-utils":1903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-UGN7PBON.js"),a=e("./chunk-S6VGOPUY.js"),n=e("@metamask/controller-utils");async function s(e,{address:t,chainId:i,fromBlock:r,limit:s}){const l=function(e,t){const i=o(e);let r=`${i}/api?`;for(const e of Object.keys(t)){const i=t[e];i&&(r+=`${e}=${i}&`)}return r+="tag=latest&page=1",r}(i,{...{module:"account",address:t,startBlock:r?.toString(),offset:s?.toString(),sort:"desc"},action:e});a.incomingTransactionsLogger.call(void 0,"Sending Etherscan request",l);return await n.handleFetch.call(void 0,l)}function o(e){const t=r.ETHERSCAN_SUPPORTED_NETWORKS[e];if(!t)throw new Error(`Etherscan does not support chain with ID: ${e}`);return`https://${t.subdomain}.${t.domain}`}i.fetchEtherscanTransactions=async function({address:e,chainId:t,fromBlock:i,limit:r}){return await s("txlist",{address:e,chainId:t,fromBlock:i,limit:r})},i.fetchEtherscanTokenTransactions=async function({address:e,chainId:t,fromBlock:i,limit:r}){return await s("tokentx",{address:e,chainId:t,fromBlock:i,limit:r})},i.getEtherscanApiHost=o}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-FDUCRHYT.js"}],[1845,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=class extends Error{constructor(e,t){super(e??"Simulation failed"),this.code=t}};i.SimulationError=r,i.SimulationChainNotSupportedError=class extends r{constructor(e){super(`Chain is not supported: ${e}`,"chain-not-supported")}},i.SimulationInvalidResponseError=class extends r{constructor(){super("Invalid response from simulation API","invalid-response")}},i.SimulationRevertedError=class extends r{constructor(){super("Transaction was reverted","reverted")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-HMOSP33F.js"}],[1846,{"./chunk-HMOSP33F.js":1845,"./chunk-KT6UAKBB.js":1847,"./chunk-S6VGOPUY.js":1854,"./chunk-UGN7PBON.js":1859,"@ethersproject/abi":463,"@metamask/controller-utils":1903,"@metamask/metamask-eth-abis":1473,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-KT6UAKBB.js"),a=e("./chunk-HMOSP33F.js"),n=e("./chunk-UGN7PBON.js"),s=e("./chunk-S6VGOPUY.js"),o=e("@ethersproject/abi"),l=e("@metamask/controller-utils"),c=e("@metamask/metamask-eth-abis"),d=e("@metamask/utils"),u=(e=>(e.ERC20="erc20",e.ERC721="erc721",e.ERC1155="erc1155",e.ERC20_WRAPPED="erc20Wrapped",e.ERC721_LEGACY="erc721Legacy",e))(u||{}),h=d.createModuleLogger.call(void 0,s.projectLogger,"simulation"),p=["Transfer","TransferSingle","TransferBatch","Deposit","Withdrawal"],m={erc20:{abi:c.abiERC20,standard:"erc20"},erc721:{abi:c.abiERC721,standard:"erc721"},erc1155:{abi:c.abiERC1155,standard:"erc1155"},erc20Wrapped:{abi:n.ABI_SIMULATION_ERC20_WRAPPED,standard:"erc20"},erc721Legacy:{abi:n.ABI_SIMULATION_ERC721_LEGACY,standard:"erc721"}},f=["execution reverted","insufficient funds for gas"];function v(e){const t=T(e.transactions[0]?.callTrace??{});h("Extracted logs",t);const i=function(){const e=Object.values(u);return new Map(e.map((e=>{const{abi:t}=m[e];return[e,new(0,o.Interface)(t)]})))}();return t.map((e=>{const t=function(e,t){const i=Object.values(u);for(const r of i)try{const i=t.get(r),{abi:a,standard:n}=m[r];return{...i.parseLog(e),abi:a,standard:n}}catch(e){continue}return}(e,i);if(!t)return void h("Failed to parse log",e);const r=t.abi.find((e=>e.name===t.name))?.inputs;if(!r)return void h("Failed to find inputs for event",t);const a=function(e,t){return e.reduce(((e,i,r)=>{const a=t[r].name.replace("_",""),n=g(i);return e[a]=n,e}),{})}(t.args,r);return{contractAddress:e.address,tokenStandard:t.standard,name:t.name,args:a,abi:t.abi}})).filter((e=>void 0!==e))}function g(e){return Array.isArray(e)?e.map(g):(e.toHexString?.()??e).toLowerCase()}function _(e){return"Transfer"===e.name&&"erc721"===e.tokenStandard&&0===parseInt(e.args.from,16)}function k(e){return"erc721"===e.tokenStandard?[e.args.tokenId]:"erc1155"===e.tokenStandard&&"TransferSingle"===e.name?[e.args.id]:"erc1155"===e.tokenStandard&&"TransferBatch"===e.name?e.args.ids:[void 0]}function w(e,t,i){const r=(a=i.return,l.toHex.call(void 0,l.hexToBN.call(void 0,a)));var a;return"erc721"===t.standard?r===e?"0x1":"0x0":r}function y(e,t,i){switch(e){case"erc721":return new(0,o.Interface)(c.abiERC721).encodeFunctionData("ownerOf",[i]);case"erc1155":return new(0,o.Interface)(c.abiERC1155).encodeFunctionData("balanceOf",[t,i]);default:return new(0,o.Interface)(c.abiERC20).encodeFunctionData("balanceOf",[t])}}function T(e){return[...e.logs??[],...(e.calls??[]).map((e=>T(e))).flat()]}function b(e,t){const i=l.hexToBN.call(void 0,t).sub(l.hexToBN.call(void 0,e)),r=i.isNeg(),a=l.toHex.call(void 0,i.abs());if(!i.isZero())return{previousBalance:e,newBalance:t,difference:a,isDecrease:r};h("Balance change is zero")}i.SupportedToken=u,i.getSimulationData=async function(e){const{chainId:t,from:i,to:n,value:s,data:o}=e;h("Getting simulation data",e);try{const l=await r.simulateTransactions.call(void 0,t,{transactions:[{data:o,from:i,maxFeePerGas:"0x0",maxPriorityFeePerGas:"0x0",to:n,value:s}],withCallTrace:!0,withLogs:!0}),c=l.transactions?.[0]?.error;if(c)throw new(0,a.SimulationError)(c);const d=function(e,t){const i=t.transactions[0];if(!i)return;const{stateDiff:r}=i,a=r?.pre?.[e]?.balance,n=r?.post?.[e]?.balance;if(!a||!n)return;return b(a,n)}(e.from,l),u=v(l);h("Parsed events",u);const m=await async function(e,t){const i=function(e,t){const i=new Set,r=new Map,a=new Map,n=t.filter((t=>p.includes(t.name)&&[t.args.from,t.args.to].includes(e.from)));h("Filtered user events",n);for(const t of n){const n=k(t);h("Extracted token ids",n);for(const s of n){const n={address:t.contractAddress,standard:t.tokenStandard,id:s},o=JSON.stringify(n);if(i.has(o)){h("Ignoring additional event with same contract and token ID",n);continue}i.add(o);const l=y(t.tokenStandard,e.from,s),c={from:e.from,to:t.contractAddress,data:l};_(t)||r.set(n,c),a.set(n,c)}}return{before:r,after:a}}(e,t);h("Generated balance transactions",[...i.after.values()]);const n=[...i.before.values(),e,...i.after.values()];if(1===n.length)return[];const s=await r.simulateTransactions.call(void 0,e.chainId,{transactions:n});if(h("Balance simulation response",s),s.transactions.length!==n.length)throw new(0,a.SimulationInvalidResponseError);let o=0;return[...i.after.keys()].map(((t,r)=>{const a=b(!i.before.get(t)?"0x0":w(e.from,t,s.transactions[o++]),w(e.from,t,s.transactions[r+i.before.size+1]));if(a)return{...t,...a}})).filter((e=>void 0!==e))}(e,u);return{nativeBalanceChange:d,tokenBalanceChanges:m}}catch(t){h("Failed to get simulation data",t,e);let i=t;f.some((e=>i.message?.includes(e)))&&(i=new(0,a.SimulationRevertedError));const{code:r,message:n}=i;return{tokenBalanceChanges:[],error:{code:r,message:n}}}},i.getEvents=v}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-IT3SYNZ6.js"}],[1847,{"./chunk-HMOSP33F.js":1845,"./chunk-S6VGOPUY.js":1854,"@metamask/controller-utils":1903,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-HMOSP33F.js"),a=e("./chunk-S6VGOPUY.js"),n=e("@metamask/controller-utils"),s=e("@metamask/utils").createModuleLogger.call(void 0,a.projectLogger,"simulation-api"),o="https://tx-sentinel-{0}.api.cx.metamask.io/",l="networks",c=0;function d(e){return o.replace("{0}",e)}i.simulateTransactions=async function(e,t){const i=await async function(e){const t=await async function(){const e=`${d("ethereum-mainnet")}${l}`,t=await fetch(e);return t.json()}(),i=n.convertHexToDecimal.call(void 0,e),a=t[i];if(!a?.confirmations)throw s("Chain is not supported",e),new(0,r.SimulationChainNotSupportedError)(e);return d(a.network)}(e);s("Sending request",i,t);const a=c;c+=1;const o=await fetch(i,{method:"POST",body:JSON.stringify({id:String(a),jsonrpc:"2.0",method:"infura_simulateTransactions",params:[t]})}),u=await o.json();if(s("Received response",u),u.error){const{code:e,message:t}=u.error;throw new(0,r.SimulationError)(t,e)}return u?.result}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-KT6UAKBB.js"}],[1848,{"./chunk-UGN7PBON.js":1859,"./chunk-YVCX6Z75.js":1864},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-YVCX6Z75.js"),a=e("./chunk-UGN7PBON.js"),n=[a.CHAIN_IDS.OPTIMISM,a.CHAIN_IDS.OPTIMISM_TESTNET,a.CHAIN_IDS.BASE,a.CHAIN_IDS.BASE_TESTNET,a.CHAIN_IDS.OPBNB,a.CHAIN_IDS.OPBNB_TESTNET,a.CHAIN_IDS.ZORA],s=class extends r.OracleLayer1GasFeeFlow{constructor(){super("0x420000000000000000000000000000000000000F")}matchesTransaction(e){return n.includes(e.chainId)}};i.OptimismLayer1GasFeeFlow=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-NYKRCWBG.js"}],[1849,{"./chunk-2XKEAKQG.js":1836,"./chunk-3ZRHCVVS.js":1837,"./chunk-5KMU2IAT.js":1838,"./chunk-7LXE4KHV.js":1839,"./chunk-7MKQDZKY.js":1840,"./chunk-DLOQPH4M.js":1841,"./chunk-DTDTOMTB.js":1842,"./chunk-EQT25RSP.js":1843,"./chunk-IT3SYNZ6.js":1846,"./chunk-NYKRCWBG.js":1848,"./chunk-PRUNMTRD.js":1850,"./chunk-PUESYN62.js":1851,"./chunk-Q6Q44V4W.js":1852,"./chunk-S6VGOPUY.js":1854,"./chunk-SD6CWFDF.js":1855,"./chunk-TIE3CPF7.js":1856,"./chunk-TJMQEH57.js":1857,"./chunk-UGFBA4GV.js":1858,"./chunk-UT4M4XI3.js":1860,"./chunk-V72C4MCR.js":1861,"./chunk-VH47Q6TS.js":1862,"./chunk-WR5F34OW.js":1863,"./chunk-YXSCBWTU.js":1865,"./chunk-Z4BLTVTB.js":1866,"@ethereumjs/common":421,"@ethereumjs/tx":1872,"@ethereumjs/util":1884,"@metamask/base-controller":1897,"@metamask/controller-utils":1903,"@metamask/eth-query":1271,"@metamask/network-controller":1510,"@metamask/nonce-tracker":1524,"@metamask/rpc-errors":1672,"@metamask/utils":2255,"async-mutex":1907,"eth-method-registry":1912,events:3276,lodash:3783,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I,j,M,x,N,R,O,G,L,B,F,D,U,H,W,$,V,K,Y,q,X,J,z,Z=e("./chunk-VH47Q6TS.js"),Q=e("./chunk-Q6Q44V4W.js"),ee=e("./chunk-YXSCBWTU.js"),te=e("./chunk-NYKRCWBG.js"),ie=e("./chunk-WR5F34OW.js"),re=e("./chunk-TJMQEH57.js"),ae=e("./chunk-TIE3CPF7.js"),ne=e("./chunk-PRUNMTRD.js"),se=e("./chunk-IT3SYNZ6.js"),oe=e("./chunk-SD6CWFDF.js"),le=e("./chunk-DTDTOMTB.js"),ce=e("./chunk-PUESYN62.js"),de=e("./chunk-5KMU2IAT.js"),ue=e("./chunk-7LXE4KHV.js"),he=e("./chunk-3ZRHCVVS.js"),pe=e("./chunk-UT4M4XI3.js"),me=e("./chunk-UGFBA4GV.js"),fe=e("./chunk-V72C4MCR.js"),ve=e("./chunk-EQT25RSP.js"),ge=e("./chunk-7MKQDZKY.js"),_e=e("./chunk-2XKEAKQG.js"),ke=e("./chunk-DLOQPH4M.js"),we=e("./chunk-S6VGOPUY.js"),ye=e("./chunk-Z4BLTVTB.js"),Te=e("@ethereumjs/common"),be=e("@ethereumjs/tx"),Ee=e("@ethereumjs/util"),Se=e("@metamask/base-controller"),Pe=e("@metamask/controller-utils"),Ce=e("@metamask/eth-query"),Ae=(r=Ce)&&r.__esModule?r:{default:r},Ie=e("@metamask/network-controller"),je=e("@metamask/nonce-tracker"),Me=e("@metamask/rpc-errors"),xe=e("@metamask/utils"),Ne=e("async-mutex"),Re=e("eth-method-registry"),Oe=e("events"),Ge=e("lodash"),Le=e("uuid"),Be={transactions:{persist:!0,anonymous:!1},methodData:{persist:!0,anonymous:!1},lastFetchedBlockNumbers:{persist:!0,anonymous:!1}},Fe=Te.Hardfork.London,De=1.1,Ue=1.1,He="TransactionController",We=(e=>(e.Approved="approved",e.NotApproved="not-approved",e.SkippedViaBeforePublishHook="skipped-via-before-publish-hook",e))(We||{});var $e=class extends Se.BaseController{constructor({blockTracker:e,disableHistory:t,disableSendFlowHistory:i,disableSwaps:r,getCurrentAccountEIP1559Compatibility:k,getCurrentNetworkEIP1559Compatibility:b,getExternalPendingTransactions:C,getGasFeeEstimates:I,getNetworkClientRegistry:O,getNetworkState:L,getPermittedAccounts:F,getSavedGasFees:U,getSelectedAddress:V,incomingTransactions:Y={},isMultichainEnabled:X=!1,isSimulationEnabled:z,messenger:Z,onNetworkStateChange:Q,pendingTransactions:ee={},provider:te,securityProviderRequest:ie,sign:re,state:ae,testGasFeeFlows:ne,transactionHistoryLimit:se=40,hooks:oe}){super({name:He,metadata:Be,messenger:Z,state:{methodData:{},transactions:[],lastFetchedBlockNumbers:{},...ae}}),ye.__privateAdd.call(void 0,this,u),ye.__privateAdd.call(void 0,this,p),ye.__privateAdd.call(void 0,this,f),ye.__privateAdd.call(void 0,this,_),ye.__privateAdd.call(void 0,this,w),ye.__privateAdd.call(void 0,this,T),ye.__privateAdd.call(void 0,this,E),ye.__privateAdd.call(void 0,this,P),ye.__privateAdd.call(void 0,this,A),ye.__privateAdd.call(void 0,this,j),ye.__privateAdd.call(void 0,this,x),ye.__privateAdd.call(void 0,this,R),ye.__privateAdd.call(void 0,this,G),ye.__privateAdd.call(void 0,this,B),ye.__privateAdd.call(void 0,this,D),ye.__privateAdd.call(void 0,this,H),ye.__privateAdd.call(void 0,this,$),ye.__privateAdd.call(void 0,this,K),ye.__privateAdd.call(void 0,this,q),ye.__privateAdd.call(void 0,this,J),ye.__privateAdd.call(void 0,this,a,new(0,Oe.EventEmitter)),this.approvingTransactionIds=new Set,this.mutex=new(0,Ne.Mutex),ye.__privateAdd.call(void 0,this,n,void 0),ye.__privateAdd.call(void 0,this,s,void 0),this.signAbortCallbacks=new Map,ye.__privateAdd.call(void 0,this,o,void 0),ye.__privateAdd.call(void 0,this,l,void 0),ye.__privateAdd.call(void 0,this,c,void 0),ye.__privateAdd.call(void 0,this,d,void 0),ye.__privateAdd.call(void 0,this,g,(()=>{this.pendingTransactionTracker.startIfPendingTransactions(),ye.__privateGet.call(void 0,this,d).checkForPendingTransactionAndStartPolling()})),this.messagingSystem=Z,this.getNetworkState=L,this.isSendFlowHistoryDisabled=i??!1,this.isHistoryDisabled=t??!1,this.isSwapsDisabled=r??!1,ye.__privateSet.call(void 0,this,l,z??(()=>!0)),this.registry=new(0,Re.MethodRegistry)({provider:te}),this.getSavedGasFees=U??(e=>{}),this.getCurrentAccountEIP1559Compatibility=k??(()=>Promise.resolve(!0)),this.getCurrentNetworkEIP1559Compatibility=b,this.getGasFeeEstimates=I||(()=>Promise.resolve({})),this.getPermittedAccounts=F,this.getSelectedAddress=V,this.getExternalPendingTransactions=C??(()=>[]),this.securityProviderRequest=ie,ye.__privateSet.call(void 0,this,n,Y),ye.__privateSet.call(void 0,this,s,ee),ye.__privateSet.call(void 0,this,o,se),this.sign=re,ye.__privateSet.call(void 0,this,c,!0===ne),this.afterSign=oe?.afterSign??(()=>!0),this.beforeApproveOnInit=oe?.beforeApproveOnInit??(()=>!0),this.beforeCheckPendingTransaction=oe?.beforeCheckPendingTransaction??(()=>!0),this.beforePublish=oe?.beforePublish??(()=>!0),this.getAdditionalSignArguments=oe?.getAdditionalSignArguments??(()=>[]),this.publish=oe?.publish??(()=>Promise.resolve({transactionHash:void 0})),this.nonceTracker=ye.__privateMethod.call(void 0,this,u,h).call(this,{provider:te,blockTracker:e});const le=e=>this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",e);ye.__privateSet.call(void 0,this,d,new(0,ce.MultichainTrackingHelper)({isMultichainEnabled:X,provider:te,nonceTracker:this.nonceTracker,incomingTransactionOptions:Y,findNetworkClientIdByChainId:le,getNetworkClientById:e=>this.messagingSystem.call("NetworkController:getNetworkClientById",e),getNetworkClientRegistry:O,removeIncomingTransactionHelperListeners:ye.__privateMethod.call(void 0,this,w,y).bind(this),removePendingTransactionTrackerListeners:ye.__privateMethod.call(void 0,this,E,S).bind(this),createNonceTracker:ye.__privateMethod.call(void 0,this,u,h).bind(this),createIncomingTransactionHelper:ye.__privateMethod.call(void 0,this,p,m).bind(this),createPendingTransactionTracker:ye.__privateMethod.call(void 0,this,f,v).bind(this),onNetworkStateChange:e=>{this.messagingSystem.subscribe("NetworkController:stateChange",e)}})),ye.__privateGet.call(void 0,this,d).initialize();const de=new(0,ve.EtherscanRemoteTransactionSource)({includeTokenTransfers:Y.includeTokenTransfers});this.incomingTransactionHelper=ye.__privateMethod.call(void 0,this,p,m).call(this,{blockTracker:e,etherscanRemoteTransactionSource:de}),this.pendingTransactionTracker=ye.__privateMethod.call(void 0,this,f,v).call(this,{provider:te,blockTracker:e}),this.gasFeeFlows=ye.__privateMethod.call(void 0,this,j,M).call(this),this.layer1GasFeeFlows=ye.__privateMethod.call(void 0,this,x,N).call(this);new(0,ge.GasFeePoller)({findNetworkClientIdByChainId:le,gasFeeFlows:this.gasFeeFlows,getGasFeeControllerEstimates:this.getGasFeeEstimates,getProvider:(e,t)=>ye.__privateGet.call(void 0,this,d).getProvider({networkClientId:t,chainId:e}),getTransactions:()=>this.state.transactions,layer1GasFeeFlows:this.layer1GasFeeFlows,onStateChange:e=>{this.messagingSystem.subscribe("TransactionController:stateChange",e)}}).hub.on("transaction-updated",ye.__privateMethod.call(void 0,this,H,W).bind(this)),this.messagingSystem.subscribe("TransactionController:stateChange",ye.__privateGet.call(void 0,this,g)),Q((()=>{we.projectLogger.call(void 0,"Detected network change",this.getChainId()),this.pendingTransactionTracker.startIfPendingTransactions(),this.onBootCleanup()})),this.onBootCleanup(),ye.__privateGet.call(void 0,this,g).call(this)}failTransaction(e,t,i){const r=Ge.merge.call(void 0,{},e,{error:me.normalizeTxError.call(void 0,t),status:"failed"});this.messagingSystem.publish(`${He}:transactionFailed`,{actionId:i,error:t.message,transactionMeta:r}),this.updateTransaction(r,"TransactionController#failTransaction - Add error message and set status to failed"),this.onTransactionStatusChange(r),this.messagingSystem.publish(`${He}:transactionFinished`,r),ye.__privateGet.call(void 0,this,a).emit(`${e.id}:finished`,r)}async registryLookup(e){const t=await this.registry.lookup(e);if(!t)return{registryMethod:"",parsedRegistryMethod:{name:void 0,args:void 0}};return{registryMethod:t,parsedRegistryMethod:this.registry.parse(t)}}destroy(){ye.__privateMethod.call(void 0,this,_,k).call(this)}async handleMethodData(e){const t=await this.mutex.acquire();try{const{methodData:t}=this.state;if(Object.keys(t).find((t=>e===t)))return t[e];const i=await this.registryLookup(e);return this.update((t=>{t.methodData[e]=i})),i}finally{t()}}async addTransaction(e,{actionId:t,deviceConfirmedOn:i,method:r,origin:a,requireApproval:n,securityAlertResponse:s,sendFlowHistory:o,swaps:l={},type:c,networkClientId:u}={}){if(we.projectLogger.call(void 0,"Adding transaction",e),e=me.normalizeTransactionParams.call(void 0,e),u&&!ye.__privateGet.call(void 0,this,d).has(u))throw new Error("The networkClientId for this transaction could not be found");const h=u??ye.__privateMethod.call(void 0,this,K,Y).call(this),p=await this.getEIP1559Compatibility(h);Z.validateTxParams.call(void 0,e,p),a&&await Z.validateTransactionOrigin.call(void 0,await this.getPermittedAccounts(a),this.getSelectedAddress(),e.from,a);const m=this.generateDappSuggestedGasFees(e,a),f=this.getChainId(h),v=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:h,chainId:f}),g=c??(await oe.determineTransactionType.call(void 0,e,v)).type,_=this.getTransactionWithActionId(t);let k=_?Ge.cloneDeep.call(void 0,_):{actionId:t,chainId:f,dappSuggestedGasFees:m,deviceConfirmedOn:i,id:Le.v1.call(void 0),origin:a,securityAlertResponse:s,status:"unapproved",time:Date.now(),txParams:e,userEditedGasLimit:!1,verifiedOnBlockchain:!1,type:g,networkClientId:h};if(await this.updateGasProperties(k),!_){if(r&&this.securityProviderRequest){const e=await this.securityProviderRequest(k,r);k.securityProviderResponse=e}this.isSendFlowHistoryDisabled||(k.sendFlowHistory=o??[]),this.isHistoryDisabled||(k=ae.addInitialHistorySnapshot.call(void 0,k)),k=pe.updateSwapsTransaction.call(void 0,k,g,l,{isSwapsDisabled:this.isSwapsDisabled,cancelTransaction:this.cancelTransaction.bind(this),messenger:this.messagingSystem}),this.addMetadata(k),!1!==n?ye.__privateMethod.call(void 0,this,D,U).call(this,k):we.projectLogger.call(void 0,"Skipping simulation as approval not required"),this.messagingSystem.publish(`${He}:unapprovedTransactionAdded`,k)}return{result:this.processApproval(k,{isExisting:Boolean(_),requireApproval:n,actionId:t}),transactionMeta:k}}startIncomingTransactionPolling(e=[]){0!==e.length?ye.__privateGet.call(void 0,this,d).startIncomingTransactionPolling(e):this.incomingTransactionHelper.start()}stopIncomingTransactionPolling(e=[]){0!==e.length?ye.__privateGet.call(void 0,this,d).stopIncomingTransactionPolling(e):this.incomingTransactionHelper.stop()}stopAllIncomingTransactionPolling(){this.incomingTransactionHelper.stop(),ye.__privateGet.call(void 0,this,d).stopAllIncomingTransactionPolling()}async updateIncomingTransactions(e=[]){0!==e.length?await ye.__privateGet.call(void 0,this,d).updateIncomingTransactions(e):await this.incomingTransactionHelper.update()}async stopTransaction(e,t,{estimatedBaseFee:i,actionId:r}={}){if(this.getTransactionWithActionId(r))return;t&&(t=me.normalizeGasFeeValues.call(void 0,t),me.validateGasValues.call(void 0,t)),we.projectLogger.call(void 0,"Creating cancel transaction",e,t);const n=this.getTransaction(e);if(!n)return;if(!this.sign)throw new Error("No sign method defined.");const s=me.getIncreasedPriceFromExisting.call(void 0,n.txParams.gasPrice,De),o=me.isGasPriceValue.call(void 0,t)&&t.gasPrice,l=o&&me.validateMinimumIncrease.call(void 0,o,s)||s,c=n.txParams?.maxFeePerGas,u=me.getIncreasedPriceFromExisting.call(void 0,c,De),h=me.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxFeePerGas,p=h&&me.validateMinimumIncrease.call(void 0,h,u)||c&&u,m=n.txParams?.maxPriorityFeePerGas,f=me.getIncreasedPriceFromExisting.call(void 0,m,De),v=me.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxPriorityFeePerGas,g=v&&me.validateMinimumIncrease.call(void 0,v,f)||m&&f,_=p&&g?{from:n.txParams.from,gasLimit:n.txParams.gas,maxFeePerGas:p,maxPriorityFeePerGas:g,type:"0x2",nonce:n.txParams.nonce,to:n.txParams.from,value:"0x0"}:{from:n.txParams.from,gasLimit:n.txParams.gas,gasPrice:l,nonce:n.txParams.nonce,to:n.txParams.from,value:"0x0"},k=this.prepareUnsignedEthTx(n.chainId,_),w=await this.sign(k,n.txParams.from),y=Ee.bufferToHex.call(void 0,w.serialize()),T=_.maxFeePerGas??_.gasPrice,b=_.maxFeePerGas?n.txParams.maxFeePerGas:n.txParams.gasPrice;we.projectLogger.call(void 0,"Submitting cancel transaction",{oldFee:b,newFee:T,txParams:_});const E=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:n.networkClientId,chainId:n.chainId}),S=await this.publishTransactionForRetry(E,y,n),P={actionId:r,chainId:n.chainId,networkClientId:n.networkClientId,estimatedBaseFee:i,hash:S,id:Le.v1.call(void 0),originalGasEstimate:n.txParams.gas,status:"submitted",time:Date.now(),type:"cancel",txParams:_};this.addMetadata(P),this.messagingSystem.publish(`${He}:transactionApproved`,{transactionMeta:P,actionId:r}),this.messagingSystem.publish(`${He}:transactionSubmitted`,{transactionMeta:P,actionId:r}),this.messagingSystem.publish(`${He}:transactionFinished`,P),ye.__privateGet.call(void 0,this,a).emit(`${n.id}:finished`,P)}async speedUpTransaction(e,t,{actionId:i,estimatedBaseFee:r}={}){if(this.getTransactionWithActionId(i))return;t&&(t=me.normalizeGasFeeValues.call(void 0,t),me.validateGasValues.call(void 0,t)),we.projectLogger.call(void 0,"Creating speed up transaction",e,t);const a=this.getTransaction(e);if(!a)return;if(!this.sign)throw new Error("No sign method defined.");const n=me.getIncreasedPriceFromExisting.call(void 0,a.txParams.gasPrice,Ue),s=me.isGasPriceValue.call(void 0,t)&&t.gasPrice,o=s&&me.validateMinimumIncrease.call(void 0,s,n)||n,l=a.txParams?.maxFeePerGas,c=me.getIncreasedPriceFromExisting.call(void 0,l,Ue),u=me.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxFeePerGas,h=u&&me.validateMinimumIncrease.call(void 0,u,c)||l&&c,p=a.txParams?.maxPriorityFeePerGas,m=me.getIncreasedPriceFromExisting.call(void 0,p,Ue),f=me.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxPriorityFeePerGas,v=f&&me.validateMinimumIncrease.call(void 0,f,m)||p&&m,g=h&&v?{...a.txParams,gasLimit:a.txParams.gas,maxFeePerGas:h,maxPriorityFeePerGas:v,type:"0x2"}:{...a.txParams,gasLimit:a.txParams.gas,gasPrice:o},_=this.prepareUnsignedEthTx(a.chainId,g),k=await this.sign(_,a.txParams.from),w=this.updateTransactionMetaRSV(a,k),y=Ee.bufferToHex.call(void 0,k.serialize()),T=g.maxFeePerGas??g.gasPrice,b=g.maxFeePerGas?w.txParams.maxFeePerGas:w.txParams.gasPrice;we.projectLogger.call(void 0,"Submitting speed up transaction",{oldFee:b,newFee:T,txParams:g});const E=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:a.networkClientId,chainId:a.chainId}),S=await this.publishTransactionForRetry(E,y,a),P={...w,estimatedBaseFee:r,id:Le.v1.call(void 0),time:Date.now(),hash:S,actionId:i,originalGasEstimate:a.txParams.gas,type:"retry",originalType:a.type},C=h&&v?{...P,txParams:{...a.txParams,maxFeePerGas:h,maxPriorityFeePerGas:v}}:{...P,txParams:{...a.txParams,gasPrice:o}};this.addMetadata(C),this.messagingSystem.publish(`${He}:transactionApproved`,{transactionMeta:C,actionId:i}),this.messagingSystem.publish(`${He}:transactionSubmitted`,{transactionMeta:C,actionId:i}),this.messagingSystem.publish(`${He}:speedupTransactionAdded`,C)}async estimateGas(e,t){const i=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:t}),{estimatedGas:r,simulationFails:a}=await fe.estimateGas.call(void 0,e,i);return{gas:r,simulationFails:a}}async estimateGasBuffered(e,t,i){const r=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:i}),{blockGasLimit:a,estimatedGas:n,simulationFails:s}=await fe.estimateGas.call(void 0,e,r);return{gas:fe.addGasBuffer.call(void 0,n,a,t),simulationFails:s}}updateTransaction(e,t){const{id:i}=e;ye.__privateMethod.call(void 0,this,R,O).call(this,{transactionId:i,note:t,skipHistory:this.isHistoryDisabled},(()=>({...e})))}updateSecurityAlertResponse(e,t){if(!t)throw new Error("updateSecurityAlertResponse: securityAlertResponse should not be null");const i=this.getTransaction(e);if(!i)throw new Error("Cannot update security alert response as no transaction metadata found");const r={...i,securityAlertResponse:t};this.updateTransaction(r,`${He}:updatesecurityAlertResponse - securityAlertResponse updated`)}wipeTransactions(e,t){if(e&&!t)return void this.update((e=>{e.transactions=[]}));const i=this.getChainId(),r=this.state.transactions.filter((({chainId:r,txParams:a})=>{if(!(e||r===i))return!0;return!(!t||a.from?.toLowerCase()===t.toLowerCase())}));this.update((e=>{e.transactions=this.trimTransactionsForState(r)}))}async confirmExternalTransaction(e,t,i){const r=this.addExternalTransaction(e);try{const e=r.id,a={...r,status:"confirmed",txReceipt:t};i&&(a.baseFeePerGas=i),this.markNonceDuplicatesDropped(e),this.updateTransaction(a,`${He}:confirmExternalTransaction - Add external transaction`),this.onTransactionStatusChange(a),this.updatePostBalance(a),this.messagingSystem.publish(`${He}:transactionConfirmed`,a)}catch(e){console.error("Failed to confirm external transaction",e)}}updateTransactionSendFlowHistory(e,t,i){if(this.isSendFlowHistoryDisabled)throw new Error("Send flow history is disabled for the current transaction controller");const r=this.getTransaction(e);if(!r)throw new Error("Cannot update send flow history as no transaction metadata found");me.validateIfTransactionUnapproved.call(void 0,r,"updateTransactionSendFlowHistory");const a=r.sendFlowHistory??[];if(t===a.length){const e={...r,sendFlowHistory:[...a,...i]};this.updateTransaction(e,`${He}:updateTransactionSendFlowHistory - sendFlowHistory updated`)}return this.getTransaction(e)}updateTransactionGasFees(e,{defaultGasEstimates:t,estimateUsed:i,estimateSuggested:r,gas:a,gasLimit:n,gasPrice:s,maxPriorityFeePerGas:o,maxFeePerGas:l,originalGasEstimate:c,userEditedGasLimit:d,userFeeLevel:u}){const h=this.getTransaction(e);if(!h)throw new Error("Cannot update transaction as no transaction metadata found");me.validateIfTransactionUnapproved.call(void 0,h,"updateTransactionGasFees");let p={txParams:{gas:a,gasLimit:n,gasPrice:s,maxPriorityFeePerGas:o,maxFeePerGas:l},defaultGasEstimates:t,estimateUsed:i,estimateSuggested:r,originalGasEstimate:c,userEditedGasLimit:d,userFeeLevel:u};p.txParams=Ge.pickBy.call(void 0,p.txParams),p=Ge.pickBy.call(void 0,p);const m=Ge.merge.call(void 0,{},h,p);return this.updateTransaction(m,`${He}:updateTransactionGasFees - gas values updated`),this.getTransaction(e)}updatePreviousGasParams(e,{gasLimit:t,maxFeePerGas:i,maxPriorityFeePerGas:r}){const a=this.getTransaction(e);if(!a)throw new Error("Cannot update transaction as no transaction metadata found");me.validateIfTransactionUnapproved.call(void 0,a,"updatePreviousGasParams");const n={previousGas:{gasLimit:t,maxFeePerGas:i,maxPriorityFeePerGas:r}};n.previousGas=Ge.pickBy.call(void 0,n.previousGas);const s=Ge.merge.call(void 0,{},a,n);return this.updateTransaction(s,`${He}:updatePreviousGasParams - Previous gas values updated`),this.getTransaction(e)}async getNonceLock(e,t){return ye.__privateGet.call(void 0,this,d).getNonceLock(e,t)}async updateEditableParams(e,{data:t,gas:i,gasPrice:r,from:a,to:n,value:s}){const o=this.getTransaction(e);if(!o)throw new Error("Cannot update editable params as no transaction metadata found");me.validateIfTransactionUnapproved.call(void 0,o,"updateEditableParams");const l={txParams:{data:t,from:a,to:n,value:s,gas:i,gasPrice:r}};l.txParams=Ge.pickBy.call(void 0,l.txParams);const c=Ge.merge.call(void 0,{},o,l),u=ye.__privateGet.call(void 0,this,d).getProvider({chainId:o.chainId,networkClientId:o.networkClientId}),h=new(0,Ae.default)(u),{type:p}=await oe.determineTransactionType.call(void 0,c.txParams,h);return c.type=p,await _e.updateTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:this.layer1GasFeeFlows,provider:u,transactionMeta:c}),this.updateTransaction(c,`Update Editable Params for ${e}`),this.getTransaction(e)}async approveTransactionsWithSameNonce(e=[],{hasNonce:t}={}){if(we.projectLogger.call(void 0,"Approving transactions with same nonce",{transactions:e}),0===e.length)return"";const i=e[0],r=this.getCommonConfiguration(i.chainId);let a;try{a=this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",i.chainId)}catch(e){we.projectLogger.call(void 0,"failed to find networkClientId from chainId",e)}const n=be.TransactionFactory.fromTxData(i,{common:r}),s=Ee.bufferToHex.call(void 0,n.serialize());if(this.approvingTransactionIds.has(s))return"";let o,l;this.approvingTransactionIds.add(s);try{const r=i.from;l=!0!==t?await this.getNonceLock(r,a):void 0;const n=l?xe.add0x.call(void 0,l.nextNonce.toString(16)):i.nonce;l&&we.projectLogger.call(void 0,"Using nonce from nonce tracker",n,l.nonceDetails),o=await Promise.all(e.map((e=>(e.nonce=n,this.signExternalTransaction(e.chainId,e)))))}catch(e){throw we.projectLogger.call(void 0,"Error while signing transactions with same nonce",e),e}finally{l?.releaseLock(),this.approvingTransactionIds.delete(s)}return o}updateCustodialTransaction(e,{errorMessage:t,hash:i,status:r}){const n=this.getTransaction(e);if(!n)throw new Error("Cannot update custodial transaction as no transaction metadata found");if(!n.custodyId)throw new Error("Transaction must be a custodian transaction");if(r&&!["submitted","signed","failed"].includes(r))throw new Error(`Cannot update custodial transaction with status: ${r}`);const s=Ge.merge.call(void 0,{},n,Ge.pickBy.call(void 0,{hash:i,status:r}));"submitted"===s.status&&(s.submittedTime=(new Date).getTime()),"failed"===s.status&&(s.error=me.normalizeTxError.call(void 0,new Error(t))),this.updateTransaction(s,`${He}:updateCustodialTransaction - Custodial transaction updated`),["submitted","failed"].includes(r)&&(this.messagingSystem.publish(`${He}:transactionFinished`,s),ye.__privateGet.call(void 0,this,a).emit(`${s.id}:finished`,s))}initApprovals(){const e=this.getChainId(),t=this.state.transactions.filter((t=>"unapproved"===t.status&&t.chainId===e&&!t.isUserOperation));for(const e of t)this.processApproval(e,{shouldShowRequest:!1}).catch((e=>{e?.code!==Me.errorCodes.provider.userRejectedRequest&&console.error("Error during persisted transaction approval",e)}))}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:i=!0,limit:r}={}){const a=this.getChainId(),n=Ge.mapValues.call(void 0,e,(e=>"function"==typeof e?e:t=>t===e)),s=t??this.state.transactions,o=Ge.sortBy.call(void 0,Ge.pickBy.call(void 0,s,(e=>{if(i&&e.chainId!==a)return!1;for(const[t,i]of Object.entries(n))if(t in e.txParams){if(!1===i(e.txParams[t]))return!1}else if(!1===i(e[t]))return!1;return!0})),"time");if(void 0!==r){const e=new Set,t=[];for(let i=o.length-1;i>-1;i--){const a=o[i],{nonce:n}=a.txParams;if(!e.has(n)){if(!(e.size<r))continue;e.add(n)}t.unshift(a)}return t}return o}async estimateGasFee({transactionParams:e,chainId:t,networkClientId:i}){const r=ye.__privateMethod.call(void 0,this,$,V).call(this,{networkClientId:i,chainId:t}),a={txParams:e,chainId:t,networkClientId:r},n=ke.getGasFeeFlow.call(void 0,a,this.gasFeeFlows),s=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:r,chainId:t}),o=await this.getGasFeeEstimates({networkClientId:r});return n.getGasFees({ethQuery:s,gasFeeControllerData:o,transactionMeta:a})}async getLayer1GasFee({transactionParams:e,chainId:t,networkClientId:i}){const r=ye.__privateGet.call(void 0,this,d).getProvider({networkClientId:i,chainId:t});return await _e.getTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:this.layer1GasFeeFlows,provider:r,transactionMeta:{txParams:e,chainId:t}})}async signExternalTransaction(e,t){if(!this.sign)throw new Error("No sign method defined.");const i=me.normalizeTransactionParams.call(void 0,t),r=me.isEIP1559Transaction.call(void 0,i)?"0x2":"0x0",a={...i,type:r,gasLimit:i.gas,chainId:e},{from:n}=a,s=this.getCommonConfiguration(e),o=be.TransactionFactory.fromTxData(a,{common:s}),l=await this.sign(o,n);return Ee.bufferToHex.call(void 0,l.serialize())}clearUnapprovedTransactions(){const e=this.state.transactions.filter((({status:e})=>"unapproved"!==e));this.update((t=>{t.transactions=this.trimTransactionsForState(e)}))}abortTransactionSigning(e){if(!this.getTransaction(e))throw new Error("Cannot abort signing as no transaction metadata found");const t=this.signAbortCallbacks.get(e);if(!t)throw new Error("Cannot abort signing as transaction is not waiting for signing");t(),this.signAbortCallbacks.delete(e)}addMetadata(e){this.update((t=>{t.transactions=this.trimTransactionsForState([...t.transactions,e])}))}async updateGasProperties(e){const t=await this.getEIP1559Compatibility(e.networkClientId)&&"0x0"!==e.txParams.type,{networkClientId:i,chainId:r}=e,a=ye.__privateMethod.call(void 0,this,J,z).call(this,i),n=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:i,chainId:r}),s=ye.__privateGet.call(void 0,this,d).getProvider({networkClientId:i,chainId:r});await fe.updateGas.call(void 0,{ethQuery:n,chainId:r,isCustomNetwork:a,txMeta:e}),await he.updateGasFees.call(void 0,{eip1559:t,ethQuery:n,gasFeeFlows:this.gasFeeFlows,getGasFeeEstimates:this.getGasFeeEstimates,getSavedGasFees:this.getSavedGasFees.bind(this),txMeta:e}),await _e.updateTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:this.layer1GasFeeFlows,provider:s,transactionMeta:e})}onBootCleanup(){this.submitApprovedTransactions()}submitApprovedTransactions(){const e=this.state.transactions.filter((e=>"approved"===e.status));for(const t of e)this.beforeApproveOnInit(t)&&this.approveTransaction(t.id).catch((e=>{console.error("Error while submitting persisted transaction",e)}))}async processApproval(e,{isExisting:t=!1,requireApproval:i,shouldShowRequest:r=!0,actionId:a}){const n=e.id;let s;const{meta:o,isCompleted:l}=this.isTransactionCompleted(n),c=l?Promise.resolve(o):this.waitForTransactionFinished(n);if(o&&!t&&!l)try{if(!1!==i){const t=await this.requestApproval(e,{shouldShowRequest:r});s=t.resultCallbacks;const i=t.value,a=i?.txMeta;a&&(we.projectLogger.call(void 0,"Updating transaction with approval data",{customNonce:a.customNonceValue,params:a.txParams}),this.updateTransaction(a,"TransactionController#processApproval - Updated with approval data"))}const{isCompleted:t}=this.isTransactionCompleted(n);if(!t){"skipped-via-before-publish-hook"===await this.approveTransaction(n)&&s&&s.success();const e=this.getTransaction(n);this.messagingSystem.publish(`${He}:transactionApproved`,{transactionMeta:e,actionId:a})}}catch(e){const{isCompleted:t}=this.isTransactionCompleted(n);if(!t){if(e?.code===Me.errorCodes.provider.userRejectedRequest)throw this.cancelTransaction(n,a),Me.providerErrors.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.");this.failTransaction(o,e,a)}}const d=await c;switch(d?.status){case"failed":throw s?.error(d.error),Me.rpcErrors.internal(d.error.message);case"submitted":return s?.success(),d.hash;default:const e=Me.rpcErrors.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(d||n)}`);throw s?.error(e),e}}async approveTransaction(e){const t=new Array;t.push(await this.mutex.acquire());let i=this.getTransactionOrThrow(e);try{if(!this.sign)return this.failTransaction(i,new Error("No sign method defined.")),"not-approved";if(!i.chainId)return this.failTransaction(i,new Error("No chainId defined.")),"not-approved";if(this.approvingTransactionIds.has(e))return we.projectLogger.call(void 0,"Skipping approval as signing in progress",e),"not-approved";this.approvingTransactionIds.add(e),t.push((()=>this.approvingTransactionIds.delete(e)));const[r,n]=await ne.getNextNonce.call(void 0,i,(e=>ye.__privateGet.call(void 0,this,d).getNonceLock(e,i.networkClientId)));n&&t.push(n),i=ye.__privateMethod.call(void 0,this,R,O).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction approved"},(e=>{const{txParams:t,chainId:i}=e;e.status="approved",e.txParams={...t,nonce:r,chainId:i,gasLimit:t.gas,...me.isEIP1559Transaction.call(void 0,t)&&{type:"0x2"}}})),this.onTransactionStatusChange(i);const s=await this.signTransaction(i,i.txParams);if(!this.beforePublish(i))return we.projectLogger.call(void 0,"Skipping publishing transaction based on hook"),this.messagingSystem.publish(`${He}:transactionPublishingSkipped`,i),"skipped-via-before-publish-hook";if(!s)return"not-approved";const o=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:i.networkClientId,chainId:i.chainId});let l;const c="swap"===i.type;c&&(we.projectLogger.call(void 0,"Determining pre-transaction balance"),l=await Pe.query.call(void 0,o,"getBalance",[i.txParams.from])),we.projectLogger.call(void 0,"Publishing transaction",i.txParams);let{transactionHash:u}=await this.publish(i,s);return void 0===u&&(u=await this.publishTransaction(o,s)),we.projectLogger.call(void 0,"Publish successful",u),i=ye.__privateMethod.call(void 0,this,R,O).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction submitted"},(e=>{e.hash=u,e.status="submitted",e.submittedTime=(new Date).getTime(),c&&(e.preTxBalance=l,we.projectLogger.call(void 0,"Updated pre-transaction balance",l))})),this.messagingSystem.publish(`${He}:transactionSubmitted`,{transactionMeta:i}),this.messagingSystem.publish(`${He}:transactionFinished`,i),ye.__privateGet.call(void 0,this,a).emit(`${e}:finished`,i),this.onTransactionStatusChange(i),"approved"}catch(e){return this.failTransaction(i,e),"not-approved"}finally{t.forEach((e=>e()))}}async publishTransaction(e,t){return await Pe.query.call(void 0,e,"sendRawTransaction",[t])}cancelTransaction(e,t){const i=this.state.transactions.find((({id:t})=>t===e));if(!i)return;this.update((t=>{const i=t.transactions.filter((({id:t})=>t!==e));t.transactions=this.trimTransactionsForState(i)}));const r={...i,status:"rejected"};this.messagingSystem.publish(`${He}:transactionFinished`,r),ye.__privateGet.call(void 0,this,a).emit(`${i.id}:finished`,r),this.messagingSystem.publish(`${He}:transactionRejected`,{transactionMeta:r,actionId:t}),this.onTransactionStatusChange(r)}trimTransactionsForState(e){const t=new Set,i=[...e].sort(((e,t)=>e.time>t.time?-1:1)).filter((e=>{const{chainId:i,status:r,txParams:a,time:n}=e;if(a){const e=`${String(a.nonce)}-${Pe.convertHexToDecimal.call(void 0,i)}-${new Date(n).toDateString()}`;if(t.has(e))return!0;if(t.size<ye.__privateGet.call(void 0,this,o)||!this.isFinalState(r))return t.add(e),!0}return!1}));return i.reverse(),i}isFinalState(e){return"rejected"===e||"confirmed"===e||"failed"===e}isLocalFinalState(e){return["confirmed","failed","rejected","submitted"].includes(e)}async requestApproval(e,{shouldShowRequest:t}){const i=this.getApprovalId(e),{origin:r}=e,a=Pe.ApprovalType.Transaction,n={txId:e.id};return await this.messagingSystem.call("ApprovalController:addRequest",{id:i,origin:r||Pe.ORIGIN_METAMASK,type:a,requestData:n,expectsResult:!0},t)}getTransaction(e){const{transactions:t}=this.state;return t.find((({id:t})=>t===e))}getTransactionOrThrow(e,t="TransactionController"){const i=this.getTransaction(e);if(!i)throw new Error(`${t}: No transaction found with id ${e}`);return i}getApprovalId(e){return String(e.id)}isTransactionCompleted(e){const t=this.getTransaction(e);if(!t)return{meta:void 0,isCompleted:!1};return{meta:t,isCompleted:this.isLocalFinalState(t.status)}}getChainId(e){const t=ye.__privateMethod.call(void 0,this,q,X).call(this),i=ye.__privateMethod.call(void 0,this,K,Y).call(this);return e&&e!==i?this.messagingSystem.call("NetworkController:getNetworkClientById",e).configuration.chainId:t}prepareUnsignedEthTx(e,t){return be.TransactionFactory.fromTxData(t,{freeze:!1,common:this.getCommonConfiguration(e)})}getCommonConfiguration(e){const t={chainId:parseInt(e,16),defaultHardfork:Fe};return Te.Common.custom(t)}onIncomingTransactions({added:e,updated:t}){this.update((i=>{const{transactions:r}=i,a=[...e,...r.map((e=>t.find((({hash:t})=>t===e.hash))??e))];i.transactions=this.trimTransactionsForState(a)}))}onUpdatedLastFetchedBlockNumbers({lastFetchedBlockNumbers:e,blockNumber:t}){this.update((t=>{t.lastFetchedBlockNumbers=e})),this.messagingSystem.publish(`${He}:incomingTransactionBlockReceived`,t)}generateDappSuggestedGasFees(e,t){if(!t||t===Pe.ORIGIN_METAMASK)return;const{gasPrice:i,maxFeePerGas:r,maxPriorityFeePerGas:a,gas:n}=e;if(void 0===i&&void 0===r&&void 0===a&&void 0===n)return;const s={};return void 0!==i?s.gasPrice=i:void 0===r&&void 0===a||(s.maxFeePerGas=r,s.maxPriorityFeePerGas=a),void 0!==n&&(s.gas=n),s}addExternalTransaction(e){const{chainId:t}=e,{transactions:i}=this.state,r=e?.txParams?.from,a=i.filter((e=>e.txParams.from===r&&e.chainId===t)),n=a.filter((e=>"confirmed"===e.status)),s=a.filter((e=>"submitted"===e.status));ue.validateConfirmedExternalTransaction.call(void 0,e,n,s);const o=0!==(e.history??[]).length||this.isHistoryDisabled?e:ae.addInitialHistorySnapshot.call(void 0,e);return this.update((e=>{e.transactions=this.trimTransactionsForState([...e.transactions,o])})),o}markNonceDuplicatesDropped(e){const t=this.getTransaction(e);if(!t)return;const i=t.txParams?.nonce,r=t.txParams?.from,{chainId:a}=t,n=this.state.transactions.filter((t=>t.id!==e&&t.txParams.from===r&&t.txParams.nonce===i&&t.chainId===a&&"incoming"!==t.type)),s=n.map((e=>e.id));if(0!==n.length){this.update((e=>{for(const i of e.transactions)s.includes(i.id)&&(i.replacedBy=t?.hash,i.replacedById=t?.id)}));for(const e of this.state.transactions)s.includes(e.id)&&"failed"!==e.status&&this.setTransactionStatusDropped(e)}}setTransactionStatusDropped(e){const t={...e,status:"dropped"};this.messagingSystem.publish(`${He}:transactionDropped`,{transactionMeta:t}),this.updateTransaction(t,"TransactionController#setTransactionStatusDropped - Transaction dropped"),this.onTransactionStatusChange(t)}getTransactionWithActionId(e){return this.state.transactions.find((t=>e&&t.actionId===e))}async waitForTransactionFinished(e){return new Promise((t=>{ye.__privateGet.call(void 0,this,a).once(`${e}:finished`,(e=>{t(e)}))}))}updateTransactionMetaRSV(e,t){const i=Ge.cloneDeep.call(void 0,e);for(const e of["r","s","v"]){const r=t[e];null!=r&&(i[e]=xe.add0x.call(void 0,r.toString(16)))}return i}async getEIP1559Compatibility(e){const t=await this.getCurrentNetworkEIP1559Compatibility(e),i=await this.getCurrentAccountEIP1559Compatibility();return t&&i}async signTransaction(e,t){we.projectLogger.call(void 0,"Signing transaction",t);const i=this.prepareUnsignedEthTx(e.chainId,t);this.approvingTransactionIds.add(e.id);const r=await new Promise(((r,a)=>{this.sign?.(i,t.from,...this.getAdditionalSignArguments(e)).then(r,a),this.signAbortCallbacks.set(e.id,(()=>a(new Error("Signing aborted by user"))))}));if(this.signAbortCallbacks.delete(e.id),!r)return void we.projectLogger.call(void 0,"Skipping signed status as no signed transaction");const a=Ge.cloneDeep.call(void 0,e);if(!this.afterSign(a,r))return this.updateTransaction(a,"TransactionController#signTransaction - Update after sign"),void we.projectLogger.call(void 0,"Skipping signed status based on hook");const n={...this.updateTransactionMetaRSV(a,r),status:"signed"};this.updateTransaction(n,"TransactionController#approveTransaction - Transaction signed"),this.onTransactionStatusChange(n);const s=Ee.bufferToHex.call(void 0,r.serialize()),o=Ge.merge.call(void 0,{},n,{rawTx:s});return this.updateTransaction(o,"TransactionController#approveTransaction - RawTransaction added"),s}onTransactionStatusChange(e){this.messagingSystem.publish(`${He}:transactionStatusUpdated`,{transactionMeta:e})}getNonceTrackerTransactions(e,t,i=this.getChainId()){return ne.getAndFormatTransactionsForNonceTracker.call(void 0,i,t,e,this.state.transactions)}onConfirmedTransaction(e){we.projectLogger.call(void 0,"Processing confirmed transaction",e.id),this.markNonceDuplicatesDropped(e.id),this.messagingSystem.publish(`${He}:transactionConfirmed`,e),this.onTransactionStatusChange(e),this.updatePostBalance(e)}async updatePostBalance(e){try{if("swap"!==e.type)return;const t=ye.__privateGet.call(void 0,this,d).getEthQuery({networkClientId:e.networkClientId,chainId:e.chainId}),{updatedTransactionMeta:i,approvalTransactionMeta:r}=await pe.updatePostTransactionBalance.call(void 0,e,{ethQuery:t,getTransaction:this.getTransaction.bind(this),updateTransaction:this.updateTransaction.bind(this)});this.messagingSystem.publish(`${He}:postTransactionBalanceUpdated`,{transactionMeta:i,approvalTransactionMeta:r})}catch(e){we.projectLogger.call(void 0,"Error while updating post transaction balance",e)}}async publishTransactionForRetry(e,t,i){try{return await this.publishTransaction(e,t)}catch(e){if(this.isTransactionAlreadyConfirmedError(e))throw await this.pendingTransactionTracker.forceCheckTransaction(i),new Error("Previous transaction is already confirmed");throw e}}isTransactionAlreadyConfirmedError(e){return e?.message?.includes("nonce too low")||e?.data?.message?.includes("nonce too low")}};a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakSet,h=function({provider:e,blockTracker:t,chainId:i}){return new(0,je.NonceTracker)({provider:e,blockTracker:t,getPendingTransactions:ye.__privateMethod.call(void 0,this,A,I).bind(this,i),getConfirmedTransactions:this.getNonceTrackerTransactions.bind(this,"confirmed")})},p=new WeakSet,m=function({blockTracker:e,etherscanRemoteTransactionSource:t,chainId:i}){const r=new(0,le.IncomingTransactionHelper)({blockTracker:e,getCurrentAccount:this.getSelectedAddress,getLastFetchedBlockNumbers:()=>this.state.lastFetchedBlockNumbers,getChainId:i?()=>i:this.getChainId.bind(this),isEnabled:ye.__privateGet.call(void 0,this,n).isEnabled,queryEntireHistory:ye.__privateGet.call(void 0,this,n).queryEntireHistory,remoteTransactionSource:t,transactionLimit:ye.__privateGet.call(void 0,this,o),updateTransactions:ye.__privateGet.call(void 0,this,n).updateTransactions});return ye.__privateMethod.call(void 0,this,T,b).call(this,r),r},f=new WeakSet,v=function({provider:e,blockTracker:t,chainId:i}){const r=new(0,Ae.default)(e),a=i?()=>i:this.getChainId.bind(this),n=new(0,de.PendingTransactionTracker)({approveTransaction:async e=>{await this.approveTransaction(e)},blockTracker:t,getChainId:a,getEthQuery:()=>r,getTransactions:()=>this.state.transactions,isResubmitEnabled:ye.__privateGet.call(void 0,this,s).isResubmitEnabled,getGlobalLock:()=>ye.__privateGet.call(void 0,this,d).acquireNonceLockForChainIdKey({chainId:a()}),publishTransaction:this.publishTransaction.bind(this),hooks:{beforeCheckPendingTransaction:this.beforeCheckPendingTransaction.bind(this),beforePublish:this.beforePublish.bind(this)}});return ye.__privateMethod.call(void 0,this,P,C).call(this,n),n},g=new WeakMap,_=new WeakSet,k=function(){this.pendingTransactionTracker.stop(),ye.__privateMethod.call(void 0,this,E,S).call(this,this.pendingTransactionTracker),this.incomingTransactionHelper.stop(),ye.__privateMethod.call(void 0,this,w,y).call(this,this.incomingTransactionHelper),ye.__privateGet.call(void 0,this,d).stopAllTracking()},w=new WeakSet,y=function(e){e.hub.removeAllListeners("transactions"),e.hub.removeAllListeners("updatedLastFetchedBlockNumbers")},T=new WeakSet,b=function(e){e.hub.on("transactions",this.onIncomingTransactions.bind(this)),e.hub.on("updatedLastFetchedBlockNumbers",this.onUpdatedLastFetchedBlockNumbers.bind(this))},E=new WeakSet,S=function(e){e.hub.removeAllListeners("transaction-confirmed"),e.hub.removeAllListeners("transaction-dropped"),e.hub.removeAllListeners("transaction-failed"),e.hub.removeAllListeners("transaction-updated")},P=new WeakSet,C=function(e){e.hub.on("transaction-confirmed",this.onConfirmedTransaction.bind(this)),e.hub.on("transaction-dropped",this.setTransactionStatusDropped.bind(this)),e.hub.on("transaction-failed",this.failTransaction.bind(this)),e.hub.on("transaction-updated",this.updateTransaction.bind(this))},A=new WeakSet,I=function(e,t){return[...this.getNonceTrackerTransactions("submitted",t,e),...this.getExternalPendingTransactions(t,e)]},j=new WeakSet,M=function(){return ye.__privateGet.call(void 0,this,c)?[new(0,re.TestGasFeeFlow)]:[new(0,Q.LineaGasFeeFlow),new(0,ee.DefaultGasFeeFlow)]},x=new WeakSet,N=function(){return[new(0,te.OptimismLayer1GasFeeFlow),new(0,ie.ScrollLayer1GasFeeFlow)]},R=new WeakSet,O=function({transactionId:e,note:t,skipHistory:i},r){let a=[];this.update((n=>{const s=n.transactions.findIndex((({id:t})=>t===e));let o=n.transactions[s];o=r(o)??o,o.txParams=me.normalizeTransactionParams.call(void 0,o.txParams),Z.validateTxParams.call(void 0,o.txParams),a=ye.__privateMethod.call(void 0,this,G,L).call(this,o),!0!==i&&(o=ae.updateTransactionHistory.call(void 0,o,t??"Transaction updated")),n.transactions[s]=o}));const n=this.getTransaction(e);return a.length>0&&ye.__privateMethod.call(void 0,this,B,F).call(this,n,a),n},G=new WeakSet,L=function(e){const{id:t,txParams:i}=e,r=this.getTransaction(t)?.txParams;if(!r||Ge.isEqual.call(void 0,r,i))return[];const a=Object.keys(i).filter((e=>i[e]!==r[e]));return we.projectLogger.call(void 0,"Transaction parameters have been updated",t,a,r,i),a},B=new WeakSet,F=function(e,t){["to","value","data"].some((e=>t.includes(e)))&&(we.projectLogger.call(void 0,"Updating simulation data due to transaction parameter update"),ye.__privateMethod.call(void 0,this,D,U).call(this,e))},D=new WeakSet,U=async function(e){const{id:t,chainId:i,txParams:r}=e,{from:a,to:n,value:s,data:o}=r;let c={error:{code:"disabled",message:"Simulation disabled"},tokenBalanceChanges:[]};ye.__privateGet.call(void 0,this,l).call(this)&&(ye.__privateMethod.call(void 0,this,R,O).call(this,{transactionId:t,skipHistory:!0},(e=>{e.simulationData=void 0})),c=await se.getSimulationData.call(void 0,{chainId:i,from:a,to:n,value:s,data:o}));this.getTransaction(t)?(ye.__privateMethod.call(void 0,this,R,O).call(this,{transactionId:t,note:"TransactionController#updateSimulationData - Update simulation data"},(e=>{e.simulationData=c})),we.projectLogger.call(void 0,"Updated simulation data",t,c)):we.projectLogger.call(void 0,"Cannot update simulation data as transaction not found",t,c)},H=new WeakSet,W=function({transactionId:e,gasFeeEstimates:t,gasFeeEstimatesLoaded:i,layer1GasFee:r}){ye.__privateMethod.call(void 0,this,R,O).call(this,{transactionId:e,skipHistory:!0},(e=>{t&&(e.gasFeeEstimates=t),void 0!==i&&(e.gasFeeEstimatesLoaded=i),r&&(e.layer1GasFee=r)}))},$=new WeakSet,V=function({networkClientId:e,chainId:t}){const i=ye.__privateMethod.call(void 0,this,q,X).call(this),r=ye.__privateMethod.call(void 0,this,K,Y).call(this);return e||(t&&t!==i?this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",t):r)},K=new WeakSet,Y=function(){return this.getNetworkState().selectedNetworkClientId},q=new WeakSet,X=function(){return this.getNetworkState().providerConfig.chainId},J=new WeakSet,z=function(e){const t=ye.__privateMethod.call(void 0,this,K,Y).call(this);return e&&e!==t?this.messagingSystem.call("NetworkController:getNetworkClientById",e).configuration.type===Ie.NetworkClientType.Custom:this.getNetworkState().providerConfig.type===Pe.NetworkType.rpc},i.HARDFORK=Fe,i.CANCEL_RATE=De,i.SPEED_UP_RATE=Ue,i.ApprovalState=We,i.TransactionController=$e}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-OQNGSDIH.js"}],[185,{"../../../shared/constants/hardware-wallets":4430,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash"),a=e("../../../shared/constants/hardware-wallets");i.default={version:66,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=66;const i=function(e){var t;const i=window.navigator.hid?a.LedgerTransportTypes.webhid:a.LedgerTransportTypes.u2f,r=Boolean(null===(t=e.PreferencesController)||void 0===t?void 0:t.useLedgerLive),n={...e,PreferencesController:{...null==e?void 0:e.PreferencesController,ledgerTransportType:r?a.LedgerTransportTypes.live:i}};return delete n.PreferencesController.useLedgerLive,n}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/066.js"}],[1850,{"./chunk-S6VGOPUY.js":1854,"@metamask/controller-utils":1903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-S6VGOPUY.js"),a=e("@metamask/controller-utils"),n=r.createModuleLogger.call(void 0,r.projectLogger,"nonce");i.getNextNonce=async function(e,t){const{customNonceValue:i,txParams:{from:r,nonce:s}}=e,o=i?a.toHex.call(void 0,i):void 0;if(o)return n("Using custom nonce",o),[o,void 0];if(s)return n("Using existing nonce",s),[s,void 0];const l=await t(r),c=a.toHex.call(void 0,l.nextNonce),d=l.releaseLock.bind(l);return n("Using nonce from nonce tracker",c,l.nonceDetails),[c,d]},i.getAndFormatTransactionsForNonceTracker=function(e,t,i,r){return r.filter((({chainId:r,isTransfer:a,isUserOperation:n,status:s,txParams:{from:o}})=>!a&&!n&&r===e&&s===i&&o.toLowerCase()===t.toLowerCase())).map((({status:e,txParams:{from:t,gas:i,value:r,nonce:a}})=>({status:e,history:[{}],txParams:{from:t??"",gas:i??"",value:r??"",nonce:a??""}})))}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-PRUNMTRD.js"}],[1851,{"./chunk-EQT25RSP.js":1843,"./chunk-S6VGOPUY.js":1854,"./chunk-Z4BLTVTB.js":1866,"@metamask/eth-query":1271,"async-mutex":1907},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C=e("./chunk-EQT25RSP.js"),A=e("./chunk-S6VGOPUY.js"),I=e("./chunk-Z4BLTVTB.js"),j=e("@metamask/eth-query"),M=(r=j)&&r.__esModule?r:{default:r},x=e("async-mutex");a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,m=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakMap,w=new WeakSet,y=function(e){const t=I.__privateGet.call(void 0,this,g).get(e);t&&(t.pendingTransactionTracker.stop(),I.__privateGet.call(void 0,this,h).call(this,t.pendingTransactionTracker),t.incomingTransactionHelper.stop(),I.__privateGet.call(void 0,this,u).call(this,t.incomingTransactionHelper),I.__privateGet.call(void 0,this,g).delete(e))},T=new WeakSet,b=function(e){if(I.__privateGet.call(void 0,this,g).get(e))return;const{provider:t,blockTracker:i,configuration:{chainId:r}}=I.__privateGet.call(void 0,this,c).call(this,e);let a=I.__privateGet.call(void 0,this,_).get(r);a||(a=new(0,C.EtherscanRemoteTransactionSource)({includeTokenTransfers:I.__privateGet.call(void 0,this,o).includeTokenTransfers}),I.__privateGet.call(void 0,this,_).set(r,a));const n=I.__privateGet.call(void 0,this,p).call(this,{provider:t,blockTracker:i,chainId:r}),s=I.__privateGet.call(void 0,this,m).call(this,{blockTracker:i,etherscanRemoteTransactionSource:a,chainId:r}),l=I.__privateGet.call(void 0,this,f).call(this,{provider:t,blockTracker:i,chainId:r});I.__privateGet.call(void 0,this,g).set(e,{nonceTracker:n,incomingTransactionHelper:s,pendingTransactionTracker:l})},E=new WeakMap,S=new WeakSet,P=function({networkClientId:e,chainId:t}={}){let i;if(e)try{i=I.__privateGet.call(void 0,this,c).call(this,e)}catch(e){A.incomingTransactionsLogger.call(void 0,"failed to get network client by networkClientId")}if(!i&&t)try{const e=I.__privateGet.call(void 0,this,l).call(this,t);i=I.__privateGet.call(void 0,this,c).call(this,e)}catch(e){A.incomingTransactionsLogger.call(void 0,"failed to get network client by chainId")}return i},i.MultichainTrackingHelper=class{constructor({isMultichainEnabled:e,provider:t,nonceTracker:i,incomingTransactionOptions:r,findNetworkClientIdByChainId:P,getNetworkClientById:C,getNetworkClientRegistry:A,removeIncomingTransactionHelperListeners:j,removePendingTransactionTrackerListeners:M,createNonceTracker:x,createIncomingTransactionHelper:N,createPendingTransactionTracker:R,onNetworkStateChange:O}){I.__privateAdd.call(void 0,this,w),I.__privateAdd.call(void 0,this,T),I.__privateAdd.call(void 0,this,S),I.__privateAdd.call(void 0,this,a,void 0),I.__privateAdd.call(void 0,this,n,void 0),I.__privateAdd.call(void 0,this,s,void 0),I.__privateAdd.call(void 0,this,o,void 0),I.__privateAdd.call(void 0,this,l,void 0),I.__privateAdd.call(void 0,this,c,void 0),I.__privateAdd.call(void 0,this,d,void 0),I.__privateAdd.call(void 0,this,u,void 0),I.__privateAdd.call(void 0,this,h,void 0),I.__privateAdd.call(void 0,this,p,void 0),I.__privateAdd.call(void 0,this,m,void 0),I.__privateAdd.call(void 0,this,f,void 0),I.__privateAdd.call(void 0,this,v,new Map),I.__privateAdd.call(void 0,this,g,new Map),I.__privateAdd.call(void 0,this,_,new Map),this.checkForPendingTransactionAndStartPolling=()=>{for(const[,e]of I.__privateGet.call(void 0,this,g))e.pendingTransactionTracker.startIfPendingTransactions()},I.__privateAdd.call(void 0,this,k,(e=>{I.__privateGet.call(void 0,this,E).call(this,e);const t=Object.keys(e),i=Array.from(I.__privateGet.call(void 0,this,g).keys());i.filter((e=>!t.includes(e))).forEach((e=>{I.__privateMethod.call(void 0,this,w,y).call(this,e)}));t.filter((e=>!i.includes(e))).forEach((e=>{I.__privateMethod.call(void 0,this,T,b).call(this,e)}))})),I.__privateAdd.call(void 0,this,E,(e=>{const t=new Set;Object.values(e).forEach((e=>t.add(e.configuration.chainId)));Array.from(I.__privateGet.call(void 0,this,_).keys()).filter((e=>!t.has(e))).forEach((e=>{I.__privateGet.call(void 0,this,_).delete(e)}))})),I.__privateSet.call(void 0,this,a,e),I.__privateSet.call(void 0,this,n,t),I.__privateSet.call(void 0,this,s,i),I.__privateSet.call(void 0,this,o,r),I.__privateSet.call(void 0,this,l,P),I.__privateSet.call(void 0,this,c,C),I.__privateSet.call(void 0,this,d,A),I.__privateSet.call(void 0,this,u,j),I.__privateSet.call(void 0,this,h,M),I.__privateSet.call(void 0,this,p,x),I.__privateSet.call(void 0,this,m,N),I.__privateSet.call(void 0,this,f,R),O(((e,t)=>{if(I.__privateGet.call(void 0,this,a)){const e=I.__privateGet.call(void 0,this,d).call(this);t.forEach((({op:t,path:i})=>{if("remove"===t&&"networkConfigurations"===i[0]){const t=i[1];delete e[t]}})),I.__privateGet.call(void 0,this,k).call(this,e)}}))}initialize(){if(!I.__privateGet.call(void 0,this,a))return;const e=I.__privateGet.call(void 0,this,d).call(this);I.__privateGet.call(void 0,this,k).call(this,e)}has(e){return I.__privateGet.call(void 0,this,g).has(e)}getEthQuery({networkClientId:e,chainId:t}={}){return new(0,M.default)(this.getProvider({networkClientId:e,chainId:t}))}getProvider({networkClientId:e,chainId:t}={}){if(!I.__privateGet.call(void 0,this,a))return I.__privateGet.call(void 0,this,n);const i=I.__privateMethod.call(void 0,this,S,P).call(this,{networkClientId:e,chainId:t});return i?.provider||I.__privateGet.call(void 0,this,n)}async acquireNonceLockForChainIdKey({chainId:e,key:t="global"}){let i=I.__privateGet.call(void 0,this,v).get(e);i||(i=new Map,I.__privateGet.call(void 0,this,v).set(e,i));let r=i.get(t);return r||(r=new(0,x.Mutex),i.set(t,r)),await r.acquire()}async getNonceLock(e,t){let i,r=I.__privateGet.call(void 0,this,s);if(t&&I.__privateGet.call(void 0,this,a)){const a=I.__privateGet.call(void 0,this,c).call(this,t);i=await this.acquireNonceLockForChainIdKey({chainId:a.configuration.chainId,key:e});const n=I.__privateGet.call(void 0,this,g).get(t);if(!n)throw new Error("missing nonceTracker for networkClientId");r=n.nonceTracker}try{const t=await r.getNonceLock(e);return{...t,releaseLock:()=>{t.releaseLock(),i?.()}}}catch(e){throw i?.(),e}}startIncomingTransactionPolling(e=[]){e.forEach((e=>{I.__privateGet.call(void 0,this,g).get(e)?.incomingTransactionHelper.start()}))}stopIncomingTransactionPolling(e=[]){e.forEach((e=>{I.__privateGet.call(void 0,this,g).get(e)?.incomingTransactionHelper.stop()}))}stopAllIncomingTransactionPolling(){for(const[,e]of I.__privateGet.call(void 0,this,g))e.incomingTransactionHelper.stop()}async updateIncomingTransactions(e=[]){(await Promise.allSettled(e.map((async e=>await(I.__privateGet.call(void 0,this,g).get(e)?.incomingTransactionHelper.update()))))).filter((e=>"rejected"===e.status)).forEach((e=>{A.incomingTransactionsLogger.call(void 0,"failed to update incoming transactions",e.reason)}))}stopAllTracking(){for(const[e]of I.__privateGet.call(void 0,this,g))I.__privateMethod.call(void 0,this,w,y).call(this,e)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-PUESYN62.js"}],[1852,{"./chunk-RAOYRJ25.js":1853,"./chunk-S6VGOPUY.js":1854,"./chunk-YXSCBWTU.js":1865,"./chunk-Z4BLTVTB.js":1866,"@metamask/controller-utils":1903,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-YXSCBWTU.js"),m=e("./chunk-S6VGOPUY.js"),f=e("./chunk-RAOYRJ25.js"),v=e("./chunk-Z4BLTVTB.js"),g=e("@metamask/controller-utils"),_=e("@metamask/utils").createModuleLogger.call(void 0,m.projectLogger,"linea-gas-fee-flow"),k=[g.ChainId["linea-mainnet"],g.ChainId["linea-goerli"],g.ChainId["linea-sepolia"]],w={low:1,medium:1.35,high:1.7},y={low:1,medium:1.05,high:1.1};r=new WeakSet,a=async function(e){const{ethQuery:t,transactionMeta:i}=e,r=await v.__privateMethod.call(void 0,this,n,s).call(this,i,t);_("Received Linea response",r);const a=v.__privateMethod.call(void 0,this,o,l).call(this,r.baseFeePerGas,w);_("Generated base fees",v.__privateMethod.call(void 0,this,u,h).call(this,a));const p=v.__privateMethod.call(void 0,this,o,l).call(this,r.priorityFeePerGas,y);_("Generated priority fees",v.__privateMethod.call(void 0,this,u,h).call(this,p));const m=v.__privateMethod.call(void 0,this,c,d).call(this,a,p);_("Generated max fees",v.__privateMethod.call(void 0,this,u,h).call(this,m));return{estimates:Object.values(f.GasFeeEstimateLevel).reduce(((e,t)=>({...e,[t]:{maxFeePerGas:g.toHex.call(void 0,m[t]),maxPriorityFeePerGas:g.toHex.call(void 0,p[t])}})),{type:"fee-market"})}},n=new WeakSet,s=function(e,t){return g.query.call(void 0,t,"linea_estimateGas",[{from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,input:e.txParams.data,gasPrice:"0x100000000"}])},o=new WeakSet,l=function(e,t){const i=g.hexToBN.call(void 0,e);return{low:i.muln(t.low),medium:i.muln(t.medium),high:i.muln(t.high)}},c=new WeakSet,d=function(e,t){return{low:e.low.add(t.low),medium:e.medium.add(t.medium),high:e.high.add(t.high)}},u=new WeakSet,h=function(e){return Object.values(f.GasFeeEstimateLevel).map((t=>e[t].toString(10)))},i.LineaGasFeeFlow=class{constructor(){v.__privateAdd.call(void 0,this,r),v.__privateAdd.call(void 0,this,n),v.__privateAdd.call(void 0,this,o),v.__privateAdd.call(void 0,this,c),v.__privateAdd.call(void 0,this,u)}matchesTransaction(e){return k.includes(e.chainId)}async getGasFees(e){try{return await v.__privateMethod.call(void 0,this,r,a).call(this,e)}catch(t){return _("Using default flow as fallback due to error",t),(new(0,p.DefaultGasFeeFlow)).getGasFees(e)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-Q6Q44V4W.js"}],[1853,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e=>(e.approved="approved",e.cancelled="cancelled",e.confirmed="confirmed",e.dropped="dropped",e.failed="failed",e.rejected="rejected",e.signed="signed",e.submitted="submitted",e.unapproved="unapproved",e))(r||{}),a=(e=>(e.MM_MOBILE="metamask_mobile",e.MM_EXTENSION="metamask_extension",e.OTHER="other_device",e))(a||{}),n=(e=>(e.cancel="cancel",e.contractInteraction="contractInteraction",e.deployContract="contractDeployment",e.ethDecrypt="eth_decrypt",e.ethGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.incoming="incoming",e.personalSign="personal_sign",e.retry="retry",e.simpleSend="simpleSend",e.signTypedData="eth_signTypedData",e.smart="smart",e.swap="swap",e.swapAndSend="swapAndSend",e.swapApproval="swapApproval",e.tokenMethodApprove="approve",e.tokenMethodSafeTransferFrom="safetransferfrom",e.tokenMethodTransfer="transfer",e.tokenMethodTransferFrom="transferfrom",e.tokenMethodSetApprovalForAll="setapprovalforall",e.tokenMethodIncreaseAllowance="increaseAllowance",e))(n||{}),s=(e=>(e.legacy="0x0",e.accessList="0x1",e.feeMarket="0x2",e))(s||{}),o=(e=>(e.CUSTOM="custom",e.DAPP_SUGGESTED="dappSuggested",e.MEDIUM="medium",e))(o||{}),l=(e=>(e.Low="low",e.Medium="medium",e.High="high",e))(l||{}),c=(e=>(e.FeeMarket="fee-market",e.Legacy="legacy",e.GasPrice="eth_gasPrice",e))(c||{}),d=(e=>(e.erc20="erc20",e.erc721="erc721",e.erc1155="erc1155",e))(d||{}),u=(e=>(e.ChainNotSupported="chain-not-supported",e.Disabled="disabled",e.InvalidResponse="invalid-response",e.Reverted="reverted",e))(u||{});i.TransactionStatus=r,i.WalletDevice=a,i.TransactionType=n,i.TransactionEnvelopeType=s,i.UserFeeLevel=o,i.GasFeeEstimateLevel=l,i.GasFeeEstimateType=c,i.SimulationTokenStandard=d,i.SimulationErrorCode=u}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-RAOYRJ25.js"}],[1854,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=r.createProjectLogger.call(void 0,"transaction-controller"),n=r.createModuleLogger.call(void 0,a,"incoming-transactions");i.createModuleLogger=r.createModuleLogger,i.projectLogger=a,i.incomingTransactionsLogger=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-S6VGOPUY.js"}],[1855,{"@ethersproject/abi":463,"@metamask/controller-utils":1903,"@metamask/metamask-eth-abis":1473},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@ethersproject/abi"),a=e("@metamask/controller-utils"),n=e("@metamask/metamask-eth-abis"),s=new(0,r.Interface)(n.abiERC20),o=new(0,r.Interface)(n.abiERC721),l=new(0,r.Interface)(n.abiERC1155),c=new(0,r.Interface)(n.abiFiatTokenV2);i.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error",i.determineTransactionType=async function(e,t){const{data:i,to:r}=e;if(i&&!r)return{type:"contractDeployment",getCodeResponse:void 0};const{contractCode:n,isContractAddress:d}=await async function(e,t){let i;try{i=await a.query.call(void 0,e,"getCode",[t])}catch(e){i=null}const r=!!i&&("0x"!==i&&"0x0"!==i);return{contractCode:i,isContractAddress:r}}(t,r);if(!d)return{type:"simpleSend",getCodeResponse:n};const u=0!==Number(e.value??"0"),h={type:"contractInteraction",getCodeResponse:n};if(!i||u)return h;const p=function(e){if(!e)return;try{return s.parseTransaction({data:e})}catch{}try{return o.parseTransaction({data:e})}catch{}try{return l.parseTransaction({data:e})}catch{}try{return c.parseTransaction({data:e})}catch{}return}(i)?.name;if(!p)return h;const m=["approve","setapprovalforall","transfer","transferfrom","safetransferfrom","increaseAllowance"].find((e=>e.toLowerCase()===p.toLowerCase()));return m?{type:m,getCodeResponse:n}:h}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-SD6CWFDF.js"}],[1856,{"fast-json-patch":3310,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("fast-json-patch"),n=(r=a)&&r.__esModule?r:{default:r},s=e("lodash"),o=["/status","/txParams/gasPrice","/txParams/gas","/estimatedBaseFee","/blockTimestamp"];function l(e,t,i){const r=n.default.compare(e,t);return r[0]&&(i&&(r[0].note=i),r[0].timestamp=Date.now()),r}function c(e){return s.cloneDeep.call(void 0,e).reduce(((e,t)=>n.default.applyPatch(e,t).newDocument))}function d(e){const t={...e};return delete t.history,s.cloneDeep.call(void 0,t)}i.MAX_TRANSACTION_HISTORY_LENGTH=100,i.DISPLAYED_TRANSACTION_HISTORY_PATHS=o,i.addInitialHistorySnapshot=function(e){const t=d(e);return s.merge.call(void 0,{},e,{history:[t]})},i.updateTransactionHistory=function(e,t){if(!e.history)return e;const i=d(e),r=l(c(e.history),i,t);if(0===r.length)return e;let a=[...e.history,r];return a.length>100&&(a=function(e){const t=e[0],i=e.slice(1),r=i.findIndex((e=>!e.some((({path:e})=>o.includes(e)))));if(-1===r)return e;const a=r===i.length-1?r-1:r+1,n=Math.min(r,a),s=i[n],d=i[n+1],u=c([t,...i.slice(0,n)]),h=c([u,s,d]),p=l(u,h,`${String(s[0].note)}, ${String(d[0].note)}`);return i.splice(n,2,p),[t,...i]}(a)),s.merge.call(void 0,{},e,{history:a})}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-TIE3CPF7.js"}],[1857,{"./chunk-Z4BLTVTB.js":1866,"@metamask/controller-utils":1903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s=e("./chunk-Z4BLTVTB.js"),o=e("@metamask/controller-utils"),l=1e15;r=new WeakMap,a=new WeakSet,n=function(e,t){const i=Math.ceil(e/t);return o.toHex.call(void 0,i)},i.TestGasFeeFlow=class{constructor(){s.__privateAdd.call(void 0,this,a),s.__privateAdd.call(void 0,this,r,1)}matchesTransaction(e){return!0}async getGasFees(e){const{transactionMeta:t}=e,{txParams:i}=t,{gas:o}=i;if(!o)throw new Error("Cannot estimate fee without gas value");const c=parseInt(o,16),d=.5*l,u=(s.__privateGet.call(void 0,this,r)+1)*l,h=s.__privateGet.call(void 0,this,r)*l,p=u-d,m=h-d,f=u+d,v=h+d;return s.__privateSet.call(void 0,this,r,s.__privateGet.call(void 0,this,r)+1),{estimates:{type:"fee-market",low:{maxFeePerGas:s.__privateMethod.call(void 0,this,a,n).call(this,p,c),maxPriorityFeePerGas:s.__privateMethod.call(void 0,this,a,n).call(this,m,c)},medium:{maxFeePerGas:s.__privateMethod.call(void 0,this,a,n).call(this,u,c),maxPriorityFeePerGas:s.__privateMethod.call(void 0,this,a,n).call(this,h,c)},high:{maxFeePerGas:s.__privateMethod.call(void 0,this,a,n).call(this,f,c),maxPriorityFeePerGas:s.__privateMethod.call(void 0,this,a,n).call(this,v,c)}}}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-TJMQEH57.js"}],[1858,{"@metamask/controller-utils":1903,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/controller-utils"),a=e("@metamask/utils"),n={data:e=>a.add0x.call(void 0,l(e)),from:e=>a.add0x.call(void 0,e).toLowerCase(),gas:e=>a.add0x.call(void 0,e),gasLimit:e=>a.add0x.call(void 0,e),gasPrice:e=>a.add0x.call(void 0,e),nonce:e=>a.add0x.call(void 0,e),to:e=>a.add0x.call(void 0,e).toLowerCase(),value:e=>a.add0x.call(void 0,e),maxFeePerGas:e=>a.add0x.call(void 0,e),maxPriorityFeePerGas:e=>a.add0x.call(void 0,e),estimatedBaseFee:e=>a.add0x.call(void 0,e),type:e=>a.add0x.call(void 0,e)};var s=(e,t)=>a.add0x.call(void 0,`${parseInt(""+e*t,10).toString(16)}`);function o(e){try{return JSON.parse(JSON.stringify(e)),!0}catch{return!1}}function l(e){const t=e.toLowerCase().startsWith("0x")?e.slice(0,2):"",i=t?e.slice(2):e;return t+(i.length%2==0?i:`0${i}`)}i.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error",i.normalizeTransactionParams=function(e){const t={from:""};for(const i of a.getKnownPropertyNames.call(void 0,n))e[i]&&(t[i]=n[i](e[i]));return t.value||(t.value="0x0"),t},i.isEIP1559Transaction=function(e){const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);return t(e,"maxFeePerGas")&&t(e,"maxPriorityFeePerGas")},i.validateGasValues=e=>{Object.keys(e).forEach((t=>{const i=e[t];if("string"!=typeof i||!a.isStrictHexString.call(void 0,i))throw new TypeError(`expected hex string for ${t} but received: ${i}`)}))},i.isFeeMarketEIP1559Values=e=>void 0!==e?.maxFeePerGas||void 0!==e?.maxPriorityFeePerGas,i.isGasPriceValue=e=>void 0!==e?.gasPrice,i.getIncreasedPriceHex=s,i.getIncreasedPriceFromExisting=(e,t)=>s(r.convertHexToDecimal.call(void 0,e),t),i.validateMinimumIncrease=function(e,t){const i=r.convertHexToDecimal.call(void 0,e),a=r.convertHexToDecimal.call(void 0,t);if(i>=a)return e;throw new Error(`The proposed value: ${i} should meet or exceed the minimum value: ${a}`)},i.validateIfTransactionUnapproved=function(e,t){if("unapproved"!==e?.status)throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n      Current tx status: ${e?.status}`)},i.normalizeTxError=function(e){return{name:e.name,message:e.message,stack:e.stack,code:e.code,rpc:o(e.value)?e.value:void 0}},i.normalizeGasFeeValues=function(e){const t=e=>"string"==typeof e?a.add0x.call(void 0,e):e;return"gasPrice"in e?{gasPrice:t(e.gasPrice)}:{maxFeePerGas:t(e.maxFeePerGas),maxPriorityFeePerGas:t(e.maxPriorityFeePerGas)}},i.padHexToEvenLength=l}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-UGFBA4GV.js"}],[1859,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r={MAINNET:"0x1",GOERLI:"0x5",BASE:"0x2105",BASE_TESTNET:"0x14a33",BSC:"0x38",BSC_TESTNET:"0x61",OPTIMISM:"0xa",OPTIMISM_TESTNET:"0x1a4",OPBNB:"0xcc",OPBNB_TESTNET:"0x15eb",OPTIMISM_SEPOLIA:"0xaa37dc",POLYGON:"0x89",POLYGON_TESTNET:"0x13881",AVALANCHE:"0xa86a",AVALANCHE_TESTNET:"0xa869",FANTOM:"0xfa",FANTOM_TESTNET:"0xfa2",SEPOLIA:"0xaa36a7",LINEA_GOERLI:"0xe704",LINEA_SEPOLIA:"0xe705",LINEA_MAINNET:"0xe708",MOONBEAM:"0x504",MOONBEAM_TESTNET:"0x507",MOONRIVER:"0x505",GNOSIS:"0x64",ARBITRUM:"0xa4b1",ZKSYNC_ERA:"0x144",ZORA:"0x76adf1",SCROLL:"0x82750",SCROLL_SEPOLIA:"0x8274f"},a="etherscan.io",n="api",s={[r.GOERLI]:{domain:a,subdomain:`${n}-goerli`},[r.MAINNET]:{domain:a,subdomain:n},[r.SEPOLIA]:{domain:a,subdomain:`${n}-sepolia`},[r.LINEA_GOERLI]:{domain:"lineascan.build",subdomain:`${n}-goerli`},[r.LINEA_SEPOLIA]:{domain:"lineascan.build",subdomain:`${n}-sepolia`},[r.LINEA_MAINNET]:{domain:"lineascan.build",subdomain:n},[r.BSC]:{domain:"bscscan.com",subdomain:n},[r.BSC_TESTNET]:{domain:"bscscan.com",subdomain:`${n}-testnet`},[r.OPTIMISM]:{domain:a,subdomain:`${n}-optimistic`},[r.OPTIMISM_SEPOLIA]:{domain:a,subdomain:`${n}-sepolia-optimistic`},[r.POLYGON]:{domain:"polygonscan.com",subdomain:n},[r.POLYGON_TESTNET]:{domain:"polygonscan.com",subdomain:`${n}-mumbai`},[r.AVALANCHE]:{domain:"snowtrace.io",subdomain:n},[r.AVALANCHE_TESTNET]:{domain:"snowtrace.io",subdomain:`${n}-testnet`},[r.FANTOM]:{domain:"ftmscan.com",subdomain:n},[r.FANTOM_TESTNET]:{domain:"ftmscan.com",subdomain:`${n}-testnet`},[r.MOONBEAM]:{domain:"moonscan.io",subdomain:`${n}-moonbeam`},[r.MOONBEAM_TESTNET]:{domain:"moonscan.io",subdomain:`${n}-moonbase`},[r.MOONRIVER]:{domain:"moonscan.io",subdomain:`${n}-moonriver`},[r.GNOSIS]:{domain:"gnosisscan.io",subdomain:`${n}-gnosis`}},o={[r.OPTIMISM]:1,[r.OPTIMISM_SEPOLIA]:1};i.CHAIN_IDS=r,i.DEFAULT_ETHERSCAN_DOMAIN=a,i.DEFAULT_ETHERSCAN_SUBDOMAIN_PREFIX=n,i.ETHERSCAN_SUPPORTED_NETWORKS=s,i.GAS_BUFFER_CHAIN_OVERRIDES=o,i.ABI_SIMULATION_ERC20_WRAPPED=[{anonymous:!1,inputs:[{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Withdrawal",type:"event"}],i.ABI_SIMULATION_ERC721_LEGACY=[{anonymous:!1,inputs:[{indexed:!1,name:"_from",type:"address"},{indexed:!1,name:"_to",type:"address"},{indexed:!1,name:"_tokenId",type:"uint256"}],name:"Transfer",type:"event"}]}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-UGN7PBON.js"}],[186,{"../../../shared/constants/network":4436,"bignumber.js":2888,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,a=e("lodash"),n=(r=e("bignumber.js"))&&r.__esModule?r:{default:r},s=e("../../../shared/constants/network");const o=e=>new n.default(e||"0x0",16).gt(0);i.default={version:67,async migrate(e){const t=(0,a.cloneDeep)(e);t.meta.version=67;const i=function(e){var t,i,r;const a=(null==e?void 0:e.PreferencesController)||{},n=a.preferences||{};if(n.showTestNetworks)return e;const l=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},c=(null===(i=e.NetworkController)||void 0===i?void 0:i.provider)||{},d=(null===(r=e.CachedBalancesController)||void 0===r?void 0:r.cachedBalances)||{},u=s.TEST_CHAINS.includes(null==c?void 0:c.chainId),h=Object.values(l).some((({chainId:e})=>s.TEST_CHAINS.includes(e))),p=s.TEST_CHAINS.some((e=>Object.values(d[e]||{}).some(o))),m=u||h||p,f={...e,PreferencesController:{...a,preferences:{...n,showTestNetworks:m}}};return f}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/067.js"}],[1860,{"./chunk-S6VGOPUY.js":1854,"./chunk-UGFBA4GV.js":1858,"./chunk-UGN7PBON.js":1859,"@metamask/controller-utils":1903,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-UGFBA4GV.js"),a=e("./chunk-UGN7PBON.js"),n=e("./chunk-S6VGOPUY.js"),s=e("@metamask/controller-utils"),o=e("lodash"),l=n.createModuleLogger.call(void 0,n.projectLogger,"swaps"),c=5e3,d="0x0000000000000000000000000000000000000000",u={name:"Ether",address:d,decimals:18},h={name:"Binance Coin",address:d,decimals:18},p={name:"Matic",address:d,decimals:18},m={name:"Avalanche",address:d,decimals:18},f={name:"Test Ether",address:d,decimals:18},v={name:"Ether",address:d,decimals:18},g={...u},_={...u},k={...u},w={[a.CHAIN_IDS.MAINNET]:u,"0x539":f,[a.CHAIN_IDS.BSC]:h,[a.CHAIN_IDS.POLYGON]:p,[a.CHAIN_IDS.GOERLI]:v,[a.CHAIN_IDS.AVALANCHE]:m,[a.CHAIN_IDS.OPTIMISM]:_,[a.CHAIN_IDS.ARBITRUM]:g,[a.CHAIN_IDS.ZKSYNC_ERA]:k},y=["swap","swapAndSend","swapApproval"];function T(e,t){return!(!e||!t)&&e===w[t]?.address}function b(e){return new Promise((t=>setTimeout(t,e)))}i.UPDATE_POST_TX_BALANCE_TIMEOUT=c,i.UPDATE_POST_TX_BALANCE_ATTEMPTS=6,i.DEFAULT_TOKEN_ADDRESS=d,i.SWAPS_CHAINID_DEFAULT_TOKEN_MAP=w,i.SWAP_TRANSACTION_TYPES=y,i.updateSwapsTransaction=function(e,t,i,{isSwapsDisabled:a,cancelTransaction:n,messenger:s}){if(a||!y.includes(t))return e;if("swap"===t&&!1===i?.hasApproveTx&&e.simulationFails)throw n(e.id),new Error("Simulation failed");const l=i?.meta;if(!l)return e;let c=e;return"swapApproval"===t&&(c=function(e,{type:t,sourceTokenSymbol:i}){r.validateIfTransactionUnapproved.call(void 0,e,"updateSwapApprovalTransaction");let a={type:t,sourceTokenSymbol:i};return a=o.pickBy.call(void 0,{type:t,sourceTokenSymbol:i}),o.merge.call(void 0,{},e,a)}(e,l),s.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:c})),"swapAndSend"===t&&(c=function(e,{approvalTxId:t,destinationTokenAddress:i,destinationTokenAmount:a,destinationTokenDecimals:n,destinationTokenSymbol:s,estimatedBaseFee:l,sourceTokenAddress:c,sourceTokenAmount:d,sourceTokenDecimals:u,sourceTokenSymbol:h,swapAndSendRecipient:p,swapMetaData:m,swapTokenValue:f,type:v}){r.validateIfTransactionUnapproved.call(void 0,e,"updateSwapTransaction");let g={approvalTxId:t,destinationTokenAddress:i,destinationTokenAmount:a,destinationTokenDecimals:n,destinationTokenSymbol:s,estimatedBaseFee:l,sourceTokenAddress:c,sourceTokenAmount:d,sourceTokenDecimals:u,sourceTokenSymbol:h,swapAndSendRecipient:p,swapMetaData:m,swapTokenValue:f,type:v};return g=o.pickBy.call(void 0,g),o.merge.call(void 0,{},e,g)}(e,l),s.publish("TransactionController:transactionNewSwapAndSend",{transactionMeta:c})),"swap"===t&&(c=function(e,{sourceTokenSymbol:t,destinationTokenSymbol:i,type:a,destinationTokenDecimals:n,destinationTokenAddress:s,swapMetaData:l,swapTokenValue:c,estimatedBaseFee:d,approvalTxId:u}){r.validateIfTransactionUnapproved.call(void 0,e,"updateSwapTransaction");let h={sourceTokenSymbol:t,destinationTokenSymbol:i,type:a,destinationTokenDecimals:n,destinationTokenAddress:s,swapMetaData:l,swapTokenValue:c,estimatedBaseFee:d,approvalTxId:u};return h=o.pickBy.call(void 0,h),o.merge.call(void 0,{},e,h)}(e,l),s.publish("TransactionController:transactionNewSwap",{transactionMeta:c})),c},i.updatePostTransactionBalance=async function(e,{ethQuery:t,getTransaction:i,updateTransaction:r}){l("Updating post transaction balance",e.id);const a=e.id;let n,o;for(let r=0;r<6;r++){l("Querying balance",{attempt:r});const d=await s.query.call(void 0,t,"getBalance",[e.txParams.from]);n={...i(a)??{}},o=n.approvalTxId?i(n.approvalTxId):void 0,n.postTxBalance=d.toString(16);const u=T(e.destinationTokenAddress,e.chainId);if(!u||e.preTxBalance!==n.postTxBalance){l("Finishing post balance update",{isDefaultTokenAddress:u,preTxBalance:e.preTxBalance,postTxBalance:n.postTxBalance});break}l("Waiting for balance to update",{delay:c}),await b(c)}return r(n,"TransactionController#updatePostTransactionBalance - Add post transaction balance"),l("Completed post balance update",n?.postTxBalance),{updatedTransactionMeta:n,approvalTransactionMeta:o}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-UT4M4XI3.js"}],[1861,{"./chunk-S6VGOPUY.js":1854,"./chunk-UGN7PBON.js":1859,"@metamask/controller-utils":1903,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-UGN7PBON.js"),a=e("./chunk-S6VGOPUY.js"),n=e("@metamask/controller-utils"),s=e("@metamask/utils"),o=s.createModuleLogger.call(void 0,a.projectLogger,"gas"),l="0x5208",c=1.5;async function d(e,t){const i={...e},{data:r,value:a}=i,{gasLimit:l,number:c}=await async function(e){return await n.query.call(void 0,e,"getBlockByNumber",["latest",!1])}(t),u=n.hexToBN.call(void 0,l);i.data=r?s.add0x.call(void 0,r):r,i.gas=n.BNToHex.call(void 0,n.fractionBN.call(void 0,u,19,20)),i.value=a||"0x0";let h,p=i.gas;try{p=await n.query.call(void 0,t,"estimateGas",[i])}catch(e){h={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:c,blockGasLimit:l}},o("Estimation failed",{...h,fallback:d})}return{blockGasLimit:l,estimatedGas:p,simulationFails:h}}function u(e,t,i){const r=n.hexToBN.call(void 0,e),a=n.hexToBN.call(void 0,t).muln(.9),l=r.muln(i);if(r.gt(a)){const t=s.add0x.call(void 0,e);return o("Using estimated value",t),t}if(l.lt(a)){const e=s.add0x.call(void 0,n.BNToHex.call(void 0,l));return o("Using padded estimate",e,i),e}const c=s.add0x.call(void 0,n.BNToHex.call(void 0,a));return o("Using 90% of block gas limit",c),c}i.log=o,i.FIXED_GAS=l,i.DEFAULT_GAS_MULTIPLIER=c,i.updateGas=async function(e){const{txMeta:t}=e,i={...t.txParams},[a,s]=await async function(e){const{isCustomNetwork:t,chainId:i,txMeta:a}=e;if(a.txParams.gas)return o("Using value from request",a.txParams.gas),[a.txParams.gas];if(await async function({ethQuery:e,txMeta:t,isCustomNetwork:i}){const{txParams:{to:r,data:a}}=t;if(i||!r||a)return!1;const s=await async function(e,t){return await n.query.call(void 0,e,"getCode",[t])}(e,r);return!s||"0x"===s}(e))return o("Using fixed value",l),[l];const{blockGasLimit:s,estimatedGas:h,simulationFails:p}=await d(a.txParams,e.ethQuery);if(t)return o("Using original estimate as custom network"),[h,p];const m=r.GAS_BUFFER_CHAIN_OVERRIDES[i]??c;return[u(h,s,m),p]}(e);t.txParams.gas=a,t.simulationFails=s,i.gas||(t.originalGasEstimate=t.txParams.gas),t.defaultGasEstimates||(t.defaultGasEstimates={}),t.defaultGasEstimates.gas=t.txParams.gas},i.estimateGas=d,i.addGasBuffer=u}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-V72C4MCR.js"}],[1862,{"./chunk-UGFBA4GV.js":1858,"@ethersproject/abi":463,"@metamask/controller-utils":1903,"@metamask/metamask-eth-abis":1473,"@metamask/rpc-errors":1672},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-UGFBA4GV.js"),a=e("@ethersproject/abi"),n=e("@metamask/controller-utils"),s=e("@metamask/metamask-eth-abis"),o=e("@metamask/rpc-errors");function l(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&"0x2"!==e.type)throw o.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "0x2"`);break;default:if(e.type&&"0x2"===e.type)throw o.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function c(e,t,i){if(void 0!==e[i])throw o.rpcErrors.invalidParams(`Invalid transaction params: specified ${t} but also included ${i}, these cannot be mixed`)}function d(e,t){if("string"!=typeof e[t])throw o.rpcErrors.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}i.validateTransactionOrigin=async function(e,t,i,r){if(r!==n.ORIGIN_METAMASK){if(!e.includes(i))throw o.providerErrors.unauthorized({data:{origin:r}})}else if(i!==t)throw o.rpcErrors.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:r,fromAddress:i,selectedAddress:t}})},i.validateTxParams=function(e,t=!0){!function(e,t){if(r.isEIP1559Transaction.call(void 0,e)&&!t)throw o.rpcErrors.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559")}(e,t),function(e){if(!e||"string"!=typeof e)throw o.rpcErrors.invalidParams(`Invalid "from" address ${e}: not a string.`);if(!n.isValidHexAddress.call(void 0,e))throw o.rpcErrors.invalidParams('Invalid "from" address.')}(e.from),function(e){if("0x"===e.to||void 0===e.to){if(!e.data)throw o.rpcErrors.invalidParams('Invalid "to" address.');delete e.to}else if(void 0!==e.to&&!n.isValidHexAddress.call(void 0,e.to))throw o.rpcErrors.invalidParams('Invalid "to" address.')}(e),function(e){if(void 0!==e){if(e.includes("-"))throw o.rpcErrors.invalidParams(`Invalid transaction value "${e}": not a positive number.`);if(e.includes("."))throw o.rpcErrors.invalidParams(`Invalid transaction value "${e}": number must be in wei.`);const t=parseInt(e,10);if(!(Number.isFinite(t)&&!Number.isNaN(t)&&!isNaN(Number(e))&&Number.isSafeInteger(t)))throw o.rpcErrors.invalidParams(`Invalid transaction value ${e}: number must be a valid number.`)}}(e.value),function(e){if(e){const t=new(0,a.Interface)(s.abiERC20);try{t.parseTransaction({data:e})}catch(e){if(e.message.match(/BUFFER_OVERRUN/u))throw o.rpcErrors.invalidParams("Invalid transaction params: data out-of-bounds, BUFFER_OVERRUN.")}}}(e.data),function(e){if(void 0!==e&&"number"!=typeof e&&"string"!=typeof e)throw o.rpcErrors.invalidParams(`Invalid transaction params: chainId is not a Number or hex string. got: (${e})`)}(e.chainId),function(e){e.gasPrice&&(l(e,"gasPrice"),c(e,"gasPrice","maxFeePerGas"),c(e,"gasPrice","maxPriorityFeePerGas"),d(e,"gasPrice"));e.maxFeePerGas&&(l(e,"maxFeePerGas"),c(e,"maxFeePerGas","gasPrice"),d(e,"maxFeePerGas"));e.maxPriorityFeePerGas&&(l(e,"maxPriorityFeePerGas"),c(e,"maxPriorityFeePerGas","gasPrice"),d(e,"maxPriorityFeePerGas"))}(e)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-VH47Q6TS.js"}],[1863,{"./chunk-UGN7PBON.js":1859,"./chunk-YVCX6Z75.js":1864},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-YVCX6Z75.js"),a=e("./chunk-UGN7PBON.js"),n=[a.CHAIN_IDS.SCROLL,a.CHAIN_IDS.SCROLL_SEPOLIA],s=class extends r.OracleLayer1GasFeeFlow{constructor(){super("0x5300000000000000000000000000000000000002",!0)}matchesTransaction(e){return n.includes(e.chainId)}};i.ScrollLayer1GasFeeFlow=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-WR5F34OW.js"}],[1864,{"./chunk-S6VGOPUY.js":1854,"./chunk-Z4BLTVTB.js":1866,"@ethereumjs/common":421,"@ethereumjs/tx":1872,"@ethersproject/contracts":486,"@ethersproject/providers":524,"@metamask/utils":2255,buffer:2983,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-S6VGOPUY.js"),m=e("./chunk-Z4BLTVTB.js"),f=e("@ethereumjs/common"),v=e("@ethereumjs/tx"),g=e("@ethersproject/contracts"),_=e("@ethersproject/providers"),k=e("@metamask/utils"),w=e("lodash"),y=k.createModuleLogger.call(void 0,p.projectLogger,"oracle-layer1-gas-fee-flow"),T=[{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"getL1Fee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];r=new WeakMap,a=new WeakMap,n=new WeakSet,s=async function(e){const{provider:t,transactionMeta:i}=e,n=new(0,g.Contract)(m.__privateGet.call(void 0,this,r),T,new(0,_.Web3Provider)(t)),s=m.__privateMethod.call(void 0,this,o,l).call(this,i,m.__privateGet.call(void 0,this,a)).serialize(),c=await n.getL1Fee(s);if(void 0===c)throw new Error("No value returned from oracle contract");return{layer1Fee:c.toHexString()}},o=new WeakSet,l=function(e,i){const r=m.__privateMethod.call(void 0,this,c,d).call(this,e),a=m.__privateMethod.call(void 0,this,u,h).call(this,e);let n=v.TransactionFactory.fromTxData(r,{common:a});if(i){const e=t.from("abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789","hex");n=n.sign(e)}return n},c=new WeakSet,d=function(e){return{...w.omit.call(void 0,e.txParams,"gas"),gasLimit:e.txParams.gas}},u=new WeakSet,h=function(e){const t=Number(e.chainId);return f.Common.custom({chainId:t,defaultHardfork:f.Hardfork.London})},i.OracleLayer1GasFeeFlow=class{constructor(e,t){m.__privateAdd.call(void 0,this,n),m.__privateAdd.call(void 0,this,o),m.__privateAdd.call(void 0,this,c),m.__privateAdd.call(void 0,this,u),m.__privateAdd.call(void 0,this,r,void 0),m.__privateAdd.call(void 0,this,a,void 0),m.__privateSet.call(void 0,this,r,e),m.__privateSet.call(void 0,this,a,t??!1)}async getLayer1Fee(e){try{return await m.__privateMethod.call(void 0,this,n,s).call(this,e)}catch(e){throw y("Failed to get oracle layer 1 gas fee",e),new Error("Failed to get oracle layer 1 gas fee")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-YVCX6Z75.js"}],[1865,{"./chunk-3ZRHCVVS.js":1837,"./chunk-RAOYRJ25.js":1853,"./chunk-S6VGOPUY.js":1854,"./chunk-Z4BLTVTB.js":1866,"@metamask/gas-fee-controller":1804,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-3ZRHCVVS.js"),m=e("./chunk-S6VGOPUY.js"),f=e("./chunk-RAOYRJ25.js"),v=e("./chunk-Z4BLTVTB.js"),g=e("@metamask/gas-fee-controller"),_=e("@metamask/utils").createModuleLogger.call(void 0,m.projectLogger,"default-gas-fee-flow");r=new WeakSet,a=function(e){return{type:"fee-market",...Object.values(f.GasFeeEstimateLevel).reduce(((t,i)=>({...t,[i]:v.__privateMethod.call(void 0,this,c,d).call(this,e,i)})),{})}},n=new WeakSet,s=function(e){return{type:"legacy",...Object.values(f.GasFeeEstimateLevel).reduce(((t,i)=>({...t,[i]:v.__privateMethod.call(void 0,this,u,h).call(this,e,i)})),{})}},o=new WeakSet,l=function(e){return{type:"eth_gasPrice",gasPrice:p.gweiDecimalToWeiHex.call(void 0,e.gasPrice)}},c=new WeakSet,d=function(e,t){return{maxFeePerGas:p.gweiDecimalToWeiHex.call(void 0,e[t].suggestedMaxFeePerGas),maxPriorityFeePerGas:p.gweiDecimalToWeiHex.call(void 0,e[t].suggestedMaxPriorityFeePerGas)}},u=new WeakSet,h=function(e,t){return p.gweiDecimalToWeiHex.call(void 0,e[t])},i.DefaultGasFeeFlow=class{constructor(){v.__privateAdd.call(void 0,this,r),v.__privateAdd.call(void 0,this,n),v.__privateAdd.call(void 0,this,o),v.__privateAdd.call(void 0,this,c),v.__privateAdd.call(void 0,this,u)}matchesTransaction(e){return!0}async getGasFees(e){const{gasFeeControllerData:t}=e,{gasEstimateType:i,gasFeeEstimates:c}=t;let d;switch(i){case g.GAS_ESTIMATE_TYPES.FEE_MARKET:_("Using fee market estimates",c),d=v.__privateMethod.call(void 0,this,r,a).call(this,c);break;case g.GAS_ESTIMATE_TYPES.LEGACY:_("Using legacy estimates",c),d=v.__privateMethod.call(void 0,this,n,s).call(this,c);break;case g.GAS_ESTIMATE_TYPES.ETH_GASPRICE:_("Using eth_gasPrice estimates",c),d=v.__privateMethod.call(void 0,this,o,l).call(this,c);break;default:throw new Error(`Unsupported gas estimate type: ${i}`)}return{estimates:d}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-YXSCBWTU.js"}],[1866,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-Z4BLTVTB.js"}],[1867,{"./chunk-2XKEAKQG.js":1836,"./chunk-3ZRHCVVS.js":1837,"./chunk-5KMU2IAT.js":1838,"./chunk-7LXE4KHV.js":1839,"./chunk-7MKQDZKY.js":1840,"./chunk-DLOQPH4M.js":1841,"./chunk-DTDTOMTB.js":1842,"./chunk-EQT25RSP.js":1843,"./chunk-FDUCRHYT.js":1844,"./chunk-HMOSP33F.js":1845,"./chunk-IT3SYNZ6.js":1846,"./chunk-KT6UAKBB.js":1847,"./chunk-NYKRCWBG.js":1848,"./chunk-OQNGSDIH.js":1849,"./chunk-PRUNMTRD.js":1850,"./chunk-PUESYN62.js":1851,"./chunk-Q6Q44V4W.js":1852,"./chunk-RAOYRJ25.js":1853,"./chunk-S6VGOPUY.js":1854,"./chunk-SD6CWFDF.js":1855,"./chunk-TIE3CPF7.js":1856,"./chunk-TJMQEH57.js":1857,"./chunk-UGFBA4GV.js":1858,"./chunk-UGN7PBON.js":1859,"./chunk-UT4M4XI3.js":1860,"./chunk-V72C4MCR.js":1861,"./chunk-VH47Q6TS.js":1862,"./chunk-WR5F34OW.js":1863,"./chunk-YVCX6Z75.js":1864,"./chunk-YXSCBWTU.js":1865,"./chunk-Z4BLTVTB.js":1866},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-OQNGSDIH.js");e("./chunk-VH47Q6TS.js"),e("./chunk-Q6Q44V4W.js"),e("./chunk-YXSCBWTU.js"),e("./chunk-NYKRCWBG.js"),e("./chunk-WR5F34OW.js"),e("./chunk-YVCX6Z75.js"),e("./chunk-TJMQEH57.js");var a=e("./chunk-TIE3CPF7.js");e("./chunk-PRUNMTRD.js"),e("./chunk-IT3SYNZ6.js"),e("./chunk-KT6UAKBB.js");var n=e("./chunk-SD6CWFDF.js");e("./chunk-DTDTOMTB.js"),e("./chunk-PUESYN62.js"),e("./chunk-5KMU2IAT.js"),e("./chunk-7LXE4KHV.js"),e("./chunk-3ZRHCVVS.js"),e("./chunk-UT4M4XI3.js");var s=e("./chunk-UGFBA4GV.js");e("./chunk-V72C4MCR.js"),e("./chunk-HMOSP33F.js"),e("./chunk-EQT25RSP.js"),e("./chunk-FDUCRHYT.js"),e("./chunk-UGN7PBON.js"),e("./chunk-7MKQDZKY.js"),e("./chunk-2XKEAKQG.js");var o=e("./chunk-DLOQPH4M.js");e("./chunk-S6VGOPUY.js");var l=e("./chunk-RAOYRJ25.js");e("./chunk-Z4BLTVTB.js"),i.CANCEL_RATE=r.CANCEL_RATE,i.DISPLAYED_TRANSACTION_HISTORY_PATHS=a.DISPLAYED_TRANSACTION_HISTORY_PATHS,i.GasFeeEstimateLevel=l.GasFeeEstimateLevel,i.GasFeeEstimateType=l.GasFeeEstimateType,i.HARDFORK=r.HARDFORK,i.MAX_TRANSACTION_HISTORY_LENGTH=a.MAX_TRANSACTION_HISTORY_LENGTH,i.SimulationErrorCode=l.SimulationErrorCode,i.SimulationTokenStandard=l.SimulationTokenStandard,i.TransactionController=r.TransactionController,i.TransactionEnvelopeType=l.TransactionEnvelopeType,i.TransactionStatus=l.TransactionStatus,i.TransactionType=l.TransactionType,i.UserFeeLevel=l.UserFeeLevel,i.WalletDevice=l.WalletDevice,i.determineTransactionType=n.determineTransactionType,i.isEIP1559Transaction=s.isEIP1559Transaction,i.mergeGasFeeEstimates=o.mergeGasFeeEstimates,i.normalizeTransactionParams=s.normalizeTransactionParams}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/index.js"}],[1868,{"./types":1875,"./util":1876,"@ethereumjs/common":421,"@ethereumjs/util":1884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.BaseTransaction=void 0;const r=e("@ethereumjs/common"),a=e("@ethereumjs/util"),n=e("./types"),s=e("./util");i.BaseTransaction=class{constructor(e,t){this.cache={hash:undefined,dataFee:undefined},this.activeCapabilities=[],this.DEFAULT_CHAIN=r.Chain.Mainnet,this.DEFAULT_HARDFORK=r.Hardfork.Merge;const{nonce:i,gasLimit:n,to:o,value:l,data:c,v:d,r:u,s:h,type:p}=e;this._type=Number((0,a.bufferToBigInt)((0,a.toBuffer)(p))),this.txOptions=t;const m=(0,a.toBuffer)(""===o?"0x":o),f=(0,a.toBuffer)(""===d?"0x":d),v=(0,a.toBuffer)(""===u?"0x":u),g=(0,a.toBuffer)(""===h?"0x":h);this.nonce=(0,a.bufferToBigInt)((0,a.toBuffer)(""===i?"0x":i)),this.gasLimit=(0,a.bufferToBigInt)((0,a.toBuffer)(""===n?"0x":n)),this.to=m.length>0?new a.Address(m):undefined,this.value=(0,a.bufferToBigInt)((0,a.toBuffer)(""===l?"0x":l)),this.data=(0,a.toBuffer)(""===c?"0x":c),this.v=f.length>0?(0,a.bufferToBigInt)(f):undefined,this.r=v.length>0?(0,a.bufferToBigInt)(v):undefined,this.s=g.length>0?(0,a.bufferToBigInt)(g):undefined,this._validateCannotExceedMaxInteger({value:this.value,r:this.r,s:this.s}),this._validateCannotExceedMaxInteger({gasLimit:this.gasLimit},64),this._validateCannotExceedMaxInteger({nonce:this.nonce},64,!0);const _=this.to===undefined||null===this.to,k=t.allowUnlimitedInitCodeSize??!1,w=t.common??this._getCommon();_&&w.isActivatedEIP(3860)&&!1===k&&(0,s.checkMaxInitCodeSize)(w,this.data.length)}get type(){return this._type}supports(e){return this.activeCapabilities.includes(e)}validate(e=!1){const t=[];return this.getBaseFee()>this.gasLimit&&t.push(`gasLimit is too low. given ${this.gasLimit}, need at least ${this.getBaseFee()}`),this.isSigned()&&!this.verifySignature()&&t.push("Invalid Signature"),e?t:0===t.length}_validateYParity(){const{v:e}=this;if(e!==undefined&&e!==BigInt(0)&&e!==BigInt(1)){const e=this._errorMsg("The y-parity of the transaction should either be 0 or 1");throw new Error(e)}}_validateHighS(){const{s:e}=this;if(this.common.gteHardfork("homestead")&&e!==undefined&&e>a.SECP256K1_ORDER_DIV_2){const e=this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");throw new Error(e)}}getBaseFee(){const e=this.common.param("gasPrices","tx");let t=this.getDataFee();if(e&&(t+=e),this.common.gteHardfork("homestead")&&this.toCreationAddress()){const e=this.common.param("gasPrices","txCreation");e&&(t+=e)}return t}getDataFee(){const e=this.common.param("gasPrices","txDataZero"),t=this.common.param("gasPrices","txDataNonZero");let i=BigInt(0);for(let r=0;r<this.data.length;r++)0===this.data[r]?i+=e:i+=t;if((this.to===undefined||null===this.to)&&this.common.isActivatedEIP(3860)){const e=BigInt(Math.ceil(this.data.length/32));i+=this.common.param("gasPrices","initCodeWordCost")*e}return i}toCreationAddress(){return this.to===undefined||0===this.to.buf.length}isSigned(){const{v:e,r:t,s:i}=this;return e!==undefined&&t!==undefined&&i!==undefined}verifySignature(){try{const e=this.getSenderPublicKey();return 0!==(0,a.unpadBuffer)(e).length}catch(e){return!1}}getSenderAddress(){return new a.Address((0,a.publicToAddress)(this.getSenderPublicKey()))}sign(e){if(32!==e.length){const e=this._errorMsg("Private key must be 32 bytes in length.");throw new Error(e)}let t=!1;0===this.type&&this.common.gteHardfork("spuriousDragon")&&!this.supports(n.Capability.EIP155ReplayProtection)&&(this.activeCapabilities.push(n.Capability.EIP155ReplayProtection),t=!0);const i=this.getMessageToSign(!0),{v:r,r:s,s:o}=(0,a.ecsign)(i,e),l=this._processSignature(r,s,o);if(t){const e=this.activeCapabilities.indexOf(n.Capability.EIP155ReplayProtection);e>-1&&this.activeCapabilities.splice(e,1)}return l}_getCommon(e,t){if(t!==undefined){const i=(0,a.bufferToBigInt)((0,a.toBuffer)(t));if(e){if(e.chainId()!==i){const e=this._errorMsg("The chain ID does not match the chain ID of Common");throw new Error(e)}return e.copy()}return r.Common.isSupportedChainId(i)?new r.Common({chain:i,hardfork:this.DEFAULT_HARDFORK}):r.Common.custom({name:"custom-chain",networkId:i,chainId:i},{baseChain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}return e?.copy()??new r.Common({chain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}_validateCannotExceedMaxInteger(e,t=256,i=!1){for(const[r,n]of Object.entries(e))switch(t){case 64:if(i){if(n!==undefined&&n>=a.MAX_UINT64){const e=this._errorMsg(`${r} cannot equal or exceed MAX_UINT64 (2^64-1), given ${n}`);throw new Error(e)}}else if(n!==undefined&&n>a.MAX_UINT64){const e=this._errorMsg(`${r} cannot exceed MAX_UINT64 (2^64-1), given ${n}`);throw new Error(e)}break;case 256:if(i){if(n!==undefined&&n>=a.MAX_INTEGER){const e=this._errorMsg(`${r} cannot equal or exceed MAX_INTEGER (2^256-1), given ${n}`);throw new Error(e)}}else if(n!==undefined&&n>a.MAX_INTEGER){const e=this._errorMsg(`${r} cannot exceed MAX_INTEGER (2^256-1), given ${n}`);throw new Error(e)}break;default:{const e=this._errorMsg("unimplemented bits value");throw new Error(e)}}}static _validateNotArray(e){const t=["nonce","gasPrice","gasLimit","to","value","data","v","r","s","type","baseFee","maxFeePerGas","chainId"];for(const[i,r]of Object.entries(e))if(t.includes(i)&&Array.isArray(r))throw new Error(`${i} cannot be an array`)}_getSharedErrorPostfix(){let e="";try{e=this.isSigned()?(0,a.bufferToHex)(this.hash()):"not available (unsigned)"}catch(t){e="error"}let t="";try{t=this.isSigned().toString()}catch(t){e="error"}let i="";try{i=this.common.hardfork()}catch(e){i="error"}let r=`tx type=${this.type} hash=${e} nonce=${this.nonce} value=${this.value} `;return r+=`signed=${t} hf=${i}`,r}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/baseTransaction.js"}],[1869,{"./baseTransaction":1868,"./util":1876,"@ethereumjs/rlp":424,"@ethereumjs/util":1884,buffer:2983,"ethereum-cryptography/keccak":3208},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.FeeMarketEIP1559Transaction=void 0;const r=e("@ethereumjs/rlp"),a=e("@ethereumjs/util"),n=e("ethereum-cryptography/keccak"),s=e("./baseTransaction"),o=e("./util"),l=t.from(2..toString(16).padStart(2,"0"),"hex");class c extends s.BaseTransaction{constructor(e,t={}){super({...e,type:2},t),this.DEFAULT_HARDFORK="london";const{chainId:i,accessList:r,maxFeePerGas:n,maxPriorityFeePerGas:l}=e;if(this.common=this._getCommon(t.common,i),this.chainId=this.common.chainId(),!1===this.common.isActivatedEIP(1559))throw new Error("EIP-1559 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([1559,2718,2930]);const c=o.AccessLists.getAccessListData(r??[]);if(this.accessList=c.accessList,this.AccessListJSON=c.AccessListJSON,o.AccessLists.verifyAccessList(this.accessList),this.maxFeePerGas=(0,a.bufferToBigInt)((0,a.toBuffer)(""===n?"0x":n)),this.maxPriorityFeePerGas=(0,a.bufferToBigInt)((0,a.toBuffer)(""===l?"0x":l)),this._validateCannotExceedMaxInteger({maxFeePerGas:this.maxFeePerGas,maxPriorityFeePerGas:this.maxPriorityFeePerGas}),s.BaseTransaction._validateNotArray(e),this.gasLimit*this.maxFeePerGas>a.MAX_INTEGER){const e=this._errorMsg("gasLimit * maxFeePerGas cannot exceed MAX_INTEGER (2^256-1)");throw new Error(e)}if(this.maxFeePerGas<this.maxPriorityFeePerGas){const e=this._errorMsg("maxFeePerGas cannot be less than maxPriorityFeePerGas (The total must be the larger of the two)");throw new Error(e)}this._validateYParity(),this._validateHighS();(t?.freeze??!0)&&Object.freeze(this)}static fromTxData(e,t={}){return new c(e,t)}static fromSerializedTx(e,t={}){if(!e.slice(0,1).equals(l))throw new Error(`Invalid serialized tx input: not an EIP-1559 transaction (wrong tx type, expected: 2, received: ${e.slice(0,1).toString("hex")}`);const i=(0,a.arrToBufArr)(r.RLP.decode(e.slice(1)));if(!Array.isArray(i))throw new Error("Invalid serialized tx input: must be array");return c.fromValuesArray(i,t)}static fromValuesArray(e,t={}){if(9!==e.length&&12!==e.length)throw new Error("Invalid EIP-1559 transaction. Only expecting 9 values (for unsigned tx) or 12 values (for signed tx).");const[i,r,n,s,o,l,d,u,h,p,m,f]=e;return this._validateNotArray({chainId:i,v:p}),(0,a.validateNoLeadingZeroes)({nonce:r,maxPriorityFeePerGas:n,maxFeePerGas:s,gasLimit:o,value:d,v:p,r:m,s:f}),new c({chainId:(0,a.bufferToBigInt)(i),nonce:r,maxPriorityFeePerGas:n,maxFeePerGas:s,gasLimit:o,to:l,value:d,data:u,accessList:h??[],v:p!==undefined?(0,a.bufferToBigInt)(p):undefined,r:m,s:f},t)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(o.AccessLists.getDataFeeEIP2930(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(e=BigInt(0)){const t=this.maxPriorityFeePerGas,i=this.maxFeePerGas-e,r=(t<i?t:i)+e;return this.gasLimit*r+this.value}raw(){return[(0,a.bigIntToUnpaddedBuffer)(this.chainId),(0,a.bigIntToUnpaddedBuffer)(this.nonce),(0,a.bigIntToUnpaddedBuffer)(this.maxPriorityFeePerGas),(0,a.bigIntToUnpaddedBuffer)(this.maxFeePerGas),(0,a.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,a.bigIntToUnpaddedBuffer)(this.value),this.data,this.accessList,this.v!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.v):t.from([]),this.r!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.r):t.from([]),this.s!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.s):t.from([])]}serialize(){const e=this.raw();return t.concat([l,t.from(r.RLP.encode((0,a.bufArrToArr)(e)))])}getMessageToSign(e=!0){const i=this.raw().slice(0,9),s=t.concat([l,t.from(r.RLP.encode((0,a.bufArrToArr)(i)))]);return e?t.from((0,n.keccak256)(s)):s}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=t.from((0,n.keccak256)(this.serialize()))),this.cache.hash):t.from((0,n.keccak256)(this.serialize()))}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const e=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(e)}const e=this.getMessageToVerifySignature(),{v:t,r:i,s:r}=this;this._validateHighS();try{return(0,a.ecrecover)(e,t+BigInt(27),(0,a.bigIntToUnpaddedBuffer)(i),(0,a.bigIntToUnpaddedBuffer)(r))}catch(e){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,i){const r={...this.txOptions,common:this.common};return c.fromTxData({chainId:this.chainId,nonce:this.nonce,maxPriorityFeePerGas:this.maxPriorityFeePerGas,maxFeePerGas:this.maxFeePerGas,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:(0,a.bufferToBigInt)(t),s:(0,a.bufferToBigInt)(i)},r)}toJSON(){const e=o.AccessLists.getAccessListJSON(this.accessList);return{chainId:(0,a.bigIntToHex)(this.chainId),nonce:(0,a.bigIntToHex)(this.nonce),maxPriorityFeePerGas:(0,a.bigIntToHex)(this.maxPriorityFeePerGas),maxFeePerGas:(0,a.bigIntToHex)(this.maxFeePerGas),gasLimit:(0,a.bigIntToHex)(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:(0,a.bigIntToHex)(this.value),data:"0x"+this.data.toString("hex"),accessList:e,v:this.v!==undefined?(0,a.bigIntToHex)(this.v):undefined,r:this.r!==undefined?(0,a.bigIntToHex)(this.r):undefined,s:this.s!==undefined?(0,a.bigIntToHex)(this.s):undefined}}errorStr(){let e=this._getSharedErrorPostfix();return e+=` maxFeePerGas=${this.maxFeePerGas} maxPriorityFeePerGas=${this.maxPriorityFeePerGas}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}i.FeeMarketEIP1559Transaction=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/eip1559Transaction.js"}],[187,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:68,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=68;const i=function(e){const{PermissionsController:t={},PermissionsMetadata:i={},...r}=e,{domainMetadata:s={},permissionsHistory:o={},permissionsLog:l=[]}=i;return{...r,PermissionController:a(t),PermissionLogController:{permissionActivityLog:l,permissionHistory:o},SubjectMetadataController:n(s)}}(t.data);return t.data=i,t}};function a(e){const{domains:t={}}=e;return{subjects:Object.entries(t).reduce(((e,[t,i])=>{const{permissions:[r]}=i,a=r.caveats.find((e=>"exposedAccounts"===e.name)),n={...r,caveats:[{type:"restrictReturnedAccounts",value:a.value}]};return delete n["@context"],e[t]={origin:t,permissions:{eth_accounts:n}},e}),{})}}function n(e){return{subjectMetadata:Object.entries(e).reduce(((e,[t,i])=>{const{name:r=null,icon:a=null,extensionId:n=null,...s}=i;return delete s.lastUpdated,delete s.host,t&&(e[t]={name:r,iconUrl:a,extensionId:n,...s,origin:t}),e}),{})}}}}},{package:"$root$",file:"app/scripts/migrations/068.js"}],[1870,{"./baseTransaction":1868,"./util":1876,"@ethereumjs/rlp":424,"@ethereumjs/util":1884,buffer:2983,"ethereum-cryptography/keccak":3208},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.AccessListEIP2930Transaction=void 0;const r=e("@ethereumjs/rlp"),a=e("@ethereumjs/util"),n=e("ethereum-cryptography/keccak"),s=e("./baseTransaction"),o=e("./util"),l=t.from(1..toString(16).padStart(2,"0"),"hex");class c extends s.BaseTransaction{constructor(e,t={}){super({...e,type:1},t),this.DEFAULT_HARDFORK="berlin";const{chainId:i,accessList:r,gasPrice:n}=e;if(this.common=this._getCommon(t.common,i),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(2930))throw new Error("EIP-2930 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([2718,2930]);const l=o.AccessLists.getAccessListData(r??[]);if(this.accessList=l.accessList,this.AccessListJSON=l.AccessListJSON,o.AccessLists.verifyAccessList(this.accessList),this.gasPrice=(0,a.bufferToBigInt)((0,a.toBuffer)(""===n?"0x":n)),this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),s.BaseTransaction._validateNotArray(e),this.gasPrice*this.gasLimit>a.MAX_INTEGER){const e=this._errorMsg("gasLimit * gasPrice cannot exceed MAX_INTEGER");throw new Error(e)}this._validateYParity(),this._validateHighS();(t?.freeze??!0)&&Object.freeze(this)}static fromTxData(e,t={}){return new c(e,t)}static fromSerializedTx(e,t={}){if(!e.slice(0,1).equals(l))throw new Error(`Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: 1, received: ${e.slice(0,1).toString("hex")}`);const i=(0,a.arrToBufArr)(r.RLP.decode(Uint8Array.from(e.slice(1))));if(!Array.isArray(i))throw new Error("Invalid serialized tx input: must be array");return c.fromValuesArray(i,t)}static fromValuesArray(e,t={}){if(8!==e.length&&11!==e.length)throw new Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");const[i,r,n,s,o,l,d,u,h,p,m]=e;this._validateNotArray({chainId:i,v:h}),(0,a.validateNoLeadingZeroes)({nonce:r,gasPrice:n,gasLimit:s,value:l,v:h,r:p,s:m});return new c({chainId:(0,a.bufferToBigInt)(i),nonce:r,gasPrice:n,gasLimit:s,to:o,value:l,data:d,accessList:u??[],v:h!==undefined?(0,a.bufferToBigInt)(h):undefined,r:p,s:m},t)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(o.AccessLists.getDataFeeEIP2930(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}raw(){return[(0,a.bigIntToUnpaddedBuffer)(this.chainId),(0,a.bigIntToUnpaddedBuffer)(this.nonce),(0,a.bigIntToUnpaddedBuffer)(this.gasPrice),(0,a.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,a.bigIntToUnpaddedBuffer)(this.value),this.data,this.accessList,this.v!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.v):t.from([]),this.r!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.r):t.from([]),this.s!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.s):t.from([])]}serialize(){const e=this.raw();return t.concat([l,t.from(r.RLP.encode((0,a.bufArrToArr)(e)))])}getMessageToSign(e=!0){const i=this.raw().slice(0,8),s=t.concat([l,t.from(r.RLP.encode((0,a.bufArrToArr)(i)))]);return e?t.from((0,n.keccak256)(s)):s}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=t.from((0,n.keccak256)(this.serialize()))),this.cache.hash):t.from((0,n.keccak256)(this.serialize()))}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const e=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(e)}const e=this.getMessageToVerifySignature(),{v:t,r:i,s:r}=this;this._validateHighS();try{return(0,a.ecrecover)(e,t+BigInt(27),(0,a.bigIntToUnpaddedBuffer)(i),(0,a.bigIntToUnpaddedBuffer)(r))}catch(e){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,i){const r={...this.txOptions,common:this.common};return c.fromTxData({chainId:this.chainId,nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:(0,a.bufferToBigInt)(t),s:(0,a.bufferToBigInt)(i)},r)}toJSON(){const e=o.AccessLists.getAccessListJSON(this.accessList);return{chainId:(0,a.bigIntToHex)(this.chainId),nonce:(0,a.bigIntToHex)(this.nonce),gasPrice:(0,a.bigIntToHex)(this.gasPrice),gasLimit:(0,a.bigIntToHex)(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:(0,a.bigIntToHex)(this.value),data:"0x"+this.data.toString("hex"),accessList:e,v:this.v!==undefined?(0,a.bigIntToHex)(this.v):undefined,r:this.r!==undefined?(0,a.bigIntToHex)(this.r):undefined,s:this.s!==undefined?(0,a.bigIntToHex)(this.s):undefined}}errorStr(){let e=this._getSharedErrorPostfix();return e+=` gasPrice=${this.gasPrice} accessListCount=${this.accessList?.length??0}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}i.AccessListEIP2930Transaction=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/eip2930Transaction.js"}],[1871,{"@ethereumjs/util":1884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.normalizeTxParams=void 0;const r=e("@ethereumjs/util");i.normalizeTxParams=e=>{const t=Object.assign({},e);return t.gasLimit=(0,r.toType)(t.gasLimit??t.gas,r.TypeOutput.BigInt),t.data=t.data===undefined?t.input:t.data,t.gasPrice=t.gasPrice!==undefined?BigInt(t.gasPrice):undefined,t.value=t.value!==undefined?BigInt(t.value):undefined,t.to=null!==t.to&&t.to!==undefined?(0,r.setLengthLeft)((0,r.toBuffer)(t.to),20):null,t.v="0x0"===t.v?"0x":t.v,t.r="0x0"===t.r?"0x":t.r,t.s="0x0"===t.s?"0x":t.s,"0x"!==t.v&&(t.v=(0,r.toType)(t.v,r.TypeOutput.BigInt)),t}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/fromRpc.js"}],[1872,{"./eip1559Transaction":1869,"./eip2930Transaction":1870,"./legacyTransaction":1873,"./transactionFactory":1874,"./types":1875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){r===undefined&&(r=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,a)}:function(e,t,i,r){r===undefined&&(r=i),e[r]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),i.TransactionFactory=i.Transaction=i.AccessListEIP2930Transaction=i.FeeMarketEIP1559Transaction=void 0;var n=e("./eip1559Transaction");Object.defineProperty(i,"FeeMarketEIP1559Transaction",{enumerable:!0,get:function(){return n.FeeMarketEIP1559Transaction}});var s=e("./eip2930Transaction");Object.defineProperty(i,"AccessListEIP2930Transaction",{enumerable:!0,get:function(){return s.AccessListEIP2930Transaction}});var o=e("./legacyTransaction");Object.defineProperty(i,"Transaction",{enumerable:!0,get:function(){return o.Transaction}});var l=e("./transactionFactory");Object.defineProperty(i,"TransactionFactory",{enumerable:!0,get:function(){return l.TransactionFactory}}),a(e("./types"),i)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/index.js"}],[1873,{"./baseTransaction":1868,"./types":1875,"@ethereumjs/rlp":424,"@ethereumjs/util":1884,buffer:2983,"ethereum-cryptography/keccak":3208},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.Transaction=void 0;const r=e("@ethereumjs/rlp"),a=e("@ethereumjs/util"),n=e("ethereum-cryptography/keccak"),s=e("./baseTransaction"),o=e("./types");function l(e,t){const i=Number(e),r=2*Number(t);return i===r+35||i===r+36}class c extends s.BaseTransaction{constructor(e,t={}){if(super({...e,type:0},t),this.common=this._validateTxV(this.v,t.common),this.gasPrice=(0,a.bufferToBigInt)((0,a.toBuffer)(""===e.gasPrice?"0x":e.gasPrice)),this.gasPrice*this.gasLimit>a.MAX_INTEGER){const e=this._errorMsg("gas limit * gasPrice cannot exceed MAX_INTEGER (2^256-1)");throw new Error(e)}this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),s.BaseTransaction._validateNotArray(e),this.common.gteHardfork("spuriousDragon")&&(this.isSigned()?l(this.v,this.common.chainId())&&this.activeCapabilities.push(o.Capability.EIP155ReplayProtection):this.activeCapabilities.push(o.Capability.EIP155ReplayProtection));(t?.freeze??!0)&&Object.freeze(this)}static fromTxData(e,t={}){return new c(e,t)}static fromSerializedTx(e,t={}){const i=(0,a.arrToBufArr)(r.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(i))throw new Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(i,t)}static fromValuesArray(e,t={}){if(6!==e.length&&9!==e.length)throw new Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");const[i,r,n,s,o,l,d,u,h]=e;return(0,a.validateNoLeadingZeroes)({nonce:i,gasPrice:r,gasLimit:n,value:o,v:d,r:u,s:h}),new c({nonce:i,gasPrice:r,gasLimit:n,to:s,value:o,data:l,v:d,r:u,s:h},t)}raw(){return[(0,a.bigIntToUnpaddedBuffer)(this.nonce),(0,a.bigIntToUnpaddedBuffer)(this.gasPrice),(0,a.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,a.bigIntToUnpaddedBuffer)(this.value),this.data,this.v!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.v):t.from([]),this.r!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.r):t.from([]),this.s!==undefined?(0,a.bigIntToUnpaddedBuffer)(this.s):t.from([])]}serialize(){return t.from(r.RLP.encode((0,a.bufArrToArr)(this.raw())))}_getMessageToSign(){const e=[(0,a.bigIntToUnpaddedBuffer)(this.nonce),(0,a.bigIntToUnpaddedBuffer)(this.gasPrice),(0,a.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,a.bigIntToUnpaddedBuffer)(this.value),this.data];return this.supports(o.Capability.EIP155ReplayProtection)&&(e.push((0,a.bigIntToUnpaddedBuffer)(this.common.chainId())),e.push((0,a.unpadBuffer)((0,a.toBuffer)(0))),e.push((0,a.unpadBuffer)((0,a.toBuffer)(0)))),e}getMessageToSign(e=!0){const i=this._getMessageToSign();return e?t.from((0,n.keccak256)(r.RLP.encode((0,a.bufArrToArr)(i)))):i}getDataFee(){return this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork()?this.cache.dataFee.value:(Object.isFrozen(this)&&(this.cache.dataFee={value:super.getDataFee(),hardfork:this.common.hardfork()}),super.getDataFee())}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=t.from((0,n.keccak256)(r.RLP.encode((0,a.bufArrToArr)(this.raw()))))),this.cache.hash):t.from((0,n.keccak256)(r.RLP.encode((0,a.bufArrToArr)(this.raw()))))}getMessageToVerifySignature(){if(!this.isSigned()){const e=this._errorMsg("This transaction is not signed");throw new Error(e)}const e=this._getMessageToSign();return t.from((0,n.keccak256)(r.RLP.encode((0,a.bufArrToArr)(e))))}getSenderPublicKey(){const e=this.getMessageToVerifySignature(),{v:t,r:i,s:r}=this;this._validateHighS();try{return(0,a.ecrecover)(e,t,(0,a.bigIntToUnpaddedBuffer)(i),(0,a.bigIntToUnpaddedBuffer)(r),this.supports(o.Capability.EIP155ReplayProtection)?this.common.chainId():undefined)}catch(e){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,i){this.supports(o.Capability.EIP155ReplayProtection)&&(e+=this.common.chainId()*BigInt(2)+BigInt(8));const r={...this.txOptions,common:this.common};return c.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v:e,r:(0,a.bufferToBigInt)(t),s:(0,a.bufferToBigInt)(i)},r)}toJSON(){return{nonce:(0,a.bigIntToHex)(this.nonce),gasPrice:(0,a.bigIntToHex)(this.gasPrice),gasLimit:(0,a.bigIntToHex)(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:(0,a.bigIntToHex)(this.value),data:"0x"+this.data.toString("hex"),v:this.v!==undefined?(0,a.bigIntToHex)(this.v):undefined,r:this.r!==undefined?(0,a.bigIntToHex)(this.r):undefined,s:this.s!==undefined?(0,a.bigIntToHex)(this.s):undefined}}_validateTxV(e,t){let i;const r=e!==undefined?Number(e):undefined;if(r!==undefined&&r<37&&27!==r&&28!==r)throw new Error(`Legacy txs need either v = 27/28 or v >= 37 (EIP-155 replay protection), got v = ${r}`);if(r!==undefined&&0!==r&&(!t||t.gteHardfork("spuriousDragon"))&&27!==r&&28!==r)if(t){if(!l(BigInt(r),t.chainId()))throw new Error(`Incompatible EIP155-based V ${r} and chain id ${t.chainId()}. See the Common parameter of the Transaction constructor to set the chain id.`)}else{let e;e=(r-35)%2==0?35:36,i=BigInt(r-e)/BigInt(2)}return this._getCommon(t,i)}errorStr(){let e=this._getSharedErrorPostfix();return e+=` gasPrice=${this.gasPrice}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}i.Transaction=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/legacyTransaction.js"}],[1874,{"../../../../../../../../../is-buffer/index.js":3595,"./eip1559Transaction":1869,"./eip2930Transaction":1870,"./fromRpc":1871,"./legacyTransaction":1873,"@ethereumjs/util":1884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.TransactionFactory=void 0;const r=e("@ethereumjs/util"),a=e("./eip1559Transaction"),n=e("./eip2930Transaction"),s=e("./fromRpc"),o=e("./legacyTransaction");class l{constructor(){}static fromTxData(e,t={}){if("type"in e&&e.type!==undefined){const i=Number((0,r.bufferToBigInt)((0,r.toBuffer)(e.type)));if(0===i)return o.Transaction.fromTxData(e,t);if(1===i)return n.AccessListEIP2930Transaction.fromTxData(e,t);if(2===i)return a.FeeMarketEIP1559Transaction.fromTxData(e,t);throw new Error(`Tx instantiation with type ${i} not supported`)}return o.Transaction.fromTxData(e,t)}static fromSerializedData(e,t={}){if(!(e[0]<=127))return o.Transaction.fromSerializedTx(e,t);switch(e[0]){case 1:return n.AccessListEIP2930Transaction.fromSerializedTx(e,t);case 2:return a.FeeMarketEIP1559Transaction.fromSerializedTx(e,t);default:throw new Error(`TypedTransaction with ID ${e[0]} unknown`)}}static fromBlockBodyData(e,i={}){if(t.isBuffer(e))return this.fromSerializedData(e,i);if(Array.isArray(e))return o.Transaction.fromValuesArray(e,i);throw new Error("Cannot decode transaction: unknown type input")}static async fromEthersProvider(e,t,i){const a=(0,r.getProvider)(e),n=await(0,r.fetchFromProvider)(a,{method:"eth_getTransactionByHash",params:[t]});if(null===n)throw new Error("No data returned from provider");return l.fromRPCTx(n,i)}static async fromRPCTx(e,t={}){return l.fromTxData((0,s.normalizeTxParams)(e),t)}}i.TransactionFactory=l}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/transactionFactory.js"}],[1875,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){function r(e){if(0===e.length)return!0;const t=e[0];return!!Array.isArray(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.isAccessList=i.isAccessListBuffer=i.Capability=void 0,function(e){e[e.EIP155ReplayProtection=155]="EIP155ReplayProtection",e[e.EIP1559FeeMarket=1559]="EIP1559FeeMarket",e[e.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",e[e.EIP2930AccessLists=2930]="EIP2930AccessLists"}(i.Capability||(i.Capability={})),i.isAccessListBuffer=r,i.isAccessList=function(e){return!r(e)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/types.js"}],[1876,{"./types":1875,"@ethereumjs/util":1884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AccessLists=i.checkMaxInitCodeSize=void 0;const r=e("@ethereumjs/util"),a=e("./types");i.checkMaxInitCodeSize=function(e,t){const i=e.param("vm","maxInitCodeSize");if(i&&BigInt(t)>i)throw new Error(`the initcode size of this transaction is too large: it is ${t} while the max is ${e.param("vm","maxInitCodeSize")}`)};i.AccessLists=class{static getAccessListData(e){let t,i;if((0,a.isAccessList)(e)){t=e;const a=[];for(let t=0;t<e.length;t++){const i=e[t],n=(0,r.toBuffer)(i.address),s=[];for(let e=0;e<i.storageKeys.length;e++)s.push((0,r.toBuffer)(i.storageKeys[e]));a.push([n,s])}i=a}else{i=e??[];const a=[];for(let e=0;e<i.length;e++){const t=i[e],n=(0,r.bufferToHex)(t[0]),s=[];for(let e=0;e<t[1].length;e++)s.push((0,r.bufferToHex)(t[1][e]));const o={address:n,storageKeys:s};a.push(o)}t=a}return{AccessListJSON:t,accessList:i}}static verifyAccessList(e){for(let t=0;t<e.length;t++){const i=e[t],r=i[0],a=i[1];if(i[2]!==undefined)throw new Error("Access list item cannot have 3 elements. It can only have an address, and an array of storage slots.");if(20!==r.length)throw new Error("Invalid EIP-2930 transaction: address length should be 20 bytes");for(let e=0;e<a.length;e++)if(32!==a[e].length)throw new Error("Invalid EIP-2930 transaction: storage slot length should be 32 bytes")}}static getAccessListJSON(e){const t=[];for(let i=0;i<e.length;i++){const a=e[i],n={address:"0x"+(0,r.setLengthLeft)(a[0],20).toString("hex"),storageKeys:[]},s=a[1];for(let e=0;e<s.length;e++){const t=s[e];n.storageKeys.push("0x"+(0,r.setLengthLeft)(t,32).toString("hex"))}t.push(n)}return t}static getDataFeeEIP2930(e,t){const i=t.param("gasPrices","accessListStorageKeyCost"),r=t.param("gasPrices","accessListAddressCost");let a=0;for(let t=0;t<e.length;t++){a+=e[t][1].length}return e.length*Number(r)+a*Number(i)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/util.js"}],[1877,{"./bytes":1880,"./constants":1881,"./helpers":1883,"./internal":1885,"@ethereumjs/rlp":424,buffer:2983,"ethereum-cryptography/keccak":3208,"ethereum-cryptography/secp256k1":3225,"ethereum-cryptography/utils":3227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.accountBodyToRLP=i.accountBodyToSlim=i.accountBodyFromSlim=i.isZeroAddress=i.zeroAddress=i.importPublic=i.privateToAddress=i.privateToPublic=i.publicToAddress=i.pubToAddress=i.isValidPublic=i.isValidPrivate=i.generateAddress2=i.generateAddress=i.isValidChecksumAddress=i.toChecksumAddress=i.isValidAddress=i.Account=void 0;const r=e("@ethereumjs/rlp"),a=e("ethereum-cryptography/keccak"),n=e("ethereum-cryptography/secp256k1"),s=e("ethereum-cryptography/utils"),o=e("./bytes"),l=e("./constants"),c=e("./helpers"),d=e("./internal"),u=BigInt(0);class h{constructor(e=u,t=u,i=l.KECCAK256_RLP,r=l.KECCAK256_NULL){this.nonce=e,this.balance=t,this.storageRoot=i,this.codeHash=r,this._validate()}static fromAccountData(e){const{nonce:t,balance:i,storageRoot:r,codeHash:a}=e;return new h(t!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(t)):undefined,i!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(i)):undefined,r!==undefined?(0,o.toBuffer)(r):undefined,a!==undefined?(0,o.toBuffer)(a):undefined)}static fromRlpSerializedAccount(e){const t=(0,o.arrToBufArr)(r.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)}static fromValuesArray(e){const[t,i,r,a]=e;return new h((0,o.bufferToBigInt)(t),(0,o.bufferToBigInt)(i),r,a)}_validate(){if(this.nonce<u)throw new Error("nonce must be greater than zero");if(this.balance<u)throw new Error("balance must be greater than zero");if(32!==this.storageRoot.length)throw new Error("storageRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")}raw(){return[(0,o.bigIntToUnpaddedBuffer)(this.nonce),(0,o.bigIntToUnpaddedBuffer)(this.balance),this.storageRoot,this.codeHash]}serialize(){return t.from(r.RLP.encode((0,o.bufArrToArr)(this.raw())))}isContract(){return!this.codeHash.equals(l.KECCAK256_NULL)}isEmpty(){return this.balance===u&&this.nonce===u&&this.codeHash.equals(l.KECCAK256_NULL)}}i.Account=h;i.isValidAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};i.toChecksumAddress=function(e,i){(0,c.assertIsHexString)(e);const r=(0,d.stripHexPrefix)(e).toLowerCase();let n="";if(i!==undefined){n=(0,o.bufferToBigInt)((0,o.toBuffer)(i)).toString()+"0x"}const l=t.from(n+r,"utf8"),u=(0,s.bytesToHex)((0,a.keccak256)(l));let h="0x";for(let e=0;e<r.length;e++)parseInt(u[e],16)>=8?h+=r[e].toUpperCase():h+=r[e];return h};i.isValidChecksumAddress=function(e,t){return(0,i.isValidAddress)(e)&&(0,i.toChecksumAddress)(e,t)===e};i.generateAddress=function(e,i){return(0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(i),(0,o.bufferToBigInt)(i)===BigInt(0)?t.from((0,a.keccak256)(r.RLP.encode((0,o.bufArrToArr)([e,null])))).slice(-20):t.from((0,a.keccak256)(r.RLP.encode((0,o.bufArrToArr)([e,i])))).slice(-20)};i.generateAddress2=function(e,i,r){if((0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(i),(0,c.assertIsBuffer)(r),20!==e.length)throw new Error("Expected from to be of length 20");if(32!==i.length)throw new Error("Expected salt to be of length 32");const n=(0,a.keccak256)(t.concat([t.from("ff","hex"),e,i,(0,a.keccak256)(r)]));return(0,o.toBuffer)(n).slice(-20)};i.isValidPrivate=function(e){return n.secp256k1.utils.isValidPrivateKey(e)};i.isValidPublic=function(e,i=!1){if((0,c.assertIsBuffer)(e),64===e.length)try{return n.secp256k1.ProjectivePoint.fromHex(t.concat([t.from([4]),e])),!0}catch(e){return!1}if(!i)return!1;try{return n.secp256k1.ProjectivePoint.fromHex(e),!0}catch(e){return!1}};i.pubToAddress=function(e,i=!1){if((0,c.assertIsBuffer)(e),i&&64!==e.length&&(e=t.from(n.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),64!==e.length)throw new Error("Expected pubKey to be of length 64");return t.from((0,a.keccak256)(e)).slice(-20)},i.publicToAddress=i.pubToAddress;i.privateToPublic=function(e){return(0,c.assertIsBuffer)(e),t.from(n.secp256k1.ProjectivePoint.fromPrivateKey(e).toRawBytes(!1).slice(1))};i.privateToAddress=function(e){return(0,i.publicToAddress)((0,i.privateToPublic)(e))};i.importPublic=function(e){return(0,c.assertIsBuffer)(e),64!==e.length&&(e=t.from(n.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),e};i.zeroAddress=function(){const e=(0,o.zeros)(20);return(0,o.bufferToHex)(e)};function p(e){const[t,i,r,a]=e;return[t,i,0===(0,o.arrToBufArr)(r).length?l.KECCAK256_RLP:r,0===(0,o.arrToBufArr)(a).length?l.KECCAK256_NULL:a]}i.isZeroAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return(0,i.zeroAddress)()===e},i.accountBodyFromSlim=p;const m=new Uint8Array(0);i.accountBodyToSlim=function(e){const[t,i,r,a]=e;return[t,i,(0,o.arrToBufArr)(r).equals(l.KECCAK256_RLP)?m:r,(0,o.arrToBufArr)(a).equals(l.KECCAK256_NULL)?m:a]},i.accountBodyToRLP=function(e,t=!0){const i=t?p(e):e;return(0,o.arrToBufArr)(r.RLP.encode(i))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/account.js"}],[1878,{"./account":1877,"./bytes":1880,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.Address=void 0;const r=e("./account"),a=e("./bytes");class n{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new n((0,a.zeros)(20))}static fromString(e){if(!(0,r.isValidAddress)(e))throw new Error("Invalid address");return new n((0,a.toBuffer)(e))}static fromPublicKey(e){if(!t.isBuffer(e))throw new Error("Public key should be Buffer");const i=(0,r.pubToAddress)(e);return new n(i)}static fromPrivateKey(e){if(!t.isBuffer(e))throw new Error("Private key should be Buffer");const i=(0,r.privateToAddress)(e);return new n(i)}static generate(e,t){if("bigint"!=typeof t)throw new Error("Expected nonce to be a bigint");return new n((0,r.generateAddress)(e.buf,(0,a.bigIntToBuffer)(t)))}static generate2(e,i,a){if(!t.isBuffer(i))throw new Error("Expected salt to be a Buffer");if(!t.isBuffer(a))throw new Error("Expected initCode to be a Buffer");return new n((0,r.generateAddress2)(e.buf,i,a))}equals(e){return this.buf.equals(e.buf)}isZero(){return this.equals(n.zero())}isPrecompileOrSystemAddress(){const e=(0,a.bufferToBigInt)(this.buf),t=BigInt(0),i=BigInt("0xffff");return e>=t&&e<=i}toString(){return"0x"+this.buf.toString("hex")}toBuffer(){return t.from(this.buf)}}i.Address=n}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/address.js"}],[1879,{events:3276},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AsyncEventEmitter=void 0;const r=e("events");class a extends r.EventEmitter{emit(e,...t){let[i,r]=t;const a=this;let n=a._events[e]??[];return r===undefined&&"function"==typeof i&&(r=i,i=undefined),"newListener"!==e&&"removeListener"!==e||(i={event:i,fn:r},r=undefined),n=Array.isArray(n)?n:[n],async function(e,t,i){let r;for await(const a of t)try{a.length<2?a.call(e,i):await new Promise(((t,r)=>{a.call(e,i,(e=>{e?r(e):t()}))}))}catch(e){r=e}if(r)throw r}(a,n.slice(),i).then(r).catch(r),a.listenerCount(e)>0}once(e,t){const i=this;let r;if("function"!=typeof t)throw new TypeError("listener must be a function");return r=t.length>=2?function(a,n){i.removeListener(e,r),t(a,n)}:function(a){i.removeListener(e,r),t(a,r)},i.on(e,r),i}first(e,t){let i=this._events[e]??[];if("function"!=typeof t)throw new TypeError("listener must be a function");return Array.isArray(i)||(this._events[e]=i=[i]),i.unshift(t),this}before(e,t,i){return this.beforeOrAfter(e,t,i)}after(e,t,i){return this.beforeOrAfter(e,t,i,"after")}beforeOrAfter(e,t,i,r){let a,n,s=this._events[e]??[];const o="after"===r?1:0;if("function"!=typeof i)throw new TypeError("listener must be a function");if("function"!=typeof t)throw new TypeError("target must be a function");for(Array.isArray(s)||(this._events[e]=s=[s]),n=s.length,a=s.length;a--;)if(s[a]===t){n=a+o;break}return s.splice(n,0,i),this}on(e,t){return super.on(e,t)}addListener(e,t){return super.addListener(e,t)}prependListener(e,t){return super.prependListener(e,t)}prependOnceListener(e,t){return super.prependOnceListener(e,t)}removeAllListeners(e){return super.removeAllListeners(e)}removeListener(e,t){return super.removeListener(e,t)}eventNames(){return super.eventNames()}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}getMaxListeners(){return super.getMaxListeners()}setMaxListeners(e){return super.setMaxListeners(e)}}i.AsyncEventEmitter=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/asyncEventEmitter.js"}],[188,{"@metamask/permission-controller":1579,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("@metamask/permission-controller"),a=e("lodash");i.default={version:69,async migrate(e){const t=(0,a.cloneDeep)(e);t.meta.version=69;const i=function(e){var t;if("object"==typeof(null==e||null===(t=e.SubjectMetadataController)||void 0===t?void 0:t.subjectMetadata)){const{SubjectMetadataController:{subjectMetadata:t}}=e;Object.values(t).forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(e.subjectType=e.extensionId?r.SubjectType.Extension:r.SubjectType.Website)}))}return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/069.js"}],[1880,{"./helpers":1883,"./internal":1885,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.intToUnpaddedBuffer=i.bigIntToUnpaddedBuffer=i.bigIntToHex=i.bufArrToArr=i.arrToBufArr=i.validateNoLeadingZeroes=i.baToJSON=i.toUtf8=i.short=i.addHexPrefix=i.toUnsigned=i.fromSigned=i.bufferToInt=i.bigIntToBuffer=i.bufferToBigInt=i.bufferToHex=i.toBuffer=i.unpadHexString=i.unpadArray=i.unpadBuffer=i.setLengthRight=i.setLengthLeft=i.zeros=i.intToBuffer=i.intToHex=void 0;const r=e("./helpers"),a=e("./internal");i.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};i.intToBuffer=function(e){const r=(0,i.intToHex)(e);return t.from((0,a.padToEven)(r.slice(2)),"hex")};i.zeros=function(e){return t.allocUnsafe(e).fill(0)};const n=function(e,t,r){const a=(0,i.zeros)(t);return r?e.length<t?(e.copy(a),a):e.slice(0,t):e.length<t?(e.copy(a,t-e.length),a):e.slice(-t)};i.setLengthLeft=function(e,t){return(0,r.assertIsBuffer)(e),n(e,t,!1)};i.setLengthRight=function(e,t){return(0,r.assertIsBuffer)(e),n(e,t,!0)};const s=function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e};i.unpadBuffer=function(e){return(0,r.assertIsBuffer)(e),s(e)};i.unpadArray=function(e){return(0,r.assertIsArray)(e),s(e)};i.unpadHexString=function(e){return(0,r.assertIsHexString)(e),e=(0,a.stripHexPrefix)(e),"0x"+s(e)};i.toBuffer=function(e){if(null===e||e===undefined)return t.allocUnsafe(0);if(t.isBuffer(e))return t.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return t.from(e);if("string"==typeof e){if(!(0,a.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return t.from((0,a.padToEven)((0,a.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,i.intToBuffer)(e);if("bigint"==typeof e){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let i=e.toString(16);return i.length%2&&(i="0"+i),t.from(i,"hex")}if(e.toArray)return t.from(e.toArray());if(e.toBuffer)return t.from(e.toBuffer());throw new Error("invalid type")};function o(e){const t=(0,i.bufferToHex)(e);return"0x"===t?BigInt(0):BigInt(t)}function l(e){return(0,i.toBuffer)("0x"+e.toString(16))}i.bufferToHex=function(e){return"0x"+(e=(0,i.toBuffer)(e)).toString("hex")},i.bufferToBigInt=o,i.bigIntToBuffer=l;i.bufferToInt=function(e){const t=Number(o(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};i.fromSigned=function(e){return BigInt.asIntN(256,o(e))};i.toUnsigned=function(e){return l(BigInt.asUintN(256,e))};i.addHexPrefix=function(e){return"string"!=typeof e||(0,a.isHexPrefixed)(e)?e:"0x"+e},i.short=function(e,i=50){const r=t.isBuffer(e)?e.toString("hex"):e;return r.length<=i?r:r.slice(0,i)+""};i.toUtf8=function(e){if((e=(0,a.stripHexPrefix)(e)).length%2!=0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return t.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};i.baToJSON=function(e){if(t.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){const t=[];for(let r=0;r<e.length;r++)t.push((0,i.baToJSON)(e[r]));return t}};i.validateNoLeadingZeroes=function(e){for(const[t,i]of Object.entries(e))if(i!==undefined&&i.length>0&&0===i[0])throw new Error(`${t} cannot have leading zeroes, received: ${i.toString("hex")}`)},i.arrToBufArr=function e(i){return Array.isArray(i)?i.map((t=>e(t))):t.from(i)},i.bufArrToArr=function e(t){return Array.isArray(t)?t.map((t=>e(t))):Uint8Array.from(t??[])};i.bigIntToHex=e=>"0x"+e.toString(16),i.bigIntToUnpaddedBuffer=function(e){return(0,i.unpadBuffer)(l(e))},i.intToUnpaddedBuffer=function(e){return(0,i.unpadBuffer)((0,i.intToBuffer)(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/bytes.js"}],[1881,{buffer:2983,"ethereum-cryptography/secp256k1":3225},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MAX_WITHDRAWALS_PER_PAYLOAD=i.RLP_EMPTY_STRING=i.KECCAK256_RLP=i.KECCAK256_RLP_S=i.KECCAK256_RLP_ARRAY=i.KECCAK256_RLP_ARRAY_S=i.KECCAK256_NULL=i.KECCAK256_NULL_S=i.TWO_POW256=i.SECP256K1_ORDER_DIV_2=i.SECP256K1_ORDER=i.MAX_INTEGER_BIGINT=i.MAX_INTEGER=i.MAX_UINT64=void 0;const r=e("buffer"),a=e("ethereum-cryptography/secp256k1");i.MAX_UINT64=BigInt("0xffffffffffffffff"),i.MAX_INTEGER=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),i.MAX_INTEGER_BIGINT=BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),i.SECP256K1_ORDER=a.secp256k1.CURVE.n,i.SECP256K1_ORDER_DIV_2=a.secp256k1.CURVE.n/BigInt(2),i.TWO_POW256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),i.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",i.KECCAK256_NULL=r.Buffer.from(i.KECCAK256_NULL_S,"hex"),i.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",i.KECCAK256_RLP_ARRAY=r.Buffer.from(i.KECCAK256_RLP_ARRAY_S,"hex"),i.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",i.KECCAK256_RLP=r.Buffer.from(i.KECCAK256_RLP_S,"hex"),i.RLP_EMPTY_STRING=r.Buffer.from([128]),i.MAX_WITHDRAWALS_PER_PAYLOAD=16}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/constants.js"}],[1882,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.compactBytesToNibbles=i.bytesToNibbles=i.nibblesToCompactBytes=i.nibblesToBytes=i.hasTerminator=void 0;i.hasTerminator=e=>e.length>0&&16===e[e.length-1];i.nibblesToBytes=(e,t)=>{for(let i=0,r=0;r<e.length;i+=1,r+=2)t[i]=e[r]<<4|e[r+1]};i.nibblesToCompactBytes=e=>{let t=0;(0,i.hasTerminator)(e)&&(t=1,e=e.subarray(0,e.length-1));const r=new Uint8Array(e.length/2+1);return r[0]=t<<5,1&~e.length||(r[0]|=16,r[0]|=e[0],e=e.subarray(1)),(0,i.nibblesToBytes)(e,r.subarray(1)),r};i.bytesToNibbles=e=>{const t=2*e.length+1,i=new Uint8Array(t);for(let t=0;t<e.length;t++){const r=e[t];i[2*t]=r/16,i[2*t+1]=r%16}return i[t-1]=16,i};i.compactBytesToNibbles=e=>{if(0===e.length)return e;let t=(0,i.bytesToNibbles)(e);t[0]<2&&(t=t.subarray(0,t.length-1));const r=2-(1&t[0]);return t.subarray(r)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/encoding.js"}],[1883,{"../../../../../../../../../is-buffer/index.js":3595,"./internal":1885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.assertIsString=i.assertIsArray=i.assertIsBuffer=i.assertIsHexString=void 0;const r=e("./internal");i.assertIsHexString=function(e){if(!(0,r.isHexString)(e)){throw new Error(`This method only supports 0x-prefixed hex strings but input was: ${e}`)}};i.assertIsBuffer=function(e){if(!t.isBuffer(e)){throw new Error(`This method only supports Buffer but input was: ${e}`)}};i.assertIsArray=function(e){if(!Array.isArray(e)){throw new Error(`This method only supports number arrays but input was: ${e}`)}};i.assertIsString=function(e){if("string"!=typeof e){throw new Error(`This method only supports strings but input was: ${e}`)}}}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/helpers.js"}],[1884,{"./account":1877,"./address":1878,"./asyncEventEmitter":1879,"./bytes":1880,"./constants":1881,"./encoding":1882,"./internal":1885,"./lock":1886,"./provider":1887,"./signature":1888,"./types":1889,"./units":1890,"./withdrawal":1891},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){r===undefined&&(r=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,a)}:function(e,t,i,r){r===undefined&&(r=i),e[r]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),i.toAscii=i.stripHexPrefix=i.padToEven=i.isHexString=i.isHexPrefixed=i.getKeys=i.getBinarySize=i.fromUtf8=i.fromAscii=i.arrayContainsArray=void 0,a(e("./constants"),i),a(e("./units"),i),a(e("./account"),i),a(e("./address"),i),a(e("./withdrawal"),i),a(e("./signature"),i),a(e("./bytes"),i),a(e("./types"),i),a(e("./encoding"),i),a(e("./asyncEventEmitter"),i);var n=e("./internal");Object.defineProperty(i,"arrayContainsArray",{enumerable:!0,get:function(){return n.arrayContainsArray}}),Object.defineProperty(i,"fromAscii",{enumerable:!0,get:function(){return n.fromAscii}}),Object.defineProperty(i,"fromUtf8",{enumerable:!0,get:function(){return n.fromUtf8}}),Object.defineProperty(i,"getBinarySize",{enumerable:!0,get:function(){return n.getBinarySize}}),Object.defineProperty(i,"getKeys",{enumerable:!0,get:function(){return n.getKeys}}),Object.defineProperty(i,"isHexPrefixed",{enumerable:!0,get:function(){return n.isHexPrefixed}}),Object.defineProperty(i,"isHexString",{enumerable:!0,get:function(){return n.isHexString}}),Object.defineProperty(i,"padToEven",{enumerable:!0,get:function(){return n.padToEven}}),Object.defineProperty(i,"stripHexPrefix",{enumerable:!0,get:function(){return n.stripHexPrefix}}),Object.defineProperty(i,"toAscii",{enumerable:!0,get:function(){return n.toAscii}}),a(e("./lock"),i),a(e("./provider"),i)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/index.js"}],[1885,{buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(e){(function(){function t(e){if("string"!=typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type "+typeof e);return"0"===e[0]&&"x"===e[1]}Object.defineProperty(i,"__esModule",{value:!0}),i.isHexString=i.getKeys=i.fromAscii=i.fromUtf8=i.toAscii=i.arrayContainsArray=i.getBinarySize=i.padToEven=i.stripHexPrefix=i.isHexPrefixed=void 0,i.isHexPrefixed=t;function r(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}i.stripHexPrefix=e=>{if("string"!=typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received "+typeof e);return t(e)?e.slice(2):e},i.padToEven=r,i.getBinarySize=function(t){if("string"!=typeof t)throw new Error("[getBinarySize] method requires input type 'string', received "+typeof t);return e.byteLength(t,"utf8")},i.arrayContainsArray=function(e,t,i){if(!0!==Array.isArray(e))throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(!0!==Array.isArray(t))throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[!0===i?"some":"every"]((t=>e.indexOf(t)>=0))},i.toAscii=function(e){let t="",i=0;const r=e.length;for("0x"===e.substring(0,2)&&(i=2);i<r;i+=2){const r=parseInt(e.substr(i,2),16);t+=String.fromCharCode(r)}return t},i.fromUtf8=function(t){return`0x${r(e.from(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")}`},i.fromAscii=function(e){let t="";for(let i=0;i<e.length;i++){const r=e.charCodeAt(i).toString(16);t+=r.length<2?`0${r}`:r}return`0x${t}`},i.getKeys=function(e,t,i){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got "+typeof e);if("string"!=typeof t)throw new Error("[getKeys] method expects input 'key' to be type 'string', got "+typeof e);const r=[];for(let a=0;a<e.length;a++){let n=e[a][t];if(!0!==i||n){if("string"!=typeof n)throw new Error("invalid abi - expected type 'string', received "+typeof n)}else n="";r.push(n)}return r},i.isHexString=function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!(void 0!==t&&t>0&&e.length!==2+2*t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/internal.js"}],[1886,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Lock=void 0;i.Lock=class{constructor(){this.permits=1,this.promiseResolverQueue=[]}async acquire(){return this.permits>0?(this.permits-=1,Promise.resolve(!0)):new Promise((e=>this.promiseResolverQueue.push(e)))}release(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)console.warn("Lock.permits should never be > 0 when there is someone waiting.");else if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;const e=this.promiseResolverQueue.shift();e&&e(!0)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/lock.js"}],[1887,{"micro-ftch":3826},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getProvider=i.fetchFromProvider=void 0;const r=e("micro-ftch");i.fetchFromProvider=async(e,t)=>(await(0,r.default)(e,{headers:{"content-type":"application/json"},type:"json",data:{method:t.method,params:t.params,jsonrpc:"2.0",id:1}})).result;i.getProvider=e=>{if("string"==typeof e)return e;if(e?.connection?.url!==undefined)return e.connection.url;throw new Error("Must provide valid provider URL or Web3Provider")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/provider.js"}],[1888,{"./bytes":1880,"./constants":1881,"./helpers":1883,buffer:2983,"ethereum-cryptography/keccak":3208,"ethereum-cryptography/secp256k1":3225},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.hashPersonalMessage=i.isValidSignature=i.fromRpcSig=i.toCompactSig=i.toRpcSig=i.ecrecover=i.ecsign=void 0;const r=e("ethereum-cryptography/keccak"),a=e("ethereum-cryptography/secp256k1"),n=e("./bytes"),s=e("./constants"),o=e("./helpers");function l(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function c(e){return e===BigInt(0)||e===BigInt(1)}i.ecsign=function(e,i,r){const n=a.secp256k1.sign(e,i),s=n.toCompactRawBytes();return{r:t.from(s.slice(0,32)),s:t.from(s.slice(32,64)),v:r===undefined?BigInt(n.recovery+27):BigInt(n.recovery+35)+BigInt(r)*BigInt(2)}};i.ecrecover=function(e,i,r,s,o){const d=t.concat([(0,n.setLengthLeft)(r,32),(0,n.setLengthLeft)(s,32)],64),u=l(i,o);if(!c(u))throw new Error("Invalid signature v value");const h=a.secp256k1.Signature.fromCompact(d).addRecoveryBit(Number(u)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};i.toRpcSig=function(e,i,r,a){if(!c(l(e,a)))throw new Error("Invalid signature v value");return(0,n.bufferToHex)(t.concat([(0,n.setLengthLeft)(i,32),(0,n.setLengthLeft)(r,32),(0,n.toBuffer)(e)]))};i.toCompactSig=function(e,i,r,a){if(!c(l(e,a)))throw new Error("Invalid signature v value");let s=r;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(s=t.from(r),s[0]|=128),(0,n.bufferToHex)(t.concat([(0,n.setLengthLeft)(i,32),(0,n.setLengthLeft)(s,32)]))};i.fromRpcSig=function(e){const t=(0,n.toBuffer)(e);let i,r,a;if(t.length>=65)i=t.slice(0,32),r=t.slice(32,64),a=(0,n.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");i=t.slice(0,32),r=t.slice(32,64),a=BigInt((0,n.bufferToInt)(t.slice(32,33))>>7),r[0]&=127}return a<27&&(a+=BigInt(27)),{v:a,r:i,s:r}};i.isValidSignature=function(e,t,i,r=!0,a){if(32!==t.length||32!==i.length)return!1;if(!c(l(e,a)))return!1;const o=(0,n.bufferToBigInt)(t),d=(0,n.bufferToBigInt)(i);return!(o===BigInt(0)||o>=s.SECP256K1_ORDER||d===BigInt(0)||d>=s.SECP256K1_ORDER)&&!(r&&d>=s.SECP256K1_ORDER_DIV_2)};i.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const i=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,r.keccak256)(t.concat([i,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/signature.js"}],[1889,{"./bytes":1880,"./internal":1885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.toType=i.TypeOutput=void 0;const r=e("./bytes"),a=e("./internal");var n;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(n=i.TypeOutput||(i.TypeOutput={})),i.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,a.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const i=(0,r.toBuffer)(e);switch(t){case n.Buffer:return i;case n.BigInt:return(0,r.bufferToBigInt)(i);case n.Number:{const e=(0,r.bufferToBigInt)(i);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case n.PrefixedHexString:return(0,r.bufferToHex)(i);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/types.js"}],[189,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:70,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=70;const i=function(e){var t;if(Array.isArray(null==e||null===(t=e.PermissionLogController)||void 0===t?void 0:t.permissionActivityLog)){const{PermissionLogController:{permissionActivityLog:t}}=e;t.forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(delete e.request,delete e.response)}))}return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/070.js"}],[1890,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.GWEI_TO_WEI=void 0,i.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/units.js"}],[1891,{"./address":1878,"./bytes":1880,"./types":1889,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.Withdrawal=void 0;const r=e("./address"),a=e("./bytes"),n=e("./types");class s{constructor(e,t,i,r){this.index=e,this.validatorIndex=t,this.address=i,this.amount=r}static fromWithdrawalData(e){const{index:t,validatorIndex:i,address:a,amount:o}=e,l=(0,n.toType)(t,n.TypeOutput.BigInt),c=(0,n.toType)(i,n.TypeOutput.BigInt),d=new r.Address((0,n.toType)(a,n.TypeOutput.Buffer)),u=(0,n.toType)(o,n.TypeOutput.BigInt);return new s(l,c,d,u)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,i,r,a]=e;return s.fromWithdrawalData({index:t,validatorIndex:i,address:r,amount:a})}static toBufferArray(e){const{index:i,validatorIndex:a,address:s,amount:o}=e,l=(0,n.toType)(i,n.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,n.toType)(i,n.TypeOutput.Buffer),c=(0,n.toType)(a,n.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,n.toType)(a,n.TypeOutput.Buffer);let d;d=s instanceof r.Address?s.buf:(0,n.toType)(s,n.TypeOutput.Buffer);return[l,c,d,(0,n.toType)(o,n.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,n.toType)(o,n.TypeOutput.Buffer)]}raw(){return s.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,a.bigIntToHex)(this.index),validatorIndex:(0,a.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,a.bigIntToHex)(this.amount)}}}i.Withdrawal=s}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1892,{"./chunk-UJFCPTF3.js":1894,"./chunk-Z4BLTVTB.js":1895},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,i.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,r,new Map),l.__privateAdd.call(void 0,this,a,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,r).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,r).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,r).delete(e)}clearActions(){l.__privateGet.call(void 0,this,r).clear()}call(e,...t){const i=l.__privateGet.call(void 0,this,r).get(e);if(!i)throw new Error(`A handler for ${e} has not been registered`);return i(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,n).set(e,t)}publish(e,...t){const i=l.__privateGet.call(void 0,this,a).get(e);if(i)for(const[e,r]of i.entries())try{if(r){const i=l.__privateGet.call(void 0,this,s).get(e),a=r(...t);a!==i&&(l.__privateGet.call(void 0,this,s).set(e,a),e(a,i))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,i){let r=l.__privateGet.call(void 0,this,a).get(e);if(r||(r=new Map,l.__privateGet.call(void 0,this,a).set(e,r)),r.set(t,i),i){const r=l.__privateGet.call(void 0,this,n).get(e);if(r){const e=i(...r());l.__privateGet.call(void 0,this,s).set(t,e)}}}unsubscribe(e,t){const i=l.__privateGet.call(void 0,this,a).get(e);if(!i||!i.has(t))throw new Error(`Subscription not found for event: ${e}`);i.get(t)&&l.__privateGet.call(void 0,this,s).delete(t),i.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,a).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,a).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:i}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:i})}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1893,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,i=!0){if(i){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const i=e[t];this.internalConfig[t]=i,this[t]=i}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},a=r;i.BaseControllerV1=r,i.BaseControllerV1_default=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1894,{"./chunk-Z4BLTVTB.js":1895},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,s);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,n);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,a)}:`)},i.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:i,allowedEvents:l}){p.__privateAdd.call(void 0,this,o),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,r,void 0),p.__privateAdd.call(void 0,this,a,void 0),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateSet.call(void 0,this,r,e),p.__privateSet.call(void 0,this,a,t),p.__privateSet.call(void 0,this,n,i),p.__privateSet.call(void 0,this,s,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,r).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).publish(e,...t)}subscribe(e,t,i){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return i?p.__privateGet.call(void 0,this,r).subscribe(e,t,i):p.__privateGet.call(void 0,this,r).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,r).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).clearEventSubscriptions(e)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1895,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1896,{"./chunk-Z4BLTVTB.js":1895,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-Z4BLTVTB.js"),n=e("immer");n.enablePatches.call(void 0);function s(e,t,i){return Object.keys(e).reduce(((r,a)=>{try{const n=t[a];if(!n)throw new Error(`No metadata found for '${String(a)}'`);const s=n[i],o=e[a];return"function"==typeof s?r[a]=s(o):s&&(r[a]=o),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}r=new WeakMap,i.BaseController=class{constructor({messenger:e,metadata:t,name:i,state:s}){a.__privateAdd.call(void 0,this,r,void 0),this.messagingSystem=e,this.name=i,a.__privateSet.call(void 0,this,r,n.freeze.call(void 0,s,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${i}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${i}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return a.__privateGet.call(void 0,this,r)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,i,s]=n.produceWithPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);return a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,i),{nextState:t,patches:i,inversePatches:s}}applyPatches(e){const t=n.applyPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},i.getAnonymizedState=function(e,t){return s(e,t,"anonymous")},i.getPersistentState=function(e,t){return s(e,t,"persist")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1897,{"./chunk-G42723LG.js":1892,"./chunk-NINOM2XQ.js":1893,"./chunk-UJFCPTF3.js":1894,"./chunk-Z4BLTVTB.js":1895,"./chunk-ZNOPSWMU.js":1896},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-NINOM2XQ.js"),a=e("./chunk-ZNOPSWMU.js"),n=e("./chunk-G42723LG.js"),s=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),i.BaseController=a.BaseController,i.BaseControllerV1=r.BaseControllerV1,i.ControllerMessenger=n.ControllerMessenger,i.RestrictedControllerMessenger=s.RestrictedControllerMessenger,i.getAnonymizedState=a.getAnonymizedState,i.getPersistentState=a.getPersistentState}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1898,{"./chunk-RKVNLW2C.js":1902,"@ethereumjs/util":1884,"@metamask/ethjs-unit":1336,"@metamask/utils":2255,"bn.js":2935,buffer:2983,"eth-ens-namehash":3173,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a=e("./chunk-RKVNLW2C.js"),n=e("@ethereumjs/util"),s=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=r(e("bn.js")),c=r(e("eth-ens-namehash")),d=r(e("fast-deep-equal")),u=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function m(e,t){const i=await fetch(e,t);if(!i.ok)throw new Error(`Fetch failed with status '${i.status}' for request '${String(e)}'`);return i}async function f(e,t){const i=await m(e,t);return await i.json()}i.PROTOTYPE_POLLUTION_BLOCKLIST=h,i.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},i.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=a.MAX_SAFE_CHAIN_ID},i.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},i.fractionBN=function(e,t,i){const r=new(0,l.default)(t),a=new(0,l.default)(i);return e.mul(r).div(a)},i.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),i=t[0]||"0";let r=t[1]||"";if(!r)return s.toWei.call(void 0,i,"gwei");if(r.length<=9)return s.toWei.call(void 0,`${i}.${r}`,"gwei");const a=r.slice(9)[0];r=r.slice(0,9);let n=s.toWei.call(void 0,`${i}.${r}`,"gwei");return Number(a)>=5&&(n=n.add(new(0,l.default)(1))),n},i.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return s.fromWei.call(void 0,t,"gwei")},i.getBuyURL=function(e="1",t,i=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${i}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},i.hexToBN=p,i.hexToText=function(e){try{const i=o.remove0x.call(void 0,e);return t.from(i,"hex").toString("utf8")}catch(t){return e}},i.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(p(e).toString(10))},i.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},i.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},i.safelyExecuteWithTimeout=async function(e,t=!1,i=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])}catch(e){return void(t&&console.error(e))}},i.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?n.toChecksumAddress.call(void 0,t):t},i.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const i=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,i)&&n.isValidAddress.call(void 0,i)},i.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},i.successfulFetch=m,i.handleFetch=f,i.fetchWithErrorHandling=async function({url:e,options:t,timeout:i,errorCodesToCatch:r}){let a;try{a=i?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==u)throw e;console.error(e)}(e,r)}return a},i.timeoutFetch=async function(e,t,i=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])},i.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},i.query=function(e,t,i=[]){return new Promise(((r,a)=>{const n=(e,t)=>{e?a(e):r(t)};t in e&&"function"==typeof e[t]?e[t](...i,n):e.sendAsync({method:t,params:i},n)}))},i.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,i.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},i.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},i.isValidJson=function(e){try{return d.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-7C4YHS6A.js"}],[1899,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=r.createProjectLogger.call(void 0,"controller-utils");i.createModuleLogger=r.createModuleLogger,i.projectLogger=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[19,{"../constants/notification-schema":16,"./process-feature-announcement":18,"./process-onchain-notifications":20},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.processNotification=function(e,t=[]){if(o(e)){const i=(0,n.processFeatureAnnouncement)(e);return i.isRead=(0,n.isFeatureAnnouncementRead)(i,t),i}if(s(e))return(0,a.processOnChainNotification)(e);return(t=>{throw new Error(`No processor found for notification kind ${e.type}`)})()};var r=e("../constants/notification-schema"),a=e("./process-onchain-notifications"),n=e("./process-feature-announcement");const s=e=>Object.values(r.TRIGGER_TYPES).includes(e.type),o=e=>e.type===r.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/processors/process-notifications.ts"}],[190,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:71,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=71;const i=function(e){e.NotificationController&&(e.AnnouncementController={announcements:e.NotificationController.notifications},delete e.NotificationController);return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/071.js"}],[1900,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},a={...r,rpc:"rpc"};var n=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(n||{}),s={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});i.InfuraNetworkType=r,i.NetworkType=a,i.isNetworkType=function(e){return Object.values(a).includes(e)},i.isInfuraNetworkType=function(e){return Object.keys(r).includes(e)},i.BuiltInNetworkName=n,i.ChainId=s,i.NetworksTicker=o}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1901,{"./chunk-DBJSLKNR.js":1899,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-DBJSLKNR.js"),a=e("@metamask/utils"),n=e("@spruceid/siwe-parser"),s=r.createModuleLogger.call(void 0,r.projectLogger,"detect-siwe");function o(e){try{const r="string"!=typeof(i=e)?i:a.remove0x.call(void 0,i),n=t.from(r,"hex");return 32===n.length?e:n.toString("utf8")}catch(t){return s(t),e}var i}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);i.parseDomainParts=c,i.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:i}=e;if(!t||!i?.parsedMessage?.domain)return!1;const r=new URL(t),a=c(i.parsedMessage.domain,r.protocol);return 0===a.hostname.localeCompare(r.hostname,void 0,{sensitivity:"accent"})&&(""!==a.port&&a.port!==r.port?""===r.port&&a.port===l[r.protocol]:""===a.username||a.username===r.username)}catch(e){return s(e),!1}},i.detectSIWE=e=>{try{const{data:t}=e,i=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,n.ParsedMessage)(i)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1902,{"./chunk-LGGBBU6G.js":1900},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LGGBBU6G.js"),a={[r.NetworkType.goerli]:{chainId:r.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.goerli}.etherscan.io`}},[r.NetworkType.sepolia]:{chainId:r.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.sepolia}.etherscan.io`}},[r.NetworkType.mainnet]:{chainId:r.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[r.NetworkType["linea-goerli"]]:{chainId:r.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[r.NetworkType["linea-sepolia"]]:{chainId:r.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[r.NetworkType["linea-mainnet"]]:{chainId:r.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[r.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},n=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(n||{}),s={[r.ChainId.goerli]:"goerli",[r.ChainId.sepolia]:"sepolia",[r.ChainId.mainnet]:"mainnet",[r.ChainId["linea-goerli"]]:"linea-goerli",[r.ChainId["linea-sepolia"]]:"linea-sepolia",[r.ChainId["linea-mainnet"]]:"linea-mainnet",[r.ChainId.aurora]:"aurora"};i.RPC="rpc",i.FALL_BACK_VS_CURRENCY="ETH",i.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",i.GANACHE_CHAIN_ID="0x539",i.MAX_SAFE_CHAIN_ID=0xfffffffffffec,i.ERC721="ERC721",i.ERC1155="ERC1155",i.ERC20="ERC20",i.ERC721_INTERFACE_ID="0x80ac58cd",i.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",i.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",i.ERC1155_INTERFACE_ID="0xd9b67a26",i.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",i.GWEI="gwei",i.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},i.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},i.BUILT_IN_NETWORKS=a,i.OPENSEA_PROXY_URL="https://proxy.api.cx.metamask.io/opensea/v1/api/v2",i.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",i.NFT_API_VERSION="1",i.NFT_API_TIMEOUT=15e3,i.ORIGIN_METAMASK="metamask",i.ApprovalType=n,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-RKVNLW2C.js"}],[1903,{"./chunk-7C4YHS6A.js":1898,"./chunk-DBJSLKNR.js":1899,"./chunk-LGGBBU6G.js":1900,"./chunk-M6G3ISXG.js":1901,"./chunk-RKVNLW2C.js":1902},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var a=e("./chunk-7C4YHS6A.js"),n=e("./chunk-RKVNLW2C.js"),s=e("./chunk-LGGBBU6G.js");i.ASSET_TYPES=n.ASSET_TYPES,i.ApprovalType=n.ApprovalType,i.BNToHex=a.BNToHex,i.BUILT_IN_NETWORKS=n.BUILT_IN_NETWORKS,i.BuiltInNetworkName=s.BuiltInNetworkName,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=n.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,i.ChainId=s.ChainId,i.ERC1155=n.ERC1155,i.ERC1155_INTERFACE_ID=n.ERC1155_INTERFACE_ID,i.ERC1155_METADATA_URI_INTERFACE_ID=n.ERC1155_METADATA_URI_INTERFACE_ID,i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=n.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,i.ERC20=n.ERC20,i.ERC721=n.ERC721,i.ERC721_ENUMERABLE_INTERFACE_ID=n.ERC721_ENUMERABLE_INTERFACE_ID,i.ERC721_INTERFACE_ID=n.ERC721_INTERFACE_ID,i.ERC721_METADATA_INTERFACE_ID=n.ERC721_METADATA_INTERFACE_ID,i.FALL_BACK_VS_CURRENCY=n.FALL_BACK_VS_CURRENCY,i.GANACHE_CHAIN_ID=n.GANACHE_CHAIN_ID,i.GWEI=n.GWEI,i.IPFS_DEFAULT_GATEWAY_URL=n.IPFS_DEFAULT_GATEWAY_URL,i.InfuraNetworkType=s.InfuraNetworkType,i.MAX_SAFE_CHAIN_ID=n.MAX_SAFE_CHAIN_ID,i.NFT_API_BASE_URL=n.NFT_API_BASE_URL,i.NFT_API_TIMEOUT=n.NFT_API_TIMEOUT,i.NFT_API_VERSION=n.NFT_API_VERSION,i.NetworkType=s.NetworkType,i.NetworksTicker=s.NetworksTicker,i.OPENSEA_PROXY_URL=n.OPENSEA_PROXY_URL,i.ORIGIN_METAMASK=n.ORIGIN_METAMASK,i.RPC=n.RPC,i.TESTNET_TICKER_SYMBOLS=n.TESTNET_TICKER_SYMBOLS,i.convertHexToDecimal=a.convertHexToDecimal,i.detectSIWE=r.detectSIWE,i.fetchWithErrorHandling=a.fetchWithErrorHandling,i.fractionBN=a.fractionBN,i.fromHex=a.fromHex,i.getBuyURL=a.getBuyURL,i.gweiDecToWEIBN=a.gweiDecToWEIBN,i.handleFetch=a.handleFetch,i.hexToBN=a.hexToBN,i.hexToText=a.hexToText,i.isInfuraNetworkType=s.isInfuraNetworkType,i.isNetworkType=s.isNetworkType,i.isNonEmptyArray=a.isNonEmptyArray,i.isPlainObject=a.isPlainObject,i.isSafeChainId=a.isSafeChainId,i.isSafeDynamicKey=a.isSafeDynamicKey,i.isSmartContractCode=a.isSmartContractCode,i.isValidHexAddress=a.isValidHexAddress,i.isValidJson=a.isValidJson,i.isValidSIWEOrigin=r.isValidSIWEOrigin,i.normalizeEnsName=a.normalizeEnsName,i.parseDomainParts=r.parseDomainParts,i.query=a.query,i.safelyExecute=a.safelyExecute,i.safelyExecuteWithTimeout=a.safelyExecuteWithTimeout,i.successfulFetch=a.successfulFetch,i.timeoutFetch=a.timeoutFetch,i.toChecksumHexAddress=a.toChecksumHexAddress,i.toHex=a.toHex,i.weiHexToGweiDec=a.weiHexToGweiDec}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1904,{"./Semaphore":1905,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),a=e("./Semaphore"),n=function(){function e(e){this._semaphore=new a.default(1,e)}return e.prototype.acquire=function(){return r.__awaiter(this,arguments,void 0,(function(e){var t;return void 0===e&&(e=0),r.__generator(this,(function(i){switch(i.label){case 0:return[4,this._semaphore.acquire(1,e)];case 1:return t=i.sent(),[2,t[1]]}}))}))},e.prototype.runExclusive=function(e,t){return void 0===t&&(t=0),this._semaphore.runExclusive((function(){return e()}),1,t)},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.waitForUnlock=function(e){return void 0===e&&(e=0),this._semaphore.waitForUnlock(1,e)},e.prototype.release=function(){this._semaphore.isLocked()&&this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}();i.default=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/Mutex.js"}],[1905,{"./errors":1906,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),a=e("./errors"),n=function(){function e(e,t){void 0===t&&(t=a.E_CANCELED),this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}return e.prototype.acquire=function(e,t){var i=this;if(void 0===e&&(e=1),void 0===t&&(t=0),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return new Promise((function(r,a){var n={resolve:r,reject:a,weight:e,priority:t},o=s(i._queue,(function(e){return t<=e.priority}));-1===o&&e<=i._value?i._dispatchItem(n):i._queue.splice(o+1,0,n)}))},e.prototype.runExclusive=function(e){return r.__awaiter(this,arguments,void 0,(function(e,t,i){var a,n,s;return void 0===t&&(t=1),void 0===i&&(i=0),r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.acquire(t,i)];case 1:a=r.sent(),n=a[0],s=a[1],r.label=2;case 2:return r.trys.push([2,,4,5]),[4,e(n)];case 3:return[2,r.sent()];case 4:return s(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(e,t){var i=this;if(void 0===e&&(e=1),void 0===t&&(t=0),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return this._couldLockImmediately(e,t)?Promise.resolve():new Promise((function(r){var a,n,o;i._weightedWaiters[e-1]||(i._weightedWaiters[e-1]=[]),a=i._weightedWaiters[e-1],n={resolve:r,priority:t},o=s(a,(function(e){return n.priority<=e.priority})),a.splice(o+1,0,n)}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._value=e,this._dispatchQueue()},e.prototype.release=function(e){if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));this._value+=e,this._dispatchQueue()},e.prototype.cancel=function(){var e=this;this._queue.forEach((function(t){return t.reject(e._cancelError)})),this._queue=[]},e.prototype._dispatchQueue=function(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()},e.prototype._dispatchItem=function(e){var t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])},e.prototype._newReleaser=function(e){var t=this,i=!1;return function(){i||(i=!0,t.release(e))}},e.prototype._drainUnlockWaiters=function(){if(0===this._queue.length)for(var e=this._value;e>0;e--){(i=this._weightedWaiters[e-1])&&(i.forEach((function(e){return e.resolve()})),this._weightedWaiters[e-1]=[])}else{var t=this._queue[0].priority;for(e=this._value;e>0;e--){var i;if(i=this._weightedWaiters[e-1]){var r=i.findIndex((function(e){return e.priority<=t}));(-1===r?i:i.splice(0,r)).forEach((function(e){return e.resolve()}))}}}},e.prototype._couldLockImmediately=function(e,t){return(0===this._queue.length||this._queue[0].priority<t)&&e<=this._value},e}();function s(e,t){for(var i=e.length-1;i>=0;i--)if(t(e[i]))return i;return-1}i.default=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/Semaphore.js"}],[1906,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.E_CANCELED=i.E_ALREADY_LOCKED=i.E_TIMEOUT=void 0,i.E_TIMEOUT=new Error("timeout while waiting for mutex to become available"),i.E_ALREADY_LOCKED=new Error("mutex already locked"),i.E_CANCELED=new Error("request for lock canceled")}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/errors.js"}],[1907,{"./Mutex":1904,"./Semaphore":1905,"./errors":1906,"./tryAcquire":1908,"./withTimeout":1909,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.tryAcquire=i.withTimeout=i.Semaphore=i.Mutex=void 0;var r=e("tslib"),a=e("./Mutex");Object.defineProperty(i,"Mutex",{enumerable:!0,get:function(){return a.default}});var n=e("./Semaphore");Object.defineProperty(i,"Semaphore",{enumerable:!0,get:function(){return n.default}});var s=e("./withTimeout");Object.defineProperty(i,"withTimeout",{enumerable:!0,get:function(){return s.withTimeout}});var o=e("./tryAcquire");Object.defineProperty(i,"tryAcquire",{enumerable:!0,get:function(){return o.tryAcquire}}),r.__exportStar(e("./errors"),i)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/index.js"}],[1908,{"./errors":1906,"./withTimeout":1909},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.tryAcquire=void 0;var r=e("./errors"),a=e("./withTimeout");i.tryAcquire=function(e,t){return void 0===t&&(t=r.E_ALREADY_LOCKED),(0,a.withTimeout)(e,0,t)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/tryAcquire.js"}],[1909,{"./errors":1906,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.withTimeout=void 0;var r=e("tslib"),a=e("./errors");function n(e){return e.getValue!==undefined}i.withTimeout=function(e,t,i){var s=this;return void 0===i&&(i=a.E_TIMEOUT),{acquire:function(a,o){var l;if(n(e)?l=a:(l=undefined,o=a),l!==undefined&&l<=0)throw new Error("invalid weight ".concat(l,": must be positive"));return new Promise((function(a,c){return r.__awaiter(s,void 0,void 0,(function(){var s,d,u,h;return r.__generator(this,(function(r){switch(r.label){case 0:s=!1,d=setTimeout((function(){s=!0,c(i)}),t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n(e)?e.acquire(l,o):e.acquire(o)];case 2:return u=r.sent(),s?(Array.isArray(u)?u[1]:u)():(clearTimeout(d),a(u)),[3,4];case 3:return h=r.sent(),s||(clearTimeout(d),c(h)),[3,4];case 4:return[2]}}))}))}))},runExclusive:function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){var a,n;return r.__generator(this,(function(r){switch(r.label){case 0:a=function(){return undefined},r.label=1;case 1:return r.trys.push([1,,7,8]),[4,this.acquire(t,i)];case 2:return n=r.sent(),Array.isArray(n)?(a=n[1],[4,e(n[0])]):[3,4];case 3:return[2,r.sent()];case 4:return a=n,[4,e()];case 5:return[2,r.sent()];case 6:return[3,8];case 7:return a(),[7];case 8:return[2]}}))}))},release:function(t){e.release(t)},cancel:function(){return e.cancel()},waitForUnlock:function(r,a){var s;if(n(e)?s=r:(s=undefined,a=r),s!==undefined&&s<=0)throw new Error("invalid weight ".concat(s,": must be positive"));return new Promise((function(r,o){var l=setTimeout((function(){return o(i)}),t);(n(e)?e.waitForUnlock(s,a):e.waitForUnlock(a)).then((function(){clearTimeout(l),r()}))}))},isLocked:function(){return e.isLocked()},getValue:function(){return e.getValue()},setValue:function(t){return e.setValue(t)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/withTimeout.js"}],[191,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:72,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=72;const i=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/072.js"}],[1910,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){!function(e){var i,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,d=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,p=1e9;function m(e){var t=0|e;return e>0||e===t?t:t-1}function f(e){for(var t,i,r=1,a=e.length,n=e[0]+"";r<a;){for(t=e[r++]+"",i=c-t.length;i--;t="0"+t);n+=t}for(a=n.length;48===n.charCodeAt(--a););return n.slice(0,a+1||1)}function v(e,t){var i,r,a=e.c,n=t.c,s=e.s,o=t.s,l=e.e,c=t.e;if(!s||!o)return null;if(i=a&&!a[0],r=n&&!n[0],i||r)return i?r?0:-o:s;if(s!=o)return s;if(i=s<0,r=l==c,!a||!n)return r?0:!a^i?1:-1;if(!r)return l>c^i?1:-1;for(o=(l=a.length)<(c=n.length)?l:c,s=0;s<o;s++)if(a[s]!=n[s])return a[s]>n[s]^i?1:-1;return l==c?0:l>c^i?1:-1}function g(e,t,i,r){if(e<t||e>i||e!==n(e))throw Error(s+(r||"Argument")+("number"==typeof e?e<t||e>i?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function _(e){var t=e.c.length-1;return m(e.e/c)==t&&e.c[t]%2!=0}function k(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function w(e,t,i){var r,a;if(t<0){for(a=i+".";++t;a+=i);e=a+e}else if(++t>(r=e.length)){for(a=i,t-=r;--t;a+=i);e+=a}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}i=function e(t){var i,y,T,b,E,S,P,C,A,I,j=$.prototype={constructor:$,toString:null,valueOf:null},M=new $(1),x=20,N=4,R=-7,O=21,G=-1e7,L=1e7,B=!1,F=1,D=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},H="0123456789abcdefghijklmnopqrstuvwxyz",W=!0;function $(e,t){var i,a,s,l,u,h,p,m,f=this;if(!(f instanceof $))return new $(e,t);if(null==t){if(e&&!0===e._isBigNumber)return f.s=e.s,void(!e.c||e.e>L?f.c=f.e=null:e.e<G?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(l=0,u=e;u>=10;u/=10,l++);return void(l>L?f.c=f.e=null:(f.e=l,f.c=[e]))}m=String(e)}else{if(!r.test(m=String(e)))return T(f,m,h);f.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(l=m.indexOf("."))>-1&&(m=m.replace(".","")),(u=m.search(/e/i))>0?(l<0&&(l=u),l+=+m.slice(u+1),m=m.substring(0,u)):l<0&&(l=m.length)}else{if(g(t,2,H.length,"Base"),10==t&&W)return q(f=new $(e),x+f.e+1,N);if(m=String(e),h="number"==typeof e){if(0*e!=0)return T(f,m,h,t);if(f.s=1/e<0?(m=m.slice(1),-1):1,$.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else f.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(i=H.slice(0,t),l=u=0,p=m.length;u<p;u++)if(i.indexOf(a=m.charAt(u))<0){if("."==a){if(u>l){l=p;continue}}else if(!s&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){s=!0,u=-1,l=0;continue}return T(f,String(e),h,t)}h=!1,(l=(m=y(m,t,10,f.s)).indexOf("."))>-1?m=m.replace(".",""):l=m.length}for(u=0;48===m.charCodeAt(u);u++);for(p=m.length;48===m.charCodeAt(--p););if(m=m.slice(u,++p)){if(p-=u,h&&$.DEBUG&&p>15&&(e>d||e!==n(e)))throw Error(o+f.s*e);if((l=l-u-1)>L)f.c=f.e=null;else if(l<G)f.c=[f.e=0];else{if(f.e=l,f.c=[],u=(l+1)%c,l<0&&(u+=c),u<p){for(u&&f.c.push(+m.slice(0,u)),p-=c;u<p;)f.c.push(+m.slice(u,u+=c));u=c-(m=m.slice(u)).length}else u-=p;for(;u--;m+="0");f.c.push(+m)}}else f.c=[f.e=0]}function V(e,t,i,r){var a,n,s,o,l;if(null==i?i=N:g(i,0,8),!e.c)return e.toString();if(a=e.c[0],s=e.e,null==t)l=f(e.c),l=1==r||2==r&&(s<=R||s>=O)?k(l,s):w(l,s,"0");else if(n=(e=q(new $(e),t,i)).e,o=(l=f(e.c)).length,1==r||2==r&&(t<=n||n<=R)){for(;o<t;l+="0",o++);l=k(l,n)}else if(t-=s,l=w(l,n,"0"),n+1>o){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=n-o)>0)for(n+1==o&&(l+=".");t--;l+="0");return e.s<0&&a?"-"+l:l}function K(e,t){for(var i,r,a=1,n=new $(e[0]);a<e.length;a++)(!(r=new $(e[a])).s||(i=v(n,r))===t||0===i&&n.s===t)&&(n=r);return n}function Y(e,t,i){for(var r=1,a=t.length;!t[--a];t.pop());for(a=t[0];a>=10;a/=10,r++);return(i=r+i*c-1)>L?e.c=e.e=null:i<G?e.c=[e.e=0]:(e.e=i,e.c=t),e}function q(e,t,i,r){var s,o,d,h,p,m,f,v=e.c,g=u;if(v){e:{for(s=1,h=v[0];h>=10;h/=10,s++);if((o=t-s)<0)o+=c,d=t,p=v[m=0],f=n(p/g[s-d-1]%10);else if((m=a((o+1)/c))>=v.length){if(!r)break e;for(;v.length<=m;v.push(0));p=f=0,s=1,d=(o%=c)-c+1}else{for(p=h=v[m],s=1;h>=10;h/=10,s++);f=(d=(o%=c)-c+s)<0?0:n(p/g[s-d-1]%10)}if(r=r||t<0||null!=v[m+1]||(d<0?p:p%g[s-d-1]),r=i<4?(f||r)&&(0==i||i==(e.s<0?3:2)):f>5||5==f&&(4==i||r||6==i&&(o>0?d>0?p/g[s-d]:0:v[m-1])%10&1||i==(e.s<0?8:7)),t<1||!v[0])return v.length=0,r?(t-=e.e+1,v[0]=g[(c-t%c)%c],e.e=-t||0):v[0]=e.e=0,e;if(0==o?(v.length=m,h=1,m--):(v.length=m+1,h=g[c-o],v[m]=d>0?n(p/g[s-d]%g[d])*h:0),r)for(;;){if(0==m){for(o=1,d=v[0];d>=10;d/=10,o++);for(d=v[0]+=h,h=1;d>=10;d/=10,h++);o!=h&&(e.e++,v[0]==l&&(v[0]=1));break}if(v[m]+=h,v[m]!=l)break;v[m--]=0,h=1}for(o=v.length;0===v[--o];v.pop());}e.e>L?e.c=e.e=null:e.e<G&&(e.c=[e.e=0])}return e}function X(e){var t,i=e.e;return null===i?e.toString():(t=f(e.c),t=i<=R||i>=O?k(t,i):w(t,i,"0"),e.s<0?"-"+t:t)}return $.clone=e,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.EUCLID=9,$.config=$.set=function(e){var t,i;if(null!=e){if("object"!=typeof e)throw Error(s+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(g(i=e[t],0,p,t),x=i),e.hasOwnProperty(t="ROUNDING_MODE")&&(g(i=e[t],0,8,t),N=i),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((i=e[t])&&i.pop?(g(i[0],-p,0,t),g(i[1],0,p,t),R=i[0],O=i[1]):(g(i,-p,p,t),R=-(O=i<0?-i:i))),e.hasOwnProperty(t="RANGE"))if((i=e[t])&&i.pop)g(i[0],-p,-1,t),g(i[1],1,p,t),G=i[0],L=i[1];else{if(g(i,-p,p,t),!i)throw Error(s+t+" cannot be zero: "+i);G=-(L=i<0?-i:i)}if(e.hasOwnProperty(t="CRYPTO")){if((i=e[t])!==!!i)throw Error(s+t+" not true or false: "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw B=!i,Error(s+"crypto unavailable");B=i}else B=i}if(e.hasOwnProperty(t="MODULO_MODE")&&(g(i=e[t],0,9,t),F=i),e.hasOwnProperty(t="POW_PRECISION")&&(g(i=e[t],0,p,t),D=i),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(i=e[t]))throw Error(s+t+" not an object: "+i);U=i}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(i=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(i))throw Error(s+t+" invalid: "+i);W="0123456789"==i.slice(0,10),H=i}}return{DECIMAL_PLACES:x,ROUNDING_MODE:N,EXPONENTIAL_AT:[R,O],RANGE:[G,L],CRYPTO:B,MODULO_MODE:F,POW_PRECISION:D,FORMAT:U,ALPHABET:H}},$.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!$.DEBUG)return!0;var t,i,r=e.c,a=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===o||-1===o)&&a>=-p&&a<=p&&a===n(a)){if(0===r[0]){if(0===a&&1===r.length)return!0;break e}if((t=(a+1)%c)<1&&(t+=c),String(r[0]).length==t){for(t=0;t<r.length;t++)if((i=r[t])<0||i>=l||i!==n(i))break e;if(0!==i)return!0}}}else if(null===r&&null===a&&(null===o||1===o||-1===o))return!0;throw Error(s+"Invalid BigNumber: "+e)},$.maximum=$.max=function(){return K(arguments,-1)},$.minimum=$.min=function(){return K(arguments,1)},$.random=(b=9007199254740992,E=Math.random()*b&2097151?function(){return n(Math.random()*b)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,i,r,o,l,d=0,h=[],m=new $(M);if(null==e?e=x:g(e,0,p),o=a(e/c),B)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));d<o;)(l=131072*t[d]+(t[d+1]>>>11))>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),t[d]=i[0],t[d+1]=i[1]):(h.push(l%1e14),d+=2);d=o/2}else{if(!crypto.randomBytes)throw B=!1,Error(s+"crypto unavailable");for(t=crypto.randomBytes(o*=7);d<o;)(l=281474976710656*(31&t[d])+1099511627776*t[d+1]+4294967296*t[d+2]+16777216*t[d+3]+(t[d+4]<<16)+(t[d+5]<<8)+t[d+6])>=9e15?crypto.randomBytes(7).copy(t,d):(h.push(l%1e14),d+=7);d=o/7}if(!B)for(;d<o;)(l=E())<9e15&&(h[d++]=l%1e14);for(o=h[--d],e%=c,o&&e&&(l=u[c-e],h[d]=n(o/l)*l);0===h[d];h.pop(),d--);if(d<0)h=[r=0];else{for(r=-1;0===h[0];h.splice(0,1),r-=c);for(d=1,l=h[0];l>=10;l/=10,d++);d<c&&(r-=c-d)}return m.e=r,m.c=h,m}),$.sum=function(){for(var e=1,t=arguments,i=new $(t[0]);e<t.length;)i=i.plus(t[e++]);return i},y=function(){var e="0123456789";function t(e,t,i,r){for(var a,n,s=[0],o=0,l=e.length;o<l;){for(n=s.length;n--;s[n]*=t);for(s[0]+=r.indexOf(e.charAt(o++)),a=0;a<s.length;a++)s[a]>i-1&&(null==s[a+1]&&(s[a+1]=0),s[a+1]+=s[a]/i|0,s[a]%=i)}return s.reverse()}return function(r,a,n,s,o){var l,c,d,u,h,p,m,v,g=r.indexOf("."),_=x,k=N;for(g>=0&&(u=D,D=0,r=r.replace(".",""),p=(v=new $(a)).pow(r.length-g),D=u,v.c=t(w(f(p.c),p.e,"0"),10,n,e),v.e=v.c.length),d=u=(m=t(r,a,n,o?(l=H,e):(l=e,H))).length;0==m[--u];m.pop());if(!m[0])return l.charAt(0);if(g<0?--d:(p.c=m,p.e=d,p.s=s,m=(p=i(p,v,_,k,n)).c,h=p.r,d=p.e),g=m[c=d+_+1],u=n/2,h=h||c<0||null!=m[c+1],h=k<4?(null!=g||h)&&(0==k||k==(p.s<0?3:2)):g>u||g==u&&(4==k||h||6==k&&1&m[c-1]||k==(p.s<0?8:7)),c<1||!m[0])r=h?w(l.charAt(1),-_,l.charAt(0)):l.charAt(0);else{if(m.length=c,h)for(--n;++m[--c]>n;)m[c]=0,c||(++d,m=[1].concat(m));for(u=m.length;!m[--u];);for(g=0,r="";g<=u;r+=l.charAt(m[g++]));r=w(r,d,l.charAt(0))}return r}}(),i=function(){function e(e,t,i){var r,a,n,s,o=0,l=e.length,c=t%h,d=t/h|0;for(e=e.slice();l--;)o=((a=c*(n=e[l]%h)+(r=d*n+(s=e[l]/h|0)*c)%h*h+o)/i|0)+(r/h|0)+d*s,e[l]=a%i;return o&&(e=[o].concat(e)),e}function t(e,t,i,r){var a,n;if(i!=r)n=i>r?1:-1;else for(a=n=0;a<i;a++)if(e[a]!=t[a]){n=e[a]>t[a]?1:-1;break}return n}function i(e,t,i,r){for(var a=0;i--;)e[i]-=a,a=e[i]<t[i]?1:0,e[i]=a*r+e[i]-t[i];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,a,s,o,d){var u,h,p,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I=r.s==a.s?1:-1,j=r.c,M=a.c;if(!(j&&j[0]&&M&&M[0]))return new $(r.s&&a.s&&(j?!M||j[0]!=M[0]:M)?j&&0==j[0]||!M?0*I:I/0:NaN);for(w=(k=new $(I)).c=[],I=s+(h=r.e-a.e)+1,d||(d=l,h=m(r.e/c)-m(a.e/c),I=I/c|0),p=0;M[p]==(j[p]||0);p++);if(M[p]>(j[p]||0)&&h--,I<0)w.push(1),f=!0;else{for(S=j.length,C=M.length,p=0,I+=2,(v=n(d/(M[0]+1)))>1&&(M=e(M,v,d),j=e(j,v,d),C=M.length,S=j.length),E=C,T=(y=j.slice(0,C)).length;T<C;y[T++]=0);A=M.slice(),A=[0].concat(A),P=M[0],M[1]>=d/2&&P++;do{if(v=0,(u=t(M,y,C,T))<0){if(b=y[0],C!=T&&(b=b*d+(y[1]||0)),(v=n(b/P))>1)for(v>=d&&(v=d-1),_=(g=e(M,v,d)).length,T=y.length;1==t(g,y,_,T);)v--,i(g,C<_?A:M,_,d),_=g.length,u=1;else 0==v&&(u=v=1),_=(g=M.slice()).length;if(_<T&&(g=[0].concat(g)),i(y,g,T,d),T=y.length,-1==u)for(;t(M,y,C,T)<1;)v++,i(y,C<T?A:M,T,d),T=y.length}else 0===u&&(v++,y=[0]);w[p++]=v,y[0]?y[T++]=j[E]||0:(y=[j[E]],T=1)}while((E++<S||null!=y[0])&&I--);f=null!=y[0],w[0]||w.splice(0,1)}if(d==l){for(p=1,I=w[0];I>=10;I/=10,p++);q(k,s+(k.e=p+h*c-1)+1,o,f)}else k.e=h,k.r=+f;return k}}(),S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,P=/^([^.]+)\.$/,C=/^\.([^.]+)$/,A=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,T=function(e,t,i,r){var a,n=i?t:t.replace(I,"");if(A.test(n))e.s=isNaN(n)?null:n<0?-1:1;else{if(!i&&(n=n.replace(S,(function(e,t,i){return a="x"==(i=i.toLowerCase())?16:"b"==i?2:8,r&&r!=a?e:t})),r&&(a=r,n=n.replace(P,"$1").replace(C,"0.$1")),t!=n))return new $(n,a);if($.DEBUG)throw Error(s+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},j.absoluteValue=j.abs=function(){var e=new $(this);return e.s<0&&(e.s=1),e},j.comparedTo=function(e,t){return v(this,new $(e,t))},j.decimalPlaces=j.dp=function(e,t){var i,r,a,n=this;if(null!=e)return g(e,0,p),null==t?t=N:g(t,0,8),q(new $(n),e+n.e+1,t);if(!(i=n.c))return null;if(r=((a=i.length-1)-m(this.e/c))*c,a=i[a])for(;a%10==0;a/=10,r--);return r<0&&(r=0),r},j.dividedBy=j.div=function(e,t){return i(this,new $(e,t),x,N)},j.dividedToIntegerBy=j.idiv=function(e,t){return i(this,new $(e,t),0,1)},j.exponentiatedBy=j.pow=function(e,t){var i,r,o,l,d,u,h,p,m=this;if((e=new $(e)).c&&!e.isInteger())throw Error(s+"Exponent not an integer: "+X(e));if(null!=t&&(t=new $(t)),d=e.e>14,!m.c||!m.c[0]||1==m.c[0]&&!m.e&&1==m.c.length||!e.c||!e.c[0])return p=new $(Math.pow(+X(m),d?e.s*(2-_(e)):+X(e))),t?p.mod(t):p;if(u=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new $(NaN);(r=!u&&m.isInteger()&&t.isInteger())&&(m=m.mod(t))}else{if(e.e>9&&(m.e>0||m.e<-1||(0==m.e?m.c[0]>1||d&&m.c[1]>=24e7:m.c[0]<8e13||d&&m.c[0]<=9999975e7)))return l=m.s<0&&_(e)?-0:0,m.e>-1&&(l=1/l),new $(u?1/l:l);D&&(l=a(D/c+2))}for(d?(i=new $(.5),u&&(e.s=1),h=_(e)):h=(o=Math.abs(+X(e)))%2,p=new $(M);;){if(h){if(!(p=p.times(m)).c)break;l?p.c.length>l&&(p.c.length=l):r&&(p=p.mod(t))}if(o){if(0===(o=n(o/2)))break;h=o%2}else if(q(e=e.times(i),e.e+1,1),e.e>14)h=_(e);else{if(0===(o=+X(e)))break;h=o%2}m=m.times(m),l?m.c&&m.c.length>l&&(m.c.length=l):r&&(m=m.mod(t))}return r?p:(u&&(p=M.div(p)),t?p.mod(t):l?q(p,D,N,undefined):p)},j.integerValue=function(e){var t=new $(this);return null==e?e=N:g(e,0,8),q(t,t.e+1,e)},j.isEqualTo=j.eq=function(e,t){return 0===v(this,new $(e,t))},j.isFinite=function(){return!!this.c},j.isGreaterThan=j.gt=function(e,t){return v(this,new $(e,t))>0},j.isGreaterThanOrEqualTo=j.gte=function(e,t){return 1===(t=v(this,new $(e,t)))||0===t},j.isInteger=function(){return!!this.c&&m(this.e/c)>this.c.length-2},j.isLessThan=j.lt=function(e,t){return v(this,new $(e,t))<0},j.isLessThanOrEqualTo=j.lte=function(e,t){return-1===(t=v(this,new $(e,t)))||0===t},j.isNaN=function(){return!this.s},j.isNegative=function(){return this.s<0},j.isPositive=function(){return this.s>0},j.isZero=function(){return!!this.c&&0==this.c[0]},j.minus=function(e,t){var i,r,a,n,s=this,o=s.s;if(t=(e=new $(e,t)).s,!o||!t)return new $(NaN);if(o!=t)return e.s=-t,s.plus(e);var d=s.e/c,u=e.e/c,h=s.c,p=e.c;if(!d||!u){if(!h||!p)return h?(e.s=-t,e):new $(p?s:NaN);if(!h[0]||!p[0])return p[0]?(e.s=-t,e):new $(h[0]?s:3==N?-0:0)}if(d=m(d),u=m(u),h=h.slice(),o=d-u){for((n=o<0)?(o=-o,a=h):(u=d,a=p),a.reverse(),t=o;t--;a.push(0));a.reverse()}else for(r=(n=(o=h.length)<(t=p.length))?o:t,o=t=0;t<r;t++)if(h[t]!=p[t]){n=h[t]<p[t];break}if(n&&(a=h,h=p,p=a,e.s=-e.s),(t=(r=p.length)-(i=h.length))>0)for(;t--;h[i++]=0);for(t=l-1;r>o;){if(h[--r]<p[r]){for(i=r;i&&!h[--i];h[i]=t);--h[i],h[r]+=l}h[r]-=p[r]}for(;0==h[0];h.splice(0,1),--u);return h[0]?Y(e,h,u):(e.s=3==N?-1:1,e.c=[e.e=0],e)},j.modulo=j.mod=function(e,t){var r,a,n=this;return e=new $(e,t),!n.c||!e.s||e.c&&!e.c[0]?new $(NaN):!e.c||n.c&&!n.c[0]?new $(n):(9==F?(a=e.s,e.s=1,r=i(n,e,0,3),e.s=a,r.s*=a):r=i(n,e,0,F),(e=n.minus(r.times(e))).c[0]||1!=F||(e.s=n.s),e)},j.multipliedBy=j.times=function(e,t){var i,r,a,n,s,o,d,u,p,f,v,g,_,k,w,y=this,T=y.c,b=(e=new $(e,t)).c;if(!(T&&b&&T[0]&&b[0]))return!y.s||!e.s||T&&!T[0]&&!b||b&&!b[0]&&!T?e.c=e.e=e.s=null:(e.s*=y.s,T&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=m(y.e/c)+m(e.e/c),e.s*=y.s,(d=T.length)<(f=b.length)&&(_=T,T=b,b=_,a=d,d=f,f=a),a=d+f,_=[];a--;_.push(0));for(k=l,w=h,a=f;--a>=0;){for(i=0,v=b[a]%w,g=b[a]/w|0,n=a+(s=d);n>a;)i=((u=v*(u=T[--s]%w)+(o=g*u+(p=T[s]/w|0)*v)%w*w+_[n]+i)/k|0)+(o/w|0)+g*p,_[n--]=u%k;_[n]=i}return i?++r:_.splice(0,1),Y(e,_,r)},j.negated=function(){var e=new $(this);return e.s=-e.s||null,e},j.plus=function(e,t){var i,r=this,a=r.s;if(t=(e=new $(e,t)).s,!a||!t)return new $(NaN);if(a!=t)return e.s=-t,r.minus(e);var n=r.e/c,s=e.e/c,o=r.c,d=e.c;if(!n||!s){if(!o||!d)return new $(a/0);if(!o[0]||!d[0])return d[0]?e:new $(o[0]?r:0*a)}if(n=m(n),s=m(s),o=o.slice(),a=n-s){for(a>0?(s=n,i=d):(a=-a,i=o),i.reverse();a--;i.push(0));i.reverse()}for((a=o.length)-(t=d.length)<0&&(i=d,d=o,o=i,t=a),a=0;t;)a=(o[--t]=o[t]+d[t]+a)/l|0,o[t]=l===o[t]?0:o[t]%l;return a&&(o=[a].concat(o),++s),Y(e,o,s)},j.precision=j.sd=function(e,t){var i,r,a,n=this;if(null!=e&&e!==!!e)return g(e,1,p),null==t?t=N:g(t,0,8),q(new $(n),e,t);if(!(i=n.c))return null;if(r=(a=i.length-1)*c+1,a=i[a]){for(;a%10==0;a/=10,r--);for(a=i[0];a>=10;a/=10,r++);}return e&&n.e+1>r&&(r=n.e+1),r},j.shiftedBy=function(e){return g(e,-9007199254740991,d),this.times("1e"+e)},j.squareRoot=j.sqrt=function(){var e,t,r,a,n,s=this,o=s.c,l=s.s,c=s.e,d=x+4,u=new $("0.5");if(1!==l||!o||!o[0])return new $(!l||l<0&&(!o||o[0])?NaN:o?s:1/0);if(0==(l=Math.sqrt(+X(s)))||l==1/0?(((t=f(o)).length+c)%2==0&&(t+="0"),l=Math.sqrt(+t),c=m((c+1)/2)-(c<0||c%2),r=new $(t=l==1/0?"5e"+c:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+c)):r=new $(l+""),r.c[0])for((l=(c=r.e)+d)<3&&(l=0);;)if(n=r,r=u.times(n.plus(i(s,n,d,1))),f(n.c).slice(0,l)===(t=f(r.c)).slice(0,l)){if(r.e<c&&--l,"9999"!=(t=t.slice(l-3,l+1))&&(a||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(q(r,r.e+x+2,1),e=!r.times(r).eq(s));break}if(!a&&(q(n,n.e+x+2,0),n.times(n).eq(s))){r=n;break}d+=4,l+=4,a=1}return q(r,r.e+x+1,N,e)},j.toExponential=function(e,t){return null!=e&&(g(e,0,p),e++),V(this,e,t,1)},j.toFixed=function(e,t){return null!=e&&(g(e,0,p),e=e+this.e+1),V(this,e,t)},j.toFormat=function(e,t,i){var r,a=this;if(null==i)null!=e&&t&&"object"==typeof t?(i=t,t=null):e&&"object"==typeof e?(i=e,e=t=null):i=U;else if("object"!=typeof i)throw Error(s+"Argument not an object: "+i);if(r=a.toFixed(e,t),a.c){var n,o=r.split("."),l=+i.groupSize,c=+i.secondaryGroupSize,d=i.groupSeparator||"",u=o[0],h=o[1],p=a.s<0,m=p?u.slice(1):u,f=m.length;if(c&&(n=l,l=c,c=n,f-=n),l>0&&f>0){for(n=f%l||l,u=m.substr(0,n);n<f;n+=l)u+=d+m.substr(n,l);c>0&&(u+=d+m.slice(n)),p&&(u="-"+u)}r=h?u+(i.decimalSeparator||"")+((c=+i.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):h):u}return(i.prefix||"")+r+(i.suffix||"")},j.toFraction=function(e){var t,r,a,n,o,l,d,h,p,m,v,g,_=this,k=_.c;if(null!=e&&(!(d=new $(e)).isInteger()&&(d.c||1!==d.s)||d.lt(M)))throw Error(s+"Argument "+(d.isInteger()?"out of range: ":"not an integer: ")+X(d));if(!k)return new $(_);for(t=new $(M),p=r=new $(M),a=h=new $(M),g=f(k),o=t.e=g.length-_.e-1,t.c[0]=u[(l=o%c)<0?c+l:l],e=!e||d.comparedTo(t)>0?o>0?t:p:d,l=L,L=1/0,d=new $(g),h.c[0]=0;m=i(d,t,0,1),1!=(n=r.plus(m.times(a))).comparedTo(e);)r=a,a=n,p=h.plus(m.times(n=p)),h=n,t=d.minus(m.times(n=t)),d=n;return n=i(e.minus(r),a,0,1),h=h.plus(n.times(p)),r=r.plus(n.times(a)),h.s=p.s=_.s,v=i(p,a,o*=2,N).minus(_).abs().comparedTo(i(h,r,o,N).minus(_).abs())<1?[p,a]:[h,r],L=l,v},j.toNumber=function(){return+X(this)},j.toPrecision=function(e,t){return null!=e&&g(e,1,p),V(this,e,t,2)},j.toString=function(e){var t,i=this,r=i.s,a=i.e;return null===a?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=a<=R||a>=O?k(f(i.c),a):w(f(i.c),a,"0"):10===e&&W?t=w(f((i=q(new $(i),x+a+1,N)).c),i.e,"0"):(g(e,2,H.length,"Base"),t=y(w(f(i.c),a,"0"),10,e,r,!0)),r<0&&i.c[0]&&(t="-"+t)),t},j.valueOf=j.toJSON=function(){return X(this)},j._isBigNumber=!0,null!=t&&$.set(t),$}(),i.default=i.BigNumber=i,"function"==typeof define&&define.amd?define((function(){return i})):void 0!==t&&t.exports?t.exports=i:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=i)}(this)}}},{package:"@metamask/smart-transactions-controller>bignumber.js",file:"node_modules/@metamask/smart-transactions-controller/node_modules/bignumber.js/bignumber.js"}],[1911,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){t.exports=[{constant:!1,inputs:[{name:"_new",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[],name:"totalSignatures",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[],name:"drain",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"",type:"bytes4"}],name:"entries",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_method",type:"string"}],name:"register",outputs:[{name:"",type:"bool"}],payable:!1,type:"function"},{inputs:[],type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"creator",type:"address"},{indexed:!0,name:"signature",type:"bytes4"},{indexed:!1,name:"method",type:"string"}],name:"Registered",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"old",type:"address"},{indexed:!0,name:"current",type:"address"}],name:"NewOwner",type:"event"}]}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry",file:"node_modules/@metamask/smart-transactions-controller/node_modules/eth-method-registry/dist/abi.json"}],[1912,{"./abi.json":1911,"./registry-map.json":1913,"@metamask/ethjs-contract":1796,"@metamask/ethjs-query":1799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.MethodRegistry=void 0;const a=r(e("@metamask/ethjs-query")),n=r(e("@metamask/ethjs-contract")),s=r(e("./registry-map.json")),o=r(e("./abi.json"));i.MethodRegistry=class{constructor(e){if(!e.provider)throw new Error("Missing required 'provider' option");const t=s.default[e.network||"1"];if(!t)throw new Error("No method registry found on the requested network.");const i=new a.default(e.provider),r=(0,n.default)(i);this.registry=r(o.default).at(t)}async lookup(e){const t=await this.registry.entries(e);return t?t[0]:undefined}parse(e){const t=e.match(/^([^)(]*)\((.*)\)([^)(]*)$/u);let i;if(i=t?t[1].charAt(0).toUpperCase()+t[1].slice(1).split(/(?=[A-Z])/u).join(" "):"",t){const r=e.match(new RegExp(`${t[1]}\\(+([a-z1-9,()\\[\\]]+)\\)`,"u"));let a,n=[];return r&&(a=r[1].match(/[A-z1-9]+/gu),a&&(n=a.map((e=>({type:e}))))),{name:i,args:n}}return{}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry",file:"node_modules/@metamask/smart-transactions-controller/node_modules/eth-method-registry/dist/index.js"}],[1913,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){t.exports={1:"0x44691B39d1a75dC4E0A0346CBB15E310e6ED1E86"}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry",file:"node_modules/@metamask/smart-transactions-controller/node_modules/eth-method-registry/dist/registry-map.json"}],[1914,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){t.exports={name:"@metamask/smart-transactions-controller",version:"10.1.2",description:"Improves success rates for swaps by trialing transactions privately and finding minimum fees",repository:{type:"git",url:"https://github.com/MetaMask/smart-transactions-controller.git"},license:"SEE LICENSE IN LICENSE",main:"dist/index.js",types:"dist/index.d.ts",files:["dist/"],scripts:{build:"tsc --project .","build:clean":"rm -rf dist && yarn build","build:link":"yarn build && cd dist && yarn link && rm -rf node_modules && cd ..",lint:"yarn lint:eslint && yarn lint:misc --check","lint:eslint":"eslint . --cache --ext js,ts","lint:fix":"yarn lint:eslint --fix && yarn lint:misc --write","lint:misc":"prettier '**/*.json' '**/*.md' '!CHANGELOG.md' '**/*.yml' '!.yarnrc.yml' --ignore-path .gitignore",prepack:"./scripts/prepack.sh",test:"jest","test:watch":"jest --watchAll"},dependencies:{"@babel/runtime":"^7.24.1","@ethereumjs/tx":"^5.2.1","@ethereumjs/util":"^9.0.2","@ethersproject/bytes":"^5.7.0","@metamask/base-controller":"^5.0.1","@metamask/controller-utils":"^9.1.0","@metamask/eth-query":"^4.0.0","@metamask/network-controller":"^18.1.2","@metamask/polling-controller":"^6.0.1","@metamask/transaction-controller":"^30.0.0","bignumber.js":"^9.0.1",events:"^3.3.0","fast-json-patch":"^3.1.0",lodash:"^4.17.21"},devDependencies:{"@lavamoat/allow-scripts":"^2.3.1","@metamask/auto-changelog":"^3.1.0","@metamask/eslint-config":"^12.2.0","@metamask/eslint-config-jest":"^12.1.0","@metamask/eslint-config-nodejs":"^12.1.0","@metamask/eslint-config-typescript":"^12.1.0","@types/jest":"^26.0.24","@types/lodash":"^4.14.194","@types/node":"^18.19.17","@types/sinon":"^9.0.10","@typescript-eslint/eslint-plugin":"^5.33.0","@typescript-eslint/parser":"^5.33.0",eslint:"^8.48.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-jest":"^27.1.5","eslint-plugin-jsdoc":"^39.2.9","eslint-plugin-n":"^15.7.0","eslint-plugin-prettier":"^4.2.1","eslint-plugin-promise":"^6.1.1","isomorphic-fetch":"^3.0.0",jest:"^26.4.2",nock:"^13.3.1",prettier:"^2.8.8","prettier-plugin-packagejson":"^2.4.3",sinon:"^9.2.4","ts-jest":"^26.5.6",typescript:"~4.8.4"},packageManager:"yarn@3.2.1",engines:{node:"^18.18 || >=20"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},lavamoat:{allowScripts:{"@lavamoat/preinstall-always-fail":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>keccak":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>secp256k1":!1,"@metamask/controller-utils>babel-runtime>core-js":!1}}}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/package.json"}],[1915,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e=>(e[e.Unverified=0]="Unverified",e[e.Blocked=1]="Blocked",e[e.Verified=2]="Verified",e[e.Unavailable=3]="Unavailable",e))(r||{});i.SnapsRegistryStatus=r}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-4CA3O64H.js"}],[1916,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-4URGXJP7.js"}],[1917,{"./chunk-EXN2TFDJ.js":1926,"./chunk-KH72WRHR.js":1933,"@metamask/post-message-stream":1624},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-KH72WRHR.js"),n=e("./chunk-EXN2TFDJ.js"),s=e("@metamask/post-message-stream"),o=class extends a.ProxyExecutionService{constructor({messenger:e,setupSnapProvider:t,offscreenPromise:i}){super({messenger:e,setupSnapProvider:t,stream:new(0,s.BrowserRuntimePostMessageStream)({name:"parent",target:"child"})}),n.__privateAdd.call(void 0,this,r,void 0),n.__privateSet.call(void 0,this,r,i)}async initEnvStream(e){return await n.__privateGet.call(void 0,this,r),await super.initEnvStream(e)}};r=new WeakMap,i.OffscreenExecutionService=o}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-6ERB63FH.js"}],[1918,{"./chunk-EXN2TFDJ.js":1926,"./chunk-WCDDYBFW.js":1942,"@metamask/base-controller":1954,"@metamask/snaps-utils":2118,"@metamask/utils":2255,nanoid:1986},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-WCDDYBFW.js"),m=e("./chunk-EXN2TFDJ.js"),f=e("@metamask/base-controller"),v=e("@metamask/snaps-utils"),g=e("@metamask/utils"),_=e("nanoid"),k=1e7,w="SnapInterfaceController",y=class extends f.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{interfaces:{persist:!1,anonymous:!1}},name:w,state:{interfaces:{},...t}}),m.__privateAdd.call(void 0,this,r),m.__privateAdd.call(void 0,this,n),m.__privateAdd.call(void 0,this,o),m.__privateAdd.call(void 0,this,c),m.__privateAdd.call(void 0,this,u),m.__privateMethod.call(void 0,this,r,a).call(this)}async createInterface(e,t,i){const r=p.getJsxInterface.call(void 0,t);await m.__privateMethod.call(void 0,this,u,h).call(this,r),p.validateInterfaceContext.call(void 0,i);const a=_.nanoid.call(void 0),n=p.constructState.call(void 0,{},r);return this.update((t=>{t.interfaces[a]={snapId:e,content:r,state:n,context:i??null}})),a}getInterface(e,t){return m.__privateMethod.call(void 0,this,n,s).call(this,e,t),this.state.interfaces[t]}async updateInterface(e,t,i){m.__privateMethod.call(void 0,this,n,s).call(this,e,t);const r=p.getJsxInterface.call(void 0,i);await m.__privateMethod.call(void 0,this,u,h).call(this,r);const a=this.state.interfaces[t].state,o=p.constructState.call(void 0,a,r);this.update((e=>{e.interfaces[t].state=o,e.interfaces[t].content=r}))}deleteInterface(e){this.update((t=>{delete t.interfaces[e]}))}updateInterfaceState(e,t){this.update((i=>{i.interfaces[e].state=t}))}};r=new WeakSet,a=function(){this.messagingSystem.registerActionHandler(`${w}:createInterface`,this.createInterface.bind(this)),this.messagingSystem.registerActionHandler(`${w}:getInterface`,this.getInterface.bind(this)),this.messagingSystem.registerActionHandler(`${w}:updateInterface`,this.updateInterface.bind(this)),this.messagingSystem.registerActionHandler(`${w}:deleteInterface`,this.deleteInterface.bind(this)),this.messagingSystem.registerActionHandler(`${w}:updateInterfaceState`,this.updateInterfaceState.bind(this))},n=new WeakSet,s=function(e,t){const i=this.state.interfaces[t];g.assert.call(void 0,void 0!==i,`Interface with id '${t}' not found.`),g.assert.call(void 0,i.snapId===e,`Interface not created by ${e}.`)},o=new WeakSet,l=async function(){await this.messagingSystem.call("PhishingController:maybeUpdateState")},c=new WeakSet,d=function(e){return this.messagingSystem.call("PhishingController:testOrigin",e).result},u=new WeakSet,h=async function(e){const t=v.getJsonSizeUnsafe.call(void 0,e);g.assert.call(void 0,t<=k,"A Snap UI may not be larger than 10 MB."),await m.__privateMethod.call(void 0,this,o,l).call(this),v.validateJsxLinks.call(void 0,e,m.__privateMethod.call(void 0,this,c,d).bind(this))},i.SnapInterfaceController=y}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-6VGMRXGY.js"}],[1919,{"./chunk-EXN2TFDJ.js":1926,"@metamask/post-message-stream":1624},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o=e("./chunk-EXN2TFDJ.js"),l=e("@metamask/post-message-stream"),c=class extends l.BasePostMessageStream{constructor({stream:e,jobId:t}){super(),o.__privateAdd.call(void 0,this,n),o.__privateAdd.call(void 0,this,r,void 0),o.__privateAdd.call(void 0,this,a,void 0),o.__privateSet.call(void 0,this,r,e),o.__privateSet.call(void 0,this,a,t),o.__privateGet.call(void 0,this,r).on("data",o.__privateMethod.call(void 0,this,n,s).bind(this))}_postMessage(e){o.__privateGet.call(void 0,this,r).write({jobId:o.__privateGet.call(void 0,this,a),data:e})}};r=new WeakMap,a=new WeakMap,n=new WeakSet,s=function(e){e.jobId===o.__privateGet.call(void 0,this,a)&&this.push(e.data)},i.ProxyPostMessageStream=c}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-7Y6P5FRN.js"}],[192,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:73,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=73;const i=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/073.js"}],[1920,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});i.RequestQueue=class{constructor(e){this.maxQueueSize=e,this.queueSizes=new Map}increment(e){const t=this.queueSizes.get(e)??0;if(t>=this.maxQueueSize)throw new Error("Maximum number of requests reached. Try again later.");this.queueSizes.set(e,t+1)}decrement(e){const t=this.queueSizes.get(e)??0;if(0===t)throw new Error(`Cannot decrement, ${e} does not have any outstanding requests.`);this.queueSizes.set(e,t-1)}get(e){return this.queueSizes.get(e)??0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-AP7CJ6DA.js"}],[1921,{"@metamask/utils":2255,"@xstate/fsm":2600},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=e("@xstate/fsm");i.validateMachine=function(e){r.assert.call(void 0,"_options"in e,"The machine is not an @xstate/fsm machine");const t=e,i=new Set,a=e=>{return(t=e,Array.isArray(t)?t:null==t?[]:[t]).flatMap((e=>"string"==typeof e?[e]:(r.assert.call(void 0,"function"==typeof e),[]))).forEach(i.add.bind(i));var t};for(const e of Object.values(t.config.states)){a(e.entry),a(e.exit);for(const t of Object.values(e.on??{}))a(t.actions)}i.forEach((e=>r.assert.call(void 0,void 0!==t._options.actions&&e in t._options.actions,`Action "${e}" doesn't have an implementation`)))},i.forceStrict=function(e){let t=!1;e.subscribe((e=>{r.assert.call(void 0,!t||e.changed,"Invalid state transition"),t=!0}));const i=e.send.bind(e);e.send=(...t)=>(r.assert.call(void 0,e.status===a.InterpreterStatus.Running,"Interpreter is stopped"),i(...t))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-BO2ZDPWV.js"}],[1922,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils");i.Timer=class{constructor(e){r.assert.call(void 0,!Number.isNaN(e),new TypeError("Can't start a timer with NaN time")),r.assert.call(void 0,e>=0,new TypeError("Can't start a timer with negative time")),this.state={value:"stopped",remaining:e}}get status(){return this.state.value}get remaining(){return this.state.remaining}cancel(){r.assert.call(void 0,"paused"===this.status||"running"===this.status,new Error("Tried to cancel a not running Timer")),this.onFinish(!1)}finish(){r.assert.call(void 0,"finished"!==this.status,new Error("Tried to finish a finished Timer.")),this.onFinish(!0)}pause(){r.assert.call(void 0,"running"===this.state.value,new Error("Tried to pause a not running Timer"));const{callback:e,start:t,timeout:i,remaining:a}=this.state;void 0!==i&&clearTimeout(i),this.state={value:"paused",callback:e,remaining:a-(Date.now()-t)}}start(e){r.assert.call(void 0,"stopped"===this.state.value,new Error("Tried to start an already running Timer"));const{remaining:t}=this.state;this.state={value:"paused",remaining:t,callback:e},this.resume()}resume(){r.assert.call(void 0,"paused"===this.state.value,new Error("Tried to resume not paused Timer"));const{remaining:e,callback:t}=this.state,i=Date.now();let a;e!==Number.POSITIVE_INFINITY&&(a=setTimeout((()=>this.onFinish(!0)),e)),this.state={value:"running",callback:t,remaining:e,start:i,timeout:a}}onFinish(e){r.assert.call(void 0,"running"===this.state.value||"paused"===this.state.value),"running"===this.state.value&&void 0!==this.state.timeout&&clearTimeout(this.state.timeout);const{callback:t,remaining:i}=this.state;this.state={value:"finished",remaining:"running"===this.state.value?i-(Date.now()-this.state.start):i},e&&t()}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-BOFPNIRX.js"}],[1923,{"./chunk-BOFPNIRX.js":1922,"@metamask/snaps-sdk":2077,"@metamask/snaps-utils":2118,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-BOFPNIRX.js"),n=e("@metamask/snaps-sdk"),s=e("@metamask/snaps-utils"),o=e("fast-deep-equal"),l=(r=o)&&r.__esModule?r:{default:r};function c(e,t){return Object.entries(e).reduce(((e,[i,r])=>(i in t||(e[i]=r),e)),{})}function d(e,t){let i;const r=new Promise(((r,a)=>{e.start((()=>{void 0===t?r():r(t)})),i=a}));return r.cancel=()=>{"finished"!==e.status&&(e.cancel(),i(new Error("The delay has been canceled.")))},r}var u=Symbol("Used to check if the requested promise has timeout (see withTimeout)");async function h(e,t){return t&&0!==t.length?await Promise.all(t.map((async t=>e.fetch(t)))):[]}i.setDiff=c,i.permissionsDiff=function(e,t){return Object.entries(e).reduce(((e,[i,r])=>{const a=i in t;return(!a||a&&!l.default.call(void 0,r.caveats??[],t[i].caveats??[]))&&(e[i]=r),e}),{})},i.delay=function(e,t){return d(new(0,a.Timer)(e),t)},i.delayWithTimer=d,i.hasTimedOut=u,i.withTimeout=async function(e,t){const i=d("number"==typeof t?new(0,a.Timer)(t):t,u);try{return await Promise.race([e,i])}finally{i.cancel()}},i.getSnapFiles=h,i.fetchSnap=async function(e,t){try{const e=await t.manifest(),i=await t.fetch(e.result.source.location.npm.filePath),{iconPath:r}=e.result.source.location.npm,a=r?await t.fetch(r):void 0,n=await h(t,e.result.source.files);await Promise.all(n.map((async e=>{e.data.base64=await s.encodeBase64.call(void 0,e)})));const o=await h(t,e.result.source.locales),l={manifest:e,sourceCode:i,svgIcon:a,auxiliaryFiles:n,localizationFiles:s.getValidatedLocalizationFiles.call(void 0,o)};return await s.validateFetchedSnap.call(void 0,l),l}catch(t){throw new Error(`Failed to fetch snap "${e}": ${n.getErrorMessage.call(void 0,t)}.`)}},i.calculateConnectionsChange=function(e,t){const i=c(t,e),r=c(e,t);return{newConnections:i,unusedConnections:r,approvedConnections:c(e,r)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-CDTGUNSA.js"}],[1924,{"./chunk-EXN2TFDJ.js":1926,"@metamask/base-controller":1954,"@metamask/snaps-registry":1993,"@metamask/snaps-utils":2118,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I=e("./chunk-EXN2TFDJ.js"),j=e("@metamask/base-controller"),M=e("@metamask/snaps-registry"),x=e("@metamask/snaps-utils"),N=e("@metamask/utils"),R={database:null,lastUpdated:null,databaseUnavailable:!1},O=class extends j.BaseController{constructor({messenger:e,state:t,url:i={registry:"https://acl.execution.metamask.io/latest/registry.json",signature:"https://acl.execution.metamask.io/latest/signature.json"},publicKey:d="0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6",fetchFunction:m=globalThis.fetch.bind(globalThis),recentFetchThreshold:v=N.inMilliseconds.call(void 0,5,N.Duration.Minute),refetchOnAllowlistMiss:_=!0}){super({messenger:e,metadata:{database:{persist:!0,anonymous:!1},lastUpdated:{persist:!0,anonymous:!1},databaseUnavailable:{persist:!0,anonymous:!1}},name:"SnapsRegistry",state:{...R,...t}}),I.__privateAdd.call(void 0,this,c),I.__privateAdd.call(void 0,this,u),I.__privateAdd.call(void 0,this,p),I.__privateAdd.call(void 0,this,f),I.__privateAdd.call(void 0,this,g),I.__privateAdd.call(void 0,this,k),I.__privateAdd.call(void 0,this,y),I.__privateAdd.call(void 0,this,b),I.__privateAdd.call(void 0,this,S),I.__privateAdd.call(void 0,this,C),I.__privateAdd.call(void 0,this,r,void 0),I.__privateAdd.call(void 0,this,a,void 0),I.__privateAdd.call(void 0,this,n,void 0),I.__privateAdd.call(void 0,this,s,void 0),I.__privateAdd.call(void 0,this,o,void 0),I.__privateAdd.call(void 0,this,l,void 0),I.__privateSet.call(void 0,this,r,i),I.__privateSet.call(void 0,this,a,d),I.__privateSet.call(void 0,this,n,m),I.__privateSet.call(void 0,this,s,v),I.__privateSet.call(void 0,this,o,_),I.__privateSet.call(void 0,this,l,null),this.messagingSystem.registerActionHandler("SnapsRegistry:get",(async(...e)=>I.__privateMethod.call(void 0,this,k,w).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:getMetadata",(async(...e)=>I.__privateMethod.call(void 0,this,b,E).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:resolveVersion",(async(...e)=>I.__privateMethod.call(void 0,this,y,T).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:update",(async()=>I.__privateMethod.call(void 0,this,u,h).call(this)))}};r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakSet,d=function(){return this.state.lastUpdated&&Date.now()-this.state.lastUpdated<I.__privateGet.call(void 0,this,s)},u=new WeakSet,h=async function(){I.__privateGet.call(void 0,this,l)?await I.__privateGet.call(void 0,this,l):(null===I.__privateGet.call(void 0,this,l)&&I.__privateSet.call(void 0,this,l,I.__privateMethod.call(void 0,this,p,m).call(this)),await I.__privateGet.call(void 0,this,l),I.__privateSet.call(void 0,this,l,null))},p=new WeakSet,m=async function(){if(!I.__privateMethod.call(void 0,this,c,d).call(this))try{const e=await I.__privateMethod.call(void 0,this,C,A).call(this,I.__privateGet.call(void 0,this,r).registry),t=await I.__privateMethod.call(void 0,this,C,A).call(this,I.__privateGet.call(void 0,this,r).signature);I.__privateMethod.call(void 0,this,S,P).call(this,e,t),this.update((t=>{t.database=JSON.parse(e),t.lastUpdated=Date.now(),t.databaseUnavailable=!1}))}catch{this.update((e=>{e.databaseUnavailable=!0}))}},f=new WeakSet,v=async function(){return null===this.state.database&&await I.__privateMethod.call(void 0,this,u,h).call(this),this.state.database},g=new WeakSet,_=async function(e,t,i=!1){const r=await I.__privateMethod.call(void 0,this,f,v).call(this),a=r?.blockedSnaps.find((i=>"id"in i?i.id===e&&N.satisfiesVersionRange.call(void 0,t.version,i.versionRange):i.checksum===t.checksum));if(a)return{status:1,reason:a.reason};const n=r?.verifiedSnaps[e],s=n?.versions?.[t.version];return s&&s.checksum===t.checksum?{status:2}:I.__privateGet.call(void 0,this,o)&&!i?(await I.__privateMethod.call(void 0,this,u,h).call(this),I.__privateMethod.call(void 0,this,g,_).call(this,e,t,!0)):{status:this.state.databaseUnavailable?3:0}},k=new WeakSet,w=async function(e){return Object.entries(e).reduce((async(e,[t,i])=>{const r=await I.__privateMethod.call(void 0,this,g,_).call(this,t,i),a=await e;return a[t]=r,a}),Promise.resolve({}))},y=new WeakSet,T=async function(e,t,i=!1){const r=await I.__privateMethod.call(void 0,this,f,v).call(this),a=r?.verifiedSnaps[e]?.versions??null;if(!a&&I.__privateGet.call(void 0,this,o)&&!i)return await I.__privateMethod.call(void 0,this,u,h).call(this),I.__privateMethod.call(void 0,this,y,T).call(this,e,t,!0);if(!a)return t;const n=x.getTargetVersion.call(void 0,Object.keys(a),t);return n||!I.__privateGet.call(void 0,this,o)||i?n?(N.assertIsSemVerRange.call(void 0,n),n):t:(await I.__privateMethod.call(void 0,this,u,h).call(this),I.__privateMethod.call(void 0,this,y,T).call(this,e,t,!0))},b=new WeakSet,E=async function(e){const t=await I.__privateMethod.call(void 0,this,f,v).call(this);return t?.verifiedSnaps[e]?.metadata??null},S=new WeakSet,P=function(e,t){N.assert.call(void 0,I.__privateGet.call(void 0,this,a),"No public key provided.");const i=M.verify.call(void 0,{registry:e,signature:JSON.parse(t),publicKey:I.__privateGet.call(void 0,this,a)});N.assert.call(void 0,i,"Invalid registry signature.")},C=new WeakSet,A=async function(e){const t=await I.__privateGet.call(void 0,this,n).call(this,e);if(!t.ok)throw new Error(`Failed to fetch ${e}.`);return await t.text()},i.JsonSnapsRegistry=O}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-CPUUURMT.js"}],[1925,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-D74XJG2L.js"}],[1926,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(t=>void 0!==e?e:"undefined"!=typeof Proxy?new Proxy(t,{get:(t,i)=>(void 0!==e?e:t)[i]}):t)((function(t){if(void 0!==e)return e.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')})),a=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__require=r,i.__privateGet=(e,t,i)=>(a(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,r)=>(a(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(a(e,t,"access private method"),i)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-EXN2TFDJ.js"}],[1927,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-G66GQJS6.js"}],[1928,{"./chunk-BOFPNIRX.js":1922,"./chunk-EXN2TFDJ.js":1926,"./chunk-YYPUPKQY.js":1945,"@metamask/base-controller":1954,"@metamask/snaps-rpc-methods":2041,"@metamask/snaps-utils":2118,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o=e("./chunk-YYPUPKQY.js"),l=e("./chunk-BOFPNIRX.js"),c=e("./chunk-EXN2TFDJ.js"),d=e("@metamask/base-controller"),u=e("@metamask/snaps-rpc-methods"),h=e("@metamask/snaps-utils"),p=e("@metamask/utils"),m=p.inMilliseconds.call(void 0,24,p.Duration.Hour),f=class extends d.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{jobs:{persist:!0,anonymous:!1}},name:"CronjobController",state:{jobs:{},...t}}),c.__privateAdd.call(void 0,this,r,void 0),c.__privateAdd.call(void 0,this,a,void 0),c.__privateAdd.call(void 0,this,n,void 0),c.__privateAdd.call(void 0,this,s,void 0),c.__privateSet.call(void 0,this,n,new Map),c.__privateSet.call(void 0,this,s,new Map),c.__privateSet.call(void 0,this,r,e),this._handleSnapRegisterEvent=this._handleSnapRegisterEvent.bind(this),this._handleSnapUnregisterEvent=this._handleSnapUnregisterEvent.bind(this),this._handleEventSnapUpdated=this._handleEventSnapUpdated.bind(this),this.messagingSystem.subscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapEnabled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapDisabled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),this.dailyCheckIn().catch((e=>{h.logError.call(void 0,e)}))}getAllJobs(){const e=this.messagingSystem.call("SnapController:getAll");return o.getRunnableSnaps.call(void 0,e).map((e=>this.getSnapJobs(e.id))).flat().filter((e=>void 0!==e))}getSnapJobs(e){const t=c.__privateGet.call(void 0,this,r).call("PermissionController:getPermissions",e),i=t?.[u.SnapEndowments.Cronjob],a=u.getCronjobCaveatJobs.call(void 0,i);return a?.map(((t,i)=>({...t,id:`${e}-${i}`,snapId:e})))}register(e){const t=this.getSnapJobs(e);t?.forEach((e=>this.schedule(e)))}schedule(e){if(c.__privateGet.call(void 0,this,n).has(e.id))return;const t=h.parseCronExpression.call(void 0,e.expression).next(),i=new Date,r=t.getTime()-i.getTime();if(r>m)return;const a=new(0,l.Timer)(r);a.start((()=>{this.executeCronjob(e).catch((e=>{h.logError.call(void 0,e)})),c.__privateGet.call(void 0,this,n).delete(e.id),this.schedule(e)})),this.state.jobs[e.id]?.lastRun||this.updateJobLastRunState(e.id,0),c.__privateGet.call(void 0,this,n).set(e.id,a),c.__privateGet.call(void 0,this,s).set(e.id,e.snapId)}async executeCronjob(e){this.updateJobLastRunState(e.id,Date.now()),await c.__privateGet.call(void 0,this,r).call("SnapController:handleRequest",{snapId:e.snapId,origin:"",handler:h.HandlerType.OnCronjob,request:e.request})}unregister(e){const t=[...c.__privateGet.call(void 0,this,s).entries()].filter((([t,i])=>i===e));t.length&&t.forEach((([e])=>{const t=c.__privateGet.call(void 0,this,n).get(e);t&&(t.cancel(),c.__privateGet.call(void 0,this,n).delete(e),c.__privateGet.call(void 0,this,s).delete(e))}))}updateJobLastRunState(e,t){this.update((i=>{i.jobs[e]={lastRun:t}}))}async dailyCheckIn(){const e=this.getAllJobs();for(const t of e){const e=h.parseCronExpression.call(void 0,t.expression),i=this.state.jobs[t.id]?.lastRun;void 0!==i&&e.hasPrev()&&e.prev().getTime()>i&&await this.executeCronjob(t),this.schedule(t)}c.__privateSet.call(void 0,this,a,new(0,l.Timer)(m)),c.__privateGet.call(void 0,this,a).start((()=>{this.dailyCheckIn().catch((e=>{h.logError.call(void 0,e)}))}))}destroy(){super.destroy(),this.messagingSystem.unsubscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapEnabled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapDisabled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),c.__privateGet.call(void 0,this,s).forEach((e=>{this.unregister(e)}))}_handleSnapRegisterEvent(e){this.register(e.id)}_handleSnapUnregisterEvent(e){this.unregister(e.id)}_handleEventSnapUpdated(e){this.unregister(e.id),this.register(e.id)}};r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,i.DAILY_TIMEOUT=m,i.CronjobController=f}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-GRBWVPLF.js"}],[1929,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-HOY6NKQR.js"}],[193,{"../../../shared/constants/network":4436,"bignumber.js":2888,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,a=e("lodash"),n=(r=e("bignumber.js"))&&r.__esModule?r:{default:r},s=e("../../../shared/constants/network");const o=e=>new n.default(e||"0x0",16).gt(0),l=["0x3","0x2a","0x4"],c={"0x3":{rpcUrl:(0,s.getRpcUrl)({network:"ropsten"}),nickname:"Ropsten",ticker:"RopstenETH"},"0x2a":{rpcUrl:(0,s.getRpcUrl)({network:"kovan"}),nickname:"Kovan",ticker:"KovanETH"},"0x4":{rpcUrl:(0,s.getRpcUrl)({network:"rinkeby"}),nickname:"Rinkeby",ticker:"RinkebyETH"}};i.default={version:74,async migrate(e){const t=(0,a.cloneDeep)(e);t.meta.version=74;const i=function(e){var t,i;const r=(null==e?void 0:e.PreferencesController)||{},n=r.preferences||{},s=(null==e?void 0:e.NetworkController)||{},d=(null==s?void 0:s.provider)||{},u=l.filter((e=>e===(null==d?void 0:d.chainId)));if(!n.showTestNetworks&&0===u.length)return e;const h=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},p=(null===(i=e.CachedBalancesController)||void 0===i?void 0:i.cachedBalances)||{},m=Object.values(h).filter((({chainId:e})=>l.includes(e))).map((({chainId:e})=>e)),f=l.filter((e=>Object.values(p[e]||{}).some(o))),v=(0,a.uniq)([...f,...m,...u]),g=r.frequentRpcListDetail??[];v.forEach((e=>{g.find((t=>t.chainId===e))||g.unshift({rpcUrl:c[e].rpcUrl,chainId:e,ticker:c[e].ticker,nickname:c[e].nickname,rpcPrefs:{}})})),g.length&&(r.frequentRpcListDetail=g);if(u.length){const e=u[0];s.provider={...s.provider,type:"rpc",rpcUrl:c[e].rpcUrl,chainId:e,nickname:c[e].nickname,ticker:c[e].ticker}}return{...e,PreferencesController:{...r},NetworkController:{...s}}}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/074.js"}],[1930,{"./chunk-7Y6P5FRN.js":1919,"./chunk-EXN2TFDJ.js":1926,"./chunk-S775IABY.js":1940,"@metamask/post-message-stream":1624,"@metamask/snaps-utils":2118,"@metamask/utils":2255,nanoid:1986},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n=e("./chunk-S775IABY.js"),s=e("./chunk-7Y6P5FRN.js"),o=e("./chunk-EXN2TFDJ.js"),l=e("@metamask/post-message-stream"),c=e("@metamask/snaps-utils"),d=e("@metamask/utils"),u=e("nanoid"),h="snaps-worker-pool",p=class extends n.AbstractExecutionService{constructor({documentUrl:e,messenger:t,setupSnapProvider:i}){super({messenger:t,setupSnapProvider:i}),o.__privateAdd.call(void 0,this,r,void 0),o.__privateAdd.call(void 0,this,a,void 0),o.__privateSet.call(void 0,this,r,e)}async terminateJob(e){d.assert.call(void 0,o.__privateGet.call(void 0,this,a),"Runtime stream not initialized."),o.__privateGet.call(void 0,this,a).write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:u.nanoid.call(void 0)}})}async initEnvStream(e){await this.createDocument(),d.assert.call(void 0,o.__privateGet.call(void 0,this,a),"Runtime stream not initialized.");return{worker:e,stream:new(0,s.ProxyPostMessageStream)({stream:o.__privateGet.call(void 0,this,a),jobId:e})}}async createDocument(){if(document.getElementById(h))return;const e=await c.createWindow.call(void 0,o.__privateGet.call(void 0,this,r).href,h,!1);o.__privateSet.call(void 0,this,a,new(0,l.WindowPostMessageStream)({name:"parent",target:"child",targetWindow:e,targetOrigin:"*"}))}};r=new WeakMap,a=new WeakMap,i.WORKER_POOL_ID=h,i.WebWorkerExecutionService=p}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-HQ6HMINL.js"}],[1931,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-JAUAKTUL.js"}],[1932,{"@metamask/snaps-rpc-methods":2041},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/snaps-rpc-methods"),a=Object.freeze(["snap_dialog","snap_manageState","snap_notify","snap_getLocale",r.SnapEndowments.Cronjob,r.SnapEndowments.HomePage,r.SnapEndowments.LifecycleHooks,r.SnapEndowments.EthereumProvider,r.SnapEndowments.TransactionInsight,r.SnapEndowments.SignatureInsight]);i.ALLOWED_PERMISSIONS=a,i.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS={algorithm:"PBKDF2",params:{iterations:1e4}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-JQ54YYLU.js"}],[1933,{"./chunk-7Y6P5FRN.js":1919,"./chunk-EXN2TFDJ.js":1926,"./chunk-S775IABY.js":1940,nanoid:1986},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-S775IABY.js"),n=e("./chunk-7Y6P5FRN.js"),s=e("./chunk-EXN2TFDJ.js"),o=e("nanoid"),l=class extends a.AbstractExecutionService{constructor({stream:e,messenger:t,setupSnapProvider:i}){super({messenger:t,setupSnapProvider:i,usePing:!1}),s.__privateAdd.call(void 0,this,r,void 0),s.__privateSet.call(void 0,this,r,e)}async terminateJob(e){s.__privateGet.call(void 0,this,r).write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:o.nanoid.call(void 0)}})}async initEnvStream(e){const t=new(0,n.ProxyPostMessageStream)({stream:s.__privateGet.call(void 0,this,r),jobId:e});return await new Promise((e=>{t.once("data",e),t.write({name:"command",data:{jsonrpc:"2.0",method:"ping",id:o.nanoid.call(void 0)}})})),{worker:e,stream:t}}};r=new WeakMap,i.ProxyExecutionService=l}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-KH72WRHR.js"}],[1934,{"./chunk-EXN2TFDJ.js":1926,"./chunk-RDBT3ZJQ.js":1939,"@metamask/snaps-utils":2118,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-RDBT3ZJQ.js"),n=e("./chunk-EXN2TFDJ.js"),s=e("@metamask/snaps-utils"),o=e("@metamask/utils");function l(e){return o.assert.call(void 0,void 0!==e.data.canonicalPath),e.data.canonicalPath=`local:${e.data.canonicalPath}`,e}r=new WeakMap,i.LocalLocation=class{constructor(e,t={}){n.__privateAdd.call(void 0,this,r,void 0),o.assertStruct.call(void 0,e.toString(),s.LocalSnapIdStruct,"Invalid Snap Id"),o.assert.call(void 0,void 0===t.fetchOptions,"Currently adding fetch options to local: is unsupported."),n.__privateSet.call(void 0,this,r,new(0,a.HttpLocation)(new URL(e.toString().slice(s.SnapIdPrefixes.local.length)),{...t,fetchOptions:{cache:"no-cache"}}))}async manifest(){return l(await n.__privateGet.call(void 0,this,r).manifest())}async fetch(e){return l(await n.__privateGet.call(void 0,this,r).fetch(e))}get shouldAlwaysReload(){return!0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-LWBPKSU2.js"}],[1935,{"@metamask/snaps-utils":2118,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/snaps-utils"),a=e("@metamask/utils").createModuleLogger.call(void 0,r.snapsLogger,"snaps-controllers");i.log=a}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-NXZVKBSV.js"}],[1936,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-OHMCPTOI.js"}],[1937,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-OIEUL55W.js"}],[1938,{"./chunk-LWBPKSU2.js":1934,"./chunk-RDBT3ZJQ.js":1939,"./chunk-XWDEGRM5.js":1944,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LWBPKSU2.js"),a=e("./chunk-XWDEGRM5.js"),n=e("./chunk-RDBT3ZJQ.js"),s=e("@metamask/utils");i.detectSnapLocation=function(e,t){const i=t?.allowHttp??!1,o=t?.allowLocal??!1,l=new URL(e);switch(l.protocol){case"npm:":return new(0,a.NpmLocation)(l,t);case"local:":return s.assert.call(void 0,o,new TypeError("Fetching local snaps is disabled.")),new(0,r.LocalLocation)(l,t);case"http:":case"https:":return s.assert.call(void 0,i,new TypeError("Fetching snaps through http/https is disabled.")),new(0,n.HttpLocation)(l,t);default:throw new TypeError(`Unrecognized "${l.protocol}" snap location protocol.`)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-PT22IXNS.js"}],[1939,{"@metamask/snaps-utils":2118,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/snaps-utils"),a=e("@metamask/utils");i.HttpLocation=class{constructor(e,t={}){this.cache=new Map,a.assertStruct.call(void 0,e.toString(),r.HttpSnapIdStruct,"Invalid Snap Id: "),this.fetchFn=t.fetch??globalThis.fetch.bind(globalThis),this.fetchOptions=t.fetchOptions,this.url=e}async manifest(){if(this.validatedManifest)return this.validatedManifest.clone();const e=new URL(r.NpmSnapFileNames.Manifest,this.url).toString(),t=await this.fetchFn(e,this.fetchOptions);if(!t.ok)throw new Error(`Failed to fetch "${e}". Status code: ${t.status}.`);const i=await t.text(),a=r.parseJson.call(void 0,i),n=new(0,r.VirtualFile)({value:i,result:r.createSnapManifest.call(void 0,a),path:r.NpmSnapFileNames.Manifest,data:{canonicalPath:e}});return this.validatedManifest=n,this.manifest()}async fetch(e){const t=r.normalizeRelative.call(void 0,e),i=this.cache.get(t);if(void 0!==i){const{file:e,contents:t}=i,r=new Uint8Array(await t.arrayBuffer()),a=e.clone();return a.value=r,a}const n=this.toCanonical(t).toString(),s=await this.fetchFn(n,this.fetchOptions);if(!s.ok)throw new Error(`Failed to fetch "${n}". Status code: ${s.status}.`);const o=new(0,r.VirtualFile)({value:"",path:t,data:{canonicalPath:n}}),l=await s.blob();return a.assert.call(void 0,!this.cache.has(t),"Corrupted cache, multiple files with same path."),this.cache.set(t,{file:o,contents:l}),this.fetch(t)}get root(){return new URL(this.url)}toCanonical(e){return a.assert.call(void 0,!e.startsWith("/"),"Tried to parse absolute path."),new URL(e,this.url)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-RDBT3ZJQ.js"}],[194,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:75,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=75;const i=function(e){return delete e.ThreeBoxController,e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/075.js"}],[1940,{"./chunk-BOFPNIRX.js":1922,"./chunk-CDTGUNSA.js":1923,"./chunk-EXN2TFDJ.js":1926,"./chunk-NXZVKBSV.js":1935,"@metamask/json-rpc-engine":1968,"@metamask/json-rpc-middleware-stream":1971,"@metamask/object-multiplex":1560,"@metamask/rpc-errors":1672,"@metamask/snaps-utils":2118,"@metamask/utils":2255,nanoid:1986,"readable-stream":4188},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w=e("./chunk-NXZVKBSV.js"),y=e("./chunk-CDTGUNSA.js"),T=e("./chunk-BOFPNIRX.js"),b=e("./chunk-EXN2TFDJ.js"),E=e("@metamask/json-rpc-engine"),S=e("@metamask/json-rpc-middleware-stream"),P=e("@metamask/object-multiplex"),C=(r=P)&&r.__esModule?r:{default:r},A=e("@metamask/rpc-errors"),I=e("@metamask/snaps-utils"),j=e("@metamask/utils"),M=e("nanoid"),x=e("readable-stream"),N="ExecutionService";function R(e,t){const i=new(0,C.default);return x.pipeline.call(void 0,e,i,e,(e=>{e&&(t?I.logError.call(void 0,`"${t}" stream failure.`,e):I.logError.call(void 0,e))})),i}a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakSet,p=function(e){b.__privateGet.call(void 0,this,a).delete(e)},m=new WeakSet,f=function(e,t){b.__privateGet.call(void 0,this,a).set(e,(async({origin:i,handler:r,request:a})=>await this.command(t,{id:M.nanoid.call(void 0),jsonrpc:"2.0",method:"snapRpc",params:{origin:i,handler:r,request:a,target:e}})))},v=new WeakSet,g=function(e,t){b.__privateGet.call(void 0,this,n).set(e,t),b.__privateGet.call(void 0,this,s).set(t,e)},_=new WeakSet,k=function(e){const t=b.__privateGet.call(void 0,this,s).get(e);if(!t)throw new Error(`job: "${e}" has no mapped snap.`);b.__privateGet.call(void 0,this,s).delete(e),b.__privateGet.call(void 0,this,n).delete(t),b.__privateMethod.call(void 0,this,h,p).call(this,t)},i.AbstractExecutionService=class{constructor({setupSnapProvider:e,messenger:t,initTimeout:i=j.inMilliseconds.call(void 0,60,j.Duration.Second),pingTimeout:r=j.inMilliseconds.call(void 0,2,j.Duration.Second),terminationTimeout:p=j.inMilliseconds.call(void 0,1,j.Duration.Second),usePing:f=!0}){b.__privateAdd.call(void 0,this,h),b.__privateAdd.call(void 0,this,m),b.__privateAdd.call(void 0,this,v),b.__privateAdd.call(void 0,this,_),b.__privateAdd.call(void 0,this,a,void 0),b.__privateAdd.call(void 0,this,n,void 0),b.__privateAdd.call(void 0,this,s,void 0),b.__privateAdd.call(void 0,this,o,void 0),b.__privateAdd.call(void 0,this,l,void 0),b.__privateAdd.call(void 0,this,c,void 0),b.__privateAdd.call(void 0,this,d,void 0),b.__privateAdd.call(void 0,this,u,void 0),b.__privateSet.call(void 0,this,a,new Map),this.jobs=new Map,this.setupSnapProvider=e,b.__privateSet.call(void 0,this,n,new Map),b.__privateSet.call(void 0,this,s,new Map),b.__privateSet.call(void 0,this,o,t),b.__privateSet.call(void 0,this,l,i),b.__privateSet.call(void 0,this,c,r),b.__privateSet.call(void 0,this,d,p),b.__privateSet.call(void 0,this,u,f),this.registerMessageHandlers()}registerMessageHandlers(){b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:handleRpcRequest`,(async(e,t)=>this.handleRpcRequest(e,t))),b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:executeSnap`,(async e=>this.executeSnap(e))),b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:terminateSnap`,(async e=>this.terminateSnap(e))),b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:terminateAllSnaps`,(async()=>this.terminateAllSnaps()))}async terminate(e){const t=this.jobs.get(e);if(!t)throw new Error(`Job with id "${e}" not found.`);try{const t=await y.withTimeout.call(void 0,this.command(e,{jsonrpc:"2.0",method:"terminate",params:[],id:M.nanoid.call(void 0)}),b.__privateGet.call(void 0,this,d));t!==y.hasTimedOut&&"OK"===t||I.logError.call(void 0,`Job "${e}" failed to terminate gracefully.`,t)}catch{}Object.values(t.streams).forEach((e=>{try{!e.destroyed&&e.destroy(),e.removeAllListeners()}catch(e){I.logError.call(void 0,"Error while destroying stream",e)}})),this.terminateJob(t),this.jobs.delete(e),b.__privateMethod.call(void 0,this,_,k).call(this,e),w.log.call(void 0,`Job "${e}" terminated.`)}async initJob(e,t){const{streams:i,worker:r}=await this.initStreams(e,t),a=new(0,E.JsonRpcEngine),n=S.createStreamMiddleware.call(void 0);x.pipeline.call(void 0,n.stream,i.command,n.stream,(e=>{e&&I.logError.call(void 0,"Command stream failure.",e)})),a.push(n.middleware);const s={id:e,streams:i,rpcEngine:a,worker:r};return this.jobs.set(e,s),s}async initStreams(e,t){const i=await y.withTimeout.call(void 0,this.initEnvStream(e),t);if(i===y.hasTimedOut)throw this.terminateJob({id:e}),new Error("The Snaps execution environment failed to start.");const{worker:r,stream:a}=i,n=R(a,`Job: "${e}"`),l=n.createStream(I.SNAP_STREAM_NAMES.COMMAND),c=t=>{if(!j.isJsonRpcNotification.call(void 0,t))return;const i=b.__privateGet.call(void 0,this,s).get(e);"OutboundRequest"===t.method?b.__privateGet.call(void 0,this,o).publish("ExecutionService:outboundRequest",i):"OutboundResponse"===t.method?b.__privateGet.call(void 0,this,o).publish("ExecutionService:outboundResponse",i):"UnhandledError"===t.method?j.isObject.call(void 0,t.params)&&t.params.error?(b.__privateGet.call(void 0,this,o).publish("ExecutionService:unhandledError",i,t.params.error),l.removeListener("data",c)):I.logError.call(void 0,new Error(`Received malformed "${t.method}" command stream notification.`)):I.logError.call(void 0,new Error(`Received unexpected command stream notification "${t.method}".`))};l.on("data",c);const d=n.createStream(I.SNAP_STREAM_NAMES.JSON_RPC);return{streams:{command:l,rpc:d,_connection:a},worker:r}}async terminateSnap(e){const t=b.__privateGet.call(void 0,this,n).get(e);t&&await this.terminate(t)}async terminateAllSnaps(){await Promise.all([...this.jobs.keys()].map((async e=>this.terminate(e)))),b.__privateGet.call(void 0,this,a).clear()}getRpcRequestHandler(e){return b.__privateGet.call(void 0,this,a).get(e)}async executeSnap({snapId:e,sourceCode:t,endowments:i}){if(b.__privateGet.call(void 0,this,n).has(e))throw new Error(`Snap "${e}" is already being executed.`);const r=M.nanoid.call(void 0),a=new(0,T.Timer)(b.__privateGet.call(void 0,this,l)),s=await this.initJob(r,a);if(b.__privateMethod.call(void 0,this,v,g).call(this,e,s.id),b.__privateGet.call(void 0,this,u)){if(await y.withTimeout.call(void 0,this.command(s.id,{jsonrpc:"2.0",method:"ping",id:M.nanoid.call(void 0)}),b.__privateGet.call(void 0,this,c))===y.hasTimedOut)throw new Error("The Snaps execution environment failed to start.")}const o=s.streams.rpc;this.setupSnapProvider(e,o);const d=a.remaining,h=await y.withTimeout.call(void 0,this.command(s.id,{jsonrpc:"2.0",method:"executeSnap",params:{snapId:e,sourceCode:t,endowments:i},id:M.nanoid.call(void 0)}),d);if(h===y.hasTimedOut)throw new Error(`${e} failed to start.`);return b.__privateMethod.call(void 0,this,m,f).call(this,e,s.id),h}async command(e,t){j.assertIsJsonRpcRequest.call(void 0,t);const i=this.jobs.get(e);if(!i)throw new Error(`Job with id "${e}" not found.`);w.log.call(void 0,"Parent: Sending Command",t);const r=await i.rpcEngine.handle(t);if(r.error)throw new(0,A.JsonRpcError)(r.error.code,r.error.message,r.error.data);return r.result}async handleRpcRequest(e,t){const i=this.getRpcRequestHandler(e);if(!i)throw new Error(`Snap execution service returned no RPC handler for running snap "${e}".`);return i(t)}},i.setupMultiplex=R}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-S775IABY.js"}],[1941,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-VNOCJWOK.js"}],[1942,{"@metamask/snaps-sdk":2077,"@metamask/snaps-sdk/jsx":2081,"@metamask/snaps-utils":2118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/snaps-sdk"),a=e("@metamask/snaps-sdk/jsx"),n=e("@metamask/snaps-utils");function s(e,t){r.assert.call(void 0,void 0===e[t],`Duplicate component names are not allowed, found multiple instances of: "${t}".`)}function o(e){if("Dropdown"===e.type){const t=n.getJsxChildren.call(void 0,e);return t[0]?.props.value}return null}function l(e,t,i,r){if("Button"===t.type)return r;const a=(n=t,Array.isArray(n.props.children)?n.props.children[0]:n.props.children);var n;return s(r,a.props.name),r[a.props.name]=function(e,t,i){const r=e[i],a=r?.[t.props.name];return t.props.value??a??o(t)??null}(e,a,i),r}var c=1e6;i.getJsxInterface=function(e){return a.isJSXElementUnsafe.call(void 0,e)?e:n.getJsxElementFromComponent.call(void 0,e)},i.assertNameIsUnique=s,i.constructState=function e(t,i,r={}){if("Box"===i.type){return n.getJsxChildren.call(void 0,i).reduce(((i,r)=>e(t,r,i)),r)}if("Form"===i.type){s(r,i.props.name);const e=n.getJsxChildren.call(void 0,i);return r[i.props.name]=e.reduce(((e,r)=>l(t,r,i.props.name,e)),{}),r}return"Input"!==i.type&&"Dropdown"!==i.type||(s(r,i.props.name),r[i.props.name]=function(e,t){return t.props.value??e[t.props.name]??o(t)??null}(t,i)),r},i.validateInterfaceContext=function(e){if(!e)return;const t=n.getJsonSizeUnsafe.call(void 0,e);r.assert.call(void 0,t<=c,"A Snap interface context may not be larger than 1 MB.")}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-WCDDYBFW.js"}],[1943,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-WEY7ICES.js"}],[1944,{"./chunk-EXN2TFDJ.js":1926,"@metamask/snaps-utils":2118,"@metamask/utils":2255,"browserify-zlib":2977,"concat-stream":1985,"get-npm-tarball-url":3357,"readable-stream":4188,"readable-web-to-node-stream":4189,"tar-stream":4292},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a,n,s,o,l=e("./chunk-EXN2TFDJ.js"),c=e("@metamask/snaps-utils"),d=e("@metamask/utils"),u=e("browserify-zlib"),h=r(e("concat-stream")),p=r(e("get-npm-tarball-url")),m=e("readable-stream"),f=e("readable-web-to-node-stream"),v=e("tar-stream"),g=new URL("https://registry.npmjs.org"),_=class{constructor(e,t={}){l.__privateAdd.call(void 0,this,s),l.__privateAdd.call(void 0,this,a,void 0),l.__privateAdd.call(void 0,this,n,void 0);const i=t.allowCustomRegistries??!1,r=t.fetch??globalThis.fetch.bind(globalThis),o=t.versionRange??c.DEFAULT_REQUESTED_SNAP_VERSION,u=t.resolveVersion??(async e=>e);let h;d.assertStruct.call(void 0,e.toString(),c.NpmSnapIdStruct,"Invalid Snap Id: "),""===e.host&&""===e.port&&""===e.username&&""===e.password?h=g:(h="https://",e.username&&(h+=e.username,e.password&&(h+=`:${e.password}`),h+="@"),h+=e.host,h=new URL(h),d.assert.call(void 0,i,new TypeError(`Custom NPM registries are disabled, tried to use "${h.toString()}".`))),d.assert.call(void 0,"/"===h.pathname&&""===h.search&&""===h.hash),d.assert.call(void 0,""!==e.pathname&&"/"!==e.pathname,new TypeError("The package name in NPM location is empty."));let p=e.pathname;p.startsWith("/")&&(p=p.slice(1)),this.meta={requestedRange:o,registry:h,packageName:p,fetch:r,resolveVersion:u}}async manifest(){if(l.__privateGet.call(void 0,this,a))return l.__privateGet.call(void 0,this,a).clone();const e=await this.fetch("snap.manifest.json"),t=c.parseJson.call(void 0,e.toString());return e.result=c.createSnapManifest.call(void 0,t),l.__privateSet.call(void 0,this,a,e),this.manifest()}async fetch(e){const t=c.normalizeRelative.call(void 0,e);l.__privateGet.call(void 0,this,n)||(await l.__privateMethod.call(void 0,this,s,o).call(this),d.assert.call(void 0,void 0!==l.__privateGet.call(void 0,this,n)));const i=l.__privateGet.call(void 0,this,n).get(t);return d.assert.call(void 0,void 0!==i,new TypeError(`File "${e}" not found in package.`)),i.clone()}get packageName(){return this.meta.packageName}get version(){return d.assert.call(void 0,void 0!==this.meta.version,"Tried to access version without first fetching NPM package."),this.meta.version}get registry(){return this.meta.registry}get versionRange(){return this.meta.requestedRange}};a=new WeakMap,n=new WeakMap,s=new WeakSet,o=async function(){d.assert.call(void 0,void 0===l.__privateGet.call(void 0,this,n));const e=await this.meta.resolveVersion(this.meta.requestedRange),{tarballURL:t,targetVersion:i}=await async function(e,t,i,r){if(T(i)&&d.isValidSemVerVersion.call(void 0,t))return{tarballURL:p.default.call(void 0,e,t),targetVersion:t};const a=await w(e,i,r),n=Object.keys(a?.versions??{}).map((e=>(d.assertIsSemVerVersion.call(void 0,e),e))),s=c.getTargetVersion.call(void 0,n,t);if(null===s)throw new Error(`Failed to find a matching version in npm metadata for package "${e}" and requested semver range "${t}".`);const o=a?.versions?.[s]?.dist?.tarball;return{tarballURL:o,targetVersion:s}}(this.meta.packageName,e,this.meta.registry,this.meta.fetch);if(!c.isValidUrl.call(void 0,t)||!t.toString().endsWith(".tgz"))throw new Error(`Failed to find valid tarball URL in NPM metadata for package "${this.meta.packageName}".`);const r=new URL(t);r.hostname=this.meta.registry.hostname,r.protocol=this.meta.registry.protocol;const a=await this.fetchNpmTarball(r);l.__privateSet.call(void 0,this,n,a),this.meta.version=i};var k=262144e3;async function w(e,t,i){const r=await i(new URL(e,t).toString(),{headers:{accept:T(t)?"application/vnd.npm.install-v1+json; q=1.0, application/json; q=0.8, */*":"application/json"}});if(!r.ok)throw new Error(`Failed to fetch NPM registry entry. Status code: ${r.status}.`);const a=await r.json();if(!d.isObject.call(void 0,a))throw new Error(`Failed to fetch package "${e}" metadata from npm.`);return a}function y(e,t){let i="npm://";return""!==e.username&&(i+=e.username,""!==e.password&&(i+=`:${e.password}`),i+="@"),`${i}${e.host}/${t}/`}function T(e){return e.toString()===g.toString()}var b=/^package\//u;function E(e){return"function"!=typeof e.getReader?e:new(0,f.ReadableWebToNodeStream)(e)}i.DEFAULT_NPM_REGISTRY=g,i.BaseNpmLocation=_,i.TARBALL_SIZE_SAFETY_LIMIT=k,i.NpmLocation=class extends _{async fetchNpmTarball(e){const t=await this.meta.fetch(e.toString());if(!t.ok||!t.body)throw new Error(`Failed to fetch tarball for package "${this.meta.packageName}".`);const i=t.headers.get("content-length");d.assert.call(void 0,i,"Snap tarball has invalid content-length");const r=parseInt(i,10);return d.assert.call(void 0,r<=k,"Snap tarball exceeds size limit"),new Promise(((e,i)=>{const r=new Map,a=function(e,t){d.assert.call(void 0,e.endsWith("/"),"Base needs to end with '/' for relative paths to be added as children instead of siblings."),d.assert.call(void 0,e.startsWith("npm:"),'Protocol mismatch, expected "npm:".');const i=v.extract.call(void 0);let r=0;return i.on("entry",((a,n,s)=>{const{name:o,type:l}=a;if("file"===l){const a=o.replace(b,"");return n.pipe(h.default.call(void 0,{encoding:"uint8array"},(n=>{try{r+=n.byteLength,d.assert.call(void 0,r<k,"Snap tarball exceeds limit of 262144000 bytes.");const i=new(0,c.VirtualFile)({value:n,path:a,data:{canonicalPath:new URL(a,e).toString()}});return d.assert.call(void 0,!t.has(a),"Malformed tarball, multiple files with the same path."),t.set(a,i),s()}catch(e){return i.destroy(e)}})))}return n.on("end",(()=>s())),n.resume()})),i}(y(this.meta.registry,this.meta.packageName),r),n=t.body;if("pipeThrough"in n&&"DecompressionStream"in globalThis){const t=new DecompressionStream("gzip"),s=n.pipeThrough(t);m.pipeline.call(void 0,E(s),a,(t=>{t?i(t):e(r)}))}else m.pipeline.call(void 0,E(n),u.createGunzip.call(void 0),a,(t=>{t?i(t):e(r)}))}))}},i.fetchNpmMetadata=w,i.getNpmCanonicalBasePath=y}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-XWDEGRM5.js"}],[1945,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});i.getRunnableSnaps=e=>e.filter((e=>e.enabled&&!e.blocked))}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-YYPUPKQY.js"}],[1946,{"./chunk-AP7CJ6DA.js":1920,"./chunk-BO2ZDPWV.js":1921,"./chunk-BOFPNIRX.js":1922,"./chunk-CDTGUNSA.js":1923,"./chunk-EXN2TFDJ.js":1926,"./chunk-JQ54YYLU.js":1932,"./chunk-NXZVKBSV.js":1935,"./chunk-PT22IXNS.js":1938,"@metamask/base-controller":1954,"@metamask/permission-controller":1984,"@metamask/rpc-errors":1672,"@metamask/snaps-rpc-methods":2041,"@metamask/snaps-sdk":2077,"@metamask/snaps-utils":2118,"@metamask/utils":2255,"@xstate/fsm":2600,nanoid:1986},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-PT22IXNS.js"),a=e("./chunk-AP7CJ6DA.js"),n=e("./chunk-JQ54YYLU.js"),s=e("./chunk-BO2ZDPWV.js"),o=e("./chunk-NXZVKBSV.js"),l=e("./chunk-CDTGUNSA.js"),c=e("./chunk-BOFPNIRX.js"),d=e("./chunk-EXN2TFDJ.js"),u=e("@metamask/base-controller"),h=e("@metamask/permission-controller"),p=e("@metamask/rpc-errors"),m=e("@metamask/snaps-rpc-methods"),f=e("@metamask/snaps-sdk"),v=e("@metamask/snaps-utils"),g=e("@metamask/utils"),_=e("@xstate/fsm"),k=e("nanoid"),w="SnapController",y="wallet_installSnap",T="wallet_updateSnap",b="wallet_installSnapResult",E=new Set(["initialPermissions","id","version","enabled","blocked"]),S={snaps:{},snapStates:{},unencryptedSnapStates:{}};function P(e){return Object.keys(e).reduce(((t,i)=>(E.has(i)&&(t[i]=e[i]),t)),{})}var C,A,I,j,M,x,N,R,O,G,L,B,F,D,U,H,W,$,V,K,Y,q,X,J,z,Z,Q,ee,te,ie,re,ae,ne,se,oe,le,ce,de,ue,he,pe,me,fe,ve,ge,_e,ke,we,ye,Te,be,Ee,Se,Pe,Ce,Ae,Ie,je,Me,xe,Ne,Re,Oe,Ge,Le,Be,Fe,De,Ue,He,We,$e,Ve,Ke,Ye,qe,Xe,Je,ze,Ze,Qe,et,tt,it,rt,at,nt,st,ot,lt,ct,dt,ut,ht,pt,mt,ft,vt,gt,_t,kt,wt,yt,Tt,bt,Et,St,Pt=class extends u.BaseController{constructor({closeAllConnections:e,messenger:t,state:i,dynamicPermissions:a=["eth_accounts"],environmentEndowmentPermissions:n=[],excludedPermissions:s={},idleTimeCheckInterval:o=g.inMilliseconds.call(void 0,5,g.Duration.Second),maxIdleTime:l=g.inMilliseconds.call(void 0,30,g.Duration.Second),maxRequestTime:c=g.inMilliseconds.call(void 0,60,g.Duration.Second),fetchFunction:u=globalThis.fetch.bind(globalThis),featureFlags:h={},detectSnapLocation:p=r.detectSnapLocation,preinstalledSnaps:m=null,encryptor:_,getMnemonic:k,getFeatureFlags:w=(()=>({}))}){super({messenger:t,metadata:{snapStates:{persist:!0,anonymous:!1},unencryptedSnapStates:{persist:!0,anonymous:!1},snaps:{persist:e=>Object.values(e).filter((e=>e.status!==v.SnapStatus.Installing)).map((e=>({...e,status:v.SnapStatus.Stopped}))).reduce(((e,t)=>(e[t.id]=t,e)),{}),anonymous:!1}},name:"SnapController",state:{...S,...i}}),d.__privateAdd.call(void 0,this,$),d.__privateAdd.call(void 0,this,K),d.__privateAdd.call(void 0,this,q),d.__privateAdd.call(void 0,this,J),d.__privateAdd.call(void 0,this,Z),d.__privateAdd.call(void 0,this,ee),d.__privateAdd.call(void 0,this,ie),d.__privateAdd.call(void 0,this,ae),d.__privateAdd.call(void 0,this,se),d.__privateAdd.call(void 0,this,le),d.__privateAdd.call(void 0,this,de),d.__privateAdd.call(void 0,this,he),d.__privateAdd.call(void 0,this,me),d.__privateAdd.call(void 0,this,ve),d.__privateAdd.call(void 0,this,_e),d.__privateAdd.call(void 0,this,we),d.__privateAdd.call(void 0,this,Te),d.__privateAdd.call(void 0,this,Ee),d.__privateAdd.call(void 0,this,Pe),d.__privateAdd.call(void 0,this,Ae),d.__privateAdd.call(void 0,this,je),d.__privateAdd.call(void 0,this,xe),d.__privateAdd.call(void 0,this,Re),d.__privateAdd.call(void 0,this,Ge),d.__privateAdd.call(void 0,this,Be),d.__privateAdd.call(void 0,this,De),d.__privateAdd.call(void 0,this,He),d.__privateAdd.call(void 0,this,$e),d.__privateAdd.call(void 0,this,Ke),d.__privateAdd.call(void 0,this,qe),d.__privateAdd.call(void 0,this,Je),d.__privateAdd.call(void 0,this,Ze),d.__privateAdd.call(void 0,this,et),d.__privateAdd.call(void 0,this,it),d.__privateAdd.call(void 0,this,at),d.__privateAdd.call(void 0,this,st),d.__privateAdd.call(void 0,this,lt),d.__privateAdd.call(void 0,this,dt),d.__privateAdd.call(void 0,this,ht),d.__privateAdd.call(void 0,this,mt),d.__privateAdd.call(void 0,this,vt),d.__privateAdd.call(void 0,this,_t),d.__privateAdd.call(void 0,this,wt),d.__privateAdd.call(void 0,this,Tt),d.__privateAdd.call(void 0,this,Et),d.__privateAdd.call(void 0,this,C,void 0),d.__privateAdd.call(void 0,this,A,void 0),d.__privateAdd.call(void 0,this,I,void 0),d.__privateAdd.call(void 0,this,j,void 0),d.__privateAdd.call(void 0,this,M,void 0),d.__privateAdd.call(void 0,this,x,void 0),d.__privateAdd.call(void 0,this,N,void 0),d.__privateAdd.call(void 0,this,R,void 0),d.__privateAdd.call(void 0,this,O,void 0),d.__privateAdd.call(void 0,this,G,void 0),d.__privateAdd.call(void 0,this,L,void 0),d.__privateAdd.call(void 0,this,B,void 0),d.__privateAdd.call(void 0,this,F,void 0),d.__privateAdd.call(void 0,this,D,void 0),d.__privateAdd.call(void 0,this,U,void 0),d.__privateAdd.call(void 0,this,H,void 0),d.__privateAdd.call(void 0,this,W,void 0),d.__privateSet.call(void 0,this,C,e),d.__privateSet.call(void 0,this,A,a),d.__privateSet.call(void 0,this,I,n),d.__privateSet.call(void 0,this,j,s),d.__privateSet.call(void 0,this,M,h),d.__privateSet.call(void 0,this,x,u),d.__privateSet.call(void 0,this,N,o),d.__privateSet.call(void 0,this,R,l),this.maxRequestTime=c,d.__privateSet.call(void 0,this,B,p),d.__privateSet.call(void 0,this,O,_),d.__privateSet.call(void 0,this,G,k),d.__privateSet.call(void 0,this,L,w),d.__privateSet.call(void 0,this,W,m),this._onUnhandledSnapError=this._onUnhandledSnapError.bind(this),this._onOutboundRequest=this._onOutboundRequest.bind(this),this._onOutboundResponse=this._onOutboundResponse.bind(this),d.__privateSet.call(void 0,this,D,new Map),d.__privateSet.call(void 0,this,F,new Map),d.__privateMethod.call(void 0,this,J,z).call(this),this.messagingSystem.subscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.subscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.subscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.subscribe("SnapController:snapInstalled",(({id:e},t)=>{d.__privateMethod.call(void 0,this,Et,St).call(this,t,e,v.HandlerType.OnInstall).catch((t=>{v.logError.call(void 0,`Error when calling \`onInstall\` lifecycle hook for snap "${e}": ${f.getErrorMessage.call(void 0,t)}`)}))})),this.messagingSystem.subscribe("SnapController:snapUpdated",(({id:e},t,i)=>{d.__privateMethod.call(void 0,this,Et,St).call(this,i,e,v.HandlerType.OnUpdate).catch((t=>{v.logError.call(void 0,`Error when calling \`onUpdate\` lifecycle hook for snap "${e}": ${f.getErrorMessage.call(void 0,t)}`)}))})),d.__privateMethod.call(void 0,this,$,V).call(this),d.__privateMethod.call(void 0,this,K,Y).call(this),d.__privateGet.call(void 0,this,W)&&d.__privateMethod.call(void 0,this,q,X).call(this,d.__privateGet.call(void 0,this,W)),Object.values(this.state?.snaps??{}).forEach((e=>d.__privateMethod.call(void 0,this,vt,gt).call(this,e.id)))}async updateBlockedSnaps(){d.__privateMethod.call(void 0,this,ae,ne).call(this),await this.messagingSystem.call("SnapsRegistry:update");const e=await this.messagingSystem.call("SnapsRegistry:get",Object.values(this.state.snaps).reduce(((e,t)=>(e[t.id]={version:t.version,checksum:t.manifest.source.shasum},e)),{}));await Promise.all(Object.entries(e).map((async([e,{status:t,reason:i}])=>1===t?d.__privateMethod.call(void 0,this,Z,Q).call(this,e,i):d.__privateMethod.call(void 0,this,ee,te).call(this,e))))}_onUnhandledSnapError(e,t){this.stopSnap(e,v.SnapStatusEvents.Crash).catch((e=>{v.logError.call(void 0,e)}))}_onOutboundRequest(e){const t=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);t.pendingInboundRequests.filter((e=>"running"===e.timer.status)).forEach((e=>e.timer.pause())),t.pendingOutboundRequests+=1}_onOutboundResponse(e){const t=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);t.pendingOutboundRequests-=1,0===t.pendingOutboundRequests&&t.pendingInboundRequests.filter((e=>"paused"===e.timer.status)).forEach((e=>e.timer.resume()))}async startSnap(e){d.__privateMethod.call(void 0,this,ae,ne).call(this);const t=this.state.snaps[e];if(!1===t.enabled)throw new Error(`Snap "${e}" is disabled.`);await d.__privateMethod.call(void 0,this,Re,Oe).call(this,{snapId:e,sourceCode:t.sourceCode})}enableSnap(e){if(this.getExpect(e),this.state.snaps[e].blocked)throw new Error(`Snap "${e}" is blocked and cannot be enabled.`);this.update((t=>{t.snaps[e].enabled=!0})),this.messagingSystem.publish("SnapController:snapEnabled",this.getTruncatedExpect(e))}async disableSnap(e){if(!this.has(e))throw new Error(`Snap "${e}" not found.`);this.update((t=>{t.snaps[e].enabled=!1})),this.isRunning(e)&&await this.stopSnap(e,v.SnapStatusEvents.Stop),this.messagingSystem.publish("SnapController:snapDisabled",this.getTruncatedExpect(e))}async stopSnap(e,t=v.SnapStatusEvents.Stop){var i;const r=d.__privateMethod.call(void 0,this,ht,pt).call(this,e);if(!r)throw new Error(`The snap "${e}" is not running.`);if(!r.stopping){r.stopping=!0;try{this.isRunning(e)&&(null==(i=d.__privateGet.call(void 0,this,C))||i.call(this,e),await d.__privateMethod.call(void 0,this,de,ue).call(this,e))}finally{r.lastRequest=null,r.pendingInboundRequests=[],r.pendingOutboundRequests=0,r.stopping=!1,this.isRunning(e)&&d.__privateMethod.call(void 0,this,le,ce).call(this,e,t)}}}isRunning(e){return"running"===this.getExpect(e).status}has(e){return Boolean(this.get(e))}get(e){return this.state.snaps[e]}getExpect(e){const t=this.get(e);return g.assert.call(void 0,void 0!==t,new Error(`Snap "${e}" not found.`)),t}getTruncated(e){const t=this.get(e);return t?P(t):null}getTruncatedExpect(e){return P(this.getExpect(e))}async updateSnapState(e,t,i){if(i){const i=await d.__privateMethod.call(void 0,this,ve,ge).call(this,e,t);this.update((t=>{t.snapStates[e]=i}))}else this.update((i=>{i.unencryptedSnapStates[e]=JSON.stringify(t)}))}clearSnapState(e,t){this.update((i=>{t?i.snapStates[e]=null:i.unencryptedSnapStates[e]=null}))}async getSnapState(e,t){const i=t?this.state.snapStates[e]:this.state.unencryptedSnapStates[e];if(null==i)return null;if(!t)return v.parseJson.call(void 0,i);return await d.__privateMethod.call(void 0,this,me,fe).call(this,e,i)}async getSnapFile(e,t,i=f.AuxiliaryFileEncoding.Base64){const r=this.getExpect(e),a=v.normalizeRelative.call(void 0,t),n=r.auxiliaryFiles?.find((e=>e.path===a))?.value;return n?v.encodeAuxiliaryFile.call(void 0,n,i):null}async clearState(){const e=Object.keys(this.state.snaps);d.__privateGet.call(void 0,this,C)&&e.forEach((e=>{var t;null==(t=d.__privateGet.call(void 0,this,C))||t.call(this,e)})),await this.messagingSystem.call("ExecutionService:terminateAllSnaps"),e.forEach((e=>d.__privateMethod.call(void 0,this,Ee,Se).call(this,e))),this.update((e=>{e.snaps={},e.snapStates={}})),d.__privateGet.call(void 0,this,F).clear(),d.__privateGet.call(void 0,this,W)&&(d.__privateMethod.call(void 0,this,q,X).call(this,d.__privateGet.call(void 0,this,W)),Object.values(this.state?.snaps).forEach((e=>d.__privateMethod.call(void 0,this,vt,gt).call(this,e.id))))}async removeSnap(e){return this.removeSnaps([e])}async removeSnaps(e){if(!Array.isArray(e))throw new Error("Expected array of snap ids.");e.forEach((e=>{const t=this.getExpect(e);g.assert.call(void 0,!1!==t.removable,`${e} is not removable.`)})),await Promise.all(e.map((async e=>{const t=this.getExpect(e),i=this.getTruncatedExpect(e);await this.disableSnap(e),d.__privateMethod.call(void 0,this,Ee,Se).call(this,e),d.__privateMethod.call(void 0,this,Te,be).call(this,e),d.__privateGet.call(void 0,this,F).delete(e),this.update((t=>{delete t.snaps[e],delete t.snapStates[e],delete t.unencryptedSnapStates[e]})),t.status!==v.SnapStatus.Installing&&this.messagingSystem.publish("SnapController:snapUninstalled",i)})))}removeSnapFromSubject(e,t){const i=this.messagingSystem.call("PermissionController:getPermissions",e),r=i?.[m.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===v.SnapCaveatType.SnapIds));if(!r)return;if(Boolean(r.value?.[t])){const i={...r.value};delete i[t],Object.keys(i).length>0?this.messagingSystem.call("PermissionController:updateCaveat",e,m.WALLET_SNAP_PERMISSION_KEY,v.SnapCaveatType.SnapIds,i):this.messagingSystem.call("PermissionController:revokePermissions",{[e]:[m.WALLET_SNAP_PERMISSION_KEY]})}}revokeDynamicSnapPermissions(e,t){g.assert.call(void 0,t.every((e=>d.__privateGet.call(void 0,this,A).includes(e))),"Non-dynamic permissions cannot be revoked"),this.messagingSystem.call("PermissionController:revokePermissions",{[e]:t})}incrementActiveReferences(e){d.__privateMethod.call(void 0,this,mt,ft).call(this,e).activeReferences+=1}decrementActiveReferences(e){const t=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);g.assert.call(void 0,t.activeReferences>0,"SnapController reference management is in an invalid state."),t.activeReferences-=1}getAllSnaps(){return Object.values(this.state.snaps).map(P)}getPermittedSnaps(e){const t=this.messagingSystem.call("PermissionController:getPermissions",e)??{},i=t[m.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===v.SnapCaveatType.SnapIds))?.value??{};return Object.keys(i).reduce(((e,t)=>{const i=this.get(t),r=this.getTruncated(t);return r&&i?.status!==v.SnapStatus.Installing&&(e[t]=r),e}),{})}async installSnaps(e,t){d.__privateMethod.call(void 0,this,ae,ne).call(this);const i={},r=Object.keys(t),a=[],n=[];try{for(const[r,{version:s}]of Object.entries(t)){v.assertIsValidSnapId.call(void 0,r);const[t,o]=v.resolveVersionRange.call(void 0,s);if(t)throw p.rpcErrors.invalidParams(`The "version" field must be a valid SemVer version range if specified. Received: "${s}".`);const l=d.__privateGet.call(void 0,this,B).call(this,r,{versionRange:o,fetch:d.__privateGet.call(void 0,this,x),allowLocal:d.__privateGet.call(void 0,this,M).allowLocalSnaps,resolveVersion:async e=>d.__privateGet.call(void 0,this,M).requireAllowlist?await d.__privateMethod.call(void 0,this,je,Me).call(this,r,e):e}),c=this.has(r)&&!l.shouldAlwaysReload;if(c&&d.__privateMethod.call(void 0,this,Tt,bt).call(this,r,o)){const e=this.getExpect(r);a.push({snapId:r,oldVersion:e.version});let t=d.__privateMethod.call(void 0,this,at,nt).call(this,r);if(void 0!==t)throw new Error("This snap is already being updated.");t=d.__privateMethod.call(void 0,this,st,ot).call(this,r),t.newVersion=o}else c||n.push(r);i[r]=await this.processRequestedSnap(e,r,l,o)}n.forEach((t=>this.messagingSystem.publish("SnapController:snapInstalled",this.getTruncatedExpect(t),e))),a.forEach((({snapId:t,oldVersion:i})=>this.messagingSystem.publish("SnapController:snapUpdated",this.getTruncatedExpect(t),i,e))),r.forEach((e=>d.__privateGet.call(void 0,this,D).delete(e)))}catch(e){const t=n.filter((e=>this.has(e)));await this.removeSnaps(t);const i=[...d.__privateGet.call(void 0,this,D).keys()],r=a.map((({snapId:e})=>e)).filter((e=>i.includes(e)));throw await d.__privateMethod.call(void 0,this,dt,ut).call(this,r),e}return i}async processRequestedSnap(e,t,i,r){const a=this.getTruncated(t);if(a&&!i.shouldAlwaysReload)return g.satisfiesVersionRange.call(void 0,a.version,r)?a:await this.updateSnap(e,t,i,r,!1);let n=d.__privateMethod.call(void 0,this,Pe,Ce).call(this,{origin:e,snapId:t,type:y});this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!1),a&&this.isRunning(t)&&await this.stopSnap(t,v.SnapStatusEvents.Stop),a&&i.shouldAlwaysReload&&d.__privateMethod.call(void 0,this,Ee,Se).call(this,t);try{const{sourceCode:a}=await d.__privateMethod.call(void 0,this,xe,Ne).call(this,{origin:e,id:t,location:i,versionRange:r});await this.authorize(t,n),n=d.__privateMethod.call(void 0,this,Pe,Ce).call(this,{origin:e,snapId:t,type:b}),await d.__privateMethod.call(void 0,this,Re,Oe).call(this,{snapId:t,sourceCode:a});const s=this.getTruncatedExpect(t);return d.__privateMethod.call(void 0,this,Ae,Ie).call(this,n.id,{loading:!1,type:y}),s}catch(i){v.logError.call(void 0,`Error when adding ${t}.`,i);const r=i instanceof Error?i.message:i.toString();throw d.__privateMethod.call(void 0,this,Ae,Ie).call(this,n.id,{loading:!1,type:y,error:r}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!1,r),i}}async updateSnap(e,t,i,r=v.DEFAULT_REQUESTED_SNAP_VERSION,a=!0){if(d.__privateMethod.call(void 0,this,ae,ne).call(this),!g.isValidSemVerRange.call(void 0,r))throw new Error(`Received invalid snap version range: "${r}".`);let n=d.__privateMethod.call(void 0,this,Pe,Ce).call(this,{origin:e,snapId:t,type:T});try{this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!0);const s=this.getExpect(t),o=s.manifest,c=await l.fetchSnap.call(void 0,t,i),{sourceCode:u,manifest:h}=c,f=h.result,_=f.version;if(!g.gtVersion.call(void 0,_,s.version))throw p.rpcErrors.invalidParams(`Snap "${t}@${s.version}" is already installed. Couldn't update to a version inside requested "${r}" range.`);if(!g.satisfiesVersionRange.call(void 0,_,r))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${_}" which doesn't satisfy requested version range "${r}".`);await d.__privateMethod.call(void 0,this,ie,re).call(this,t,{version:_,checksum:f.source.shasum,permissions:f.initialPermissions});const k=m.processSnapPermissions.call(void 0,f.initialPermissions);d.__privateMethod.call(void 0,this,De,Ue).call(this,k);const{newPermissions:w,unusedPermissions:y,approvedPermissions:E}=d.__privateMethod.call(void 0,this,_t,kt).call(this,t,k),{newConnections:S,unusedConnections:P,approvedConnections:C}=l.calculateConnectionsChange.call(void 0,o.initialConnections??{},f.initialConnections??{});d.__privateMethod.call(void 0,this,Ae,Ie).call(this,n.id,{permissions:w,newVersion:f.version,newPermissions:w,approvedPermissions:E,unusedPermissions:y,newConnections:S,unusedConnections:P,approvedConnections:C,loading:!1});const{permissions:A,...I}=await n.promise;n=d.__privateMethod.call(void 0,this,Pe,Ce).call(this,{origin:e,snapId:t,type:b}),this.isRunning(t)&&await this.stopSnap(t,v.SnapStatusEvents.Stop),d.__privateMethod.call(void 0,this,le,ce).call(this,t,v.SnapStatusEvents.Update),d.__privateMethod.call(void 0,this,Be,Fe).call(this,{origin:e,id:t,files:c,isUpdate:!0}),d.__privateMethod.call(void 0,this,wt,yt).call(this,{snapId:t,unusedPermissions:y,newPermissions:A,requestData:I}),f.initialConnections&&d.__privateMethod.call(void 0,this,_e,ke).call(this,t,o.initialConnections??null,f.initialConnections);const j=d.__privateMethod.call(void 0,this,at,nt).call(this,t);void 0!==j&&(j.permissions.revoked=y,j.permissions.granted=A,j.permissions.requestData=I);const M=u.toString();g.assert.call(void 0,"string"==typeof M&&M.length>0,`Invalid source code for snap "${t}".`);try{await d.__privateMethod.call(void 0,this,Re,Oe).call(this,{snapId:t,sourceCode:M})}catch{throw new Error(`Snap ${t} crashed with updated source code.`)}const x=this.getTruncatedExpect(t);return a&&this.messagingSystem.publish("SnapController:snapUpdated",x,s.version,e),d.__privateMethod.call(void 0,this,Ae,Ie).call(this,n.id,{loading:!1,type:T}),x}catch(i){v.logError.call(void 0,`Error when updating ${t},`,i);const r=i instanceof Error?i.message:i.toString();throw d.__privateMethod.call(void 0,this,Ae,Ie).call(this,n.id,{loading:!1,error:r,type:T}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!0,r),i}}async getRegistryMetadata(e){return d.__privateMethod.call(void 0,this,ae,ne).call(this),await this.messagingSystem.call("SnapsRegistry:getMetadata",e)}async authorize(e,t){o.log.call(void 0,`Authorizing snap: ${e}`);const i=this.state.snaps[e],{initialPermissions:r,initialConnections:a}=i;try{const n=m.processSnapPermissions.call(void 0,r);d.__privateMethod.call(void 0,this,De,Ue).call(this,n),d.__privateMethod.call(void 0,this,Ae,Ie).call(this,t.id,{loading:!1,connections:a??{},permissions:n});const{permissions:s,...o}=await t.promise;d.__privateMethod.call(void 0,this,wt,yt).call(this,{snapId:e,newPermissions:s,requestData:o}),i.manifest.initialConnections&&d.__privateMethod.call(void 0,this,_e,ke).call(this,e,null,i.manifest.initialConnections)}finally{d.__privateMethod.call(void 0,this,mt,ft).call(this,e).installPromise=null}}destroy(){super.destroy(),d.__privateGet.call(void 0,this,U)&&clearTimeout(d.__privateGet.call(void 0,this,U)),this.messagingSystem.unsubscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.unsubscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.unsubscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.clearEventSubscriptions("SnapController:snapInstalled"),this.messagingSystem.clearEventSubscriptions("SnapController:snapUpdated")}async handleRequest({snapId:e,origin:t,handler:i,request:r}){d.__privateMethod.call(void 0,this,ae,ne).call(this);const a={jsonrpc:"2.0",id:k.nanoid.call(void 0),...r};g.assertIsJsonRpcRequest.call(void 0,a);const n=m.handlerEndowments[i];g.assert.call(void 0,"string"==typeof n||null===n,"'permissionName' must be either a string or null.");const s=this.messagingSystem.call("PermissionController:getPermissions",e);if(!(null===n||s&&g.hasProperty.call(void 0,s,n)))throw new Error(`Snap "${e}" is not permitted to use "${n}".`);const o=n?s[n]:void 0;if(n===m.SnapEndowments.Rpc||n===m.SnapEndowments.Keyring){g.assert.call(void 0,o);const i=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",t),r=n===m.SnapEndowments.Rpc?m.getRpcCaveatOrigins.call(void 0,o):m.getKeyringCaveatOrigins.call(void 0,o);if(g.assert.call(void 0,r),!v.isOriginAllowed.call(void 0,r,i?.subjectType??h.SubjectType.Website,t))throw new Error(`Snap "${e}" is not permitted to handle requests from "${t}".`)}const l=d.__privateMethod.call(void 0,this,$e,Ve).call(this,e);if(!l)throw new Error(`Snap RPC message handler not found for snap "${e}".`);return l({origin:t,handler:i,request:a,timeout:d.__privateMethod.call(void 0,this,He,We).call(this,o)})}};C=new WeakMap,A=new WeakMap,I=new WeakMap,j=new WeakMap,M=new WeakMap,x=new WeakMap,N=new WeakMap,R=new WeakMap,O=new WeakMap,G=new WeakMap,L=new WeakMap,B=new WeakMap,F=new WeakMap,D=new WeakMap,U=new WeakMap,H=new WeakMap,W=new WeakMap,$=new WeakSet,V=function(){const e=({snapId:e})=>this.getExpect(e).enabled,t={initial:v.SnapStatus.Installing,states:{[v.SnapStatus.Installing]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e}}},[v.SnapStatus.Updating]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e},[v.SnapStatusEvents.Stop]:v.SnapStatus.Stopped}},[v.SnapStatus.Running]:{on:{[v.SnapStatusEvents.Stop]:v.SnapStatus.Stopped,[v.SnapStatusEvents.Crash]:v.SnapStatus.Crashed}},[v.SnapStatus.Stopped]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e},[v.SnapStatusEvents.Update]:v.SnapStatus.Updating}},[v.SnapStatus.Crashed]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e},[v.SnapStatusEvents.Update]:v.SnapStatus.Updating}}}};d.__privateSet.call(void 0,this,H,_.createMachine.call(void 0,t)),s.validateMachine.call(void 0,d.__privateGet.call(void 0,this,H))},K=new WeakSet,Y=function(){this.messagingSystem.registerActionHandler(`${w}:clearSnapState`,((...e)=>this.clearSnapState(...e))),this.messagingSystem.registerActionHandler(`${w}:get`,((...e)=>this.get(...e))),this.messagingSystem.registerActionHandler(`${w}:getSnapState`,(async(...e)=>this.getSnapState(...e))),this.messagingSystem.registerActionHandler(`${w}:handleRequest`,(async(...e)=>this.handleRequest(...e))),this.messagingSystem.registerActionHandler(`${w}:has`,((...e)=>this.has(...e))),this.messagingSystem.registerActionHandler(`${w}:updateBlockedSnaps`,(async()=>this.updateBlockedSnaps())),this.messagingSystem.registerActionHandler(`${w}:updateSnapState`,(async(...e)=>this.updateSnapState(...e))),this.messagingSystem.registerActionHandler(`${w}:enable`,((...e)=>this.enableSnap(...e))),this.messagingSystem.registerActionHandler(`${w}:disable`,(async(...e)=>this.disableSnap(...e))),this.messagingSystem.registerActionHandler(`${w}:remove`,(async(...e)=>this.removeSnap(...e))),this.messagingSystem.registerActionHandler(`${w}:getPermitted`,((...e)=>this.getPermittedSnaps(...e))),this.messagingSystem.registerActionHandler(`${w}:install`,(async(...e)=>this.installSnaps(...e))),this.messagingSystem.registerActionHandler(`${w}:getAll`,((...e)=>this.getAllSnaps(...e))),this.messagingSystem.registerActionHandler(`${w}:incrementActiveReferences`,((...e)=>this.incrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${w}:decrementActiveReferences`,((...e)=>this.decrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${w}:getRegistryMetadata`,(async(...e)=>this.getRegistryMetadata(...e))),this.messagingSystem.registerActionHandler(`${w}:disconnectOrigin`,((...e)=>this.removeSnapFromSubject(...e))),this.messagingSystem.registerActionHandler(`${w}:revokeDynamicPermissions`,((...e)=>this.revokeDynamicSnapPermissions(...e))),this.messagingSystem.registerActionHandler(`${w}:getFile`,(async(...e)=>this.getSnapFile(...e)))},q=new WeakSet,X=function(e){for(const{snapId:t,manifest:i,files:r,removable:a,hidden:n}of e){const e=this.get(t),s=void 0!==e,o=s&&g.gtVersion.call(void 0,i.version,e.version);if(s&&(!o||!0!==e.preinstalled))continue;const l=new(0,v.VirtualFile)({path:v.NpmSnapFileNames.Manifest,value:JSON.stringify(i),result:i}),c=r.map((({path:e,value:t})=>new(0,v.VirtualFile)({value:t,path:e}))),{filePath:u,iconPath:h}=i.source.location.npm,p=c.find((e=>e.path===u)),f=h?c.find((e=>e.path===h)):void 0;g.assert.call(void 0,p,"Source code not provided for preinstalled snap."),g.assert.call(void 0,!h||h&&f,"Icon not provided for preinstalled snap."),g.assert.call(void 0,void 0===i.source.files,"Auxiliary files are not currently supported for preinstalled snaps.");const _=i.source.locales?.map((e=>c.find((t=>t.path===e))))??[],k=v.getValidatedLocalizationFiles.call(void 0,_.filter(Boolean));g.assert.call(void 0,_.length===k.length,"Missing localization files for preinstalled snap.");const w={manifest:l,sourceCode:p,svgIcon:f,auxiliaryFiles:[],localizationFiles:k};d.__privateMethod.call(void 0,this,Be,Fe).call(this,{id:t,origin:"metamask",files:w,removable:a,hidden:n,preinstalled:!0});const y=m.processSnapPermissions.call(void 0,i.initialPermissions);d.__privateMethod.call(void 0,this,De,Ue).call(this,y);const{newPermissions:T,unusedPermissions:b}=d.__privateMethod.call(void 0,this,_t,kt).call(this,t,y);d.__privateMethod.call(void 0,this,wt,yt).call(this,{snapId:t,newPermissions:T,unusedPermissions:b}),this.update((e=>{e.snaps[t].status=v.SnapStatus.Stopped}))}},J=new WeakSet,z=function(){d.__privateSet.call(void 0,this,U,setTimeout((()=>{d.__privateMethod.call(void 0,this,se,oe).call(this).catch((e=>{v.logError.call(void 0,e)})),d.__privateMethod.call(void 0,this,J,z).call(this)}),d.__privateGet.call(void 0,this,N)))},Z=new WeakSet,Q=async function(e,t){if(this.has(e)){try{this.update((i=>{i.snaps[e].blocked=!0,i.snaps[e].blockInformation=t})),await this.disableSnap(e)}catch(t){v.logError.call(void 0,`Encountered error when stopping blocked snap "${e}".`,t)}this.messagingSystem.publish(`${w}:snapBlocked`,e,t)}},ee=new WeakSet,te=function(e){this.has(e)&&this.state.snaps[e].blocked&&(this.update((t=>{t.snaps[e].blocked=!1,delete t.snaps[e].blockInformation})),this.messagingSystem.publish(`${w}:snapUnblocked`,e))},ie=new WeakSet,re=async function(e,t){const i=(await this.messagingSystem.call("SnapsRegistry:get",{[e]:t}))[e];if(1===i.status)throw new Error(`Cannot install version "${t.version}" of snap "${e}": The version is blocked. ${i.reason?.explanation??""}`);const r=Object.keys(t.permissions).some((e=>!n.ALLOWED_PERMISSIONS.includes(e)));if(d.__privateGet.call(void 0,this,M).requireAllowlist&&r&&2!==i.status)throw new Error(`Cannot install version "${t.version}" of snap "${e}": ${3===i.status?"The registry is temporarily unavailable.":"The snap is not on the allowlist."}`)},ae=new WeakSet,ne=function(){const e=d.__privateGet.call(void 0,this,L).call(this);g.assert.call(void 0,!0!==e.disableSnaps,"The Snaps platform requires basic functionality to be used. Enable basic functionality in the settings to use the Snaps platform.")},se=new WeakSet,oe=async function(){const e=[...d.__privateGet.call(void 0,this,F).entries()];return Promise.all(e.filter((([e,t])=>0===t.activeReferences&&0===t.pendingInboundRequests.length&&t.lastRequest&&d.__privateGet.call(void 0,this,R)&&g.timeSince.call(void 0,t.lastRequest)>d.__privateGet.call(void 0,this,R))).map((async([e])=>this.stopSnap(e,v.SnapStatusEvents.Stop))))},le=new WeakSet,ce=function(e,t){const{interpreter:i}=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);i.send(t),this.update((t=>{t.snaps[e].status=i.state.value}))},de=new WeakSet,ue=async function(e){await this.messagingSystem.call("ExecutionService:terminateSnap",e),await new Promise((e=>setTimeout(e,1)));d.__privateMethod.call(void 0,this,mt,ft).call(this,e).pendingInboundRequests.filter((e=>"finished"!==e.timer.status)).forEach((e=>e.timer.finish())),await new Promise((e=>setTimeout(e,1))),this.messagingSystem.publish("SnapController:snapTerminated",this.getTruncatedExpect(e))},he=new WeakSet,pe=async function({snapId:e,salt:t,useCache:i,keyMetadata:r}){const a=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);if(a.encryptionKey&&a.encryptionSalt&&i)return{key:await d.__privateGet.call(void 0,this,O).importKey(a.encryptionKey),salt:a.encryptionSalt};const n=t??d.__privateGet.call(void 0,this,O).generateSalt(),s=await d.__privateGet.call(void 0,this,G).call(this),o=await m.getEncryptionEntropy.call(void 0,{snapId:e,mnemonicPhrase:s}),l=await d.__privateGet.call(void 0,this,O).keyFromPassword(o,n,!0,r),c=await d.__privateGet.call(void 0,this,O).exportKey(l);return i&&(a.encryptionKey=c,a.encryptionSalt=n),{key:l,salt:n}},me=new WeakSet,fe=async function(e,t){try{const i=v.parseJson.call(void 0,t),{salt:r,keyMetadata:a}=i,s=d.__privateGet.call(void 0,this,O).isVaultUpdated(t),{key:o}=await d.__privateMethod.call(void 0,this,he,pe).call(this,{snapId:e,salt:r,useCache:s,keyMetadata:a??n.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS}),l=await d.__privateGet.call(void 0,this,O).decryptWithKey(o,i);return g.assert.call(void 0,g.isValidJson.call(void 0,l)),l}catch{throw p.rpcErrors.internal({message:"Failed to decrypt snap state, the state must be corrupted."})}},ve=new WeakSet,ge=async function(e,t){const{key:i,salt:r}=await d.__privateMethod.call(void 0,this,he,pe).call(this,{snapId:e,useCache:!0}),a=await d.__privateGet.call(void 0,this,O).encryptWithKey(i,t);return a.salt=r,JSON.stringify(a)},_e=new WeakSet,ke=function(e,t,i){if(t){const r=l.setDiff.call(void 0,t,i);for(const t of Object.keys(r))this.removeSnapFromSubject(t,e)}for(const t of Object.keys(i))d.__privateMethod.call(void 0,this,we,ye).call(this,t,e)},we=new WeakSet,ye=function(e,t){const i=this.messagingSystem.call("PermissionController:getPermissions",e),r=i?.[m.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===v.SnapCaveatType.SnapIds));if(Boolean(r?.value?.[t]))return;if(r)return void this.messagingSystem.call("PermissionController:updateCaveat",e,m.WALLET_SNAP_PERMISSION_KEY,v.SnapCaveatType.SnapIds,{...r.value,[t]:{}});const a={[m.WALLET_SNAP_PERMISSION_KEY]:{caveats:[{type:v.SnapCaveatType.SnapIds,value:{[t]:{}}}]}};this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:a,subject:{origin:e}})},Te=new WeakSet,be=function(e){const t=this.messagingSystem.call("PermissionController:getSubjectNames");for(const i of t)this.removeSnapFromSubject(i,e)},Ee=new WeakSet,Se=function(e){this.messagingSystem.call("PermissionController:hasPermissions",e)&&this.messagingSystem.call("PermissionController:revokeAllPermissions",e)},Pe=new WeakSet,Ce=function({origin:e,snapId:t,type:i}){const r=k.nanoid.call(void 0);return{id:r,promise:this.messagingSystem.call("ApprovalController:addRequest",{origin:e,id:r,type:i,requestData:{metadata:{id:r,origin:t,dappOrigin:e},snapId:t},requestState:{loading:!0}},!0)}},Ae=new WeakSet,Ie=function(e,t){try{this.messagingSystem.call("ApprovalController:updateRequestState",{id:e,requestState:t})}catch{}},je=new WeakSet,Me=async function(e,t){return await this.messagingSystem.call("SnapsRegistry:resolveVersion",e,t)},xe=new WeakSet,Ne=async function(e){const{id:t,location:i,versionRange:r}=e;d.__privateMethod.call(void 0,this,vt,gt).call(this,t);const a=d.__privateMethod.call(void 0,this,mt,ft).call(this,t);a.installPromise||(o.log.call(void 0,`Adding snap: ${t}`),a.installPromise=(async()=>{const a=await l.fetchSnap.call(void 0,t,i),n=a.manifest.result;if(!g.satisfiesVersionRange.call(void 0,n.version,r))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${n.version}" which doesn't satisfy requested version range "${r}".`);return await d.__privateMethod.call(void 0,this,ie,re).call(this,t,{version:n.version,checksum:n.source.shasum,permissions:n.initialPermissions}),d.__privateMethod.call(void 0,this,Be,Fe).call(this,{...e,files:a,id:t})})());try{return await a.installPromise}catch(e){throw a.installPromise=null,e}},Re=new WeakSet,Oe=async function(e){const{snapId:t}=e;if(this.isRunning(t))throw new Error(`Snap "${t}" is already started.`);try{const i=d.__privateMethod.call(void 0,this,mt,ft).call(this,t),r=await this.messagingSystem.call("ExecutionService:executeSnap",{...e,endowments:await d.__privateMethod.call(void 0,this,Ge,Le).call(this,t)});return d.__privateMethod.call(void 0,this,le,ce).call(this,t,v.SnapStatusEvents.Start),i.lastRequest=Date.now(),r}catch(e){throw await d.__privateMethod.call(void 0,this,de,ue).call(this,t),e}},Ge=new WeakSet,Le=async function(e){let t=[];for(const i of d.__privateGet.call(void 0,this,I))if(this.messagingSystem.call("PermissionController:hasPermission",e,i)){const r=await this.messagingSystem.call("PermissionController:getEndowments",e,i);if(r){if(!Array.isArray(r)||r.some((e=>"string"!=typeof e)))throw new Error("Expected an array of string endowment names.");t=t.concat(r)}}const i=[...new Set([...v.DEFAULT_ENDOWMENTS,...t])];return i.length<v.DEFAULT_ENDOWMENTS.length+t.length&&v.logError.call(void 0,`Duplicate endowments found for ${e}. Default endowments should not be requested.`,t),i},Be=new WeakSet,Fe=function(e){const{id:t,origin:i,files:r,isUpdate:a=!1,removable:n,preinstalled:s,hidden:o}=e,{manifest:l,sourceCode:c,svgIcon:u,auxiliaryFiles:p,localizationFiles:m}=r;v.assertIsSnapManifest.call(void 0,l.result);const{version:f}=l.result,_=c.toString();g.assert.call(void 0,"string"==typeof _&&_.length>0,`Invalid source code for snap "${t}".`);const k=p.map((e=>(g.assert.call(void 0,"string"==typeof e.data.base64),{path:e.path,value:e.data.base64}))),w=this.state.snaps[t],y=[...w?.versionHistory??[],{version:f,date:Date.now(),origin:i}],T=m.map((e=>e.result)),b={...w,blocked:!1,enabled:!0,removable:n,preinstalled:s,hidden:o,id:t,initialConnections:l.result.initialConnections,initialPermissions:l.result.initialPermissions,manifest:l.result,status:d.__privateGet.call(void 0,this,H).config.initial,sourceCode:_,version:f,versionHistory:y,auxiliaryFiles:k,localizationFiles:T};delete b.blockInformation;const{inversePatches:E}=this.update((e=>{e.snaps[t]=b}));if(a){const e=d.__privateMethod.call(void 0,this,at,nt).call(this,t);void 0!==e&&(e.statePatches=E)}const{proposedName:S}=v.getLocalizedSnapManifest.call(void 0,l.result,"en",T);return this.messagingSystem.call("SubjectMetadataController:addSubjectMetadata",{subjectType:h.SubjectType.Snap,name:S,origin:b.id,version:f,svgIcon:u?.toString()??null}),{...b,sourceCode:_}},De=new WeakSet,Ue=function(e){const t=Object.keys(e),i=Array.from(new Set(Object.values(m.handlerEndowments)));g.assert.call(void 0,t.some((e=>i.includes(e))),`A snap must request at least one of the following permissions: ${i.filter((e=>null!==e)).join(", ")}.`);const r=t.reduce(((e,t)=>(g.hasProperty.call(void 0,d.__privateGet.call(void 0,this,j),t)&&e.push(d.__privateGet.call(void 0,this,j)[t]),e)),[]);g.assert.call(void 0,0===r.length,`One or more permissions are not allowed:\n${r.join("\n")}`)},He=new WeakSet,We=function(e){return m.getMaxRequestTimeCaveat.call(void 0,e)??this.maxRequestTime},$e=new WeakSet,Ve=function(e){const t=d.__privateMethod.call(void 0,this,mt,ft).call(this,e),i=t.rpcHandler;if(i)return i;const r=new(0,a.RequestQueue)(5),n=new Map,s=async({origin:t,handler:i,request:a,timeout:s})=>{if(!1===this.state.snaps[e].enabled)throw new Error(`Snap "${e}" is disabled.`);if(this.state.snaps[e].status===v.SnapStatus.Installing)throw new Error(`Snap "${e}" is currently being installed. Please try again later.`);if(!this.isRunning(e)){let i=n.get(e);if(i){if(r.get(t)>=r.maxQueueSize)throw new Error("Exceeds maximum number of requests waiting to be resolved, please try again.")}else i=this.startSnap(e),n.set(e,i);r.increment(t);try{await i}finally{r.decrement(t),n.get(e)===i&&n.delete(e)}}const o=new(0,c.Timer)(s);d.__privateMethod.call(void 0,this,et,tt).call(this,e,a.id,o);const u=this.messagingSystem.call("ExecutionService:handleRpcRequest",e,{origin:t,handler:i,request:a});try{const t=await l.withTimeout.call(void 0,u,o);if(t===l.hasTimedOut)throw new Error(`${e} failed to respond to the request in time.`);await d.__privateMethod.call(void 0,this,Ze,Qe).call(this,e,i,t);const r=await d.__privateMethod.call(void 0,this,Je,ze).call(this,e,i,t);return d.__privateMethod.call(void 0,this,it,rt).call(this,e,a.id),r}catch(t){d.__privateMethod.call(void 0,this,it,rt).call(this,e,a.id);const[i,r]=v.unwrapError.call(void 0,t);throw r||await this.stopSnap(e,v.SnapStatusEvents.Crash),i}};return t.rpcHandler=s,s},Ke=new WeakSet,Ye=async function(e,t){return this.messagingSystem.call("SnapInterfaceController:createInterface",e,t)},qe=new WeakSet,Xe=function(e,t){g.assert.call(void 0,this.messagingSystem.call("SnapInterfaceController:getInterface",e,t))},Je=new WeakSet,ze=async function(e,t,i){switch(t){case v.HandlerType.OnTransaction:case v.HandlerType.OnSignature:case v.HandlerType.OnHomePage:{const t=i;if(t&&g.hasProperty.call(void 0,t,"content")){const{content:i,...r}=t;return{...r,id:await d.__privateMethod.call(void 0,this,Ke,Ye).call(this,e,i)}}return i}default:return i}},Ze=new WeakSet,Qe=async function(e,t,i){switch(t){case v.HandlerType.OnTransaction:g.assertStruct.call(void 0,i,v.OnTransactionResponseStruct),i&&g.hasProperty.call(void 0,i,"id")&&d.__privateMethod.call(void 0,this,qe,Xe).call(this,e,i.id);break;case v.HandlerType.OnSignature:g.assertStruct.call(void 0,i,v.OnSignatureResponseStruct),i&&g.hasProperty.call(void 0,i,"id")&&d.__privateMethod.call(void 0,this,qe,Xe).call(this,e,i.id);break;case v.HandlerType.OnHomePage:g.assertStruct.call(void 0,i,v.OnHomePageResponseStruct),i&&g.hasProperty.call(void 0,i,"id")&&d.__privateMethod.call(void 0,this,qe,Xe).call(this,e,i.id);break;case v.HandlerType.OnNameLookup:g.assertStruct.call(void 0,i,v.OnNameLookupResponseStruct)}},et=new WeakSet,tt=function(e,t,i){const r=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);r.pendingInboundRequests.push({requestId:t,timer:i}),r.lastRequest=null},it=new WeakSet,rt=function(e,t){const i=d.__privateMethod.call(void 0,this,mt,ft).call(this,e);i.pendingInboundRequests=i.pendingInboundRequests.filter((e=>e.requestId!==t)),0===i.pendingInboundRequests.length&&(i.lastRequest=Date.now())},at=new WeakSet,nt=function(e){return d.__privateGet.call(void 0,this,D).get(e)},st=new WeakSet,ot=function(e){g.assert.call(void 0,void 0===d.__privateGet.call(void 0,this,D).get(e),new Error(`Snap "${e}" rollback snapshot already exists.`)),d.__privateGet.call(void 0,this,D).set(e,{statePatches:[],permissions:{},newVersion:""});const t=d.__privateGet.call(void 0,this,D).get(e);return g.assert.call(void 0,void 0!==t,new Error(`Snapshot creation failed for ${e}.`)),t},lt=new WeakSet,ct=async function(e){const t=d.__privateMethod.call(void 0,this,at,nt).call(this,e);if(!t)throw new Error("A snapshot does not exist for this snap.");await this.stopSnap(e,v.SnapStatusEvents.Stop),this.get(e)?.status!==v.SnapStatus.Stopped&&d.__privateMethod.call(void 0,this,le,ce).call(this,e,v.SnapStatusEvents.Stop);const{statePatches:i,permissions:r}=t;i?.length&&this.applyPatches(i),this.get(e)?.status!==v.SnapStatus.Stopped&&this.update((t=>{t.snaps[e].status=v.SnapStatus.Stopped})),d.__privateMethod.call(void 0,this,wt,yt).call(this,{snapId:e,unusedPermissions:r.granted,newPermissions:r.revoked,requestData:r.requestData});const a=this.getTruncatedExpect(e);this.messagingSystem.publish("SnapController:snapRolledback",a,t.newVersion),d.__privateGet.call(void 0,this,D).delete(e)},dt=new WeakSet,ut=async function(e){for(const t of e)await d.__privateMethod.call(void 0,this,lt,ct).call(this,t)},ht=new WeakSet,pt=function(e){return d.__privateGet.call(void 0,this,F).get(e)},mt=new WeakSet,ft=function(e){const t=d.__privateMethod.call(void 0,this,ht,pt).call(this,e);return g.assert.call(void 0,void 0!==t,new Error(`Snap "${e}" runtime data not found`)),t},vt=new WeakSet,gt=function(e){if(d.__privateGet.call(void 0,this,F).has(e))return;const t=this.get(e),i=_.interpret.call(void 0,d.__privateGet.call(void 0,this,H));i.start({context:{snapId:e},value:t?.status??d.__privateGet.call(void 0,this,H).config.initial}),s.forceStrict.call(void 0,i),d.__privateGet.call(void 0,this,F).set(e,{lastRequest:null,rpcHandler:null,installPromise:null,encryptionKey:null,encryptionSalt:null,activeReferences:0,pendingInboundRequests:[],pendingOutboundRequests:0,interpreter:i,stopping:!1})},_t=new WeakSet,kt=function(e,t){const i=this.messagingSystem.call("PermissionController:getPermissions",e)??{},r=l.permissionsDiff.call(void 0,t,i),a=l.permissionsDiff.call(void 0,i,t);return{newPermissions:r,unusedPermissions:a,approvedPermissions:l.permissionsDiff.call(void 0,i,a)}},wt=new WeakSet,yt=function({snapId:e,unusedPermissions:t={},newPermissions:i={},requestData:r}){const a=Object.keys(t);g.isNonEmptyArray.call(void 0,a)&&this.messagingSystem.call("PermissionController:revokePermissions",{[e]:a}),g.isNonEmptyArray.call(void 0,Object.keys(i))&&this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:i,subject:{origin:e},requestData:r})},Tt=new WeakSet,bt=function(e,t){const i=this.getExpect(e);return!g.satisfiesVersionRange.call(void 0,i.version,t)&&!g.gtRange.call(void 0,i.version,t)},Et=new WeakSet,St=async function(e,t,i){const r=m.handlerEndowments[i];g.assert.call(void 0,r,"Lifecycle hook must have an endowment.");this.messagingSystem.call("PermissionController:hasPermission",t,r)&&await this.handleRequest({snapId:t,handler:i,origin:e,request:{jsonrpc:"2.0",method:i}})},i.controllerName=w,i.SNAP_APPROVAL_INSTALL=y,i.SNAP_APPROVAL_UPDATE=T,i.SNAP_APPROVAL_RESULT=b,i.SnapController=Pt}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-ZBSBCWWM.js"}],[1947,{"./chunk-S775IABY.js":1940,"@metamask/post-message-stream":1624,"@metamask/snaps-utils":2118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-S775IABY.js"),a=e("@metamask/post-message-stream"),n=e("@metamask/snaps-utils"),s=class extends r.AbstractExecutionService{constructor({iframeUrl:e,messenger:t,setupSnapProvider:i}){super({messenger:t,setupSnapProvider:i}),this.iframeUrl=e}terminateJob(e){document.getElementById(e.id)?.remove()}async initEnvStream(e){const t=await n.createWindow.call(void 0,this.iframeUrl.toString(),e);return{worker:t,stream:new(0,a.WindowPostMessageStream)({name:"parent",target:"child",targetWindow:t,targetOrigin:"*"})}}};i.IframeExecutionService=s}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-ZRC46TUF.js"}],[1948,{"./chunk-4CA3O64H.js":1915,"./chunk-4URGXJP7.js":1916,"./chunk-6ERB63FH.js":1917,"./chunk-6VGMRXGY.js":1918,"./chunk-7Y6P5FRN.js":1919,"./chunk-AP7CJ6DA.js":1920,"./chunk-BO2ZDPWV.js":1921,"./chunk-BOFPNIRX.js":1922,"./chunk-CDTGUNSA.js":1923,"./chunk-CPUUURMT.js":1924,"./chunk-D74XJG2L.js":1925,"./chunk-EXN2TFDJ.js":1926,"./chunk-G66GQJS6.js":1927,"./chunk-GRBWVPLF.js":1928,"./chunk-HOY6NKQR.js":1929,"./chunk-HQ6HMINL.js":1930,"./chunk-JAUAKTUL.js":1931,"./chunk-JQ54YYLU.js":1932,"./chunk-KH72WRHR.js":1933,"./chunk-LWBPKSU2.js":1934,"./chunk-NXZVKBSV.js":1935,"./chunk-OHMCPTOI.js":1936,"./chunk-OIEUL55W.js":1937,"./chunk-PT22IXNS.js":1938,"./chunk-RDBT3ZJQ.js":1939,"./chunk-S775IABY.js":1940,"./chunk-VNOCJWOK.js":1941,"./chunk-WCDDYBFW.js":1942,"./chunk-WEY7ICES.js":1943,"./chunk-XWDEGRM5.js":1944,"./chunk-YYPUPKQY.js":1945,"./chunk-ZBSBCWWM.js":1946,"./chunk-ZRC46TUF.js":1947},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-GRBWVPLF.js");e("./chunk-JAUAKTUL.js");var a=e("./chunk-ZBSBCWWM.js");e("./chunk-WEY7ICES.js");var n=e("./chunk-PT22IXNS.js"),s=e("./chunk-LWBPKSU2.js"),o=e("./chunk-XWDEGRM5.js");e("./chunk-G66GQJS6.js");var l=e("./chunk-CPUUURMT.js"),c=e("./chunk-4CA3O64H.js"),d=e("./chunk-RDBT3ZJQ.js");e("./chunk-AP7CJ6DA.js"),e("./chunk-JQ54YYLU.js");var u=e("./chunk-YYPUPKQY.js");e("./chunk-VNOCJWOK.js");var h=e("./chunk-6VGMRXGY.js");e("./chunk-WCDDYBFW.js"),e("./chunk-4URGXJP7.js"),e("./chunk-OHMCPTOI.js"),e("./chunk-D74XJG2L.js");var p=e("./chunk-HQ6HMINL.js");e("./chunk-HOY6NKQR.js");var m=e("./chunk-ZRC46TUF.js"),f=e("./chunk-6ERB63FH.js");e("./chunk-KH72WRHR.js");var v=e("./chunk-S775IABY.js");e("./chunk-OIEUL55W.js");var g=e("./chunk-7Y6P5FRN.js");e("./chunk-BO2ZDPWV.js"),e("./chunk-NXZVKBSV.js");var _=e("./chunk-CDTGUNSA.js");e("./chunk-BOFPNIRX.js"),e("./chunk-EXN2TFDJ.js"),i.AbstractExecutionService=v.AbstractExecutionService,i.BaseNpmLocation=o.BaseNpmLocation,i.CronjobController=r.CronjobController,i.DAILY_TIMEOUT=r.DAILY_TIMEOUT,i.DEFAULT_NPM_REGISTRY=o.DEFAULT_NPM_REGISTRY,i.HttpLocation=d.HttpLocation,i.IframeExecutionService=m.IframeExecutionService,i.JsonSnapsRegistry=l.JsonSnapsRegistry,i.LocalLocation=s.LocalLocation,i.NpmLocation=o.NpmLocation,i.OffscreenExecutionService=f.OffscreenExecutionService,i.ProxyPostMessageStream=g.ProxyPostMessageStream,i.SNAP_APPROVAL_INSTALL=a.SNAP_APPROVAL_INSTALL,i.SNAP_APPROVAL_RESULT=a.SNAP_APPROVAL_RESULT,i.SNAP_APPROVAL_UPDATE=a.SNAP_APPROVAL_UPDATE,i.SnapController=a.SnapController,i.SnapInterfaceController=h.SnapInterfaceController,i.SnapsRegistryStatus=c.SnapsRegistryStatus,i.TARBALL_SIZE_SAFETY_LIMIT=o.TARBALL_SIZE_SAFETY_LIMIT,i.WebWorkerExecutionService=p.WebWorkerExecutionService,i.calculateConnectionsChange=_.calculateConnectionsChange,i.controllerName=a.controllerName,i.delay=_.delay,i.delayWithTimer=_.delayWithTimer,i.detectSnapLocation=n.detectSnapLocation,i.fetchNpmMetadata=o.fetchNpmMetadata,i.fetchSnap=_.fetchSnap,i.getNpmCanonicalBasePath=o.getNpmCanonicalBasePath,i.getRunnableSnaps=u.getRunnableSnaps,i.getSnapFiles=_.getSnapFiles,i.hasTimedOut=_.hasTimedOut,i.permissionsDiff=_.permissionsDiff,i.setDiff=_.setDiff,i.setupMultiplex=v.setupMultiplex,i.withTimeout=_.withTimeout}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/index.js"}],[1949,{"./chunk-UJFCPTF3.js":1951,"./chunk-Z4BLTVTB.js":1952},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,i.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,r,new Map),l.__privateAdd.call(void 0,this,a,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,r).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,r).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,r).delete(e)}clearActions(){l.__privateGet.call(void 0,this,r).clear()}call(e,...t){const i=l.__privateGet.call(void 0,this,r).get(e);if(!i)throw new Error(`A handler for ${e} has not been registered`);return i(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,n).set(e,t)}publish(e,...t){const i=l.__privateGet.call(void 0,this,a).get(e);if(i)for(const[e,r]of i.entries())try{if(r){const i=l.__privateGet.call(void 0,this,s).get(e),a=r(...t);a!==i&&(l.__privateGet.call(void 0,this,s).set(e,a),e(a,i))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,i){let r=l.__privateGet.call(void 0,this,a).get(e);if(r||(r=new Map,l.__privateGet.call(void 0,this,a).set(e,r)),r.set(t,i),i){const r=l.__privateGet.call(void 0,this,n).get(e);if(r){const e=i(...r());l.__privateGet.call(void 0,this,s).set(t,e)}}}unsubscribe(e,t){const i=l.__privateGet.call(void 0,this,a).get(e);if(!i||!i.has(t))throw new Error(`Subscription not found for event: ${e}`);i.get(t)&&l.__privateGet.call(void 0,this,s).delete(t),i.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,a).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,a).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:i}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:i})}}}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[195,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:76,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=76;const i=function(e){var t;if(e.CollectiblesController){const{allCollectibleContracts:t,allCollectibles:i,ignoredCollectibles:r,...a}=e.CollectiblesController;e.NftController={...t?{allNftContracts:t}:{},...i?{allNfts:i}:{},...r?{ignoredNfts:r}:{},...a},delete e.CollectiblesController}null!==(t=e.PreferencesController)&&void 0!==t&&t.useCollectibleDetection&&(e.PreferencesController.useNftDetection=e.PreferencesController.useCollectibleDetection,delete e.PreferencesController.useCollectibleDetection);return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/076.js"}],[1950,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,i=!0){if(i){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const i=e[t];this.internalConfig[t]=i,this[t]=i}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},a=r;i.BaseControllerV1=r,i.BaseControllerV1_default=a}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1951,{"./chunk-Z4BLTVTB.js":1952},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,s);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,n);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,a)}:`)},i.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:i,allowedEvents:l}){p.__privateAdd.call(void 0,this,o),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,r,void 0),p.__privateAdd.call(void 0,this,a,void 0),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateSet.call(void 0,this,r,e),p.__privateSet.call(void 0,this,a,t),p.__privateSet.call(void 0,this,n,i),p.__privateSet.call(void 0,this,s,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,r).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).publish(e,...t)}subscribe(e,t,i){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return i?p.__privateGet.call(void 0,this,r).subscribe(e,t,i):p.__privateGet.call(void 0,this,r).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,r).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).clearEventSubscriptions(e)}}}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1952,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1953,{"./chunk-Z4BLTVTB.js":1952,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-Z4BLTVTB.js"),n=e("immer");n.enablePatches.call(void 0);function s(e,t,i){return Object.keys(e).reduce(((r,a)=>{try{const n=t[a];if(!n)throw new Error(`No metadata found for '${String(a)}'`);const s=n[i],o=e[a];return"function"==typeof s?r[a]=s(o):s&&(r[a]=o),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}r=new WeakMap,i.BaseController=class{constructor({messenger:e,metadata:t,name:i,state:s}){a.__privateAdd.call(void 0,this,r,void 0),this.messagingSystem=e,this.name=i,a.__privateSet.call(void 0,this,r,n.freeze.call(void 0,s,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${i}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${i}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return a.__privateGet.call(void 0,this,r)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,i,s]=n.produceWithPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);return a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,i),{nextState:t,patches:i,inversePatches:s}}applyPatches(e){const t=n.applyPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},i.getAnonymizedState=function(e,t){return s(e,t,"anonymous")},i.getPersistentState=function(e,t){return s(e,t,"persist")}}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1954,{"./chunk-G42723LG.js":1949,"./chunk-NINOM2XQ.js":1950,"./chunk-UJFCPTF3.js":1951,"./chunk-Z4BLTVTB.js":1952,"./chunk-ZNOPSWMU.js":1953},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-NINOM2XQ.js"),a=e("./chunk-ZNOPSWMU.js"),n=e("./chunk-G42723LG.js"),s=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),i.BaseController=a.BaseController,i.BaseControllerV1=r.BaseControllerV1,i.ControllerMessenger=n.ControllerMessenger,i.RestrictedControllerMessenger=s.RestrictedControllerMessenger,i.getAnonymizedState=a.getAnonymizedState,i.getPersistentState=a.getPersistentState}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/index.js"}],[1955,{"./chunk-RKVNLW2C.js":1959,"@ethereumjs/util":441,"@metamask/ethjs-unit":1336,"@metamask/utils":2255,"bn.js":2935,buffer:2983,"eth-ens-namehash":3173,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a=e("./chunk-RKVNLW2C.js"),n=e("@ethereumjs/util"),s=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=r(e("bn.js")),c=r(e("eth-ens-namehash")),d=r(e("fast-deep-equal")),u=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function m(e,t){const i=await fetch(e,t);if(!i.ok)throw new Error(`Fetch failed with status '${i.status}' for request '${String(e)}'`);return i}async function f(e,t){const i=await m(e,t);return await i.json()}i.PROTOTYPE_POLLUTION_BLOCKLIST=h,i.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},i.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=a.MAX_SAFE_CHAIN_ID},i.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},i.fractionBN=function(e,t,i){const r=new(0,l.default)(t),a=new(0,l.default)(i);return e.mul(r).div(a)},i.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),i=t[0]||"0";let r=t[1]||"";if(!r)return s.toWei.call(void 0,i,"gwei");if(r.length<=9)return s.toWei.call(void 0,`${i}.${r}`,"gwei");const a=r.slice(9)[0];r=r.slice(0,9);let n=s.toWei.call(void 0,`${i}.${r}`,"gwei");return Number(a)>=5&&(n=n.add(new(0,l.default)(1))),n},i.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return s.fromWei.call(void 0,t,"gwei")},i.getBuyURL=function(e="1",t,i=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${i}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},i.hexToBN=p,i.hexToText=function(e){try{const i=o.remove0x.call(void 0,e);return t.from(i,"hex").toString("utf8")}catch(t){return e}},i.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(p(e).toString(10))},i.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},i.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},i.safelyExecuteWithTimeout=async function(e,t=!1,i=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])}catch(e){return void(t&&console.error(e))}},i.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?n.toChecksumAddress.call(void 0,t):t},i.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const i=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,i)&&n.isValidAddress.call(void 0,i)},i.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},i.successfulFetch=m,i.handleFetch=f,i.fetchWithErrorHandling=async function({url:e,options:t,timeout:i,errorCodesToCatch:r}){let a;try{a=i?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==u)throw e;console.error(e)}(e,r)}return a},i.timeoutFetch=async function(e,t,i=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])},i.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},i.query=function(e,t,i=[]){return new Promise(((r,a)=>{const n=(e,t)=>{e?a(e):r(t)};t in e&&"function"==typeof e[t]?e[t](...i,n):e.sendAsync({method:t,params:i},n)}))},i.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,i.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},i.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},i.isValidJson=function(e){try{return d.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-7C4YHS6A.js"}],[1956,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=r.createProjectLogger.call(void 0,"controller-utils");i.createModuleLogger=r.createModuleLogger,i.projectLogger=a}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1957,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},a={...r,rpc:"rpc"};var n=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(n||{}),s={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});i.InfuraNetworkType=r,i.NetworkType=a,i.isNetworkType=function(e){return Object.values(a).includes(e)},i.isInfuraNetworkType=function(e){return Object.keys(r).includes(e)},i.BuiltInNetworkName=n,i.ChainId=s,i.NetworksTicker=o}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1958,{"./chunk-DBJSLKNR.js":1956,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-DBJSLKNR.js"),a=e("@metamask/utils"),n=e("@spruceid/siwe-parser"),s=r.createModuleLogger.call(void 0,r.projectLogger,"detect-siwe");function o(e){try{const r="string"!=typeof(i=e)?i:a.remove0x.call(void 0,i),n=t.from(r,"hex");return 32===n.length?e:n.toString("utf8")}catch(t){return s(t),e}var i}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);i.parseDomainParts=c,i.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:i}=e;if(!t||!i?.parsedMessage?.domain)return!1;const r=new URL(t),a=c(i.parsedMessage.domain,r.protocol);return 0===a.hostname.localeCompare(r.hostname,void 0,{sensitivity:"accent"})&&(""!==a.port&&a.port!==r.port?""===r.port&&a.port===l[r.protocol]:""===a.username||a.username===r.username)}catch(e){return s(e),!1}},i.detectSIWE=e=>{try{const{data:t}=e,i=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,n.ParsedMessage)(i)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1959,{"./chunk-LGGBBU6G.js":1957},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LGGBBU6G.js"),a={[r.NetworkType.goerli]:{chainId:r.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.goerli}.etherscan.io`}},[r.NetworkType.sepolia]:{chainId:r.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.sepolia}.etherscan.io`}},[r.NetworkType.mainnet]:{chainId:r.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[r.NetworkType["linea-goerli"]]:{chainId:r.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[r.NetworkType["linea-sepolia"]]:{chainId:r.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[r.NetworkType["linea-mainnet"]]:{chainId:r.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[r.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},n=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(n||{}),s={[r.ChainId.goerli]:"goerli",[r.ChainId.sepolia]:"sepolia",[r.ChainId.mainnet]:"mainnet",[r.ChainId["linea-goerli"]]:"linea-goerli",[r.ChainId["linea-sepolia"]]:"linea-sepolia",[r.ChainId["linea-mainnet"]]:"linea-mainnet",[r.ChainId.aurora]:"aurora"};i.RPC="rpc",i.FALL_BACK_VS_CURRENCY="ETH",i.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",i.GANACHE_CHAIN_ID="0x539",i.MAX_SAFE_CHAIN_ID=0xfffffffffffec,i.ERC721="ERC721",i.ERC1155="ERC1155",i.ERC20="ERC20",i.ERC721_INTERFACE_ID="0x80ac58cd",i.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",i.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",i.ERC1155_INTERFACE_ID="0xd9b67a26",i.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",i.GWEI="gwei",i.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},i.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},i.BUILT_IN_NETWORKS=a,i.OPENSEA_PROXY_URL="https://proxy.api.cx.metamask.io/opensea/v1/api/v2",i.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",i.NFT_API_VERSION="1",i.NFT_API_TIMEOUT=15e3,i.ORIGIN_METAMASK="metamask",i.ApprovalType=n,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-RKVNLW2C.js"}],[196,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){(0,r.hasProperty)(e,"PreferencesController")&&(0,r.isObject)(e.PreferencesController)&&(0,r.hasProperty)(e.PreferencesController,"frequentRpcListDetail")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"networkConfigurations")&&delete e.PreferencesController.frequentRpcListDetail;return{...e}};var r=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-082.ts"}],[1960,{"./chunk-7C4YHS6A.js":1955,"./chunk-DBJSLKNR.js":1956,"./chunk-LGGBBU6G.js":1957,"./chunk-M6G3ISXG.js":1958,"./chunk-RKVNLW2C.js":1959},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var a=e("./chunk-7C4YHS6A.js"),n=e("./chunk-RKVNLW2C.js"),s=e("./chunk-LGGBBU6G.js");i.ASSET_TYPES=n.ASSET_TYPES,i.ApprovalType=n.ApprovalType,i.BNToHex=a.BNToHex,i.BUILT_IN_NETWORKS=n.BUILT_IN_NETWORKS,i.BuiltInNetworkName=s.BuiltInNetworkName,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=n.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,i.ChainId=s.ChainId,i.ERC1155=n.ERC1155,i.ERC1155_INTERFACE_ID=n.ERC1155_INTERFACE_ID,i.ERC1155_METADATA_URI_INTERFACE_ID=n.ERC1155_METADATA_URI_INTERFACE_ID,i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=n.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,i.ERC20=n.ERC20,i.ERC721=n.ERC721,i.ERC721_ENUMERABLE_INTERFACE_ID=n.ERC721_ENUMERABLE_INTERFACE_ID,i.ERC721_INTERFACE_ID=n.ERC721_INTERFACE_ID,i.ERC721_METADATA_INTERFACE_ID=n.ERC721_METADATA_INTERFACE_ID,i.FALL_BACK_VS_CURRENCY=n.FALL_BACK_VS_CURRENCY,i.GANACHE_CHAIN_ID=n.GANACHE_CHAIN_ID,i.GWEI=n.GWEI,i.IPFS_DEFAULT_GATEWAY_URL=n.IPFS_DEFAULT_GATEWAY_URL,i.InfuraNetworkType=s.InfuraNetworkType,i.MAX_SAFE_CHAIN_ID=n.MAX_SAFE_CHAIN_ID,i.NFT_API_BASE_URL=n.NFT_API_BASE_URL,i.NFT_API_TIMEOUT=n.NFT_API_TIMEOUT,i.NFT_API_VERSION=n.NFT_API_VERSION,i.NetworkType=s.NetworkType,i.NetworksTicker=s.NetworksTicker,i.OPENSEA_PROXY_URL=n.OPENSEA_PROXY_URL,i.ORIGIN_METAMASK=n.ORIGIN_METAMASK,i.RPC=n.RPC,i.TESTNET_TICKER_SYMBOLS=n.TESTNET_TICKER_SYMBOLS,i.convertHexToDecimal=a.convertHexToDecimal,i.detectSIWE=r.detectSIWE,i.fetchWithErrorHandling=a.fetchWithErrorHandling,i.fractionBN=a.fractionBN,i.fromHex=a.fromHex,i.getBuyURL=a.getBuyURL,i.gweiDecToWEIBN=a.gweiDecToWEIBN,i.handleFetch=a.handleFetch,i.hexToBN=a.hexToBN,i.hexToText=a.hexToText,i.isInfuraNetworkType=s.isInfuraNetworkType,i.isNetworkType=s.isNetworkType,i.isNonEmptyArray=a.isNonEmptyArray,i.isPlainObject=a.isPlainObject,i.isSafeChainId=a.isSafeChainId,i.isSafeDynamicKey=a.isSafeDynamicKey,i.isSmartContractCode=a.isSmartContractCode,i.isValidHexAddress=a.isValidHexAddress,i.isValidJson=a.isValidJson,i.isValidSIWEOrigin=r.isValidSIWEOrigin,i.normalizeEnsName=a.normalizeEnsName,i.parseDomainParts=r.parseDomainParts,i.query=a.query,i.safelyExecute=a.safelyExecute,i.safelyExecuteWithTimeout=a.safelyExecuteWithTimeout,i.successfulFetch=a.successfulFetch,i.timeoutFetch=a.timeoutFetch,i.toChecksumHexAddress=a.toChecksumHexAddress,i.toHex=a.toHex,i.weiHexToGweiDec=a.weiHexToGweiDec}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/index.js"}],[1961,{"./chunk-Z4BLTVTB.js":1966,"@metamask/rpc-errors":1672,"@metamask/safe-event-emitter":1673,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b=e("./chunk-Z4BLTVTB.js"),E=e("@metamask/rpc-errors"),S=e("@metamask/safe-event-emitter"),P=(r=S)&&r.__esModule?r:{default:r},C=e("@metamask/utils"),A=class e extends P.default{constructor({notificationHandler:e}={}){super(),b.__privateAdd.call(void 0,this,o),b.__privateAdd.call(void 0,this,c),b.__privateAdd.call(void 0,this,u),b.__privateAdd.call(void 0,this,a,!1),b.__privateAdd.call(void 0,this,n,void 0),b.__privateAdd.call(void 0,this,s,void 0),b.__privateSet.call(void 0,this,n,[]),b.__privateSet.call(void 0,this,s,e)}destroy(){b.__privateGet.call(void 0,this,n).forEach((e=>{"destroy"in e&&"function"==typeof e.destroy&&e.destroy()})),b.__privateSet.call(void 0,this,n,[]),b.__privateSet.call(void 0,this,a,!0)}push(e){b.__privateMethod.call(void 0,this,o,l).call(this),b.__privateGet.call(void 0,this,n).push(e)}handle(e,t){if(b.__privateMethod.call(void 0,this,o,l).call(this),t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?b.__privateMethod.call(void 0,this,c,d).call(this,e,t):b.__privateMethod.call(void 0,this,c,d).call(this,e):t?b.__privateMethod.call(void 0,this,u,h).call(this,e,t):this._promiseHandle(e)}asMiddleware(){return b.__privateMethod.call(void 0,this,o,l).call(this),async(t,i,r,a)=>{var s,o;try{const[l,c,d]=await b.__privateMethod.call(void 0,s=e,f,v).call(s,t,i,b.__privateGet.call(void 0,this,n));return c?(await b.__privateMethod.call(void 0,o=e,k,w).call(o,d),a(l)):r((async t=>{var i;try{await b.__privateMethod.call(void 0,i=e,k,w).call(i,d)}catch(e){return t(e)}return t()}))}catch(e){return a(e)}}}async _promiseHandle(e){return new Promise(((t,i)=>{b.__privateMethod.call(void 0,this,u,h).call(this,e,((e,r)=>{e&&void 0===r?i(e):t(r)})).catch(i)}))}};a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(){if(b.__privateGet.call(void 0,this,a))throw new Error("This engine is destroyed and can no longer be used.")},c=new WeakSet,d=async function(e,t){try{if(0===e.length){const e=[{id:null,jsonrpc:"2.0",error:new(0,E.JsonRpcError)(E.errorCodes.rpc.invalidRequest,"Request batch must contain plain objects. Received an empty array")}];return t?t(null,e):e}const i=(await Promise.all(e.map(this._promiseHandle.bind(this)))).filter((e=>void 0!==e));return t?t(null,i):i}catch(e){if(t)return t(e);throw e}},u=new WeakSet,h=async function(e,t){var i;if(!e||Array.isArray(e)||"object"!=typeof e){const i=new(0,E.JsonRpcError)(E.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(i,{id:null,jsonrpc:"2.0",error:i})}if("string"!=typeof e.method){const i=new(0,E.JsonRpcError)(E.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return b.__privateGet.call(void 0,this,s)&&!C.isJsonRpcRequest.call(void 0,e)?t(null):t(i,{id:e.id??null,jsonrpc:"2.0",error:i})}if(b.__privateGet.call(void 0,this,s)&&C.isJsonRpcNotification.call(void 0,e)&&!C.isJsonRpcRequest.call(void 0,e)){try{await b.__privateGet.call(void 0,this,s).call(this,e)}catch(e){return t(e)}return t(null)}let r=null;const a={...e},o={id:a.id,jsonrpc:a.jsonrpc};try{await b.__privateMethod.call(void 0,i=A,p,m).call(i,a,o,b.__privateGet.call(void 0,this,n))}catch(e){r=e}return r&&(delete o.result,o.error||(o.error=E.serializeError.call(void 0,r))),t(r,o)},p=new WeakSet,m=async function(e,t,i){var r,a,n;const[s,o,l]=await b.__privateMethod.call(void 0,r=A,f,v).call(r,e,t,i);if(b.__privateMethod.call(void 0,a=A,y,T).call(a,e,t,o),await b.__privateMethod.call(void 0,n=A,k,w).call(n,l),s)throw s},f=new WeakSet,v=async function(e,t,i){var r;const a=[];let n=null,s=!1;for(const o of i)if([n,s]=await b.__privateMethod.call(void 0,r=A,g,_).call(r,e,t,o,a),s)break;return[n,s,a.reverse()]},g=new WeakSet,_=async function(e,t,i,r){return new Promise((a=>{const n=e=>{const i=e||t.error;i&&(t.error=E.serializeError.call(void 0,i)),a([i,!0])},s=i=>{t.error?n(t.error):(i&&("function"!=typeof i&&n(new(0,E.JsonRpcError)(E.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof i}" for request:\n${j(e)}`,{request:e})),r.push(i)),a([null,!1]))};try{i(e,t,s,n)}catch(e){n(e)}}))},k=new WeakSet,w=async function(e){for(const t of e)await new Promise(((e,i)=>{t((t=>t?i(t):e()))}))},y=new WeakSet,T=function(e,t,i){if(!C.hasProperty.call(void 0,t,"result")&&!C.hasProperty.call(void 0,t,"error"))throw new(0,E.JsonRpcError)(E.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${j(e)}`,{request:e});if(!i)throw new(0,E.JsonRpcError)(E.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${j(e)}`,{request:e})},b.__privateAdd.call(void 0,A,p),b.__privateAdd.call(void 0,A,f),b.__privateAdd.call(void 0,A,g),b.__privateAdd.call(void 0,A,k),b.__privateAdd.call(void 0,A,y);var I=A;function j(e){return JSON.stringify(e,null,2)}i.JsonRpcEngine=I}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-2LXAFMJD.js"}],[1962,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.createScaffoldMiddleware=function(e){return(t,i,r,a)=>{const n=e[t.method];return void 0===n?r():"function"==typeof n?n(t,i,r,a):(i.result=n,a())}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-3AC2MIND.js"}],[1963,{"./chunk-XDGWQHNY.js":1965},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-XDGWQHNY.js");i.createIdRemapMiddleware=function(){return(e,t,i,a)=>{const n=e.id,s=r.getUniqueId.call(void 0);e.id=s,t.id=s,i((i=>{e.id=n,t.id=n,i()}))}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-PBQXMZM5.js"}],[1964,{"./chunk-2LXAFMJD.js":1961},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-2LXAFMJD.js");i.mergeMiddleware=function(e){const t=new(0,r.JsonRpcEngine);return e.forEach((e=>t.push(e))),t.asMiddleware()}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-VK4MHWJV.js"}],[1965,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=4294967295,a=Math.floor(Math.random()*r);i.getUniqueId=function(){return a=(a+1)%r}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-XDGWQHNY.js"}],[1966,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-Z4BLTVTB.js"}],[1967,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.createAsyncMiddleware=function(e){return async(t,i,r,a)=>{let n;const s=new Promise((e=>{n=e}));let o=null,l=!1;const c=async()=>(l=!0,r((e=>{o=e,n()})),s);try{await e(t,i,c),l?(await s,o(null)):a(null)}catch(e){o?o(e):a(e)}}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-ZYXL5TCS.js"}],[1968,{"./chunk-2LXAFMJD.js":1961,"./chunk-3AC2MIND.js":1962,"./chunk-PBQXMZM5.js":1963,"./chunk-VK4MHWJV.js":1964,"./chunk-XDGWQHNY.js":1965,"./chunk-Z4BLTVTB.js":1966,"./chunk-ZYXL5TCS.js":1967},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-ZYXL5TCS.js"),a=e("./chunk-3AC2MIND.js"),n=e("./chunk-PBQXMZM5.js"),s=e("./chunk-XDGWQHNY.js"),o=e("./chunk-VK4MHWJV.js"),l=e("./chunk-2LXAFMJD.js");e("./chunk-Z4BLTVTB.js"),i.JsonRpcEngine=l.JsonRpcEngine,i.createAsyncMiddleware=r.createAsyncMiddleware,i.createIdRemapMiddleware=n.createIdRemapMiddleware,i.createScaffoldMiddleware=a.createScaffoldMiddleware,i.getUniqueId=s.getUniqueId,i.mergeMiddleware=o.mergeMiddleware}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/index.js"}],[1969,{"@metamask/safe-event-emitter":1673,"readable-stream":4188},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("@metamask/safe-event-emitter"),n=(r=a)&&r.__esModule?r:{default:r},s=e("readable-stream");i.createStreamMiddleware=function(e={}){const t={},i=new(0,s.Duplex)({objectMode:!0,read:()=>{},write:function(i,n,s){let o=null;try{!i.id?function(i){e?.retryOnMessage&&i.method===e.retryOnMessage&&Object.values(t).forEach((({req:e,retryCount:i=0})=>{if(!e.id)return;if(i>=3)throw new Error(`StreamMiddleware - Retry limit exceeded for request id "${e.id}"`);const r=t[e.id];r&&(r.retryCount=i+1),a(e)}));r.emit("notification",i)}(i):function(e){const{id:i}=e;if(null===i)return;const r=t[i];if(!r)return void console.warn(`StreamMiddleware - Unknown response id "${i}"`);delete t[i],Object.assign(r.res,e),setTimeout(r.end)}(i)}catch(e){o=e}s(o)}}),r=new(0,n.default);return{events:r,middleware:(e,i,r,n)=>{t[e.id]={req:e,res:i,next:r,end:n},a(e)},stream:i};function a(e){i.push(e)}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-middleware-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-middleware-stream/dist/chunk-3SFZPJR3.js"}],[197,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){(0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"network")&&(0,r.hasProperty)(e.NetworkController,"networkId")&&delete e.NetworkController.network;return{...e}};var r=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-084.ts"}],[1970,{"readable-stream":4188},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("readable-stream");i.createEngineStream=function(e){if(!e?.engine)throw new Error("Missing engine parameter!");const{engine:t}=e,i=new(0,r.Duplex)({objectMode:!0,read:()=>{},write:function(e,r,a){t.handle(e,((e,t)=>{i.push(t)})),a()}});return t.on&&t.on("notification",(e=>{i.push(e)})),i}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-middleware-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-middleware-stream/dist/chunk-IDTAZSDC.js"}],[1971,{"./chunk-3SFZPJR3.js":1969,"./chunk-IDTAZSDC.js":1970},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-IDTAZSDC.js"),a=e("./chunk-3SFZPJR3.js");i.createEngineStream=r.createEngineStream,i.createStreamMiddleware=a.createStreamMiddleware}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-middleware-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-middleware-stream/dist/index.js"}],[1972,{"@metamask/rpc-errors":1672},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/rpc-errors");var a=class extends Error{constructor(e){super(`Invalid subject identifier: "${"string"==typeof e?e:typeof e}"`)}},n=class extends Error{constructor(e){super(`Unrecognized subject: "${e}" has no permissions.`)}},s=class extends Error{constructor(e){super(`Caveat value merger does not exist for type: "${e}"`)}},o=class extends Error{constructor(e,t,i){super(`Invalid merged permissions for subject "${e}":\n${t.message}`),this.cause=t,this.data={diff:i}}},l=class extends Error{constructor(e,t,i){super(`Invalid approved permission for origin "${e}" and target "${t}".`),this.data={origin:e,target:t,approvedPermission:i}}},c=class extends Error{constructor(e,t){super(`Subject "${e}" has no permission for "${t}".`)}},d=class extends Error{constructor(e,t){super(`Subject "${t}" has no permission for "${e}".`),t&&(this.data={origin:t})}},u=class extends Error{constructor(e,t,i){super(`Unrecognized caveat type: "${e}"`),this.data={caveatType:e},void 0!==t&&(this.data.origin=t),void 0!==i&&(this.data.target=i)}},h=class extends Error{constructor(e,t,i){super(`The "caveats" property of permission for "${t}" of subject "${e}" is invalid. It must be a non-empty array if specified.`),this.data={origin:e,target:t,caveatsProperty:i}}},p=class extends Error{constructor(e,t,i){super(`Permission for "${t}" of subject "${e}" has no caveat of type "${i}".`)}},m=class extends Error{constructor(e,t,i){super(`Permission for "${t}" of subject "${e}" already has a caveat of type "${i}".`)}},f=class extends r.JsonRpcError{constructor(e,t,i){super(r.errorCodes.rpc.invalidParams,"Invalid caveat. Caveats must be plain objects.",{receivedCaveat:e}),this.data={origin:t,target:i}}},v=class extends Error{constructor(e,t,i){super(`Caveat types must be strings. Received: "${typeof e.type}"`),this.data={caveat:e,origin:t,target:i}}},g=class extends Error{constructor(e,t,i){super('Caveat is missing "value" field.'),this.data={caveat:e,origin:t,target:i}}},_=class extends Error{constructor(e,t,i){super('Caveat "value" is invalid JSON.'),this.data={caveat:e,origin:t,target:i}}},k=class extends Error{constructor(e,t,i){super(`Caveat has unexpected number of fields: "${Object.keys(e).length}"`),this.data={caveat:e,origin:t,target:i}}},w=class extends Error{constructor(e,t,i){super(`Permissions for target "${i}" may not have caveats of type "${e}".`),this.data={caveatType:e,origin:t,target:i}}},y=class extends Error{constructor(e,t,i){super(`Permissions for target "${i}" contains multiple caveats of type "${e}".`),this.data={caveatType:e,origin:t,target:i}}},T=class extends Error{constructor(e,t){super(`Cannot merge caveats of different types: "${e}" and "${t}".`),this.data={leftCaveatType:e,rightCaveatType:t}}},b=class extends Error{constructor(e,t){super(`Caveat specification uses a mismatched type. Expected caveats for ${t}`),this.data={caveatSpec:e,permissionType:t}}},E=class extends Error{constructor(e){super(`Permissions request with id "${e}" not found.`)}};i.unauthorized=function(e){return r.providerErrors.unauthorized({message:"Unauthorized to perform action. Try requesting the required permission(s) first. For more information, see: https://docs.metamask.io/guide/rpc-api.html#permissions",data:e.data})},i.methodNotFound=function(e,t){const i={message:`The method "${e}" does not exist / is not available.`};return void 0!==t&&(i.data=t),r.rpcErrors.methodNotFound(i)},i.invalidParams=function(e){return r.rpcErrors.invalidParams({data:e.data,message:e.message})},i.userRejectedRequest=function(e){return r.providerErrors.userRejectedRequest({data:e})},i.internalError=function(e,t){return r.rpcErrors.internal({message:e,data:t})},i.InvalidSubjectIdentifierError=a,i.UnrecognizedSubjectError=n,i.CaveatMergerDoesNotExistError=s,i.InvalidMergedPermissionsError=o,i.InvalidApprovedPermissionError=l,i.PermissionDoesNotExistError=c,i.EndowmentPermissionDoesNotExistError=d,i.UnrecognizedCaveatTypeError=u,i.InvalidCaveatsPropertyError=h,i.CaveatDoesNotExistError=p,i.CaveatAlreadyExistsError=m,i.InvalidCaveatError=f,i.InvalidCaveatTypeError=v,i.CaveatMissingValueError=g,i.CaveatInvalidJsonError=_,i.InvalidCaveatFieldsError=k,i.ForbiddenCaveatError=w,i.DuplicateCaveatError=y,i.CaveatMergeTypeMismatchError=T,i.CaveatSpecificationMismatchError=b,i.PermissionsRequestNotFoundError=E}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-3X6WO7UG.js"}],[1973,{"@metamask/base-controller":1954},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/base-controller"),a=(e=>(e.Extension="extension",e.Internal="internal",e.Unknown="unknown",e.Website="website",e.Snap="snap",e))(a||{}),n={subjectMetadata:{persist:!0,anonymous:!1}},s={subjectMetadata:{}},o=class e extends r.BaseController{constructor({messenger:t,subjectCacheLimit:i,state:r={}}){if(!Number.isInteger(i)||i<1)throw new Error(`subjectCacheLimit must be a positive integer. Received: "${i}"`);const a=e=>t.call("PermissionController:hasPermissions",e);super({name:"SubjectMetadataController",metadata:n,messenger:t,state:{...e.getTrimmedState(r,a)}}),this.subjectHasPermissions=a,this.subjectCacheLimit=i,this.subjectsWithoutPermissionsEncounteredSinceStartup=new Set,this.messagingSystem.registerActionHandler(`${this.name}:getSubjectMetadata`,this.getSubjectMetadata.bind(this)),this.messagingSystem.registerActionHandler(`${this.name}:addSubjectMetadata`,this.addSubjectMetadata.bind(this))}clearState(){this.subjectsWithoutPermissionsEncounteredSinceStartup.clear(),this.update((e=>({...s})))}addSubjectMetadata(e){const{origin:t}=e,i={...e,extensionId:e.extensionId||null,iconUrl:e.iconUrl||null,name:e.name||null,subjectType:e.subjectType||null};let r=null;if(this.subjectsWithoutPermissionsEncounteredSinceStartup.size>=this.subjectCacheLimit){const e=this.subjectsWithoutPermissionsEncounteredSinceStartup.values().next().value;this.subjectsWithoutPermissionsEncounteredSinceStartup.delete(e),this.subjectHasPermissions(e)||(r=e)}this.subjectsWithoutPermissionsEncounteredSinceStartup.add(t),this.update((e=>{e.subjectMetadata[t]=i,"string"==typeof r&&delete e.subjectMetadata[r]}))}getSubjectMetadata(e){return this.state.subjectMetadata[e]}trimMetadataState(){this.update((t=>e.getTrimmedState(t,this.subjectHasPermissions)))}static getTrimmedState(e,t){const{subjectMetadata:i={}}=e;return{subjectMetadata:Object.keys(i).reduce(((e,r)=>(t(r)&&(e[r]=i[r]),e)),{})}}};i.SubjectType=a,i.SubjectMetadataController=o}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-C73QV75D.js"}],[1974,{"./chunk-GHOOCGN3.js":1975,"./chunk-HRDKMOYS.js":1976,"./chunk-XM622CMP.js":1981,"./chunk-Z2XKIXLS.js":1982},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-HRDKMOYS.js"),a=e("./chunk-XM622CMP.js"),n=e("./chunk-GHOOCGN3.js"),s={};e("./chunk-Z2XKIXLS.js").__export.call(void 0,s,{handlers:()=>o});var o=[a.requestPermissionsHandler,r.getPermissionsHandler,n.revokePermissionsHandler];i.handlers=o,i.rpc_methods_exports=s}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-DV74ZDGD.js"}],[1975,{"./chunk-3X6WO7UG.js":1972,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-3X6WO7UG.js"),a=e("@metamask/utils"),n={methodNames:["wallet_revokePermissions"],implementation:async function(e,t,i,n,{revokePermissionsForOrigin:s}){const{params:o}=e,l=o?.[0];if(!l)return n(r.invalidParams.call(void 0,{data:{request:e}}));const c=Object.keys(l);if(!a.isNonEmptyArray.call(void 0,c))return n(r.invalidParams.call(void 0,{data:{request:e}}));return s(c),t.result=null,n()},hookNames:{revokePermissionsForOrigin:!0}};i.revokePermissionsHandler=n}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-GHOOCGN3.js"}],[1976,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r={methodNames:["wallet_getPermissions"],implementation:async function(e,t,i,r,{getPermissionsForOrigin:a}){return t.result=Object.values(a()||{}),r()},hookNames:{getPermissionsForOrigin:!0}};i.getPermissionsHandler=r}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-HRDKMOYS.js"}],[1977,{"./chunk-3X6WO7UG.js":1972,"./chunk-PTE4672I.js":1978,"./chunk-RKDXFKNN.js":1979,"./chunk-VM4LI55W.js":1980,"./chunk-Z2XKIXLS.js":1982,"./chunk-ZH4MLSXX.js":1983,"@metamask/base-controller":1954,"@metamask/controller-utils":1960,"@metamask/rpc-errors":1672,"@metamask/utils":2255,"deep-freeze-strict":3128,immer:3587,nanoid:1986},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-RKDXFKNN.js"),n=e("./chunk-ZH4MLSXX.js"),s=e("./chunk-VM4LI55W.js"),o=e("./chunk-3X6WO7UG.js"),l=e("./chunk-PTE4672I.js"),c=e("./chunk-Z2XKIXLS.js"),d=e("@metamask/base-controller"),u=e("@metamask/controller-utils"),h=e("@metamask/rpc-errors"),p=e("@metamask/utils"),m=e("deep-freeze-strict"),f=(r=m)&&r.__esModule?r:{default:r},v=e("immer"),g=e("nanoid"),_="PermissionController";var k,w,y,T,b,E,S,P,C,A,I,j,M=(e=>(e[e.noop=0]="noop",e[e.updateValue=1]="updateValue",e[e.deleteCaveat=2]="deleteCaveat",e[e.revokePermission=3]="revokePermission",e))(M||{}),x=class extends d.BaseController{constructor(e){const{caveatSpecifications:t,permissionSpecifications:i,unrestrictedMethods:r,messenger:a,state:n={}}=e;super({name:_,metadata:{subjects:{anonymous:!0,persist:!0}},messenger:a,state:{subjects:{},...n}}),c.__privateAdd.call(void 0,this,k),c.__privateAdd.call(void 0,this,y),c.__privateAdd.call(void 0,this,b),c.__privateAdd.call(void 0,this,S),c.__privateAdd.call(void 0,this,C),c.__privateAdd.call(void 0,this,I),this._unrestrictedMethods=new Set(r),this._caveatSpecifications=f.default.call(void 0,{...t}),this.validatePermissionSpecifications(i,this._caveatSpecifications),this._permissionSpecifications=f.default.call(void 0,{...i}),this.registerMessageHandlers(),this.createPermissionMiddleware=s.getPermissionMiddlewareFactory.call(void 0,{executeRestrictedMethod:this._executeRestrictedMethod.bind(this),getRestrictedMethod:this.getRestrictedMethod.bind(this),isUnrestrictedMethod:this.unrestrictedMethods.has.bind(this.unrestrictedMethods)})}get unrestrictedMethods(){return this._unrestrictedMethods}getPermissionSpecification(e){return this._permissionSpecifications[e]}getCaveatSpecification(e){return this._caveatSpecifications[e]}validatePermissionSpecifications(e,t){Object.entries(e).forEach((([e,{permissionType:i,targetName:r,allowedCaveats:s}])=>{if(!i||!p.hasProperty.call(void 0,n.PermissionType,i))throw new Error(`Invalid permission type: "${i}"`);if(!e)throw new Error(`Invalid permission target name: "${e}"`);if(e!==r)throw new Error(`Invalid permission specification: target name "${e}" must match specification.targetName value "${r}".`);s&&s.forEach((e=>{if(!p.hasProperty.call(void 0,t,e))throw new(0,o.UnrecognizedCaveatTypeError)(e);const r=t[e],n=a.isRestrictedMethodCaveatSpecification.call(void 0,r);if("RestrictedMethod"===i&&!n||"Endowment"===i&&n)throw new(0,o.CaveatSpecificationMismatchError)(r,i)}))}))}registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${_}:clearPermissions`,(()=>this.clearState())),this.messagingSystem.registerActionHandler(`${_}:getEndowments`,((e,t,i)=>this.getEndowments(e,t,i))),this.messagingSystem.registerActionHandler(`${_}:getSubjectNames`,(()=>this.getSubjectNames())),this.messagingSystem.registerActionHandler(`${_}:getPermissions`,(e=>this.getPermissions(e))),this.messagingSystem.registerActionHandler(`${_}:hasPermission`,((e,t)=>this.hasPermission(e,t))),this.messagingSystem.registerActionHandler(`${_}:hasPermissions`,(e=>this.hasPermissions(e))),this.messagingSystem.registerActionHandler(`${_}:grantPermissions`,this.grantPermissions.bind(this)),this.messagingSystem.registerActionHandler(`${_}:grantPermissionsIncremental`,this.grantPermissionsIncremental.bind(this)),this.messagingSystem.registerActionHandler(`${_}:requestPermissions`,((e,t)=>this.requestPermissions(e,t))),this.messagingSystem.registerActionHandler(`${_}:requestPermissionsIncremental`,((e,t)=>this.requestPermissionsIncremental(e,t))),this.messagingSystem.registerActionHandler(`${_}:revokeAllPermissions`,(e=>this.revokeAllPermissions(e))),this.messagingSystem.registerActionHandler(`${_}:revokePermissionForAllSubjects`,(e=>this.revokePermissionForAllSubjects(e))),this.messagingSystem.registerActionHandler(`${_}:revokePermissions`,this.revokePermissions.bind(this)),this.messagingSystem.registerActionHandler(`${_}:updateCaveat`,((e,t,i,r)=>{this.updateCaveat(e,t,i,r)}))}clearState(){this.update((e=>({subjects:{}})))}getTypedPermissionSpecification(e,t,i){const r="RestrictedMethod"===e?o.methodNotFound.call(void 0,t,i?{origin:i}:void 0):new(0,o.EndowmentPermissionDoesNotExistError)(t,i);if(!this.targetExists(t))throw r;const a=this.getPermissionSpecification(t);if(!n.hasSpecificationType.call(void 0,a,e))throw r;return a}getRestrictedMethod(e,t){return this.getTypedPermissionSpecification("RestrictedMethod",e,t).methodImplementation}getSubjectNames(){return Object.keys(this.state.subjects)}getPermission(e,t){return this.state.subjects[e]?.permissions[t]}getPermissions(e){return this.state.subjects[e]?.permissions}hasPermission(e,t){return Boolean(this.getPermission(e,t))}hasPermissions(e){return Boolean(this.state.subjects[e])}revokeAllPermissions(e){this.update((t=>{if(!t.subjects[e])throw new(0,o.UnrecognizedSubjectError)(e);delete t.subjects[e]}))}revokePermission(e,t){this.revokePermissions({[e]:[t]})}revokePermissions(e){this.update((t=>{Object.keys(e).forEach((i=>{if(!p.hasProperty.call(void 0,t.subjects,i))throw new(0,o.UnrecognizedSubjectError)(i);e[i].forEach((e=>{const{permissions:r}=t.subjects[i];if(!p.hasProperty.call(void 0,r,e))throw new(0,o.PermissionDoesNotExistError)(i,e);this.deletePermission(t.subjects,i,e)}))}))}))}revokePermissionForAllSubjects(e){0!==this.getSubjectNames().length&&this.update((t=>{Object.entries(t.subjects).forEach((([i,r])=>{const{permissions:a}=r;p.hasProperty.call(void 0,a,e)&&this.deletePermission(t.subjects,i,e)}))}))}deletePermission(e,t,i){const{permissions:r}=e[t];Object.keys(r).length>1?delete r[i]:delete e[t]}hasCaveat(e,t,i){return Boolean(this.getCaveat(e,t,i))}getCaveat(e,t,i){const r=this.getPermission(e,t);if(!r)throw new(0,o.PermissionDoesNotExistError)(e,t);return n.findCaveat.call(void 0,r,i)}addCaveat(e,t,i,r){if(this.hasCaveat(e,t,i))throw new(0,o.CaveatAlreadyExistsError)(e,t,i);this.setCaveat(e,t,i,r)}updateCaveat(e,t,i,r){if(!this.hasCaveat(e,t,i))throw new(0,o.CaveatDoesNotExistError)(e,t,i);this.setCaveat(e,t,i,r)}setCaveat(e,t,i,r){this.update((a=>{const n=a.subjects[e];if(!n)throw new(0,o.UnrecognizedSubjectError)(e);const s=n.permissions[t];if(!s)throw new(0,o.PermissionDoesNotExistError)(e,t);const l={type:i,value:r};if(this.validateCaveat(l,e,t),s.caveats){const e=s.caveats.findIndex((e=>e.type===l.type));-1===e?s.caveats.push(l):s.caveats.splice(e,1,l)}else s.caveats=[l];this.validateModifiedPermission(s,e)}))}updatePermissionsByCaveat(e,t){0!==Object.keys(this.state.subjects).length&&this.update((i=>{Object.values(i.subjects).forEach((r=>{Object.values(r.permissions).forEach((a=>{const{caveats:n}=a,s=n?.find((({type:t})=>t===e));if(!s)return;const o=t(s.value),{operation:l}=o;switch(l){case 0:break;case 1:s.value=o.value,this.validateCaveat(s,r.origin,a.parentCapability);break;case 2:this.deleteCaveat(a,e,r.origin);break;case 3:this.deletePermission(i.subjects,r.origin,a.parentCapability);break;default:throw new Error(`Unrecognized mutation result: "${l}"`)}}))}))}))}removeCaveat(e,t,i){this.update((r=>{const a=r.subjects[e]?.permissions[t];if(!a)throw new(0,o.PermissionDoesNotExistError)(e,t);if(!a.caveats)throw new(0,o.CaveatDoesNotExistError)(e,t,i);this.deleteCaveat(a,i,e)}))}deleteCaveat(e,t,i){if(!e.caveats)throw new(0,o.CaveatDoesNotExistError)(i,e.parentCapability,t);const r=e.caveats.findIndex((e=>e.type===t));if(-1===r)throw new(0,o.CaveatDoesNotExistError)(i,e.parentCapability,t);1===e.caveats.length?e.caveats=null:e.caveats.splice(r,1),this.validateModifiedPermission(e,i)}validateModifiedPermission(e,t){if(!this.targetExists(e.parentCapability))throw new Error(`Fatal: Existing permission target "${e.parentCapability}" has no specification.`);this.validatePermission(this.getPermissionSpecification(e.parentCapability),e,t)}targetExists(e){return p.hasProperty.call(void 0,this._permissionSpecifications,e)}grantPermissions({approvedPermissions:e,requestData:t,preserveExistingPermissions:i=!0,subject:r}){return c.__privateMethod.call(void 0,this,y,T).call(this,{approvedPermissions:e,subject:r,mergePermissions:!1,preserveExistingPermissions:i,requestData:t})}grantPermissionsIncremental({approvedPermissions:e,requestData:t,subject:i}){return c.__privateMethod.call(void 0,this,y,T).call(this,{approvedPermissions:e,subject:i,mergePermissions:!0,preserveExistingPermissions:!0,requestData:t})}validatePermission(e,t,i,{invokePermissionValidator:r,performCaveatValidation:a}={invokePermissionValidator:!0,performCaveatValidation:!0}){const{allowedCaveats:n,validator:s,targetName:l}=e;if(e.subjectTypes?.length&&e.subjectTypes.length>0){const t=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",i);if(!t||null===t.subjectType||!e.subjectTypes.includes(t.subjectType))throw"RestrictedMethod"===e.permissionType?o.methodNotFound.call(void 0,l,{origin:i}):new(0,o.EndowmentPermissionDoesNotExistError)(l,i)}if(p.hasProperty.call(void 0,t,"caveats")){const{caveats:e}=t;if(null!==e&&!(Array.isArray(e)&&e.length>0))throw new(0,o.InvalidCaveatsPropertyError)(i,l,e);const r=new Set;e?.forEach((e=>{if(a&&this.validateCaveat(e,i,l),!n?.includes(e.type))throw new(0,o.ForbiddenCaveatError)(e.type,i,l);if(r.has(e.type))throw new(0,o.DuplicateCaveatError)(e.type,i,l);r.add(e.type)}))}r&&s&&s(t,i,l)}setValidatedPermissions(e,t){this.update((i=>{i.subjects[e]||(i.subjects[e]={origin:e,permissions:{}}),i.subjects[e].permissions=v.castDraft.call(void 0,t)}))}constructCaveats(e,t,i){const r=i?.map((i=>{this.validateCaveat(i,e,t);const{type:r,value:a}=i;return{type:r,value:a}}));return r&&u.isNonEmptyArray.call(void 0,r)?r:void 0}validateCaveat(e,t,i){if(!u.isPlainObject.call(void 0,e))throw new(0,o.InvalidCaveatError)(e,t,i);if(2!==Object.keys(e).length)throw new(0,o.InvalidCaveatFieldsError)(e,t,i);if("string"!=typeof e.type)throw new(0,o.InvalidCaveatTypeError)(e,t,i);const r=this.getCaveatSpecification(e.type);if(!r)throw new(0,o.UnrecognizedCaveatTypeError)(e.type,t,i);if(!p.hasProperty.call(void 0,e,"value")||void 0===e.value)throw new(0,o.CaveatMissingValueError)(e,t,i);if(!u.isValidJson.call(void 0,e.value))throw new(0,o.CaveatInvalidJsonError)(e,t,i);r.validator?.(e,t,i)}async requestPermissions(e,t,i={}){const{origin:r}=e,{id:a=g.nanoid.call(void 0),preserveExistingPermissions:n=!0}=i;this.validateRequestedPermissions(r,t);const s={...i.metadata,id:a,origin:r},o={metadata:s,permissions:t},l=await this.requestUserApproval(o);return await c.__privateMethod.call(void 0,this,I,j).call(this,{subject:e,metadata:s,preserveExistingPermissions:n,approvedRequest:l})}async requestPermissionsIncremental(e,t,i={}){const{origin:r}=e,{id:a=g.nanoid.call(void 0)}=i;this.validateRequestedPermissions(r,t);const n=this.getPermissions(r)??{},[s,l]=c.__privateMethod.call(void 0,this,b,E).call(this,n,t);if(void 0===s||void 0===l)return[];try{this.validateRequestedPermissions(r,s)}catch(e){if(e instanceof Error)throw new(0,o.InvalidMergedPermissionsError)(r,e,l);throw o.internalError.call(void 0,"Unrecognized error type",{error:e})}const d={...i.metadata,id:a,origin:r},u={metadata:d,permissions:s,diff:{currentPermissions:n,permissionDiffMap:l}},h=await this.requestUserApproval(u);return await c.__privateMethod.call(void 0,this,I,j).call(this,{subject:e,metadata:d,preserveExistingPermissions:!1,approvedRequest:h})}validateRequestedPermissions(e,t){if(!u.isPlainObject.call(void 0,t))throw o.invalidParams.call(void 0,{message:`Requested permissions for origin "${e}" is not a plain object.`,data:{origin:e,requestedPermissions:t}});if(0===Object.keys(t).length)throw o.invalidParams.call(void 0,{message:`Permissions request for origin "${e}" contains no permissions.`,data:{requestedPermissions:t}});for(const i of Object.keys(t)){const r=t[i];if(!this.targetExists(i))throw o.methodNotFound.call(void 0,i,{origin:e,requestedPermissions:t});if(!u.isPlainObject.call(void 0,r)||void 0!==r.parentCapability&&i!==r.parentCapability)throw o.invalidParams.call(void 0,{message:`Permissions request for origin "${e}" contains invalid requested permission(s).`,data:{origin:e,requestedPermissions:t}});this.validatePermission(this.getPermissionSpecification(i),r,e,{invokePermissionValidator:!1,performCaveatValidation:!0})}}async requestUserApproval(e){const{origin:t,id:i}=e.metadata,r=await this.messagingSystem.call("ApprovalController:addRequest",{id:i,origin:t,requestData:e,type:"wallet_requestPermissions"},!0);return this.validateApprovedPermissions(r,{id:i,origin:t}),r}getSideEffects(e){return Object.keys(e).reduce(((e,t)=>{if(this.targetExists(t)){const i=this.getPermissionSpecification(t);i.sideEffect&&(e.permittedHandlers[t]=i.sideEffect.onPermitted,i.sideEffect.onFailure&&(e.failureHandlers[t]=i.sideEffect.onFailure))}return e}),{permittedHandlers:{},failureHandlers:{}})}async executeSideEffects(e,t){const{permittedHandlers:i,failureHandlers:r}=e,a={requestData:t,messagingSystem:this.messagingSystem},n=await Promise.allSettled(Object.values(i).map((e=>e(a)))),s=n.filter((e=>"rejected"===e.status));if(s.length>0){const e=Object.values(r);if(e.length>0)try{await Promise.all(e.map((e=>e(a))))}catch(e){throw o.internalError.call(void 0,"Unexpected error in side-effects",{error:e})}const t=s.map((e=>e.reason));throw t.forEach((e=>{console.error(e)})),t.length>1?o.internalError.call(void 0,"Multiple errors occurred during side-effects execution",{errors:t}):t[0]}return n.map((({value:e})=>e))}validateApprovedPermissions(e,t){const{id:i,origin:r}=t;if(!u.isPlainObject.call(void 0,e)||!u.isPlainObject.call(void 0,e.metadata))throw o.internalError.call(void 0,`Approved permissions request for subject "${r}" is invalid.`,{data:{approvedRequest:e}});const{metadata:{id:a,origin:n},permissions:s}=e;if(a!==i)throw o.internalError.call(void 0,`Approved permissions request for subject "${r}" mutated its id.`,{originalId:i,mutatedId:a});if(n!==r)throw o.internalError.call(void 0,`Approved permissions request for subject "${r}" mutated its origin.`,{originalOrigin:r,mutatedOrigin:n});try{this.validateRequestedPermissions(r,s)}catch(e){if(e instanceof Error)throw o.internalError.call(void 0,`Invalid approved permissions request: ${e.message}`,e instanceof h.JsonRpcError?e.data:void 0);throw o.internalError.call(void 0,"Unrecognized error type",{error:e})}}async acceptPermissionsRequest(e){const{id:t}=e.metadata;if(!this.hasApprovalRequest({id:t}))throw new(0,o.PermissionsRequestNotFoundError)(t);if(0!==Object.keys(e.permissions).length)try{this.messagingSystem.call("ApprovalController:acceptRequest",t,e)}catch(e){throw this._rejectPermissionsRequest(t,e),e}else this._rejectPermissionsRequest(t,o.invalidParams.call(void 0,{message:"Must request at least one permission."}))}async rejectPermissionsRequest(e){if(!this.hasApprovalRequest({id:e}))throw new(0,o.PermissionsRequestNotFoundError)(e);this._rejectPermissionsRequest(e,o.userRejectedRequest.call(void 0))}hasApprovalRequest(e){return this.messagingSystem.call("ApprovalController:hasRequest",e)}_rejectPermissionsRequest(e,t){return this.messagingSystem.call("ApprovalController:rejectRequest",e,t)}async getEndowments(e,t,i){if(!this.hasPermission(e,t))throw o.unauthorized.call(void 0,{data:{origin:e,targetName:t}});return this.getTypedPermissionSpecification("Endowment",t,e).endowmentGetter({origin:e,requestData:i})}async executeRestrictedMethod(e,t,i){const r=this.getRestrictedMethod(t,e),a=await this._executeRestrictedMethod(r,{origin:e},t,i);if(void 0===a)throw new Error(`Internal request for method "${t}" as origin "${e}" returned no result.`);return a}_executeRestrictedMethod(e,t,i,r=[]){const{origin:n}=t,s=this.getPermission(n,i);if(!s)throw o.unauthorized.call(void 0,{data:{origin:n,method:i}});return a.decorateWithCaveats.call(void 0,e,s,this._caveatSpecifications)({method:i,params:r,context:{origin:n}})}};k=new WeakSet,w=function(e){const{merger:t}=this.getCaveatSpecification(e);if(void 0===t)throw new(0,o.CaveatMergerDoesNotExistError)(e);return t},y=new WeakSet,T=function({approvedPermissions:e,subject:t,mergePermissions:i,preserveExistingPermissions:r,requestData:a}){const{origin:s}=t;if(!s||"string"!=typeof s)throw new(0,o.InvalidSubjectIdentifierError)(s);const l=r?{...this.getPermissions(s)}:{};for(const[t,r]of Object.entries(e)){if(!this.targetExists(t))throw o.methodNotFound.call(void 0,t);if(void 0!==r.parentCapability&&t!==r.parentCapability)throw new(0,o.InvalidApprovedPermissionError)(s,t,r);const e=t,d=this.getPermissionSpecification(e),u={caveats:this.constructCaveats(s,e,r.caveats),invoker:s,target:e};let h,p=!0;d.factory?h=d.factory(u,a):(h=n.constructPermission.call(void 0,u),p=!1),i&&(h=c.__privateMethod.call(void 0,this,S,P).call(this,l[e],h)[0]),this.validatePermission(d,h,s,{invokePermissionValidator:!0,performCaveatValidation:p}),l[e]=h}return this.setValidatedPermissions(s,l),l},b=new WeakSet,E=function(e,t){const i={},r=v.produce.call(void 0,e,(e=>{const r=e;Object.entries(t).forEach((([e,t])=>{const a=r[e],[n,s]=c.__privateMethod.call(void 0,this,S,P).call(this,a??{},t);(void 0===a||Object.keys(s).length>0)&&(r[e]=n,i[e]=s)}))}));return 0===Object.keys(i).length?[]:[r,i]},S=new WeakSet,P=function(e,t){const{caveatPairs:i,leftUniqueCaveats:r,rightUniqueCaveats:a}=l.collectUniqueAndPairedCaveats.call(void 0,e,t),[n,s]=i.reduce((([e,t],[i,r])=>{const[a,n]=c.__privateMethod.call(void 0,this,C,A).call(this,i,r);return void 0!==a&&void 0!==n?(e.push(a),t[a.type]=n):e.push(i),[e,t]}),[[],{}]),o=[...n,...r,...a.map((e=>{const[t,i]=c.__privateMethod.call(void 0,this,C,A).call(this,void 0,e);return s[t.type]=i,t}))];return[{...e,...t,...o.length>0?{caveats:o}:{}},s]},C=new WeakSet,A=function(e,t){if(void 0!==e&&e.type!==t.type)throw new(0,o.CaveatMergeTypeMismatchError)(e.type,t.type);const i=c.__privateMethod.call(void 0,this,k,w).call(this,t.type);if(void 0===e)return[{...t},t.value];const[r,a]=i(e.value,t.value);return void 0!==r&&void 0!==a?[{type:t.type,value:r},a]:[]},I=new WeakSet,j=async function({subject:e,metadata:t,preserveExistingPermissions:i,approvedRequest:r}){const{permissions:a,...n}=r,s={...t},o=this.getSideEffects(a);if(Object.values(o.permittedHandlers).length>0){const e=await this.executeSideEffects(o,r);s.data=Object.keys(o.permittedHandlers).reduce(((t,i,r)=>({[i]:e[r],...t})),{})}return[this.grantPermissions({subject:e,approvedPermissions:a,preserveExistingPermissions:i,requestData:n}),s]},i.CaveatMutatorOperation=M,i.PermissionController=x}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-I3DJ23QH.js"}],[1978,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e=>(e.requestPermissions="wallet_requestPermissions",e.getPermissions="wallet_getPermissions",e.revokePermissions="wallet_revokePermissions",e))(r||{});i.MethodNames=r,i.collectUniqueAndPairedCaveats=function(e,t){const i=e?.caveats?.slice()??[],r=t.caveats?.slice()??[],a=[],n=[];return i.forEach((e=>{const t=r.findIndex((t=>t.type===e.type));-1===t?a.push(e):(n.push([e,r[t]]),r.splice(t,1))})),{caveatPairs:n,leftUniqueCaveats:a,rightUniqueCaveats:[...r]}}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-PTE4672I.js"}],[1979,{"./chunk-3X6WO7UG.js":1972,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-3X6WO7UG.js"),a=e("@metamask/utils");function n(e){return a.hasProperty.call(void 0,e,"decorator")}i.isRestrictedMethodCaveatSpecification=n,i.decorateWithCaveats=function(e,t,i){const{caveats:a}=t;if(!a)return e;let s=async t=>e(t);for(const e of a){const t=i[e.type];if(!t)throw new(0,r.UnrecognizedCaveatTypeError)(e.type);if(!n(t))throw new(0,r.CaveatSpecificationMismatchError)(t,"RestrictedMethod");s=t.decorator(s,e)}return s}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-RKDXFKNN.js"}],[198,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){(0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"provider")&&(0,r.hasProperty)(e.NetworkController,"providerConfig")&&delete e.NetworkController.provider;return{...e}};var r=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-086.ts"}],[1980,{"./chunk-3X6WO7UG.js":1972,"@metamask/json-rpc-engine":1968},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-3X6WO7UG.js"),a=e("@metamask/json-rpc-engine");i.getPermissionMiddlewareFactory=function({executeRestrictedMethod:e,getRestrictedMethod:t,isUnrestrictedMethod:i}){return function(n){const{origin:s}=n;if("string"!=typeof s||!s)throw new Error('The subject "origin" must be a non-empty string.');return a.createAsyncMiddleware.call(void 0,(async(a,o,l)=>{const{method:c,params:d}=a;if(i(c))return l();const u=t(c,s),h=await e(u,n,c,d);void 0!==h?o.result=h:o.error=r.internalError.call(void 0,`Request for method "${a.method}" returned undefined result.`,{request:a})}))}}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-VM4LI55W.js"}],[1981,{"./chunk-3X6WO7UG.js":1972,"@metamask/controller-utils":1960},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-3X6WO7UG.js"),a=e("@metamask/controller-utils"),n={methodNames:["wallet_requestPermissions"],implementation:async function(e,t,i,n,{requestPermissionsForOrigin:s}){const{params:o}=e;if(!Array.isArray(o)||!a.isPlainObject.call(void 0,o[0]))return n(r.invalidParams.call(void 0,{data:{request:e}}));const[l]=o,[c]=await s(l);return t.result=Object.values(c),n()},hookNames:{requestPermissionsForOrigin:!0}};i.requestPermissionsHandler=n}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-XM622CMP.js"}],[1982,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=Object.defineProperty;i.__export=(e,t)=>{for(var i in t)r(e,i,{get:t[i],enumerable:!0})},i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateMethod=(e,t,i)=>(((e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)})(e,t,"access private method"),i)}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-Z2XKIXLS.js"}],[1983,{nanoid:1986},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("nanoid");var a=(e=>(e.RestrictedMethod="RestrictedMethod",e.Endowment="Endowment",e))(a||{});i.constructPermission=function(e){const{caveats:t=null,invoker:i,target:a}=e;return{id:r.nanoid.call(void 0),parentCapability:a,invoker:i,caveats:t,date:(new Date).getTime()}},i.findCaveat=function(e,t){return e.caveats?.find((e=>e.type===t))},i.PermissionType=a,i.hasSpecificationType=function(e,t){return e.permissionType===t}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-ZH4MLSXX.js"}],[1984,{"./chunk-3X6WO7UG.js":1972,"./chunk-C73QV75D.js":1973,"./chunk-DV74ZDGD.js":1974,"./chunk-GHOOCGN3.js":1975,"./chunk-HRDKMOYS.js":1976,"./chunk-I3DJ23QH.js":1977,"./chunk-PTE4672I.js":1978,"./chunk-RKDXFKNN.js":1979,"./chunk-VM4LI55W.js":1980,"./chunk-XM622CMP.js":1981,"./chunk-Z2XKIXLS.js":1982,"./chunk-ZH4MLSXX.js":1983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-DV74ZDGD.js");e("./chunk-HRDKMOYS.js"),e("./chunk-XM622CMP.js"),e("./chunk-GHOOCGN3.js");var a=e("./chunk-I3DJ23QH.js"),n=e("./chunk-RKDXFKNN.js"),s=e("./chunk-ZH4MLSXX.js"),o=e("./chunk-C73QV75D.js");e("./chunk-VM4LI55W.js");var l=e("./chunk-3X6WO7UG.js"),c=e("./chunk-PTE4672I.js");e("./chunk-Z2XKIXLS.js"),i.CaveatAlreadyExistsError=l.CaveatAlreadyExistsError,i.CaveatDoesNotExistError=l.CaveatDoesNotExistError,i.CaveatInvalidJsonError=l.CaveatInvalidJsonError,i.CaveatMergeTypeMismatchError=l.CaveatMergeTypeMismatchError,i.CaveatMergerDoesNotExistError=l.CaveatMergerDoesNotExistError,i.CaveatMissingValueError=l.CaveatMissingValueError,i.CaveatMutatorOperation=a.CaveatMutatorOperation,i.CaveatSpecificationMismatchError=l.CaveatSpecificationMismatchError,i.DuplicateCaveatError=l.DuplicateCaveatError,i.EndowmentPermissionDoesNotExistError=l.EndowmentPermissionDoesNotExistError,i.ForbiddenCaveatError=l.ForbiddenCaveatError,i.InvalidApprovedPermissionError=l.InvalidApprovedPermissionError,i.InvalidCaveatError=l.InvalidCaveatError,i.InvalidCaveatFieldsError=l.InvalidCaveatFieldsError,i.InvalidCaveatTypeError=l.InvalidCaveatTypeError,i.InvalidCaveatsPropertyError=l.InvalidCaveatsPropertyError,i.InvalidMergedPermissionsError=l.InvalidMergedPermissionsError,i.InvalidSubjectIdentifierError=l.InvalidSubjectIdentifierError,i.MethodNames=c.MethodNames,i.PermissionController=a.PermissionController,i.PermissionDoesNotExistError=l.PermissionDoesNotExistError,i.PermissionType=s.PermissionType,i.PermissionsRequestNotFoundError=l.PermissionsRequestNotFoundError,i.SubjectMetadataController=o.SubjectMetadataController,i.SubjectType=o.SubjectType,i.UnrecognizedCaveatTypeError=l.UnrecognizedCaveatTypeError,i.UnrecognizedSubjectError=l.UnrecognizedSubjectError,i.constructPermission=s.constructPermission,i.decorateWithCaveats=n.decorateWithCaveats,i.findCaveat=s.findCaveat,i.hasSpecificationType=s.hasSpecificationType,i.internalError=l.internalError,i.invalidParams=l.invalidParams,i.isRestrictedMethodCaveatSpecification=n.isRestrictedMethodCaveatSpecification,i.methodNotFound=l.methodNotFound,i.permissionRpcMethods=r.rpc_methods_exports,i.unauthorized=l.unauthorized,i.userRejectedRequest=l.userRejectedRequest}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/index.js"}],[1985,{buffer:2983,"buffer-from":2988,inherits:3588,"readable-stream":4188,typedarray:4311},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(i){(function(){var r=e("readable-stream").Writable,a=e("inherits"),n=e("buffer-from");if("undefined"==typeof Uint8Array)var s=e("typedarray").Uint8Array;else s=Uint8Array;function o(e,t){if(!(this instanceof o))return new o(e,t);"function"==typeof e&&(t=e,e={}),e||(e={});var i=e.encoding,a=!1;i?"u8"!==(i=String(i).toLowerCase())&&"uint8"!==i||(i="uint8array"):a=!0,r.call(this,{objectMode:!0}),this.encoding=i,this.shouldInferEncoding=a,t&&this.on("finish",(function(){t(this.getBody())})),this.body=[]}t.exports=o,a(o,r),o.prototype._write=function(e,t,i){this.body.push(e),i()},o.prototype.inferEncoding=function(e){var t=e===undefined?this.body[0]:e;return i.isBuffer(t)?"buffer":"undefined"!=typeof Uint8Array&&t instanceof Uint8Array?"uint8array":Array.isArray(t)?"array":"string"==typeof t?"string":"[object Object]"===Object.prototype.toString.call(t)?"object":"buffer"},o.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?function(e){for(var t=[],i=0;i<e.length;i++)t.push.apply(t,e[i]);return t}(this.body):"string"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];"string"==typeof a||i.isBuffer(a)?t.push(a):l(a)?t.push(n(a)):t.push(n(String(a)))}t=i.isBuffer(e[0])?(t=i.concat(t)).toString("utf8"):t.join("");return t}(this.body):"buffer"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];i.isBuffer(a)?t.push(a):l(a)?t.push(n(a)):t.push(n(String(a)))}return i.concat(t)}(this.body):"uint8array"===this.encoding?function(e){for(var t=0,i=0;i<e.length;i++)"string"==typeof e[i]&&(e[i]=n(e[i])),t+=e[i].length;for(var r=new s(t),a=(i=0,0);i<e.length;i++)for(var o=e[i],l=0;l<o.length;l++)r[a++]=o[l];return r}(this.body):this.body):[]};Array.isArray;function l(e){return"string"==typeof e||(t=e,/Array\]$/.test(Object.prototype.toString.call(t)))||e&&"function"==typeof e.subarray;var t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>concat-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/concat-stream/index.js"}],[1986,{"./url-alphabet/index.cjs":1987},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){let{urlAlphabet:r}=e("./url-alphabet/index.cjs"),a=e=>crypto.getRandomValues(new Uint8Array(e)),n=(e,t,i)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,a=-~(1.6*r*t/e.length);return(n=t)=>{let s="";for(;;){let t=i(a),o=a;for(;o--;)if(s+=e[t[o]&r]||"",s.length===n)return s}}};t.exports={nanoid:(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),customAlphabet:(e,t=21)=>n(e,t,a),customRandom:n,urlAlphabet:r,random:a}}}},{package:"@metamask/snaps-controllers>nanoid",file:"node_modules/@metamask/snaps-controllers/node_modules/nanoid/index.browser.cjs"}],[1987,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){t.exports={urlAlphabet:"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}}}},{package:"@metamask/snaps-controllers>nanoid",file:"node_modules/@metamask/snaps-controllers/node_modules/nanoid/url-alphabet/index.cjs"}],[199,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){if((0,r.hasProperty)(e,"NftController")&&(0,r.isObject)(e.NftController)){const t=e.NftController;if((0,r.hasProperty)(t,"allNftContracts")&&(0,r.isObject)(t.allNftContracts)){const{allNftContracts:e}=t;Object.keys(e).every((t=>(0,r.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const i=e[t];if((0,r.isObject)(i)&&a(i))for(const e of Object.keys(i))(0,r.isStrictHexString)(e)||delete i[e]}))}if((0,r.hasProperty)(t,"allNfts")&&(0,r.isObject)(t.allNfts)){const{allNfts:e}=t;Object.keys(e).every((t=>(0,r.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const i=e[t];if((0,r.isObject)(i)&&a(i))for(const e of Object.keys(i))(0,r.isStrictHexString)(e)||delete i[e]}))}e.NftController=t}if((0,r.hasProperty)(e,"TokenListController")&&(0,r.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,r.hasProperty)(t,"tokensChainsCache")&&(0,r.isObject)(t.tokensChainsCache)&&a(t.tokensChainsCache))for(const e of Object.keys(t.tokensChainsCache))(0,r.isStrictHexString)(e)||delete t.tokensChainsCache[e]}if((0,r.hasProperty)(e,"TokensController")&&(0,r.isObject)(e.TokensController)){const t=e.TokensController;if((0,r.hasProperty)(t,"allTokens")&&(0,r.isObject)(t.allTokens)&&a(t.allTokens)){const{allTokens:e}=t;for(const i of Object.keys(e))(0,r.isStrictHexString)(i)||delete t.allTokens[i]}if((0,r.hasProperty)(t,"allIgnoredTokens")&&(0,r.isObject)(t.allIgnoredTokens)&&a(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const i of Object.keys(e))(0,r.isStrictHexString)(i)||delete t.allIgnoredTokens[i]}if((0,r.hasProperty)(t,"allDetectedTokens")&&(0,r.isObject)(t.allDetectedTokens)&&a(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const i of Object.keys(e))(0,r.isStrictHexString)(i)||delete t.allDetectedTokens[i]}e.TokensController=t}return e};var r=e("@metamask/utils");function a(e){return Object.keys(e).some((e=>(0,r.isStrictHexString)(e)))}}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-088.ts"}],[1993,{"./verify":1994,"@metamask/utils":2255,superstruct:4288},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){r===undefined&&(r=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,a)}:function(e,t,i,r){r===undefined&&(r=i),e[r]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),i.SnapsRegistryDatabaseStruct=i.BlockedSnapStruct=i.BlockReasonStruct=i.VerifiedSnapStruct=i.ImagePathStruct=i.AdditionalSourceCodeStruct=i.SupportStruct=i.AuditStruct=i.AuthorStruct=void 0;const n=e("@metamask/utils"),s=e("superstruct"),o=(0,s.refine)((0,s.string)(),"Npm ID",(e=>e.startsWith("npm:"))),l=(0,s.object)({checksum:n.ChecksumStruct});i.AuthorStruct=(0,s.object)({name:(0,s.string)(),website:(0,s.string)()}),i.AuditStruct=(0,s.object)({auditor:(0,s.string)(),report:(0,s.string)()}),i.SupportStruct=(0,s.object)({knowledgeBase:(0,s.optional)((0,s.string)()),faq:(0,s.optional)((0,s.string)()),contact:(0,s.optional)((0,s.string)()),keyRecovery:(0,s.optional)((0,s.string)())}),i.AdditionalSourceCodeStruct=(0,s.object)({name:(0,s.string)(),url:(0,s.string)()}),i.ImagePathStruct=(0,s.pattern)((0,s.string)(),/\.\/images\/.*\/\d+\.(?:png|jpe?g)$/u),i.VerifiedSnapStruct=(0,s.object)({id:o,metadata:(0,s.object)({name:(0,s.string)(),type:(0,s.optional)((0,s.enums)(["account"])),author:(0,s.optional)(i.AuthorStruct),website:(0,s.optional)((0,s.string)()),onboard:(0,s.optional)((0,s.boolean)()),summary:(0,s.optional)((0,s.string)()),description:(0,s.optional)((0,s.string)()),audits:(0,s.optional)((0,s.array)(i.AuditStruct)),category:(0,s.optional)((0,s.enums)(["interoperability","notifications","transaction insights","account management"])),tags:(0,s.optional)((0,s.array)((0,s.string)())),support:(0,s.optional)(i.SupportStruct),sourceCode:(0,s.optional)((0,s.string)()),hidden:(0,s.optional)((0,s.boolean)()),privateCode:(0,s.optional)((0,s.boolean)()),privacyPolicy:(0,s.optional)((0,s.string)()),termsOfUse:(0,s.optional)((0,s.string)()),additionalSourceCode:(0,s.optional)((0,s.array)(i.AdditionalSourceCodeStruct)),screenshots:(0,s.optional)((0,s.size)((0,s.array)(i.ImagePathStruct),3,3))}),versions:(0,s.record)(n.VersionStruct,l)}),i.BlockReasonStruct=(0,s.object)({explanation:(0,s.optional)((0,s.string)()),url:(0,s.optional)((0,s.string)())}),i.BlockedSnapStruct=(0,s.union)([(0,s.object)({id:o,versionRange:n.VersionRangeStruct,reason:(0,s.optional)(i.BlockReasonStruct)}),(0,s.object)({checksum:n.ChecksumStruct,reason:(0,s.optional)(i.BlockReasonStruct)})]),i.SnapsRegistryDatabaseStruct=(0,s.object)({verifiedSnaps:(0,s.record)(o,i.VerifiedSnapStruct),blockedSnaps:(0,s.array)(i.BlockedSnapStruct)}),a(e("./verify"),i)}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/index.js"}],[1994,{"@metamask/utils":2255,"@noble/curves/secp256k1":2285,"@noble/hashes/sha256":2294,superstruct:4288},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.verify=i.SignatureStruct=void 0;const r=e("@metamask/utils"),a=e("@noble/curves/secp256k1"),n=e("@noble/hashes/sha256"),s=e("superstruct");i.SignatureStruct=(0,s.object)({signature:r.StrictHexStruct,curve:(0,s.literal)("secp256k1"),format:(0,s.literal)("DER")}),i.verify=function({registry:e,signature:t,publicKey:s}){(0,r.assertStruct)(t,i.SignatureStruct,"Invalid signature object");const o=(0,r.hexToBytes)(s);return a.secp256k1.verify((0,r.remove0x)(t.signature),(0,n.sha256)((0,r.stringToBytes)(e)),o)}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/verify.js"}],[20,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.processOnChainNotification=function(e){return{...e,id:e.id,createdAt:new Date(e.created_at).toISOString(),isRead:!e.unread}}}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/processors/process-onchain-notifications.ts"}],[200,{"./077-supplements/077-supplement-for-082":196,"./077-supplements/077-supplement-for-084":197,"./077-supplements/077-supplement-for-086":198,"./077-supplements/077-supplement-for-088":199,"@metamask/utils":2255,lodash:3783,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash"),a=d(e("loglevel")),n=e("@metamask/utils"),s=d(e("./077-supplements/077-supplement-for-082")),o=d(e("./077-supplements/077-supplement-for-084")),l=d(e("./077-supplements/077-supplement-for-086")),c=d(e("./077-supplements/077-supplement-for-088"));function d(e){return e&&e.__esModule?e:{default:e}}i.default={version:77,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=77;let i=function(e){if(!(0,n.hasProperty)(e,"TokenListController"))return a.default.warn("Skipping migration, TokenListController state is missing"),e;var t,i;if(!(0,n.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,n.hasProperty)(e.TokenListController,"tokensChainsCache"))return a.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;const{TokenListController:r}=e,{tokensChainsCache:s}=r;let o,l;for(const e in s){var c,d;if(o=s[e].data||{},l={},Array.isArray(o))for(const e of o)l[e.address]=e;else if((null===(c=Object.keys(o)[0])||void 0===c?void 0:c.toLowerCase())!==(null===(d=o[Object.keys(o)[0]])||void 0===d||null===(d=d.address)||void 0===d?void 0:d.toLowerCase()))for(const e in o)l[o[e].address]=o[e];s[e].data=Object.keys(l).length>0?l:o}return r.tokensChainsCache=s,{...e,TokenListController:{...r}}}(t.data);return i=(0,s.default)(i),i=(0,o.default)(i),i=(0,l.default)(i),i=(0,c.default)(i),t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/077.js"}],[201,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if(!(0,a.hasProperty)(e,"PhishingController")||!(0,a.isObject)(e.PhishingController))return e;const{PhishingController:t}=e;return delete t.phishing,delete t.lastFetched,e}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=78}}},{package:"$root$",file:"app/scripts/migrations/078.ts"}],[202,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:79,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=79;const i=function(e){var t,i;(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.collectiblesDetectionNoticeDismissed)!==undefined&&delete e.AppStateController.collectiblesDetectionNoticeDismissed;(null==e||null===(i=e.metamask)||void 0===i?void 0:i.collectiblesDropdownState)!==undefined&&delete e.metamask.collectiblesDropdownState;return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/079.js"}],[203,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("lodash");i.default={version:80,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=80;const i=function(e){var t;(null==e||null===(t=e.metamask)||void 0===t?void 0:t.showPortfolioTooltip)!==undefined&&delete e.metamask.showPortfolioTooltip;return e}(t.data);return t.data=i,t}}}}},{package:"$root$",file:"app/scripts/migrations/080.js"}],[204,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);t.meta.version=n;const i=function(e){if(!(0,a.hasProperty)(e,"SnapController")||!(0,a.hasProperty)(e,"PermissionController")||!(0,a.isObject)(e.PermissionController))return e;const{PermissionController:t}=e,{subjects:i}=t;if(!(0,a.isObject)(i))return e;const n="wallet_snap_";for(const[t,s]of Object.entries(i)){if(!(0,a.isObject)(s)||!(0,a.isObject)(s.permissions))return e;let i,o=1;const{permissions:l}=s,c={...l};for(const[s,d]of Object.entries(l))if(s.startsWith(n)){if(!(0,a.isObject)(d)||!(0,a.hasProperty)(d,"id")||!(0,a.hasProperty)(d,"date"))return e;if((0,a.hasProperty)(c,"wallet_snap")||(c.wallet_snap={caveats:[{type:"snapIds",value:{}}],invoker:t,parentCapability:"wallet_snap"}),!(0,a.isObject)(c.wallet_snap))return e;if(!(0,r.isArray)(c.wallet_snap.caveats))return e;const l=s.slice(n.length),u=c.wallet_snap.caveats[0];if(!(0,a.isObject)(u))return e;if(!(0,a.hasProperty)(u,"type")||"snapIds"!==u.type||!(0,a.hasProperty)(u,"value")||!(0,a.isObject)(u.value))return e;if(u.value[l]={},"number"!=typeof d.date||"string"!=typeof d.id)return e;d.date>o&&(o=d.date,i=d.id),delete c[s]}c.wallet_snap&&(c.wallet_snap.date=o,c.wallet_snap.id=i,s.permissions=c)}return e}(t.data);return t.data=i,t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=81}}},{package:"$root$",file:"app/scripts/migrations/081.ts"}],[205,{"@metamask/utils":2255,lodash:3783,loglevel:3789,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=l,t.data=function(e){if(!(0,n.hasProperty)(e,"PreferencesController"))return o.default.warn("state.PreferencesController is undefined"),e;if(!(0,n.isObject)(e.PreferencesController)){var t,i;return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController)),e}if(!(0,n.hasProperty)(e,"NetworkController")||!(0,n.isObject)(e.NetworkController)){var r,a;return null===(r=global.sentry)||void 0===r||null===(a=r.captureException)||void 0===a||a.call(r,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,n.hasProperty)(e.PreferencesController,"frequentRpcListDetail")||!Array.isArray(e.PreferencesController.frequentRpcListDetail)){var l,c;if(!(e.NetworkController.networkConfigurations&&e.PreferencesController.frequentRpcListDetail===undefined))null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error("typeof state.PreferencesController.frequentRpcListDetail is "+typeof e.PreferencesController.frequentRpcListDetail));return e}if(!e.PreferencesController.frequentRpcListDetail.every(n.isObject)){var d,u;const t=e.PreferencesController.frequentRpcListDetail.find((e=>!(0,n.isObject)(e)));return null===(d=global.sentry)||void 0===d||null===(u=d.captureException)||void 0===u||u.call(d,new Error("state.PreferencesController.frequentRpcListDetail contains an element of type "+typeof t)),e}const{PreferencesController:h,NetworkController:p}=e,{frequentRpcListDetail:m}=h;if(!Array.isArray(m))return e;const f=m.reduce(((e,{rpcUrl:t,chainId:i,ticker:r,nickname:a,rpcPrefs:n})=>({...e,[(0,s.v4)()]:{rpcUrl:t,chainId:i,ticker:r,rpcPrefs:n,nickname:a}})),{});return delete h.frequentRpcListDetail,{...e,NetworkController:{...p,networkConfigurations:f},PreferencesController:{...h}}}(t.data),t},i.version=void 0;var r,a=e("lodash"),n=e("@metamask/utils"),s=e("uuid"),o=(r=e("loglevel"))&&r.__esModule?r:{default:r};const l=i.version=82}}},{package:"$root$",file:"app/scripts/migrations/082.ts"}],[206,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if(!(0,a.isObject)(e.NetworkController)){var t,i;return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}const{NetworkController:r}=e;if(!(0,a.isObject)(r.networkConfigurations)){var n,s;return null===(n=global.sentry)||void 0===n||null===(s=n.captureException)||void 0===s||s.call(n,new Error("typeof NetworkController.networkConfigurations is "+typeof r.networkConfigurations)),e}const{networkConfigurations:o}=r,l={};for(const t of Object.keys(o)){const i=o[t];if(!(0,a.isObject)(i))return e;l[t]={...i,id:t}}return{...e,NetworkController:{...r,networkConfigurations:l}}}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=83}}},{package:"$root$",file:"app/scripts/migrations/083.ts"}],[207,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if(!(0,a.hasProperty)(e,"NetworkController")||!(0,a.isObject)(e.NetworkController)){var t,i;return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,a.hasProperty)(e.NetworkController,"network")){var r,n;if(e.NetworkController.networkId===undefined)null===(r=global.sentry)||void 0===r||null===(n=r.captureException)||void 0===n||n.call(r,new Error("typeof state.NetworkController.network is "+typeof e.NetworkController.network));return e}const s={...e.NetworkController};"loading"===s.network?(s.networkId=null,s.networkStatus="unknown"):(s.networkId=s.network,s.networkStatus="available");return delete s.network,{...e,NetworkController:s}}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=84}}},{package:"$root$",file:"app/scripts/migrations/084.ts"}],[208,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if(!(0,a.isObject)(e.NetworkController)){var t,i;return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}return delete e.NetworkController.previousProviderStore,e}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=85}}},{package:"$root$",file:"app/scripts/migrations/085.ts"}],[209,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"provider")){const t=e.NetworkController;return t.providerConfig=t.provider,delete t.provider,{...e,NetworkController:t}}var t,i;if((0,r.isObject)(e.NetworkController)){if(!(0,r.hasProperty)(e.NetworkController,"provider")){var a,n;if(e.NetworkController.providerConfig===undefined)null===(a=global.sentry)||void 0===a||null===(n=a.captureException)||void 0===n||n.call(a,new Error("typeof state.NetworkController.provider is "+typeof e.NetworkController.provider))}}else null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("lodash");const n=i.version=86}}},{package:"$root$",file:"app/scripts/migrations/086.ts"}],[21,{"../constants/notification-schema":16,"../processors/process-feature-announcement":18,"@contentful/rich-text-html-renderer":354,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FEATURE_ANNOUNCEMENT_URL=i.FEATURE_ANNOUNCEMENT_API=void 0,i.getFeatureAnnouncementNotifications=async function(){null;return[]};var r;e("@contentful/rich-text-html-renderer"),(r=e("loglevel"))&&r.__esModule,e("../processors/process-feature-announcement"),e("../constants/notification-schema");const a=i.FEATURE_ANNOUNCEMENT_API="https://cdn.contentful.com/spaces/:space_id/environments/master/entries";i.FEATURE_ANNOUNCEMENT_URL=`${a}?access_token=&content_type=productAnnouncement&include=10&fields.clients=extension`}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/services/feature-announcements.ts"}],[210,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if(!(0,r.isObject)(e.TokensController)){var t,i;return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.TokensController is "+typeof e.TokensController)),e}return delete e.TokensController.suggestedAssets,e}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("lodash");const n=i.version=87}}},{package:"$root$",file:"app/scripts/migrations/087.ts"}],[211,{"@metamask/utils":2255,"ethereumjs-util":3236,lodash:3783,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=l,function(e){if((0,a.hasProperty)(e,"NftController")&&(0,a.isObject)(e.NftController)){const l=e.NftController;if((0,a.hasProperty)(l,"allNftContracts")&&(0,a.isObject)(l.allNftContracts)){const{allNftContracts:e}=l;Object.keys(e).every((t=>(0,a.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const i=e[t];if((0,a.isObject)(i)){for(const e of Object.keys(i))"undefined"!==e&&e!==undefined&&"null"!==e||delete i[e];e[t]=(0,s.mapKeys)(i,((e,t)=>c(t)))}}))}else if((0,a.hasProperty)(l,"allNftContracts")){var t,i;null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts))}else o.default.warn("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts);if((0,a.hasProperty)(l,"allNfts")&&(0,a.isObject)(l.allNfts)){const{allNfts:e}=l;Object.keys(e).every((t=>(0,a.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const i=e[t];if((0,a.isObject)(i)){for(const e of Object.keys(i))"undefined"!==e&&e!==undefined&&"null"!==e||delete i[e];e[t]=(0,s.mapKeys)(i,((e,t)=>c(t)))}}))}else if((0,a.hasProperty)(l,"allNfts")){var r,n;null===(r=global.sentry)||void 0===r||null===(n=r.captureException)||void 0===n||n.call(r,new Error("typeof state.NftController.allNfts is "+typeof l.allNfts))}else o.default.warn("typeof state.NftController.allNfts is "+typeof l.allNfts);e.NftController=l}else if((0,a.hasProperty)(e,"NftController")){var l,d;null===(l=global.sentry)||void 0===l||null===(d=l.captureException)||void 0===d||d.call(l,new Error("typeof state.NftController is "+typeof e.NftController))}else o.default.warn("typeof state.NftController is undefined");if((0,a.hasProperty)(e,"TokenListController")&&(0,a.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,a.hasProperty)(t,"tokensChainsCache")&&(0,a.isObject)(t.tokensChainsCache)){for(const e of Object.keys(t.tokensChainsCache))"undefined"!==e&&e!==undefined&&"null"!==e||delete t.tokensChainsCache[e];t.tokensChainsCache=(0,s.mapKeys)(t.tokensChainsCache,((e,t)=>c(t)))}else if((0,a.hasProperty)(t,"tokensChainsCache")){var u,h;null===(u=global.sentry)||void 0===u||null===(h=u.captureException)||void 0===h||h.call(u,new Error("typeof state.TokenListController.tokensChainsCache is "+typeof e.TokenListController.tokensChainsCache))}else o.default.warn("typeof state.TokenListController.tokensChainsCache is undefined")}else o.default.warn("typeof state.TokenListController is "+typeof e.TokenListController);if((0,a.hasProperty)(e,"TokensController")&&(0,a.isObject)(e.TokensController)){const t=e.TokensController;if((0,a.hasProperty)(t,"allTokens")&&(0,a.isObject)(t.allTokens)){const{allTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allTokens=(0,s.mapKeys)(e,((e,t)=>c(t)))}else if((0,a.hasProperty)(t,"allTokens")){var p,m;null===(p=global.sentry)||void 0===p||null===(m=p.captureException)||void 0===m||m.call(p,new Error("typeof state.TokensController.allTokens is "+typeof t.allTokens))}else o.default.warn("typeof state.TokensController.allTokens is "+typeof t.allTokens);if((0,a.hasProperty)(t,"allIgnoredTokens")&&(0,a.isObject)(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allIgnoredTokens=(0,s.mapKeys)(e,((e,t)=>c(t)))}else if((0,a.hasProperty)(t,"allIgnoredTokens")){var f,v;null===(f=global.sentry)||void 0===f||null===(v=f.captureException)||void 0===v||v.call(f,new Error("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens))}else o.default.warn("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens);if((0,a.hasProperty)(t,"allDetectedTokens")&&(0,a.isObject)(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allDetectedTokens=(0,s.mapKeys)(e,((e,t)=>c(t)))}else if((0,a.hasProperty)(t,"allDetectedTokens")){var g,_;null===(g=global.sentry)||void 0===g||null===(_=g.captureException)||void 0===_||_.call(g,new Error("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens))}else o.default.warn("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens);e.TokensController=t}else{var k,w;null===(k=global.sentry)||void 0===k||null===(w=k.captureException)||void 0===w||w.call(k,new Error("typeof state.TokensController is "+typeof e.TokensController))}}(t.data),t},i.version=void 0;var r,a=e("@metamask/utils"),n=e("ethereumjs-util"),s=e("lodash"),o=(r=e("loglevel"))&&r.__esModule?r:{default:r};const l=i.version=88;function c(e){if("string"==typeof e&&(0,a.isStrictHexString)(e))return e;return`0x${n.BN.isBN(e)?e.toString(16):new n.BN(e.toString(),10).toString(16)}`}}}},{package:"$root$",file:"app/scripts/migrations/088.ts"}],[212,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"providerConfig")&&(0,r.isObject)(e.NetworkController.providerConfig)){const{networkConfigurations:t,providerConfig:i}=e.NetworkController;if(!(0,r.isObject)(t))return e;if(i.id)return e;let a;for(const n of Object.keys(t)){const s=t[n];if(!(0,r.isObject)(s))return e;if(s.rpcUrl===i.rpcUrl){a=s.id;break}}return a?(e.NetworkController.providerConfig={...i,id:a},{...e,NetworkController:e.NetworkController}):e}var t,i;if((0,r.isObject)(e.NetworkController)){if(!(0,r.isObject)(e.NetworkController.providerConfig)){var a,n;null===(a=global.sentry)||void 0===a||null===(n=a.captureException)||void 0===n||n.call(a,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("lodash");const n=i.version=89}}},{package:"$root$",file:"app/scripts/migrations/089.ts"}],[213,{"@metamask/utils":2255,lodash:3783,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if(!(0,n.hasProperty)(e,"PhishingController"))return s.default.warn("typeof state.PhishingController is undefined"),e;if(!(0,n.isObject)(e.PhishingController)){var t,i;return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController)),e}if(!(0,n.hasProperty)(e.PhishingController,"listState"))return s.default.warn("typeof state.PhishingController.listState is "+typeof e.PhishingController),e;return delete e.PhishingController.listState,e}(t.data),t},i.version=void 0;var r,a=e("lodash"),n=e("@metamask/utils"),s=(r=e("loglevel"))&&r.__esModule?r:{default:r};const o=i.version=90}}},{package:"$root$",file:"app/scripts/migrations/090.ts"}],[214,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"networkConfigurations")&&(0,r.isObject)(e.NetworkController.networkConfigurations)){const{networkConfigurations:t}=e.NetworkController;for(const[e,i]of Object.entries(t))(0,r.isObject)(i)&&(i.chainId||delete t[e]);return e.NetworkController={...e.NetworkController,networkConfigurations:t},{...e,NetworkController:e.NetworkController}}var t,i;if((0,r.isObject)(e.NetworkController)){if(!(0,r.isObject)(e.NetworkController.networkConfigurations)){var a,n;null===(a=global.sentry)||void 0===a||null===(n=a.captureException)||void 0===n||n.call(a,new Error("typeof state.NetworkController.networkConfigurations is "+typeof e.NetworkController.networkConfigurations))}}else null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("lodash");const n=i.version=91}}},{package:"$root$",file:"app/scripts/migrations/091.ts"}],[215,{"@metamask/utils":2255,lodash:3783,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if(!(0,n.hasProperty)(e,"TokenListController"))return s.default.warn("Skipping migration, TokenListController state is missing"),e;var t,i;if(!(0,n.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,n.hasProperty)(e.TokenListController,"tokensChainsCache"))return s.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;e.TokenListController.tokensChainsCache===undefined&&delete e.TokenListController.tokensChainsCache;return e}(t.data),t},i.version=void 0;var r,a=e("lodash"),n=e("@metamask/utils"),s=(r=e("loglevel"))&&r.__esModule?r:{default:r};const o=i.version=92.1}}},{package:"$root$",file:"app/scripts/migrations/092.1.ts"}],[216,{"@metamask/utils":2255,"@sentry/browser":2364,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){return function(e){const t=["networkId","networkStatus","providerConfig","networkDetails","networkConfigurations"];if(!(0,r.hasProperty)(e,"NetworkController")||!(0,n.isObject)(e.NetworkController))return(0,a.captureException)(`Migration ${s}: Invalid NetworkController state: ${typeof e.NetworkController}`),e;const i=e.NetworkController,o=(0,n.pick)(i,t);return{...e,NetworkController:o}}(e)}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("@sentry/browser"),n=e("lodash");const s=i.version=92.2}}},{package:"$root$",file:"app/scripts/migrations/092.2.ts"}],[217,{"@metamask/utils":2255,lodash:3783,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=o,function(e){!function(e){if((0,a.isNullOrUndefined)(e.PreferencesController))return void s.default.warn(`Migration #${o}: preferences controller null or undefined, skipping migration`);if((0,a.hasProperty)(e,"AppStateController")&&(0,a.isObject)(e.AppStateController)&&(0,a.hasProperty)(e,"PreferencesController")&&(0,a.isObject)(e.PreferencesController)){var t;const i=null===(t=e.PreferencesController)||void 0===t?void 0:t.advancedGasFee,r=(0,a.isObject)(i)&&l(i);e.AppStateController.hadAdvancedGasFeesSetPriorToMigration92_3=r,(null===e.PreferencesController.advancedGasFee||(0,a.isObject)(e.PreferencesController.advancedGasFee)&&l(e.PreferencesController.advancedGasFee))&&(e.PreferencesController.advancedGasFee={})}else if(!1===(0,a.isObject)(e.AppStateController)){var i,r;null===(i=global.sentry)||void 0===i||null===(r=i.captureException)||void 0===r||r.call(i,new Error("typeof state.AppStateController is "+typeof e.AppStateController))}else if(!1===(0,a.isObject)(e.PreferencesController)){var n,c;null===(n=global.sentry)||void 0===n||null===(c=n.captureException)||void 0===c||c.call(n,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController))}}(e)}(t.data),t},i.version=void 0;var r,a=e("@metamask/utils"),n=e("lodash"),s=(r=e("loglevel"))&&r.__esModule?r:{default:r};const o=i.version=92.3;function l(e){const t=Object.keys(e);return!(!t.includes("maxBaseFee")&&!t.includes("priorityFee"))}}}},{package:"$root$",file:"app/scripts/migrations/092.3.ts"}],[218,{"@metamask/utils":2255,lodash:3783,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if((0,n.hasProperty)(e,"PhishingController")&&(0,n.isObject)(e.PhishingController))delete e.PhishingController.stalelistLastFetched,delete e.PhishingController.hotlistLastFetched;else if((0,n.hasProperty)(e,"PhishingController")){var t,i;null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController))}else s.default.warn("typeof state.PhishingController is undefined");return e}(t.data),t},i.version=void 0;var r,a=e("lodash"),n=e("@metamask/utils"),s=(r=e("loglevel"))&&r.__esModule?r:{default:r};const o=i.version=92}}},{package:"$root$",file:"app/scripts/migrations/092.ts"}],[219,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if((0,a.hasProperty)(e,"NetworkController")&&(0,a.isObject)(e.NetworkController)&&(0,a.hasProperty)(e.NetworkController,"providerConfig")&&(0,a.isObject)(e.NetworkController.providerConfig)){const{providerConfig:t}=e.NetworkController;return t.ticker?e:(e.NetworkController.providerConfig={ticker:"ETH",...t},{...e,NetworkController:e.NetworkController})}var t,i;if((0,a.isObject)(e.NetworkController)){if((0,a.isObject)(e.NetworkController)&&!(0,a.isObject)(e.NetworkController.providerConfig)){var r,n;null===(r=global.sentry)||void 0===r||null===(n=r.captureException)||void 0===n||n.call(r,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=93}}},{package:"$root$",file:"app/scripts/migrations/093.ts"}],[22,{"../../user-storage/encryption":43,"../utils/utils":23,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TRIGGER_API_BATCH_ENDPOINT=i.TRIGGER_API=i.NOTIFICATION_API_MARK_ALL_AS_READ_ENDPOINT=i.NOTIFICATION_API_LIST_ENDPOINT_PAGE_QUERY=i.NOTIFICATION_API_LIST_ENDPOINT=i.NOTIFICATION_API=void 0,i.createOnChainTriggers=async function(e,t,i,r){const o=r.map((e=>({id:e.id,token:(0,s.createSHA256Hash)(e.id+t),config:{kind:e.kind,chain_id:Number(e.chainId),address:e.address}})));if(0===o.length)return;const l=await(0,n.makeApiCall)(i,c,"POST",o);if(!l.ok){const e=await l.json().catch((()=>undefined));throw a.default.error("Error creating triggers:",e),new Error("OnChain Notifications - unable to create triggers")}for(const t of o)(0,n.toggleUserStorageTriggerStatus)(e,t.config.address,String(t.config.chain_id),t.id,!0)},i.deleteOnChainTriggers=async function(e,t,i,r){const o=r.map((e=>({id:e,token:(0,s.createSHA256Hash)(e+t)})));try{if(!(await(0,n.makeApiCall)(i,c,"DELETE",o)).ok)throw new Error(`Failed to delete on-chain notifications for uuids ${r.join(", ")}`);for(const t of r)for(const i in e)if(Object.hasOwn(e,i))for(const r in e[i]){var l;null!=e&&null!==(l=e[i])&&void 0!==l&&null!==(l=l[r])&&void 0!==l&&l[t]&&delete e[i][r][t]}const t=(e={})=>0===Object.keys(e).length;for(const i in e)if(Object.hasOwn(e,i)){for(const r in e[i]){var d;t(null==e||null===(d=e[i])||void 0===d?void 0:d[r])&&delete e[i][r]}t(null==e?void 0:e[i])&&delete e[i]}}catch(e){throw a.default.error(`Error deleting on-chain notifications for uuids ${r.join(", ")}:`,e),e}return e},i.getOnChainNotifications=async function(e,t){const i=(0,n.traverseUserStorageTriggers)(e,{mapTrigger:e=>e.enabled?e.id:undefined});if(0===i.length)return[];const r=[];for(let e=1;e<=2;e++)try{const a=await(0,n.makeApiCall)(t,u(e),"POST",{trigger_ids:i}),s=await a.json(),o=s.map((e=>{var t;return null!==(t=e.data)&&void 0!==t&&t.kind?{...e,type:e.data.kind}:undefined})).filter((e=>Boolean(e)));if(r.push(...o),s.length<100){e=3;break}}catch(e){a.default.error(`Error fetching on-chain notifications for trigger IDs ${i.join(", ")}:`,e)}return r},i.markNotificationsAsRead=async function(e,t){if(0===t.length)return;try{const i=await(0,n.makeApiCall)(e,h,"POST",{ids:t});if(200!==i.status){const e=await i.json().catch((()=>undefined));throw new Error(`Error marking notifications as read: ${null==e?void 0:e.message}`)}}catch(e){throw a.default.error("Error marking notifications as read:",e),e}};var r,a=(r=e("loglevel"))&&r.__esModule?r:{default:r},n=e("../utils/utils"),s=e("../../user-storage/encryption");const o=i.TRIGGER_API="https://trigger.api.cx.metamask.io",l=i.NOTIFICATION_API="https://notification.api.cx.metamask.io",c=i.TRIGGER_API_BATCH_ENDPOINT=`${o}/api/v1/triggers/batch`,d=i.NOTIFICATION_API_LIST_ENDPOINT=`${l}/api/v1/notifications`,u=e=>`${d}?page=${e}&per_page=100`;i.NOTIFICATION_API_LIST_ENDPOINT_PAGE_QUERY=u;const h=i.NOTIFICATION_API_MARK_ALL_AS_READ_ENDPOINT=`${l}/api/v1/notifications/mark-as-read`}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/services/onchain-notifications.ts"}],[220,{"@metamask/controller-utils":1166,"@metamask/network-controller":1510,"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if((0,a.hasProperty)(e,"NetworkController")&&(0,a.isObject)(e.NetworkController)&&(0,a.hasProperty)(e.NetworkController,"providerConfig")&&(0,a.isObject)(e.NetworkController.providerConfig)&&((0,a.hasProperty)(e.NetworkController.providerConfig,"id")||(0,a.hasProperty)(e.NetworkController.providerConfig,"type")&&e.NetworkController.providerConfig.type!==s.NetworkType.rpc)){const t=e.NetworkController.providerConfig.id||e.NetworkController.providerConfig.type;if(!t||"string"!=typeof t)return e;const i={[t]:{EIPS:{},status:n.NetworkStatus.Unknown}};if((0,a.hasProperty)(e.NetworkController,"networkDetails")&&(0,a.isObject)(e.NetworkController.networkDetails)){const{networkDetails:r}=e.NetworkController;r.EIPS&&(0,a.isObject)(r.EIPS)&&(i[t].EIPS={...r.EIPS}),delete e.NetworkController.networkDetails}return(0,a.hasProperty)(e.NetworkController,"networkStatus")&&"string"==typeof e.NetworkController.networkStatus&&(i[t].status=e.NetworkController.networkStatus,delete e.NetworkController.networkStatus),{...e,NetworkController:{...e.NetworkController,networksMetadata:i,selectedNetworkClientId:t}}}var t,i;if((0,a.isObject)(e.NetworkController)){if((0,a.isObject)(e.NetworkController)&&!(0,a.isObject)(e.NetworkController.providerConfig)){var r,o;null===(r=global.sentry)||void 0===r||null===(o=r.captureException)||void 0===o||o.call(r,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}else if((0,a.isObject)(e.NetworkController)&&(0,a.isObject)(e.NetworkController.providerConfig)){var l,c;null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error(`typeof state.NetworkController.providerConfig.id is ${typeof e.NetworkController.providerConfig.id} and state.NetworkController.providerConfig.type is ${e.NetworkController.providerConfig.type}`))}}else null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils"),n=e("@metamask/network-controller"),s=e("@metamask/controller-utils");const o=i.version=94}}},{package:"$root$",file:"app/scripts/migrations/094.ts"}],[2208,{"./chunk-BTR56Y3F.js":2209,"./chunk-K6XMMCKJ.js":2212,"./chunk-KQMYR73X.js":2214,"@metamask/controller-utils":2233,"@metamask/utils":2255,"bn.js":2935},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-K6XMMCKJ.js"),n=e("./chunk-KQMYR73X.js"),s=e("./chunk-BTR56Y3F.js"),o=e("@metamask/controller-utils"),l=e("@metamask/utils"),c=e("bn.js"),d=(r=c)&&r.__esModule?r:{default:r},u=n.createModuleLogger.call(void 0,n.projectLogger,"gas"),h=1.5;function p(e){const t=("string"==typeof e?o.hexToBN.call(void 0,e):new(0,d.default)(e)).muln(h);return l.add0x.call(void 0,t.toString(16))}i.updateGas=async function(e,t,i){const{userOperation:r}=e;if(t.gas)return r.callGasLimit=t.gas.callGasLimit,r.preVerificationGas=t.gas.preVerificationGas,r.verificationGasLimit=t.gas.verificationGasLimit,void u("Using gas values from smart contract account",{callGasLimit:r.callGasLimit,preVerificationGas:r.preVerificationGas,verificationGasLimit:r.verificationGasLimit});const n={...r,maxFeePerGas:s.VALUE_ZERO,maxPriorityFeePerGas:s.VALUE_ZERO,callGasLimit:s.VALUE_ZERO,preVerificationGas:s.VALUE_ZERO,verificationGasLimit:"0xF4240"},o=new(0,a.Bundler)(e.bundlerUrl),l=await o.estimateUserOperationGas(n,i);r.callGasLimit=p(l.callGasLimit),r.preVerificationGas=p(l.preVerificationGas),r.verificationGasLimit=p(l.verificationGasLimit??l.verificationGas),u("Using buffered gas values from bundler estimate",{callGasLimit:r.callGasLimit,preVerificationGas:r.preVerificationGas,verificationGasLimit:r.verificationGasLimit,multiplier:h,estimate:l})}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-7JPKNM2X.js"}],[2209,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});i.EMPTY_BYTES="0x",i.ADDRESS_ZERO="0x0000000000000000000000000000000000000000",i.VALUE_ZERO="0x0"}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-BTR56Y3F.js"}],[221,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,function(e){(function(e){var t,i;const r=(null===(t=e.IncomingTransactionsController)||void 0===t?void 0:t.incomingTransactions)||{};if(0===Object.keys(r).length)return;const a=(null===(i=e.TransactionController)||void 0===i?void 0:i.transactions)||{},n=Object.values(r).reduce(((e,t)=>(e[t.id]=t,e)),a);e.TransactionController={...e.TransactionController||{},transactions:n}})(e),function(e){var t;const i=(null===(t=e.IncomingTransactionsController)||void 0===t?void 0:t.incomingTransactions)||{};if(0===Object.keys(i).length)return;const r={};for(const e of Object.values(i)){if(!e.blockNumber||!e.chainId||!e.txParams.to)continue;const t=parseInt(e.blockNumber,10),i=`${e.chainId}#${e.txParams.to.toLowerCase()}`,a=r[i]||-1;r[i]=Math.max(a,t)}e.TransactionController={...e.TransactionController,lastFetchedBlockNumbers:r}}(e),function(e){delete e.IncomingTransactionsController}(e)}(t.data),t},i.version=void 0;var r=e("lodash");const a=i.version=95}}},{package:"$root$",file:"app/scripts/migrations/095.ts"}],[2210,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e=>(e.Unapproved="unapproved",e.Approved="approved",e.Signed="signed",e.Submitted="submitted",e.Failed="failed",e.Confirmed="confirmed",e))(r||{});i.UserOperationStatus=r}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-EKSYIL4U.js"}],[2211,{"./chunk-7JPKNM2X.js":2208,"./chunk-BTR56Y3F.js":2209,"./chunk-K6XMMCKJ.js":2212,"./chunk-KBGSERJ2.js":2213,"./chunk-KQMYR73X.js":2214,"./chunk-MRVTCZLI.js":2215,"./chunk-O3AO62RJ.js":2216,"./chunk-SSHRMBLI.js":2218,"./chunk-WF3VLEGJ.js":2219,"./chunk-Z4BLTVTB.js":2220,"@metamask/base-controller":2227,"@metamask/controller-utils":2233,"@metamask/eth-query":1271,"@metamask/rpc-errors":1672,"@metamask/transaction-controller":2189,"@metamask/utils":2255,events:3276,lodash:3783,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T,b,E,S,P,C,A,I,j,M,x,N,R,O,G,L,B,F,D,U,H,W,$,V,K,Y=e("./chunk-SSHRMBLI.js"),q=e("./chunk-7JPKNM2X.js"),X=e("./chunk-WF3VLEGJ.js"),J=e("./chunk-O3AO62RJ.js"),z=e("./chunk-KBGSERJ2.js"),Z=e("./chunk-K6XMMCKJ.js"),Q=e("./chunk-KQMYR73X.js"),ee=e("./chunk-MRVTCZLI.js"),te=e("./chunk-BTR56Y3F.js"),ie=e("./chunk-Z4BLTVTB.js"),re=e("@metamask/base-controller"),ae=e("@metamask/controller-utils"),ne=r(e("@metamask/eth-query")),se=e("@metamask/rpc-errors"),oe=e("@metamask/transaction-controller"),le=e("@metamask/utils"),ce=r(e("events")),de=e("lodash"),ue=e("uuid"),he={userOperations:{persist:!0,anonymous:!1}},pe=class extends re.BaseController{constructor({entrypoint:e,getGasFeeEstimates:t,messenger:i,state:r}){super({name:"UserOperationController",metadata:he,messenger:i,state:{userOperations:{},...r}}),ie.__privateAdd.call(void 0,this,o),ie.__privateAdd.call(void 0,this,c),ie.__privateAdd.call(void 0,this,u),ie.__privateAdd.call(void 0,this,p),ie.__privateAdd.call(void 0,this,f),ie.__privateAdd.call(void 0,this,g),ie.__privateAdd.call(void 0,this,k),ie.__privateAdd.call(void 0,this,y),ie.__privateAdd.call(void 0,this,b),ie.__privateAdd.call(void 0,this,S),ie.__privateAdd.call(void 0,this,C),ie.__privateAdd.call(void 0,this,I),ie.__privateAdd.call(void 0,this,M),ie.__privateAdd.call(void 0,this,N),ie.__privateAdd.call(void 0,this,O),ie.__privateAdd.call(void 0,this,L),ie.__privateAdd.call(void 0,this,F),ie.__privateAdd.call(void 0,this,U),ie.__privateAdd.call(void 0,this,W),ie.__privateAdd.call(void 0,this,V),ie.__privateAdd.call(void 0,this,a,void 0),ie.__privateAdd.call(void 0,this,n,void 0),ie.__privateAdd.call(void 0,this,s,void 0),this.hub=new(0,ce.default),ie.__privateSet.call(void 0,this,a,e),ie.__privateSet.call(void 0,this,n,t),ie.__privateSet.call(void 0,this,s,new(0,z.PendingUserOperationTracker)({getUserOperations:()=>de.cloneDeep.call(void 0,Object.values(this.state.userOperations)),messenger:i})),ie.__privateMethod.call(void 0,this,O,G).call(this)}async addUserOperation(e,t){return J.validateAddUserOperationRequest.call(void 0,e),J.validateAddUserOperationOptions.call(void 0,t),await ie.__privateMethod.call(void 0,this,o,l).call(this,e,t)}async addUserOperationFromTransaction(e,t){J.validateAddUserOperationOptions.call(void 0,t);const{data:i,from:r,maxFeePerGas:a,maxPriorityFeePerGas:n,to:s,value:c}=e,d={data:""===i?void 0:i,from:r,maxFeePerGas:a,maxPriorityFeePerGas:n,to:s,value:c};return J.validateAddUserOperationRequest.call(void 0,d),await ie.__privateMethod.call(void 0,this,o,l).call(this,d,{...t,transaction:e})}startPollingByNetworkClientId(e){return ie.__privateGet.call(void 0,this,s).startPollingByNetworkClientId(e)}};a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=async function(e,t){Q.projectLogger.call(void 0,"Adding user operation",{request:e,options:t});const{networkClientId:i,origin:r,smartContractAccount:a,swaps:n,transaction:s}=t,{chainId:o,provider:l}=await ie.__privateMethod.call(void 0,this,U,H).call(this,i),f=await ie.__privateMethod.call(void 0,this,p,m).call(this,o,r,s,n),v=a??new(0,ee.SnapSmartContractAccount)(this.messagingSystem),g={chainId:o,metadata:f,options:{...t,smartContractAccount:v},provider:l,request:e,transaction:s},{id:_}=f;let k=!1;const w=(async()=>{try{return await ie.__privateMethod.call(void 0,this,c,d).call(this,g)}catch(e){if(ie.__privateMethod.call(void 0,this,S,P).call(this,f,e),k)throw e;return}})(),y=async()=>(k=!0,await w);return{id:_,hash:y,transactionHash:async()=>{await y();const{transactionHash:e}=await ie.__privateMethod.call(void 0,this,u,h).call(this,f);return e}}},c=new WeakSet,d=async function(e){const{metadata:t,options:i}=e,{requireApproval:r,smartContractAccount:a}=i;let n;try{return await ie.__privateMethod.call(void 0,this,f,v).call(this,e),await ie.__privateMethod.call(void 0,this,g,_).call(this,t,a),this.hub.emit("user-operation-added",t),!1!==r&&(n=await ie.__privateMethod.call(void 0,this,k,w).call(this,e)),await ie.__privateMethod.call(void 0,this,y,T).call(this,t,a),await ie.__privateMethod.call(void 0,this,b,E).call(this,t),n?.success(),t.hash}catch(e){throw n?.error(e),e}},u=new WeakSet,h=async function(e){const{id:t,hash:i}=e;return Q.projectLogger.call(void 0,"Waiting for confirmation",t,i),new Promise(((e,i)=>{this.hub.once(`${t}:confirmed`,(t=>{e(t)})),this.hub.once(`${t}:failed`,((e,t)=>{i(t)}))}))},p=new WeakSet,m=async function(e,t,i,r){const a={actualGasCost:null,actualGasUsed:null,baseFeePerGas:null,bundlerUrl:null,chainId:e,error:null,hash:null,id:ue.v1.call(void 0),origin:t,status:"unapproved",swapsMetadata:r?{approvalTxId:r.approvalTxId??null,destinationTokenAddress:r.destinationTokenAddress??null,destinationTokenDecimals:r.destinationTokenDecimals??null,destinationTokenSymbol:r.destinationTokenSymbol??null,estimatedBaseFee:r.estimatedBaseFee??null,sourceTokenSymbol:r.sourceTokenSymbol??null,swapMetaData:r.swapMetaData??null,swapTokenValue:r.swapTokenValue??null}:null,time:Date.now(),transactionHash:null,transactionParams:i??null,transactionType:null,userFeeLevel:null,userOperation:ie.__privateMethod.call(void 0,this,C,A).call(this,i)};return ie.__privateMethod.call(void 0,this,I,j).call(this,a),Q.projectLogger.call(void 0,"Added user operation",a.id),a},f=new WeakSet,v=async function(e){const{chainId:t,metadata:i,options:r,provider:s,request:o,transaction:l}=e,{data:c,from:d,to:u,value:h}=o,{id:p,transactionParams:m,userOperation:f}=i,{smartContractAccount:v}=r;Q.projectLogger.call(void 0,"Preparing user operation",{id:p});const g=await ie.__privateMethod.call(void 0,this,F,D).call(this,l,s,r);i.transactionType=g??null,Q.projectLogger.call(void 0,"Determined transaction type",g),await Y.updateGasFees.call(void 0,{getGasFeeEstimates:ie.__privateGet.call(void 0,this,n),metadata:i,originalRequest:o,provider:s,transaction:m??void 0});const _=await v.prepareUserOperation({chainId:t,data:c,from:d,to:u,value:h});J.validatePrepareUserOperationResponse.call(void 0,_);const{bundler:k,callData:w,dummyPaymasterAndData:y,dummySignature:T,initCode:b,nonce:E,sender:S}=_;f.callData=w,f.initCode=b??te.EMPTY_BYTES,f.nonce=E,f.paymasterAndData=y??te.EMPTY_BYTES,f.sender=S,f.signature=T??te.EMPTY_BYTES,i.bundlerUrl=k,await q.updateGas.call(void 0,i,_,ie.__privateGet.call(void 0,this,a)),ie.__privateMethod.call(void 0,this,I,j).call(this,i)},g=new WeakSet,_=async function(e,t){const{id:i,userOperation:r,chainId:a}=e;Q.projectLogger.call(void 0,"Requesting paymaster data",{id:i});const n=await t.updateUserOperation({userOperation:r,chainId:a});J.validateUpdateUserOperationResponse.call(void 0,n),r.paymasterAndData=n.paymasterAndData??te.EMPTY_BYTES,n.callGasLimit&&(r.callGasLimit=n.callGasLimit),n.preVerificationGas&&(r.preVerificationGas=n.preVerificationGas),n.verificationGasLimit&&(r.verificationGasLimit=n.verificationGasLimit),ie.__privateMethod.call(void 0,this,I,j).call(this,e)},k=new WeakSet,w=async function(e){Q.projectLogger.call(void 0,"Requesting approval");const{metadata:t}=e,{resultCallbacks:i,value:r}=await ie.__privateMethod.call(void 0,this,L,B).call(this,t),a=r?.txMeta;return a&&await ie.__privateMethod.call(void 0,this,W,$).call(this,e,a),t.status="approved",ie.__privateMethod.call(void 0,this,I,j).call(this,t),i},y=new WeakSet,T=async function(e,t){const{id:i,chainId:r,userOperation:a}=e;Q.projectLogger.call(void 0,"Signing user operation",i,a);const n=await t.signUserOperation({userOperation:a,chainId:r});J.validateSignUserOperationResponse.call(void 0,n);const{signature:s}=n;a.signature=s,Q.projectLogger.call(void 0,"Signed user operation",s),e.status="signed",ie.__privateMethod.call(void 0,this,I,j).call(this,e)},b=new WeakSet,E=async function(e){const{userOperation:t}=e;Q.projectLogger.call(void 0,"Submitting user operation",t);const i=new(0,Z.Bundler)(e.bundlerUrl),r=await i.sendUserOperation(t,ie.__privateGet.call(void 0,this,a));e.hash=r,e.status="submitted",ie.__privateMethod.call(void 0,this,I,j).call(this,e)},S=new WeakSet,P=function(e,t){const{id:i}=e,r=t;Q.projectLogger.call(void 0,"User operation failed",i,t),e.error={name:r.name,message:r.message,stack:r.stack,code:r.code,rpc:r.value},e.status="failed",ie.__privateMethod.call(void 0,this,I,j).call(this,e),String(r.code)===String(se.errorCodes.provider.userRejectedRequest)&&ie.__privateMethod.call(void 0,this,M,x).call(this,i)},C=new WeakSet,A=function(e){return{callData:te.EMPTY_BYTES,callGasLimit:te.EMPTY_BYTES,initCode:te.EMPTY_BYTES,maxFeePerGas:e?.maxFeePerGas??te.EMPTY_BYTES,maxPriorityFeePerGas:e?.maxPriorityFeePerGas??te.EMPTY_BYTES,nonce:te.EMPTY_BYTES,paymasterAndData:te.EMPTY_BYTES,preVerificationGas:te.EMPTY_BYTES,sender:te.ADDRESS_ZERO,signature:te.EMPTY_BYTES,verificationGasLimit:te.EMPTY_BYTES}},I=new WeakSet,j=function(e){const{id:t}=e;this.update((i=>{i.userOperations[t]=de.cloneDeep.call(void 0,e)})),ie.__privateMethod.call(void 0,this,N,R).call(this,e)},M=new WeakSet,x=function(e){this.update((t=>{delete t.userOperations[e]}))},N=new WeakSet,R=function(e){if(!e.transactionParams)return;const t=X.getTransactionMetadata.call(void 0,e);this.hub.emit("transaction-updated",t)},O=new WeakSet,G=function(){ie.__privateGet.call(void 0,this,s).hub.on("user-operation-confirmed",(e=>{Q.projectLogger.call(void 0,"In listener..."),this.hub.emit("user-operation-confirmed",e),this.hub.emit(`${e.id}:confirmed`,e)})),ie.__privateGet.call(void 0,this,s).hub.on("user-operation-failed",((e,t)=>{this.hub.emit("user-operation-failed",e,t),this.hub.emit(`${e.id}:failed`,e,t)})),ie.__privateGet.call(void 0,this,s).hub.on("user-operation-updated",(e=>{ie.__privateMethod.call(void 0,this,I,j).call(this,e)}))},L=new WeakSet,B=async function(e){const{id:t,origin:i}=e,r=ae.ApprovalType.Transaction,a={txId:t};return await this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:i,type:r,requestData:a,expectsResult:!0},!0)},F=new WeakSet,D=async function(e,t,i){if(!e)return;if(i.type)return i.type;const r=new(0,ne.default)(t),a=oe.determineTransactionType.call(void 0,e,r);return(await a).type},U=new WeakSet,H=async function(e){const{provider:t,configuration:i}=this.messagingSystem.call("NetworkController:getNetworkClientById",e),{chainId:r}=i;return{provider:t,chainId:r}},W=new WeakSet,$=async function(e,t){Q.projectLogger.call(void 0,"Found updated transaction in approval",{updatedTransaction:t});const{metadata:i,request:r}=e,{userOperation:a}=i,n=a.paymasterAndData!==te.EMPTY_BYTES,s=le.add0x.call(void 0,t.txParams.maxFeePerGas),o=le.add0x.call(void 0,t.txParams.maxPriorityFeePerGas);let l=!1;const c=a.maxFeePerGas,d=a.maxPriorityFeePerGas,u=c!==s||d!==o,h=n&&s===te.VALUE_ZERO&&o===te.VALUE_ZERO;u&&!h&&(Q.projectLogger.call(void 0,"Gas fees updated during approval",{previousMaxFeePerGas:c,previousMaxPriorityFeePerGas:d,updatedMaxFeePerGas:s,updatedMaxPriorityFeePerGas:o}),a.maxFeePerGas=s,a.maxPriorityFeePerGas=o,l=n);const p=r.data??te.EMPTY_BYTES,m=t.txParams.data??te.EMPTY_BYTES;p!==m&&(Q.projectLogger.call(void 0,"Data updated during approval",{previousData:p,updatedData:m}),l=!0);const f=r.value??te.VALUE_ZERO,v=t.txParams.value??te.VALUE_ZERO;if(f!==v&&(Q.projectLogger.call(void 0,"Value updated during approval",{previousValue:f,updatedValue:v}),l=!0),l){const t={...r,data:m,maxFeePerGas:s,maxPriorityFeePerGas:o,value:v};await ie.__privateMethod.call(void 0,this,V,K).call(this,{...e,request:t})}},V=new WeakSet,K=async function(e){Q.projectLogger.call(void 0,"Regenerating user operation as parameters were updated during approval");const{options:{smartContractAccount:t},metadata:i}=e;await ie.__privateMethod.call(void 0,this,f,v).call(this,e),await ie.__privateMethod.call(void 0,this,g,_).call(this,i,t),Q.projectLogger.call(void 0,"Regenerated user operation",i.userOperation)},i.UserOperationController=pe}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-F7MQQF7R.js"}],[2212,{"./chunk-KQMYR73X.js":2214,"./chunk-Z4BLTVTB.js":2220},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s=e("./chunk-KQMYR73X.js"),o=e("./chunk-Z4BLTVTB.js"),l=s.createModuleLogger.call(void 0,s.projectLogger,"bundler");r=new WeakMap,a=new WeakSet,n=async function(e,t){const i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:e,params:t})},a=await fetch(o.__privateGet.call(void 0,this,r),i),n=await a.json();if(n.error){const e=new Error(n.error.message||n.error);throw e.code=n.error.code,e}return n.result},i.Bundler=class{constructor(e){o.__privateAdd.call(void 0,this,a),o.__privateAdd.call(void 0,this,r,void 0),o.__privateSet.call(void 0,this,r,e)}async estimateUserOperationGas(e,t){l("Estimating gas",{url:o.__privateGet.call(void 0,this,r),userOperation:e,entrypoint:t});const i=await o.__privateMethod.call(void 0,this,a,n).call(this,"eth_estimateUserOperationGas",[e,t]);return l("Estimated gas",{response:i}),i}async getUserOperationReceipt(e){return l("Getting user operation receipt",{url:o.__privateGet.call(void 0,this,r),hash:e}),await o.__privateMethod.call(void 0,this,a,n).call(this,"eth_getUserOperationReceipt",[e])}async sendUserOperation(e,t){l("Sending user operation",{url:o.__privateGet.call(void 0,this,r),userOperation:e,entrypoint:t});const i=await o.__privateMethod.call(void 0,this,a,n).call(this,"eth_sendUserOperation",[e,t]);return l("Sent user operation",i),i}}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-K6XMMCKJ.js"}],[2213,{"./chunk-K6XMMCKJ.js":2212,"./chunk-KQMYR73X.js":2214,"./chunk-Z4BLTVTB.js":2220,"@metamask/controller-utils":2233,"@metamask/eth-query":1271,"@metamask/polling-controller":1614,"@metamask/utils":2255,events:3276},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a,n,s,o,l,c,d,u,h,p,m,f,v,g,_,k,w,y,T=e("./chunk-K6XMMCKJ.js"),b=e("./chunk-KQMYR73X.js"),E=e("./chunk-Z4BLTVTB.js"),S=e("@metamask/controller-utils"),P=r(e("@metamask/eth-query")),C=e("@metamask/polling-controller"),A=e("@metamask/utils"),I=r(e("events")),j=A.createModuleLogger.call(void 0,b.projectLogger,"pending-user-operations"),M=class extends C.BlockTrackerPollingControllerOnly{constructor({getUserOperations:e,messenger:t}){super(),E.__privateAdd.call(void 0,this,s),E.__privateAdd.call(void 0,this,l),E.__privateAdd.call(void 0,this,d),E.__privateAdd.call(void 0,this,h),E.__privateAdd.call(void 0,this,m),E.__privateAdd.call(void 0,this,v),E.__privateAdd.call(void 0,this,_),E.__privateAdd.call(void 0,this,w),E.__privateAdd.call(void 0,this,a,void 0),E.__privateAdd.call(void 0,this,n,void 0),this.hub=new(0,I.default),E.__privateSet.call(void 0,this,a,e),E.__privateSet.call(void 0,this,n,t)}async _executePoll(e,t){try{const{blockTracker:t,configuration:i,provider:r}=this._getNetworkClientById(e);j("Polling",{blockNumber:t.getCurrentBlock(),chainId:i.chainId}),await E.__privateMethod.call(void 0,this,s,o).call(this,i.chainId,r)}catch(e){j("Failed to check user operations",e)}}_getNetworkClientById(e){return E.__privateGet.call(void 0,this,n).call("NetworkController:getNetworkClientById",e)}};a=new WeakMap,n=new WeakMap,s=new WeakSet,o=async function(e,t){const i=E.__privateMethod.call(void 0,this,m,f).call(this).filter((t=>t.chainId===e));i.length?(j("Found pending user operations to check",{count:i.length,ids:i.map((e=>e.id))}),await Promise.all(i.map((e=>E.__privateMethod.call(void 0,this,l,c).call(this,e,t))))):j("No pending user operations to check")},l=new WeakSet,c=async function(e,t){const{bundlerUrl:i,hash:r,id:a}=e;if(r&&i)try{const n=await E.__privateMethod.call(void 0,this,_,k).call(this,r,i),s=n?.success;if(n&&!s)return void E.__privateMethod.call(void 0,this,h,p).call(this,e,n);if(s)return void await E.__privateMethod.call(void 0,this,d,u).call(this,e,n,t);j("No receipt found for user operation",{id:a,hash:r})}catch(e){j("Failed to check user operation",a,e)}else j("Skipping user operation as missing hash or bundler",a)},d=new WeakSet,u=async function(e,t,i){const{id:r}=e,{actualGasCost:a,actualGasUsed:n,receipt:{blockHash:s,transactionHash:o}}=t;j("User operation confirmed",r,o);const{baseFeePerGas:l}=await S.query.call(void 0,new(0,P.default)(i),"getBlockByHash",[s,!1]);e.actualGasCost=E.__privateMethod.call(void 0,this,w,y).call(this,a),e.actualGasUsed=E.__privateMethod.call(void 0,this,w,y).call(this,n),e.baseFeePerGas=l,e.status="confirmed",e.transactionHash=o,E.__privateMethod.call(void 0,this,v,g).call(this,e),this.hub.emit("user-operation-confirmed",e)},h=new WeakSet,p=function(e,t){const{id:i}=e;j("User operation failed",i),e.status="failed",E.__privateMethod.call(void 0,this,v,g).call(this,e),this.hub.emit("user-operation-failed",e,new Error("User operation receipt has failed status"))},m=new WeakSet,f=function(){return E.__privateGet.call(void 0,this,a).call(this).filter((e=>"submitted"===e.status))},v=new WeakSet,g=function(e){this.hub.emit("user-operation-updated",e)},_=new WeakSet,k=async function(e,t){return new(0,T.Bundler)(t).getUserOperationReceipt(e)},w=new WeakSet,y=function(e){return"number"==typeof e?S.toHex.call(void 0,e):e},i.PendingUserOperationTracker=M}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-KBGSERJ2.js"}],[2214,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=r.createProjectLogger.call(void 0,"user-operation-controller");i.createModuleLogger=r.createModuleLogger,i.projectLogger=a}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-KQMYR73X.js"}],[2215,{"./chunk-BTR56Y3F.js":2209,"./chunk-OIJGGQRQ.js":2217,"./chunk-Z4BLTVTB.js":2220},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-OIJGGQRQ.js"),n=e("./chunk-BTR56Y3F.js"),s=e("./chunk-Z4BLTVTB.js");r=new WeakMap,i.SnapSmartContractAccount=class{constructor(e){s.__privateAdd.call(void 0,this,r,void 0),s.__privateSet.call(void 0,this,r,e)}async prepareUserOperation(e){const{chainId:t,data:i,from:o,to:l,value:c}=e,d=i??n.EMPTY_BYTES,u=l??n.ADDRESS_ZERO,h=c??n.VALUE_ZERO,p=await s.__privateGet.call(void 0,this,r).call("KeyringController:prepareUserOperation",o,[{data:d,to:u,value:h}],{chainId:a.toEip155ChainId.call(void 0,t)}),{bundlerUrl:m,callData:f,dummyPaymasterAndData:v,dummySignature:g,gasLimits:_,initCode:k,nonce:w}=p;return{bundler:m,callData:f,dummyPaymasterAndData:v,dummySignature:g,gas:_,initCode:k,nonce:w,sender:o}}async updateUserOperation(e){const{userOperation:t,chainId:i}=e,{sender:o}=t,{paymasterAndData:l,verificationGasLimit:c,preVerificationGas:d,callGasLimit:u}=await s.__privateGet.call(void 0,this,r).call("KeyringController:patchUserOperation",o,t,{chainId:a.toEip155ChainId.call(void 0,i)});return{paymasterAndData:l===n.EMPTY_BYTES?void 0:l,verificationGasLimit:c,preVerificationGas:d,callGasLimit:u}}async signUserOperation(e){const{userOperation:t,chainId:i}=e,{sender:n}=t;return{signature:await s.__privateGet.call(void 0,this,r).call("KeyringController:signUserOperation",n,t,{chainId:a.toEip155ChainId.call(void 0,i)})}}}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-MRVTCZLI.js"}],[2216,{"./chunk-BTR56Y3F.js":2209,"@metamask/transaction-controller":2189,"@metamask/utils":2255,superstruct:4288},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-BTR56Y3F.js"),a=e("@metamask/transaction-controller"),n=e("@metamask/utils"),s=e("superstruct");function o(e,t,i){try{s.assert.call(void 0,e,t,i)}catch(e){const t=e.failures().map((e=>e.path.length?`${e.path.join(".")} - ${e.message}`:e.message)).join("\n");throw new Error(`${i}\n${t}`)}}function l(){return s.define.call(void 0,"Hexadecimal String",(e=>n.isStrictHexString.call(void 0,e)))}function c(){return s.define.call(void 0,"Hexadecimal String or 0x",(e=>n.isStrictHexString.call(void 0,e)||e===r.EMPTY_BYTES))}i.validateAddUserOperationRequest=function(e){const t=l(),i=c();o(e,s.object.call(void 0,{data:s.optional.call(void 0,i),from:t,maxFeePerGas:s.optional.call(void 0,t),maxPriorityFeePerGas:s.optional.call(void 0,t),to:s.optional.call(void 0,t),value:s.optional.call(void 0,t)}),"Invalid request to add user operation")},i.validateAddUserOperationOptions=function(e){o(e,s.object.call(void 0,{networkClientId:s.string.call(void 0),origin:s.string.call(void 0),requireApproval:s.optional.call(void 0,s.boolean.call(void 0)),smartContractAccount:s.optional.call(void 0,s.object.call(void 0,{prepareUserOperation:s.func.call(void 0),updateUserOperation:s.func.call(void 0),signUserOperation:s.func.call(void 0)})),swaps:s.optional.call(void 0,s.object.call(void 0,{approvalTxId:s.optional.call(void 0,s.string.call(void 0)),destinationTokenAddress:s.optional.call(void 0,s.string.call(void 0)),destinationTokenDecimals:s.optional.call(void 0,s.number.call(void 0)),destinationTokenSymbol:s.optional.call(void 0,s.string.call(void 0)),estimatedBaseFee:s.optional.call(void 0,s.string.call(void 0)),sourceTokenSymbol:s.optional.call(void 0,s.string.call(void 0)),swapMetaData:s.optional.call(void 0,s.object.call(void 0)),swapTokenValue:s.optional.call(void 0,s.string.call(void 0))})),type:s.optional.call(void 0,s.enums.call(void 0,Object.values(a.TransactionType)))}),"Invalid options to add user operation")},i.validatePrepareUserOperationResponse=function(e){const t=l(),i=c();o(e,s.refine.call(void 0,s.object.call(void 0,{bundler:s.string.call(void 0),callData:t,dummyPaymasterAndData:s.optional.call(void 0,i),dummySignature:s.optional.call(void 0,i),gas:s.optional.call(void 0,s.object.call(void 0,{callGasLimit:t,preVerificationGas:t,verificationGasLimit:t})),initCode:s.optional.call(void 0,i),nonce:t,sender:t}),"ValidPrepareUserOperationResponse",(({gas:e,dummySignature:t})=>!!(e||t&&t!==r.EMPTY_BYTES)||"Must specify dummySignature if not specifying gas")),"Invalid response when preparing user operation")},i.validateUpdateUserOperationResponse=function(e){o(e,s.optional.call(void 0,s.object.call(void 0,{paymasterAndData:s.optional.call(void 0,c()),callGasLimit:s.optional.call(void 0,c()),preVerificationGas:s.optional.call(void 0,c()),verificationGasLimit:s.optional.call(void 0,c())})),"Invalid response when updating user operation")},i.validateSignUserOperationResponse=function(e){const t=l();o(e,s.object.call(void 0,{signature:t}),"Invalid response when signing user operation")}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-O3AO62RJ.js"}],[2217,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.toEip155ChainId=function(e){const t=Number(e);return Number.isInteger(t)?t.toString():e}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-OIJGGQRQ.js"}],[2218,{"./chunk-BTR56Y3F.js":2209,"./chunk-KQMYR73X.js":2214,"@metamask/controller-utils":2233,"@metamask/eth-query":1271,"@metamask/gas-fee-controller":1342,"@metamask/transaction-controller":2189,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-KQMYR73X.js"),n=e("./chunk-BTR56Y3F.js"),s=e("@metamask/controller-utils"),o=e("@metamask/eth-query"),l=(r=o)&&r.__esModule?r:{default:r},c=e("@metamask/gas-fee-controller"),d=e("@metamask/transaction-controller"),u=e("@metamask/utils"),h=a.createModuleLogger.call(void 0,a.projectLogger,"gas-fees");function p(e){return s.toHex.call(void 0,s.gweiDecToWEIBN.call(void 0,e))}function m(e){return!e||e===n.EMPTY_BYTES}i.updateGasFees=async function(e){const{metadata:t,originalRequest:i,transaction:r}=e,{userOperation:a}=t;let n;const o=async()=>(n||(n=await async function(e){const{getGasFeeEstimates:t,provider:i}=e;try{const{gasFeeEstimates:e,gasEstimateType:i}=await t();if(i===c.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:i}={}}=e;if(t&&i){const e={maxFeePerGas:p(i),maxPriorityFeePerGas:p(t)};return h("Using medium values from fee market estimate",e),e}}if(i===c.GAS_ESTIMATE_TYPES.LEGACY){const t=p(e.medium);return h("Using medium value from legacy estimate",t),{maxFeePerGas:t}}if(i===c.GAS_ESTIMATE_TYPES.ETH_GASPRICE){const t=p(e.gasPrice);return h("Using gasPrice from estimate",t),{maxFeePerGas:t}}}catch(e){h("Failed to get estimate",e)}const r=await s.query.call(void 0,new(0,l.default)(i),"gasPrice");if(!r)return{};const a=u.add0x.call(void 0,r.toString(16));return h("Using gasPrice from network as fallback",a),{maxFeePerGas:a}}(e)),n);a.maxFeePerGas=await async function(e,t,i){const{maxFeePerGas:r,maxPriorityFeePerGas:a}=e,{gasPrice:n}=i??{};if(!m(r))return h("Using maxFeePerGas from request",r),r;if(m(a)&&n)return h("Setting maxFeePerGas to transaction gasPrice",n),n;const{maxFeePerGas:s}=await t();if(!s)throw new Error("Failed to get gas fee estimate for maxFeePerGas");return h("Using maxFeePerGas from estimate",s),s}(i,o,r),a.maxPriorityFeePerGas=await async function(e,t,i,r){const{maxFeePerGas:a,maxPriorityFeePerGas:n}=e,{gasPrice:s}=r??{},{maxFeePerGas:o}=i;if(!m(n))return h("Using maxPriorityFeePerGas from request",n),n;if(m(a)&&s)return h("Setting maxPriorityFeePerGas to transaction gasPrice",s),s;const{maxPriorityFeePerGas:l}=await t();if(l)return h("Using maxPriorityFeePerGas from estimate",l),l;return h("Setting maxPriorityFeePerGas to maxFeePerGas",o),o}(i,o,a,r),t.userFeeLevel=function(e,t,i,r){const{origin:a}=e,{maxFeePerGas:n,maxPriorityFeePerGas:o}=t,{maxFeePerGas:l,maxPriorityFeePerGas:c}=i||{};if(m(n)&&m(o)&&r?.gasPrice)return a===s.ORIGIN_METAMASK?d.UserFeeLevel.CUSTOM:d.UserFeeLevel.DAPP_SUGGESTED;if(m(n)&&m(o)&&l&&c)return d.UserFeeLevel.MEDIUM;if(a===s.ORIGIN_METAMASK)return d.UserFeeLevel.CUSTOM;return d.UserFeeLevel.DAPP_SUGGESTED}(t,i,n,r)}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-SSHRMBLI.js"}],[2219,{"./chunk-BTR56Y3F.js":2209,"@metamask/transaction-controller":2189,"@metamask/utils":2255,"bn.js":2935},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-BTR56Y3F.js"),n=e("@metamask/transaction-controller"),s=e("@metamask/utils"),o=e("bn.js"),l=(r=o)&&r.__esModule?r:{default:r};i.getTransactionMetadata=function(e){const{actualGasCost:t,actualGasUsed:i,baseFeePerGas:r,chainId:o,error:c,origin:d,transactionHash:u,id:h,swapsMetadata:p,time:m,transactionParams:f,transactionType:v,userFeeLevel:g,userOperation:_}=e;if(!f)return;const k=t&&i?s.add0x.call(void 0,new(0,l.default)(s.remove0x.call(void 0,t),16).div(new(0,l.default)(s.remove0x.call(void 0,i),16)).toString(16)):void 0,w=c?{name:c.name,message:c.message,stack:c.stack,code:c.code,rpc:c.rpc}:void 0,y={unapproved:n.TransactionStatus.unapproved,approved:n.TransactionStatus.approved,signed:n.TransactionStatus.signed,submitted:n.TransactionStatus.submitted,confirmed:n.TransactionStatus.confirmed,failed:n.TransactionStatus.failed}[e.status],T=function(...e){const t=new(0,l.default)(0);for(const i of e)i&&t.iadd(new(0,l.default)(s.remove0x.call(void 0,i),16));return s.add0x.call(void 0,t.toString(16))}(_.preVerificationGas,_.verificationGasLimit,_.callGasLimit),b=_.paymasterAndData!==a.EMPTY_BYTES,E=b?a.VALUE_ZERO:_.maxFeePerGas,S=b?a.VALUE_ZERO:_.maxPriorityFeePerGas,P=_.nonce===a.EMPTY_BYTES?void 0:_.nonce,C={...f,from:_.sender,gas:T,nonce:P,maxFeePerGas:E,maxPriorityFeePerGas:S};delete C.gasPrice;const A={approvalTxId:p?.approvalTxId??void 0,destinationTokenAddress:p?.destinationTokenAddress??void 0,destinationTokenDecimals:p?.destinationTokenDecimals??void 0,destinationTokenSymbol:p?.destinationTokenSymbol??void 0,estimatedBaseFee:p?.estimatedBaseFee??void 0,sourceTokenSymbol:p?.sourceTokenSymbol??void 0,swapMetaData:p?.swapMetaData??void 0,swapTokenValue:p?.swapTokenValue??void 0};return{baseFeePerGas:r??void 0,chainId:o,error:w,hash:u??void 0,id:h,isUserOperation:!0,origin:d,status:y,time:m,txParams:C,txReceipt:{effectiveGasPrice:k??void 0,gasUsed:i??void 0},type:v??void 0,userFeeLevel:b?n.UserFeeLevel.CUSTOM:g,...A}}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-WF3VLEGJ.js"}],[222,{"../../../shared/constants/network":4436,"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,function(e){if(!((0,a.hasProperty)(e,"PreferencesController")&&(0,a.isObject)(e.PreferencesController)&&(0,a.isObject)(e.NetworkController)&&(0,a.hasProperty)(e.PreferencesController,"featureFlags")&&(0,a.hasProperty)(e.NetworkController,"networkConfigurations")))return e;const{PreferencesController:t,NetworkController:i}=e,{featureFlags:s}=t,{showIncomingTransactions:o}=s,{networkConfigurations:l}=i,c=Object.values(l).map((e=>e.chainId)),d=[n.CHAIN_IDS.MAINNET,n.CHAIN_IDS.LINEA_MAINNET],u=[n.CHAIN_IDS.GOERLI,n.CHAIN_IDS.SEPOLIA,n.CHAIN_IDS.LINEA_GOERLI],h=[...d,...c,...u],p=(0,r.fromPairs)((0,r.map)(h,(e=>[e,o])));(null==s?void 0:s.showIncomingTransactions)!==undefined&&delete s.showIncomingTransactions;e.PreferencesController.incomingTransactionsPreferences=p}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils"),n=e("../../../shared/constants/network");const s=i.version=96}}},{package:"$root$",file:"app/scripts/migrations/096.ts"}],[2220,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-Z4BLTVTB.js"}],[2221,{"./chunk-7JPKNM2X.js":2208,"./chunk-BTR56Y3F.js":2209,"./chunk-EKSYIL4U.js":2210,"./chunk-F7MQQF7R.js":2211,"./chunk-K6XMMCKJ.js":2212,"./chunk-KBGSERJ2.js":2213,"./chunk-KQMYR73X.js":2214,"./chunk-MRVTCZLI.js":2215,"./chunk-O3AO62RJ.js":2216,"./chunk-OIJGGQRQ.js":2217,"./chunk-SSHRMBLI.js":2218,"./chunk-WF3VLEGJ.js":2219,"./chunk-Z4BLTVTB.js":2220},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-F7MQQF7R.js");e("./chunk-SSHRMBLI.js"),e("./chunk-7JPKNM2X.js"),e("./chunk-WF3VLEGJ.js"),e("./chunk-O3AO62RJ.js"),e("./chunk-KBGSERJ2.js");var a=e("./chunk-EKSYIL4U.js");e("./chunk-K6XMMCKJ.js"),e("./chunk-KQMYR73X.js"),e("./chunk-MRVTCZLI.js"),e("./chunk-OIJGGQRQ.js"),e("./chunk-BTR56Y3F.js"),e("./chunk-Z4BLTVTB.js"),i.UserOperationController=r.UserOperationController,i.UserOperationStatus=a.UserOperationStatus}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/index.js"}],[2222,{"./chunk-UJFCPTF3.js":2224,"./chunk-Z4BLTVTB.js":2225},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,i.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,r,new Map),l.__privateAdd.call(void 0,this,a,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,r).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,r).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,r).delete(e)}clearActions(){l.__privateGet.call(void 0,this,r).clear()}call(e,...t){const i=l.__privateGet.call(void 0,this,r).get(e);if(!i)throw new Error(`A handler for ${e} has not been registered`);return i(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,n).set(e,t)}publish(e,...t){const i=l.__privateGet.call(void 0,this,a).get(e);if(i)for(const[e,r]of i.entries())try{if(r){const i=l.__privateGet.call(void 0,this,s).get(e),a=r(...t);a!==i&&(l.__privateGet.call(void 0,this,s).set(e,a),e(a,i))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,i){let r=l.__privateGet.call(void 0,this,a).get(e);if(r||(r=new Map,l.__privateGet.call(void 0,this,a).set(e,r)),r.set(t,i),i){const r=l.__privateGet.call(void 0,this,n).get(e);if(r){const e=i(...r());l.__privateGet.call(void 0,this,s).set(t,e)}}}unsubscribe(e,t){const i=l.__privateGet.call(void 0,this,a).get(e);if(!i||!i.has(t))throw new Error(`Subscription not found for event: ${e}`);i.get(t)&&l.__privateGet.call(void 0,this,s).delete(t),i.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,a).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,a).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:i}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:i})}}}}},{package:"@metamask/user-operation-controller>@metamask/base-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[2223,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,i=!0){if(i){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const i=e[t];this.internalConfig[t]=i,this[t]=i}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},a=r;i.BaseControllerV1=r,i.BaseControllerV1_default=a}}},{package:"@metamask/user-operation-controller>@metamask/base-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[2224,{"./chunk-Z4BLTVTB.js":2225},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a,n,s,o,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,s);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,n);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,a)}:`)},i.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:i,allowedEvents:l}){p.__privateAdd.call(void 0,this,o),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,r,void 0),p.__privateAdd.call(void 0,this,a,void 0),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateSet.call(void 0,this,r,e),p.__privateSet.call(void 0,this,a,t),p.__privateSet.call(void 0,this,n,i),p.__privateSet.call(void 0,this,s,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,r).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).publish(e,...t)}subscribe(e,t,i){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return i?p.__privateGet.call(void 0,this,r).subscribe(e,t,i):p.__privateGet.call(void 0,this,r).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,r).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,a)}:'`);p.__privateGet.call(void 0,this,r).clearEventSubscriptions(e)}}}}},{package:"@metamask/user-operation-controller>@metamask/base-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[2225,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};i.__privateGet=(e,t,i)=>(r(e,t,"read from private field"),i?i.call(e):t.get(e)),i.__privateAdd=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i.__privateSet=(e,t,i,a)=>(r(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),i.__privateMethod=(e,t,i)=>(r(e,t,"access private method"),i)}}},{package:"@metamask/user-operation-controller>@metamask/base-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[2226,{"./chunk-Z4BLTVTB.js":2225,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r,a=e("./chunk-Z4BLTVTB.js"),n=e("immer");n.enablePatches.call(void 0);function s(e,t,i){return Object.keys(e).reduce(((r,a)=>{try{const n=t[a];if(!n)throw new Error(`No metadata found for '${String(a)}'`);const s=n[i],o=e[a];return"function"==typeof s?r[a]=s(o):s&&(r[a]=o),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}r=new WeakMap,i.BaseController=class{constructor({messenger:e,metadata:t,name:i,state:s}){a.__privateAdd.call(void 0,this,r,void 0),this.messagingSystem=e,this.name=i,a.__privateSet.call(void 0,this,r,n.freeze.call(void 0,s,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${i}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${i}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return a.__privateGet.call(void 0,this,r)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,i,s]=n.produceWithPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);return a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,i),{nextState:t,patches:i,inversePatches:s}}applyPatches(e){const t=n.applyPatches.call(void 0,a.__privateGet.call(void 0,this,r),e);a.__privateSet.call(void 0,this,r,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},i.getAnonymizedState=function(e,t){return s(e,t,"anonymous")},i.getPersistentState=function(e,t){return s(e,t,"persist")}}}},{package:"@metamask/user-operation-controller>@metamask/base-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[2227,{"./chunk-G42723LG.js":2222,"./chunk-NINOM2XQ.js":2223,"./chunk-UJFCPTF3.js":2224,"./chunk-Z4BLTVTB.js":2225,"./chunk-ZNOPSWMU.js":2226},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-NINOM2XQ.js"),a=e("./chunk-ZNOPSWMU.js"),n=e("./chunk-G42723LG.js"),s=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),i.BaseController=a.BaseController,i.BaseControllerV1=r.BaseControllerV1,i.ControllerMessenger=n.ControllerMessenger,i.RestrictedControllerMessenger=s.RestrictedControllerMessenger,i.getAnonymizedState=a.getAnonymizedState,i.getPersistentState=a.getPersistentState}}},{package:"@metamask/user-operation-controller>@metamask/base-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/base-controller/dist/index.js"}],[2228,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("@metamask/utils"),a=r.createProjectLogger.call(void 0,"controller-utils");i.createModuleLogger=r.createModuleLogger,i.projectLogger=a}}},{package:"@metamask/user-operation-controller>@metamask/controller-utils",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[2229,{"./chunk-X4PYR7CK.js":2232,"@ethereumjs/util":441,"@metamask/ethjs-unit":1336,"@metamask/utils":2255,"bn.js":2935,buffer:2983,"eth-ens-namehash":3173,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a=e("./chunk-X4PYR7CK.js"),n=e("@ethereumjs/util"),s=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=r(e("bn.js")),c=r(e("eth-ens-namehash")),d=r(e("fast-deep-equal")),u=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function m(e,t){const i=await fetch(e,t);if(!i.ok)throw new Error(`Fetch failed with status '${i.status}' for request '${String(e)}'`);return i}async function f(e,t){const i=await m(e,t);return await i.json()}i.PROTOTYPE_POLLUTION_BLOCKLIST=h,i.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},i.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=a.MAX_SAFE_CHAIN_ID},i.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},i.fractionBN=function(e,t,i){const r=new(0,l.default)(t),a=new(0,l.default)(i);return e.mul(r).div(a)},i.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),i=t[0]||"0";let r=t[1]||"";if(!r)return s.toWei.call(void 0,i,"gwei");if(r.length<=9)return s.toWei.call(void 0,`${i}.${r}`,"gwei");const a=r.slice(9)[0];r=r.slice(0,9);let n=s.toWei.call(void 0,`${i}.${r}`,"gwei");return Number(a)>=5&&(n=n.add(new(0,l.default)(1))),n},i.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return s.fromWei.call(void 0,t,"gwei")},i.getBuyURL=function(e="1",t,i=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${i}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},i.hexToBN=p,i.hexToText=function(e){try{const i=o.remove0x.call(void 0,e);return t.from(i,"hex").toString("utf8")}catch(t){return e}},i.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(p(e).toString(10))},i.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},i.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},i.safelyExecuteWithTimeout=async function(e,t=!1,i=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])}catch(e){return void(t&&console.error(e))}},i.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?n.toChecksumAddress.call(void 0,t):t},i.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const i=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,i)&&n.isValidAddress.call(void 0,i)},i.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},i.successfulFetch=m,i.handleFetch=f,i.fetchWithErrorHandling=async function({url:e,options:t,timeout:i,errorCodesToCatch:r}){let a;try{a=i?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==u)throw e;console.error(e)}(e,r)}return a},i.timeoutFetch=async function(e,t,i=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),i)))])},i.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},i.query=function(e,t,i=[]){return new Promise(((r,a)=>{const n=(e,t)=>{e?a(e):r(t)};t in e&&"function"==typeof e[t]?e[t](...i,n):e.sendAsync({method:t,params:i},n)}))},i.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,i.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},i.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},i.isValidJson=function(e){try{return d.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/user-operation-controller>@metamask/controller-utils",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/controller-utils/dist/chunk-EDY72VWL.js"}],[223,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,function(e){const t=(null==e?void 0:e.TransactionController)||{},i=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(i))return;const a=Object.keys(i).reduce(((e,t)=>{const r=i[t];return null!=r&&r.nonceDetails&&delete r.nonceDetails,{...e,[t]:r}}),{});e.TransactionController={...t,transactions:a}}(t.data),t},i.version=void 0;var r=e("lodash");const a=i.version=97}}},{package:"$root$",file:"app/scripts/migrations/097.ts"}],[2230,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},a={...r,rpc:"rpc"};var n=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(n||{}),s={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});i.InfuraNetworkType=r,i.NetworkType=a,i.isNetworkType=function(e){return Object.values(a).includes(e)},i.isInfuraNetworkType=function(e){return Object.keys(r).includes(e)},i.BuiltInNetworkName=n,i.ChainId=s,i.NetworksTicker=o}}},{package:"@metamask/user-operation-controller>@metamask/controller-utils",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[2231,{"./chunk-DBJSLKNR.js":2228,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){(function(t){(function(){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-DBJSLKNR.js"),a=e("@metamask/utils"),n=e("@spruceid/siwe-parser"),s=r.createModuleLogger.call(void 0,r.projectLogger,"detect-siwe");function o(e){try{const r="string"!=typeof(i=e)?i:a.remove0x.call(void 0,i),n=t.from(r,"hex");return 32===n.length?e:n.toString("utf8")}catch(t){return s(t),e}var i}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);i.parseDomainParts=c,i.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:i}=e;if(!t||!i?.parsedMessage?.domain)return!1;const r=new URL(t),a=c(i.parsedMessage.domain,r.protocol);return 0===a.hostname.localeCompare(r.hostname,void 0,{sensitivity:"accent"})&&(""!==a.port&&a.port!==r.port?""===r.port&&a.port===l[r.protocol]:""===a.username||a.username===r.username)}catch(e){return s(e),!1}},i.detectSIWE=e=>{try{const{data:t}=e,i=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,n.ParsedMessage)(i)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/user-operation-controller>@metamask/controller-utils",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[2232,{"./chunk-LGGBBU6G.js":2230},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-LGGBBU6G.js"),a={[r.NetworkType.goerli]:{chainId:r.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.goerli}.etherscan.io`}},[r.NetworkType.sepolia]:{chainId:r.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.sepolia}.etherscan.io`}},[r.NetworkType.mainnet]:{chainId:r.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[r.NetworkType["linea-goerli"]]:{chainId:r.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[r.NetworkType["linea-sepolia"]]:{chainId:r.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[r.NetworkType["linea-mainnet"]]:{chainId:r.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[r.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},n=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(n||{}),s={[r.ChainId.goerli]:"goerli",[r.ChainId.sepolia]:"sepolia",[r.ChainId.mainnet]:"mainnet",[r.ChainId["linea-goerli"]]:"linea-goerli",[r.ChainId["linea-sepolia"]]:"linea-sepolia",[r.ChainId["linea-mainnet"]]:"linea-mainnet",[r.ChainId.aurora]:"aurora"};i.RPC="rpc",i.FALL_BACK_VS_CURRENCY="ETH",i.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",i.GANACHE_CHAIN_ID="0x539",i.MAX_SAFE_CHAIN_ID=0xfffffffffffec,i.ERC721="ERC721",i.ERC1155="ERC1155",i.ERC20="ERC20",i.ERC721_INTERFACE_ID="0x80ac58cd",i.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",i.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",i.ERC1155_INTERFACE_ID="0xd9b67a26",i.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",i.GWEI="gwei",i.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},i.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},i.BUILT_IN_NETWORKS=a,i.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v2",i.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",i.ORIGIN_METAMASK="metamask",i.ApprovalType=n,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s}}},{package:"@metamask/user-operation-controller>@metamask/controller-utils",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/controller-utils/dist/chunk-X4PYR7CK.js"}],[2233,{"./chunk-DBJSLKNR.js":2228,"./chunk-EDY72VWL.js":2229,"./chunk-LGGBBU6G.js":2230,"./chunk-M6G3ISXG.js":2231,"./chunk-X4PYR7CK.js":2232},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var a=e("./chunk-EDY72VWL.js"),n=e("./chunk-X4PYR7CK.js"),s=e("./chunk-LGGBBU6G.js");i.ASSET_TYPES=n.ASSET_TYPES,i.ApprovalType=n.ApprovalType,i.BNToHex=a.BNToHex,i.BUILT_IN_NETWORKS=n.BUILT_IN_NETWORKS,i.BuiltInNetworkName=s.BuiltInNetworkName,i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=n.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,i.ChainId=s.ChainId,i.ERC1155=n.ERC1155,i.ERC1155_INTERFACE_ID=n.ERC1155_INTERFACE_ID,i.ERC1155_METADATA_URI_INTERFACE_ID=n.ERC1155_METADATA_URI_INTERFACE_ID,i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=n.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,i.ERC20=n.ERC20,i.ERC721=n.ERC721,i.ERC721_ENUMERABLE_INTERFACE_ID=n.ERC721_ENUMERABLE_INTERFACE_ID,i.ERC721_INTERFACE_ID=n.ERC721_INTERFACE_ID,i.ERC721_METADATA_INTERFACE_ID=n.ERC721_METADATA_INTERFACE_ID,i.FALL_BACK_VS_CURRENCY=n.FALL_BACK_VS_CURRENCY,i.GANACHE_CHAIN_ID=n.GANACHE_CHAIN_ID,i.GWEI=n.GWEI,i.IPFS_DEFAULT_GATEWAY_URL=n.IPFS_DEFAULT_GATEWAY_URL,i.InfuraNetworkType=s.InfuraNetworkType,i.MAX_SAFE_CHAIN_ID=n.MAX_SAFE_CHAIN_ID,i.NFT_API_BASE_URL=n.NFT_API_BASE_URL,i.NetworkType=s.NetworkType,i.NetworksTicker=s.NetworksTicker,i.OPENSEA_PROXY_URL=n.OPENSEA_PROXY_URL,i.ORIGIN_METAMASK=n.ORIGIN_METAMASK,i.RPC=n.RPC,i.TESTNET_TICKER_SYMBOLS=n.TESTNET_TICKER_SYMBOLS,i.convertHexToDecimal=a.convertHexToDecimal,i.detectSIWE=r.detectSIWE,i.fetchWithErrorHandling=a.fetchWithErrorHandling,i.fractionBN=a.fractionBN,i.fromHex=a.fromHex,i.getBuyURL=a.getBuyURL,i.gweiDecToWEIBN=a.gweiDecToWEIBN,i.handleFetch=a.handleFetch,i.hexToBN=a.hexToBN,i.hexToText=a.hexToText,i.isInfuraNetworkType=s.isInfuraNetworkType,i.isNetworkType=s.isNetworkType,i.isNonEmptyArray=a.isNonEmptyArray,i.isPlainObject=a.isPlainObject,i.isSafeChainId=a.isSafeChainId,i.isSafeDynamicKey=a.isSafeDynamicKey,i.isSmartContractCode=a.isSmartContractCode,i.isValidHexAddress=a.isValidHexAddress,i.isValidJson=a.isValidJson,i.isValidSIWEOrigin=r.isValidSIWEOrigin,i.normalizeEnsName=a.normalizeEnsName,i.parseDomainParts=r.parseDomainParts,i.query=a.query,i.safelyExecute=a.safelyExecute,i.safelyExecuteWithTimeout=a.safelyExecuteWithTimeout,i.successfulFetch=a.successfulFetch,i.timeoutFetch=a.timeoutFetch,i.toChecksumHexAddress=a.toChecksumHexAddress,i.toHex=a.toHex,i.weiHexToGweiDec=a.weiHexToGweiDec}}},{package:"@metamask/user-operation-controller>@metamask/controller-utils",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[224,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,function(e){const t=(null==e?void 0:e.TransactionController)||{},i=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(i))return;const a=Object.keys(i).reduce(((e,t)=>{const r=i[t];return r.verifiedOnBlockchain=Boolean(r.txReceipt),{...e,[t]:r}}),{});e.TransactionController={...t,transactions:a}}(t.data),t},i.version=void 0;var r=e("lodash");const a=i.version=98}}},{package:"$root$",file:"app/scripts/migrations/098.ts"}],[225,{lodash:3783,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,function(e){const t=(null==e?void 0:e.TransactionController)||{},i=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(i))return;const n=Object.keys(i).reduce(((e,t)=>{const n=(0,r.cloneDeep)(i[t]),s=(0,a.v1)();return n.id=s,{...e,[s]:n}}),{});e.TransactionController={...t,transactions:n}}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("uuid");const n=i.version=99}}},{package:"$root$",file:"app/scripts/migrations/099.ts"}],[2256,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){t.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var r=0;r<e.length;r++){var a=e.charAt(r),n=a.charCodeAt(0);if(255!==t[n])throw new TypeError(a+" is ambiguous");t[n]=r}var s=e.length,o=e.charAt(0),l=Math.log(s)/Math.log(256),c=Math.log(256)/Math.log(s);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var i=0;if(" "!==e[i]){for(var r=0,a=0;e[i]===o;)r++,i++;for(var n=(e.length-i)*l+1>>>0,c=new Uint8Array(n);e[i];){var d=t[e.charCodeAt(i)];if(255===d)return;for(var u=0,h=n-1;(0!==d||u<a)&&-1!==h;h--,u++)d+=s*c[h]>>>0,c[h]=d%256>>>0,d=d/256>>>0;if(0!==d)throw new Error("Non-zero carry");a=u,i++}if(" "!==e[i]){for(var p=n-a;p!==n&&0===c[p];)p++;for(var m=new Uint8Array(r+(n-p)),f=r;p!==n;)m[f++]=c[p++];return m}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var i=0,r=0,a=0,n=t.length;a!==n&&0===t[a];)a++,i++;for(var l=(n-a)*c+1>>>0,d=new Uint8Array(l);a!==n;){for(var u=t[a],h=0,p=l-1;(0!==u||h<r)&&-1!==p;p--,h++)u+=256*d[p]>>>0,d[p]=u%s>>>0,u=u/s>>>0;if(0!==u)throw new Error("Non-zero carry");r=h,a++}for(var m=l-r;m!==l&&0===d[m];)m++;for(var f=o.repeat(i);m<l;++m)f+=e.charAt(d[m]);return f},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}}}},{package:"@ensdomains/content-hash>cids>multibase>@multiformats/base-x",file:"node_modules/@multiformats/base-x/src/index.js"}],[226,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,function(e){var t,i;const a=(null==e||null===(t=e.AddressBookController)||void 0===t?void 0:t.addressBook)??{},n=(null==e||null===(i=e.NameController)||void 0===i||null===(i=i.names)||void 0===i?void 0:i.ethereumAddress)??{};if((0,r.isEmpty)(Object.keys(a)))return;for(const e of Object.keys(a)){const t=a[e];for(const i of Object.keys(t)){var s,o;const r=t[i],a=i.toLowerCase(),l=n[a]??{};null!==(s=(l[e]??{}).name)&&void 0!==s&&s.length||null===(o=r.name)||void 0===o||!o.length||null==a||!a.length||(n[a]=l,l[e]={name:r.name,sourceId:r.isEns?"ens":null,proposedNames:{}})}}e.NameController={...e.NameController,names:{ethereumAddress:n}}}(t.data),t},i.version=void 0;var r=e("lodash");const a=i.version=100}}},{package:"$root$",file:"app/scripts/migrations/100.ts"}],[227,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=n,function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"networkId")){const t=e.NetworkController;return delete t.networkId,{...e,NetworkController:t}}var t,i;(0,r.isObject)(e.NetworkController)||null===(t=global.sentry)||void 0===t||null===(i=t.captureException)||void 0===i||i.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController))}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("lodash");const n=i.version=101}}},{package:"$root$",file:"app/scripts/migrations/101.ts"}],[2270,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){function r(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function a(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}function n(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function s(e,...t){if(!n(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function o(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("hash must be wrapped by utils.wrapConstructor");r(e.outputLen),r(e.blockLen)}function l(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function c(e,t){s(e);const i=t.outputLen;if(e.length<i)throw new Error(`digestInto() expects output buffer of length at least ${i}`)}Object.defineProperty(i,"__esModule",{value:!0}),i.output=i.exists=i.hash=i.bytes=i.bool=i.number=i.isBytes=void 0,i.number=r,i.bool=a,i.isBytes=n,i.bytes=s,i.hash=o,i.exists=l,i.output=c;const d={number:r,bool:a,bytes:s,hash:o,exists:l,output:c};i.default=d}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/_assert.js"}],[2271,{"./_assert.js":2270,"./utils.js":2274},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.polyval=i.ghash=i._toGHASHKey=void 0;const r=e("./utils.js"),a=e("./_assert.js"),n=16,s=new Uint8Array(16),o=(0,r.u32)(s),l=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;function c(e){e.reverse();const t=1&e[15];let i=0;for(let t=0;t<e.length;t++){const r=e[t];e[t]=r>>>1|i,i=(1&r)<<7}return e[0]^=225&-t,e}i._toGHASHKey=c;class d{constructor(e,t){this.blockLen=n,this.outputLen=n,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,e=(0,r.toBytes)(e),(0,a.bytes)(e,16);const i=(0,r.createView)(e);let s=i.getUint32(0,!1),o=i.getUint32(4,!1),c=i.getUint32(8,!1),d=i.getUint32(12,!1);const u=[];for(let e=0;e<128;e++)u.push({s0:l(s),s1:l(o),s2:l(c),s3:l(d)}),({s0:s,s1:o,s2:c,s3:d}={s3:(m=c)<<31|(f=d)>>>1,s2:(p=o)<<31|m>>>1,s1:(h=s)<<31|p>>>1,s0:h>>>1^225<<24&-(1&f)});var h,p,m,f;const v=(g=t||1024)>65536?8:g>1024?4:2;var g;if(![1,2,4,8].includes(v))throw new Error(`ghash: wrong window size=${v}, should be 2, 4 or 8`);this.W=v;const _=128/v,k=this.windowSize=2**v,w=[];for(let e=0;e<_;e++)for(let t=0;t<k;t++){let i=0,r=0,a=0,n=0;for(let s=0;s<v;s++){if(!(t>>>v-s-1&1))continue;const{s0:o,s1:l,s2:c,s3:d}=u[v*e+s];i^=o,r^=l,a^=c,n^=d}w.push({s0:i,s1:r,s2:a,s3:n})}this.t=w}_updateBlock(e,t,i,r){e^=this.s0,t^=this.s1,i^=this.s2,r^=this.s3;const{W:a,t:n,windowSize:s}=this;let o=0,l=0,c=0,d=0;const u=(1<<a)-1;let h=0;for(const p of[e,t,i,r])for(let e=0;e<4;e++){const t=p>>>8*e&255;for(let e=8/a-1;e>=0;e--){const i=t>>>a*e&u,{s0:r,s1:p,s2:m,s3:f}=n[h*s+i];o^=r,l^=p,c^=m,d^=f,h+=1}}this.s0=o,this.s1=l,this.s2=c,this.s3=d}update(e){e=(0,r.toBytes)(e),(0,a.exists)(this);const t=(0,r.u32)(e),i=Math.floor(e.length/n),l=e.length%n;for(let e=0;e<i;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return l&&(s.set(e.subarray(i*n)),this._updateBlock(o[0],o[1],o[2],o[3]),o.fill(0)),this}destroy(){const{t:e}=this;for(const t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){(0,a.exists)(this),(0,a.output)(e,this),this.finished=!0;const{s0:t,s1:i,s2:n,s3:s}=this,o=(0,r.u32)(e);return o[0]=t,o[1]=i,o[2]=n,o[3]=s,e}digest(){const e=new Uint8Array(n);return this.digestInto(e),this.destroy(),e}}class u extends d{constructor(e,t){const i=c((e=(0,r.toBytes)(e)).slice());super(i,t),i.fill(0)}update(e){e=(0,r.toBytes)(e),(0,a.exists)(this);const t=(0,r.u32)(e),i=e.length%n,c=Math.floor(e.length/n);for(let e=0;e<c;e++)this._updateBlock(l(t[4*e+3]),l(t[4*e+2]),l(t[4*e+1]),l(t[4*e+0]));return i&&(s.set(e.subarray(c*n)),this._updateBlock(l(o[3]),l(o[2]),l(o[1]),l(o[0])),o.fill(0)),this}digestInto(e){(0,a.exists)(this),(0,a.output)(e,this),this.finished=!0;const{s0:t,s1:i,s2:n,s3:s}=this,o=(0,r.u32)(e);return o[0]=t,o[1]=i,o[2]=n,o[3]=s,e.reverse()}}function h(e){const t=(t,i)=>e(i,t.length).update((0,r.toBytes)(t)).digest(),i=e(new Uint8Array(16),0);return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=(t,i)=>e(t,i),t}i.ghash=h(((e,t)=>new d(e,t))),i.polyval=h(((e,t)=>new u(e,t)))}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/_polyval.js"}],[2272,{"./_assert.js":2270,"./_polyval.js":2271,"./utils.js":2274},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.unsafe=i.siv=i.gcm=i.cfb=i.cbc=i.ecb=i.ctr=i.expandKeyDecLE=i.expandKeyLE=void 0;const r=e("./utils.js"),a=e("./_polyval.js"),n=e("./_assert.js"),s=16,o=new Uint8Array(s),l=283;function c(e){return e<<1^l&-(e>>7)}function d(e,t){let i=0;for(;t>0;t>>=1)i^=e&-(1&t),e=c(e);return i}const u=(()=>{let e=new Uint8Array(256);for(let t=0,i=1;t<256;t++,i^=c(i))e[t]=i;const t=new Uint8Array(256);t[0]=99;for(let i=0;i<255;i++){let r=e[255-i];r|=r<<8,t[e[i]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return t})(),h=u.map(((e,t)=>u.indexOf(t))),p=e=>e<<24|e>>>8,m=e=>e<<8|e>>>24;function f(e,t){if(256!==e.length)throw new Error("Wrong sbox length");const i=new Uint32Array(256).map(((i,r)=>t(e[r]))),r=i.map(m),a=r.map(m),n=a.map(m),s=new Uint32Array(65536),o=new Uint32Array(65536),l=new Uint16Array(65536);for(let t=0;t<256;t++)for(let c=0;c<256;c++){const d=256*t+c;s[d]=i[t]^r[c],o[d]=a[t]^n[c],l[d]=e[t]<<8|e[c]}return{sbox:e,sbox2:l,T0:i,T1:r,T2:a,T3:n,T01:s,T23:o}}const v=f(u,(e=>d(e,3)<<24|e<<16|e<<8|d(e,2))),g=f(h,(e=>d(e,11)<<24|d(e,13)<<16|d(e,9)<<8|d(e,14))),_=(()=>{const e=new Uint8Array(16);for(let t=0,i=1;t<16;t++,i=c(i))e[t]=i;return e})();function k(e){(0,n.bytes)(e);const t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);const{sbox2:i}=v,a=(0,r.u32)(e),s=a.length,o=e=>T(i,e,e,e,e),l=new Uint32Array(t+28);l.set(a);for(let e=s;e<l.length;e++){let t=l[e-1];e%s==0?t=o(p(t))^_[e/s-1]:s>6&&e%s==4&&(t=o(t)),l[e]=l[e-s]^t}return l}function w(e){const t=k(e),i=t.slice(),r=t.length,{sbox2:a}=v,{T0:n,T1:s,T2:o,T3:l}=g;for(let e=0;e<r;e+=4)for(let a=0;a<4;a++)i[e+a]=t[r-e-4+a];t.fill(0);for(let e=4;e<r-4;e++){const t=i[e],r=T(a,t,t,t,t);i[e]=n[255&r]^s[r>>>8&255]^o[r>>>16&255]^l[r>>>24]}return i}function y(e,t,i,r,a,n){return e[i<<8&65280|r>>>8&255]^t[a>>>8&65280|n>>>24&255]}function T(e,t,i,r,a){return e[255&t|65280&i]|e[r>>>16&255|a>>>16&65280]<<16}function b(e,t,i,r,a){const{sbox2:n,T01:s,T23:o}=v;let l=0;t^=e[l++],i^=e[l++],r^=e[l++],a^=e[l++];const c=e.length/4-2;for(let n=0;n<c;n++){const n=e[l++]^y(s,o,t,i,r,a),c=e[l++]^y(s,o,i,r,a,t),d=e[l++]^y(s,o,r,a,t,i),u=e[l++]^y(s,o,a,t,i,r);t=n,i=c,r=d,a=u}return{s0:e[l++]^T(n,t,i,r,a),s1:e[l++]^T(n,i,r,a,t),s2:e[l++]^T(n,r,a,t,i),s3:e[l++]^T(n,a,t,i,r)}}function E(e,t,i,r,a){const{sbox2:n,T01:s,T23:o}=g;let l=0;t^=e[l++],i^=e[l++],r^=e[l++],a^=e[l++];const c=e.length/4-2;for(let n=0;n<c;n++){const n=e[l++]^y(s,o,t,a,r,i),c=e[l++]^y(s,o,i,t,a,r),d=e[l++]^y(s,o,r,i,t,a),u=e[l++]^y(s,o,a,r,i,t);t=n,i=c,r=d,a=u}return{s0:e[l++]^T(n,t,a,r,i),s1:e[l++]^T(n,i,t,a,r),s2:e[l++]^T(n,r,i,t,a),s3:e[l++]^T(n,a,r,i,t)}}function S(e,t){if(!t)return new Uint8Array(e);if((0,n.bytes)(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function P(e,t,i,a){(0,n.bytes)(t,s),(0,n.bytes)(i);const o=i.length;a=S(o,a);const l=t,c=(0,r.u32)(l);let{s0:d,s1:u,s2:h,s3:p}=b(e,c[0],c[1],c[2],c[3]);const m=(0,r.u32)(i),f=(0,r.u32)(a);for(let t=0;t+4<=m.length;t+=4){f[t+0]=m[t+0]^d,f[t+1]=m[t+1]^u,f[t+2]=m[t+2]^h,f[t+3]=m[t+3]^p;let i=1;for(let e=l.length-1;e>=0;e--)i=i+(255&l[e])|0,l[e]=255&i,i>>>=8;({s0:d,s1:u,s2:h,s3:p}=b(e,c[0],c[1],c[2],c[3]))}const v=s*Math.floor(m.length/4);if(v<o){const e=new Uint32Array([d,u,h,p]),t=(0,r.u8)(e);for(let e=v,r=0;e<o;e++,r++)a[e]=i[e]^t[r]}return a}function C(e,t,i,a,o){(0,n.bytes)(i,s),(0,n.bytes)(a),o=S(a.length,o);const l=i,c=(0,r.u32)(l),d=(0,r.createView)(l),u=(0,r.u32)(a),h=(0,r.u32)(o),p=t?0:12,m=a.length;let f=d.getUint32(p,t),{s0:v,s1:g,s2:_,s3:k}=b(e,c[0],c[1],c[2],c[3]);for(let i=0;i+4<=u.length;i+=4)h[i+0]=u[i+0]^v,h[i+1]=u[i+1]^g,h[i+2]=u[i+2]^_,h[i+3]=u[i+3]^k,f=f+1>>>0,d.setUint32(p,f,t),({s0:v,s1:g,s2:_,s3:k}=b(e,c[0],c[1],c[2],c[3]));const w=s*Math.floor(u.length/4);if(w<m){const e=new Uint32Array([v,g,_,k]),t=(0,r.u8)(e);for(let e=w,i=0;e<m;e++,i++)o[e]=a[e]^t[i]}return o}function A(e){if((0,n.bytes)(e),e.length%s!=0)throw new Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}function I(e,t,i){let a=e.length;const n=a%s;if(!t&&0!==n)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const o=(0,r.u32)(e);if(t){let e=s-n;e||(e=s),a+=e}const l=S(a,i);return{b:o,o:(0,r.u32)(l),out:l}}function j(e,t){if(!t)return e;const i=e.length;if(!i)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=e[i-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const a=e.subarray(0,-r);for(let t=0;t<r;t++)if(e[i-t-1]!==r)throw new Error("aes/pcks5: wrong padding");return a}function M(e){const t=new Uint8Array(16),i=(0,r.u32)(t);t.set(e);const a=s-e.length;for(let e=s-a;e<s;e++)t[e]=a;return i}function x(e,t,i,a,n){const s=e.create(i,a.length+(n?.length||0));n&&s.update(n),s.update(a);const o=new Uint8Array(16),l=(0,r.createView)(o);return n&&(0,r.setBigUint64)(l,0,BigInt(8*n.length),t),(0,r.setBigUint64)(l,8,BigInt(8*a.length),t),s.update(o),s.digest()}i.expandKeyLE=k,i.expandKeyDecLE=w,i.ctr=(0,r.wrapCipher)({blockSize:16,nonceLength:16},(function(e,t){function i(i,r){const a=k(e),n=t.slice(),s=P(a,n,i,r);return a.fill(0),n.fill(0),s}return(0,n.bytes)(e),(0,n.bytes)(t,s),{encrypt:(e,t)=>i(e,t),decrypt:(e,t)=>i(e,t)}})),i.ecb=(0,r.wrapCipher)({blockSize:16},(function(e,t={}){(0,n.bytes)(e);const i=!t.disablePadding;return{encrypt:(t,r)=>{(0,n.bytes)(t);const{b:a,o:s,out:o}=I(t,i,r),l=k(e);let c=0;for(;c+4<=a.length;){const{s0:e,s1:t,s2:i,s3:r}=b(l,a[c+0],a[c+1],a[c+2],a[c+3]);s[c++]=e,s[c++]=t,s[c++]=i,s[c++]=r}if(i){const e=M(t.subarray(4*c)),{s0:i,s1:r,s2:a,s3:n}=b(l,e[0],e[1],e[2],e[3]);s[c++]=i,s[c++]=r,s[c++]=a,s[c++]=n}return l.fill(0),o},decrypt:(t,a)=>{A(t);const n=w(e),s=S(t.length,a),o=(0,r.u32)(t),l=(0,r.u32)(s);for(let e=0;e+4<=o.length;){const{s0:t,s1:i,s2:r,s3:a}=E(n,o[e+0],o[e+1],o[e+2],o[e+3]);l[e++]=t,l[e++]=i,l[e++]=r,l[e++]=a}return n.fill(0),j(s,i)}}})),i.cbc=(0,r.wrapCipher)({blockSize:16,nonceLength:16},(function(e,t,i={}){(0,n.bytes)(e),(0,n.bytes)(t,16);const a=!i.disablePadding;return{encrypt:(i,n)=>{const s=k(e),{b:o,o:l,out:c}=I(i,a,n),d=(0,r.u32)(t);let u=d[0],h=d[1],p=d[2],m=d[3],f=0;for(;f+4<=o.length;)u^=o[f+0],h^=o[f+1],p^=o[f+2],m^=o[f+3],({s0:u,s1:h,s2:p,s3:m}=b(s,u,h,p,m)),l[f++]=u,l[f++]=h,l[f++]=p,l[f++]=m;if(a){const e=M(i.subarray(4*f));u^=e[0],h^=e[1],p^=e[2],m^=e[3],({s0:u,s1:h,s2:p,s3:m}=b(s,u,h,p,m)),l[f++]=u,l[f++]=h,l[f++]=p,l[f++]=m}return s.fill(0),c},decrypt:(i,n)=>{A(i);const s=w(e),o=(0,r.u32)(t),l=S(i.length,n),c=(0,r.u32)(i),d=(0,r.u32)(l);let u=o[0],h=o[1],p=o[2],m=o[3];for(let e=0;e+4<=c.length;){const t=u,i=h,r=p,a=m;u=c[e+0],h=c[e+1],p=c[e+2],m=c[e+3];const{s0:n,s1:o,s2:l,s3:f}=E(s,u,h,p,m);d[e++]=n^t,d[e++]=o^i,d[e++]=l^r,d[e++]=f^a}return s.fill(0),j(l,a)}}})),i.cfb=(0,r.wrapCipher)({blockSize:16,nonceLength:16},(function(e,t){function i(i,a,n){const o=k(e),l=i.length;n=S(l,n);const c=(0,r.u32)(i),d=(0,r.u32)(n),u=a?d:c,h=(0,r.u32)(t);let p=h[0],m=h[1],f=h[2],v=h[3];for(let e=0;e+4<=c.length;){const{s0:t,s1:i,s2:r,s3:a}=b(o,p,m,f,v);d[e+0]=c[e+0]^t,d[e+1]=c[e+1]^i,d[e+2]=c[e+2]^r,d[e+3]=c[e+3]^a,p=u[e++],m=u[e++],f=u[e++],v=u[e++]}const g=s*Math.floor(c.length/4);if(g<l){({s0:p,s1:m,s2:f,s3:v}=b(o,p,m,f,v));const e=(0,r.u8)(new Uint32Array([p,m,f,v]));for(let t=g,r=0;t<l;t++,r++)n[t]=i[t]^e[r];e.fill(0)}return o.fill(0),n}return(0,n.bytes)(e),(0,n.bytes)(t,16),{encrypt:(e,t)=>i(e,!0,t),decrypt:(e,t)=>i(e,!1,t)}})),i.gcm=(0,r.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16},(function(e,t,i){if((0,n.bytes)(t),0===t.length)throw new Error("aes/gcm: empty nonce");const s=16;function l(e,t,r){const n=x(a.ghash,!1,e,r,i);for(let e=0;e<t.length;e++)n[e]^=t[e];return n}function c(){const i=k(e),n=o.slice(),s=o.slice();if(C(i,!1,s,s,n),12===t.length)s.set(t);else{const e=o.slice(),i=(0,r.createView)(e);(0,r.setBigUint64)(i,8,BigInt(8*t.length),!1),a.ghash.create(n).update(t).update(e).digestInto(s)}return{xk:i,authKey:n,counter:s,tagMask:C(i,!1,s,o)}}return{encrypt:e=>{(0,n.bytes)(e);const{xk:t,authKey:i,counter:r,tagMask:a}=c(),o=new Uint8Array(e.length+s);C(t,!1,r,e,o);const d=l(i,a,o.subarray(0,o.length-s));return o.set(d,e.length),t.fill(0),o},decrypt:e=>{if((0,n.bytes)(e),e.length<s)throw new Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:t,authKey:i,counter:a,tagMask:o}=c(),d=e.subarray(0,-16),u=e.subarray(-16),h=l(i,o,d);if(!(0,r.equalBytes)(h,u))throw new Error("aes/gcm: invalid ghash tag");const p=C(t,!1,a,d);return i.fill(0),o.fill(0),t.fill(0),p}}}));const N=(e,t,i)=>r=>{if(!Number.isSafeInteger(r)||t>r||r>i)throw new Error(`${e}: invalid value=${r}, must be [${t}..${i}]`)};function R(e){return null!=e&&"object"==typeof e&&(e instanceof Uint32Array||"Uint32Array"===e.constructor.name)}i.siv=(0,r.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16},(function(e,t,i){const s=N("AAD",0,2**36),o=N("plaintext",0,2**36),l=N("nonce",12,12),c=N("ciphertext",16,2**36+16);function d(){const i=e.length;if(16!==i&&24!==i&&32!==i)throw new Error(`key length must be 16, 24 or 32 bytes, got: ${i} bytes`);const a=k(e),n=new Uint8Array(i),s=new Uint8Array(16),o=(0,r.u32)(t);let l=0,c=o[0],d=o[1],u=o[2],h=0;for(const e of[s,n].map(r.u32)){const t=(0,r.u32)(e);for(let e=0;e<t.length;e+=2){const{s0:i,s1:r}=b(a,l,c,d,u);t[e+0]=i,t[e+1]=r,l=++h}}return a.fill(0),{authKey:s,encKey:k(n)}}function u(e,n,s){const o=x(a.polyval,!0,n,s,i);for(let e=0;e<12;e++)o[e]^=t[e];o[15]&=127;const l=(0,r.u32)(o);let c=l[0],d=l[1],u=l[2],h=l[3];return({s0:c,s1:d,s2:u,s3:h}=b(e,c,d,u,h)),l[0]=c,l[1]=d,l[2]=u,l[3]=h,o}function h(e,t,i){let r=t.slice();return r[15]|=128,C(e,!0,r,i)}return(0,n.bytes)(t),l(t.length),i&&((0,n.bytes)(i),s(i.length)),{encrypt:e=>{(0,n.bytes)(e),o(e.length);const{encKey:t,authKey:i}=d(),r=u(t,i,e),a=new Uint8Array(e.length+16);return a.set(r,e.length),a.set(h(t,r,e)),t.fill(0),i.fill(0),a},decrypt:e=>{(0,n.bytes)(e),c(e.length);const t=e.subarray(-16),{encKey:i,authKey:a}=d(),s=h(i,t,e.subarray(0,-16)),o=u(i,a,s);if(i.fill(0),a.fill(0),!(0,r.equalBytes)(t,o))throw new Error("invalid polyval tag");return s}}})),i.unsafe={expandKeyLE:k,expandKeyDecLE:w,encrypt:b,decrypt:E,encryptBlock:function(e,t){if((0,n.bytes)(t,16),!R(e))throw new Error("_encryptBlock accepts result of expandKeyLE");const i=(0,r.u32)(t);let{s0:a,s1:s,s2:o,s3:l}=b(e,i[0],i[1],i[2],i[3]);return i[0]=a,i[1]=s,i[2]=o,i[3]=l,t},decryptBlock:function(e,t){if((0,n.bytes)(t,16),!R(e))throw new Error("_decryptBlock accepts result of expandKeyLE");const i=(0,r.u32)(t);let{s0:a,s1:s,s2:o,s3:l}=E(e,i[0],i[1],i[2],i[3]);return i[0]=a,i[1]=s,i[2]=o,i[3]=l,t},ctrCounter:P,ctr32:C}}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/aes.js"}],[2273,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getWebcryptoSubtle=i.randomBytes=void 0;const r="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:undefined;i.randomBytes=function(e=32){if(r&&"function"==typeof r.getRandomValues)return r.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")},i.getWebcryptoSubtle=function(){if(r&&"object"==typeof r.subtle&&null!=r.subtle)return r.subtle;throw new Error("crypto.subtle must be defined")}}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/crypto.js"}],[2274,{"./_assert.js":2270},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.u64Lengths=i.setBigUint64=i.wrapCipher=i.Hash=i.equalBytes=i.checkOpts=i.concatBytes=i.toBytes=i.bytesToUtf8=i.utf8ToBytes=i.asyncLoop=i.nextTick=i.numberToBytesBE=i.bytesToNumberBE=i.hexToNumber=i.hexToBytes=i.bytesToHex=i.isLE=i.createView=i.u32=i.u16=i.u8=void 0;
/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */
const r=e("./_assert.js");i.u8=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);i.u16=e=>new Uint16Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/2));i.u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));if(i.createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),i.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!i.isLE)throw new Error("Non little-endian hardware is not supported");const a=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function n(e){(0,r.bytes)(e);let t="";for(let i=0;i<e.length;i++)t+=a[e[i]];return t}i.bytesToHex=n;const s={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function o(e){return e>=s._0&&e<=s._9?e-s._0:e>=s._A&&e<=s._F?e-(s._A-10):e>=s._a&&e<=s._f?e-(s._a-10):void 0}function l(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,i=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(i);for(let t=0,a=0;t<i;t++,a+=2){const i=o(e.charCodeAt(a)),n=o(e.charCodeAt(a+1));if(i===undefined||n===undefined){const t=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+a)}r[t]=16*i+n}return r}function c(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}i.hexToBytes=l,i.hexToNumber=c,i.bytesToNumberBE=function(e){return c(n(e))},i.numberToBytesBE=function(e,t){return l(e.toString(16).padStart(2*t,"0"))};function d(e){if("string"!=typeof e)throw new Error("string expected, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}i.nextTick=async()=>{},i.asyncLoop=async function(e,t,r){let a=Date.now();for(let n=0;n<e;n++){r(n);const e=Date.now()-a;e>=0&&e<t||(await(0,i.nextTick)(),a+=e)}},i.utf8ToBytes=d,i.bytesToUtf8=function(e){return(new TextDecoder).decode(e)},i.toBytes=function(e){if("string"==typeof e)e=d(e);else{if(!(0,r.isBytes)(e))throw new Error("Uint8Array expected, got "+typeof e);e=e.slice()}return e},i.concatBytes=function(...e){let t=0;for(let i=0;i<e.length;i++){const a=e[i];(0,r.bytes)(a),t+=a.length}const i=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const a=e[t];i.set(a,r),r+=a.length}return i},i.checkOpts=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign(e,t)},i.equalBytes=function(e,t){if(e.length!==t.length)return!1;let i=0;for(let r=0;r<e.length;r++)i|=e[r]^t[r];return 0===i};i.Hash=class{};function u(e,t,i,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,i,r);const a=BigInt(32),n=BigInt(4294967295),s=Number(i>>a&n),o=Number(i&n),l=r?4:0,c=r?0:4;e.setUint32(t+l,s,r),e.setUint32(t+c,o,r)}i.wrapCipher=(e,t)=>(Object.assign(t,e),t),i.setBigUint64=u,i.u64Lengths=function(e,t){const r=new Uint8Array(16),a=(0,i.createView)(r);return u(a,0,BigInt(t?t.length:0),!0),u(a,8,BigInt(e.length),!0),r}}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/utils.js"}],[2275,{"./_assert.js":2270,"./utils.js":2274,"@noble/ciphers/crypto":2273},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.gcm=i.ctr=i.cbc=i.utils=i.managedNonce=i.getWebcryptoSubtle=i.randomBytes=void 0;const r=e("@noble/ciphers/crypto");Object.defineProperty(i,"randomBytes",{enumerable:!0,get:function(){return r.randomBytes}}),Object.defineProperty(i,"getWebcryptoSubtle",{enumerable:!0,get:function(){return r.getWebcryptoSubtle}});const a=e("./utils.js"),n=e("./_assert.js");i.managedNonce=function(e){return(0,n.number)(e.nonceLength),(t,...i)=>({encrypt:(n,...s)=>{const{nonceLength:o}=e,l=(0,r.randomBytes)(o),c=e(t,l,...i).encrypt(n,...s),d=(0,a.concatBytes)(l,c);return c.fill(0),d},decrypt:(r,...a)=>{const{nonceLength:n}=e,s=r.subarray(0,n),o=r.subarray(n);return e(t,s,...i).decrypt(o,...a)}})},i.utils={async encrypt(e,t,i,a){const n=(0,r.getWebcryptoSubtle)(),s=await n.importKey("raw",e,t,!0,["encrypt"]),o=await n.encrypt(i,s,a);return new Uint8Array(o)},async decrypt(e,t,i,a){const n=(0,r.getWebcryptoSubtle)(),s=await n.importKey("raw",e,t,!0,["decrypt"]),o=await n.decrypt(i,s,a);return new Uint8Array(o)}};const s={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function o(e){return(t,r,a)=>{(0,n.bytes)(t),(0,n.bytes)(r);const o={name:e,length:8*t.length},l=function(e,t,i){if(e===s.CBC)return{name:s.CBC,iv:t};if(e===s.CTR)return{name:s.CTR,counter:t,length:64};if(e===s.GCM)return{name:s.GCM,iv:t,additionalData:i};throw new Error("unknown aes block mode")}(e,r,a);return{encrypt:e=>((0,n.bytes)(e),i.utils.encrypt(t,o,l,e)),decrypt:e=>((0,n.bytes)(e),i.utils.decrypt(t,o,l,e))}}}i.cbc=o(s.CBC),i.ctr=o(s.CTR),i.gcm=o(s.GCM)}}},{package:"@noble/ciphers",file:"node_modules/@noble/ciphers/webcrypto.js"}],[228,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,function(e){const t=(null==e?void 0:e.TransactionController)||{},i=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(i))return;const a=Object.keys(i).reduce(((e,t)=>{const a=(0,r.cloneDeep)(i[t]);return null!=a&&a.err&&(a.error=a.err,delete a.err),{...e,[t]:a}}),{});e.TransactionController={...t,transactions:a}}(t.data),t},i.version=void 0;var r=e("lodash");const a=i.version=102}}},{package:"$root$",file:"app/scripts/migrations/102.ts"}],[229,{"../../../shared/constants/hardware-wallets":4430,"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,r.hasProperty)(e,"PreferencesController")&&(0,r.isObject)(e.PreferencesController)&&window.navigator.userAgent.includes("Chrome")){const t=e.PreferencesController;return t.ledgerTransportType=n.LedgerTransportTypes.webhid,{...e,PreferencesController:t}}return e}(t.data),t},i.version=void 0;var r=e("@metamask/utils"),a=e("lodash"),n=e("../../../shared/constants/hardware-wallets");const s=i.version=103}}},{package:"$root$",file:"app/scripts/migrations/103.ts"}],[2293,{"./_assert.js":2286,"./pbkdf2.js":2291,"./sha256.js":2294,"./utils.js":2297},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.scryptAsync=i.scrypt=void 0;const r=e("./_assert.js"),a=e("./sha256.js"),n=e("./pbkdf2.js"),s=e("./utils.js");function o(e,t,i,r,a,n){let o=e[t++]^i[r++],l=e[t++]^i[r++],c=e[t++]^i[r++],d=e[t++]^i[r++],u=e[t++]^i[r++],h=e[t++]^i[r++],p=e[t++]^i[r++],m=e[t++]^i[r++],f=e[t++]^i[r++],v=e[t++]^i[r++],g=e[t++]^i[r++],_=e[t++]^i[r++],k=e[t++]^i[r++],w=e[t++]^i[r++],y=e[t++]^i[r++],T=e[t++]^i[r++],b=o,E=l,S=c,P=d,C=u,A=h,I=p,j=m,M=f,x=v,N=g,R=_,O=k,G=w,L=y,B=T;for(let e=0;e<8;e+=2)C^=(0,s.rotl)(b+O|0,7),M^=(0,s.rotl)(C+b|0,9),O^=(0,s.rotl)(M+C|0,13),b^=(0,s.rotl)(O+M|0,18),x^=(0,s.rotl)(A+E|0,7),G^=(0,s.rotl)(x+A|0,9),E^=(0,s.rotl)(G+x|0,13),A^=(0,s.rotl)(E+G|0,18),L^=(0,s.rotl)(N+I|0,7),S^=(0,s.rotl)(L+N|0,9),I^=(0,s.rotl)(S+L|0,13),N^=(0,s.rotl)(I+S|0,18),P^=(0,s.rotl)(B+R|0,7),j^=(0,s.rotl)(P+B|0,9),R^=(0,s.rotl)(j+P|0,13),B^=(0,s.rotl)(R+j|0,18),E^=(0,s.rotl)(b+P|0,7),S^=(0,s.rotl)(E+b|0,9),P^=(0,s.rotl)(S+E|0,13),b^=(0,s.rotl)(P+S|0,18),I^=(0,s.rotl)(A+C|0,7),j^=(0,s.rotl)(I+A|0,9),C^=(0,s.rotl)(j+I|0,13),A^=(0,s.rotl)(C+j|0,18),R^=(0,s.rotl)(N+x|0,7),M^=(0,s.rotl)(R+N|0,9),x^=(0,s.rotl)(M+R|0,13),N^=(0,s.rotl)(x+M|0,18),O^=(0,s.rotl)(B+L|0,7),G^=(0,s.rotl)(O+B|0,9),L^=(0,s.rotl)(G+O|0,13),B^=(0,s.rotl)(L+G|0,18);a[n++]=o+b|0,a[n++]=l+E|0,a[n++]=c+S|0,a[n++]=d+P|0,a[n++]=u+C|0,a[n++]=h+A|0,a[n++]=p+I|0,a[n++]=m+j|0,a[n++]=f+M|0,a[n++]=v+x|0,a[n++]=g+N|0,a[n++]=_+R|0,a[n++]=k+O|0,a[n++]=w+G|0,a[n++]=y+L|0,a[n++]=T+B|0}function l(e,t,i,r,a){let n=r+0,s=r+16*a;for(let r=0;r<16;r++)i[s+r]=e[t+16*(2*a-1)+r];for(let r=0;r<a;r++,n+=16,t+=16)o(i,s,e,t,i,n),r>0&&(s+=16),o(i,n,e,t+=16,i,s)}function c(e,t,i){const o=(0,s.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},i),{N:l,r:c,p:d,dkLen:u,asyncTick:h,maxmem:p,onProgress:m}=o;if((0,r.number)(l),(0,r.number)(c),(0,r.number)(d),(0,r.number)(u),(0,r.number)(h),(0,r.number)(p),m!==undefined&&"function"!=typeof m)throw new Error("progressCb should be function");const f=128*c,v=f/4;if(l<=1||l&l-1||l>=2**(f/8)||l>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(d<0||d>137438953440/f)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(u<0||u>137438953440)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const g=f*(l+d);if(g>p)throw new Error(`Scrypt: parameters too large, ${g} (128 * r * (N + p)) > ${p} (maxmem)`);const _=(0,n.pbkdf2)(a.sha256,e,t,{c:1,dkLen:f*d}),k=(0,s.u32)(_),w=(0,s.u32)(new Uint8Array(f*l)),y=(0,s.u32)(new Uint8Array(f));let T=()=>{};if(m){const e=2*l*d,t=Math.max(Math.floor(e/1e4),1);let i=0;T=()=>{i++,!m||i%t&&i!==e||m(i/e)}}return{N:l,r:c,p:d,dkLen:u,blockSize32:v,V:w,B32:k,B:_,tmp:y,blockMixCb:T,asyncTick:h}}function d(e,t,i,r,s){const o=(0,n.pbkdf2)(a.sha256,e,i,{c:1,dkLen:t});return i.fill(0),r.fill(0),s.fill(0),o}i.scrypt=function(e,t,i){const{N:r,r:a,p:n,dkLen:o,blockSize32:u,V:h,B32:p,B:m,tmp:f,blockMixCb:v}=c(e,t,i);s.isLE||(0,s.byteSwap32)(p);for(let e=0;e<n;e++){const t=u*e;for(let e=0;e<u;e++)h[e]=p[t+e];for(let e=0,t=0;e<r-1;e++)l(h,t,h,t+=u,a),v();l(h,(r-1)*u,p,t,a),v();for(let e=0;e<r;e++){const e=p[t+u-16]%r;for(let i=0;i<u;i++)f[i]=p[t+i]^h[e*u+i];l(f,0,p,t,a),v()}}return s.isLE||(0,s.byteSwap32)(p),d(e,o,m,h,f)},i.scryptAsync=async function(e,t,i){const{N:r,r:a,p:n,dkLen:o,blockSize32:u,V:h,B32:p,B:m,tmp:f,blockMixCb:v,asyncTick:g}=c(e,t,i);s.isLE||(0,s.byteSwap32)(p);for(let e=0;e<n;e++){const t=u*e;for(let e=0;e<u;e++)h[e]=p[t+e];let i=0;await(0,s.asyncLoop)(r-1,g,(()=>{l(h,i,h,i+=u,a),v()})),l(h,(r-1)*u,p,t,a),v(),await(0,s.asyncLoop)(r,g,(()=>{const e=p[t+u-16]%r;for(let i=0;i<u;i++)f[i]=p[t+i]^h[e*u+i];l(f,0,p,t,a),v()}))}return s.isLE||(0,s.byteSwap32)(p),d(e,o,m,h,f)}}}},{package:"@noble/hashes",file:"node_modules/@noble/hashes/scrypt.js"}],[23,{"../constants/constants":15,"../constants/notification-schema":16,loglevel:3789,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.checkAccountsPresence=function(e,t){const i={};return t.forEach((t=>{i[t.toLowerCase()]=function(e,t){const i=t[null==e?void 0:e.toLowerCase()];if(!i)return!1;for(const[e,t]of Object.entries(o.TRIGGERS))for(const r of t.supported_chains){if(!i[r])return!1;if(!Object.values(i[r]).some((t=>t.k===e)))return!1;for(const e in i[r])if(!i[r][e].e)return!1}return!0}(t,e)})),i},i.checkTriggersPresenceByGroup=function(e){const t={[o.TRIGGER_TYPES_GROUPS.RECEIVED]:!0,[o.TRIGGER_TYPES_GROUPS.SENT]:!0,[o.TRIGGER_TYPES_GROUPS.DEFI]:!0},i={[o.TRIGGER_TYPES_GROUPS.RECEIVED]:new Set([o.TRIGGER_TYPES.ERC20_RECEIVED,o.TRIGGER_TYPES.ETH_RECEIVED,o.TRIGGER_TYPES.ERC721_RECEIVED,o.TRIGGER_TYPES.ERC1155_RECEIVED]),[o.TRIGGER_TYPES_GROUPS.SENT]:new Set([o.TRIGGER_TYPES.ERC20_SENT,o.TRIGGER_TYPES.ETH_SENT,o.TRIGGER_TYPES.ERC721_SENT,o.TRIGGER_TYPES.ERC1155_SENT]),[o.TRIGGER_TYPES_GROUPS.DEFI]:new Set([o.TRIGGER_TYPES.METAMASK_SWAP_COMPLETED,o.TRIGGER_TYPES.ROCKETPOOL_STAKE_COMPLETED,o.TRIGGER_TYPES.ROCKETPOOL_UNSTAKE_COMPLETED,o.TRIGGER_TYPES.LIDO_STAKE_COMPLETED,o.TRIGGER_TYPES.LIDO_WITHDRAWAL_REQUESTED,o.TRIGGER_TYPES.LIDO_WITHDRAWAL_COMPLETED,o.TRIGGER_TYPES.LIDO_STAKE_READY_TO_BE_WITHDRAWN])},r={};return u(e,{mapTrigger:e=>{const t=d(e.kind);return r[e.address]||(r[e.address]={[o.TRIGGER_TYPES_GROUPS.RECEIVED]:new Set,[o.TRIGGER_TYPES_GROUPS.SENT]:new Set,[o.TRIGGER_TYPES_GROUPS.DEFI]:new Set}),r[e.address][t].add(e.kind),undefined}}),Object.keys(r).forEach((e=>{Object.entries(i).forEach((([i,a])=>{Array.from(a).every((t=>r[e][i].has(t)))||(t[i]=!1)}))})),t},i.getAllUUIDs=function(e){return u(e,{mapTrigger:l})},i.getUUIDsForAccount=function(e,t){return u(e,{address:t,mapTrigger:l})},i.getUUIDsForAccountByKinds=function(e,t,i){const r=new Set(i);return u(e,{address:t,mapTrigger:e=>r.has(e.kind)?e:undefined})},i.getUUIDsForKinds=function(e,t){const i=new Set(t);return u(e,{mapTrigger:e=>i.has(e.kind)?e.id:undefined})},i.inferEnabledKinds=function(e){const t=new Set;return u(e,{mapTrigger:e=>{t.add(e.kind)}}),Array.from(t)},i.initializeUserStorage=function(e,t){const i={[s.USER_STORAGE_VERSION_KEY]:s.USER_STORAGE_VERSION};return e.forEach((e=>{var r;const a=null===(r=e.address)||void 0===r?void 0:r.toLowerCase();a&&(i[a]||(i[a]={}),Object.entries(o.TRIGGERS).forEach((([e,{supported_chains:r}])=>{r.forEach((r=>{var s;null!==(s=i[a])&&void 0!==s&&s[r]||(i[a][r]={}),i[a][r][(0,n.v4)()]={k:e,e:t}}))})))})),i},i.makeApiCall=async function(e,t,i,r,n=1,s=1e3){const o={method:i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(r)};return async function(e,t,i=3,r=1e3){for(let n=1;n<=i;n++)try{const i=await fetch(e,t);if(!i.ok)throw new Error(`Fetch failed with status: ${i.status}`);return i}catch(e){if(a.default.error(`Attempt ${n} failed for fetch:`,e),!(n<i))throw new Error(`Fetching failed after ${i} retries. Last error: ${e instanceof Error?e.message:"Unknown error"}`);await new Promise((e=>setTimeout(e,r)))}throw new Error("Unexpected error in fetchWithRetry")}(t,o,n,s)},i.toggleUserStorageTriggerStatus=function(e,t,i,r,a){var n;null!=e&&null!==(n=e[t])&&void 0!==n&&null!==(n=n[i])&&void 0!==n&&n[r]&&(e[t][i][r].e=a);return e},i.traverseUserStorageTriggers=u,i.upsertAddressTriggers=function(e,t){const i=e.toLowerCase();t[i]=t[i]||{};for(const[e,{supported_chains:r}]of Object.entries(o.TRIGGERS))for(const a of r){t[i][a]=t[i][a]||{};if(!Object.values(t[i][a]).find((t=>t.k===e))){const r=(0,n.v4)();t[i][a][r]={k:e,e:!1}}}return t},i.upsertTriggerTypeTriggers=function(e,t){return Object.entries(t).forEach((([i,r])=>{i!==s.USER_STORAGE_VERSION_KEY&&Object.entries(r).forEach((([r,a])=>{if(!Object.values(a).find((t=>t.k===e))){const a=(0,n.v4)();t[i][r][a]={k:e,e:!1}}}))})),t};var r,a=(r=e("loglevel"))&&r.__esModule?r:{default:r},n=e("uuid"),s=e("../constants/constants"),o=e("../constants/notification-schema");const l=e=>e.id,c=e=>e,d=e=>{switch(e){case o.TRIGGER_TYPES.ERC20_RECEIVED:case o.TRIGGER_TYPES.ETH_RECEIVED:case o.TRIGGER_TYPES.ERC721_RECEIVED:case o.TRIGGER_TYPES.ERC1155_RECEIVED:return o.TRIGGER_TYPES_GROUPS.RECEIVED;case o.TRIGGER_TYPES.ERC20_SENT:case o.TRIGGER_TYPES.ETH_SENT:case o.TRIGGER_TYPES.ERC721_SENT:case o.TRIGGER_TYPES.ERC1155_SENT:return o.TRIGGER_TYPES_GROUPS.SENT;case o.TRIGGER_TYPES.METAMASK_SWAP_COMPLETED:case o.TRIGGER_TYPES.ROCKETPOOL_STAKE_COMPLETED:case o.TRIGGER_TYPES.ROCKETPOOL_UNSTAKE_COMPLETED:case o.TRIGGER_TYPES.LIDO_STAKE_COMPLETED:case o.TRIGGER_TYPES.LIDO_WITHDRAWAL_REQUESTED:case o.TRIGGER_TYPES.LIDO_WITHDRAWAL_COMPLETED:default:return o.TRIGGER_TYPES_GROUPS.DEFI}};function u(e,t){const i=[],r=(null==t?void 0:t.mapTrigger)??c;for(const o in e)if(o!==s.USER_STORAGE_VERSION_KEY&&(null==t||!t.address||o===t.address))for(const t in e[o])if(Object.hasOwn(e[o],t))for(const s in e[o][t])if(s){var a,n;const l=r({id:s,kind:null===(a=e[o])||void 0===a||null===(a=a[t])||void 0===a||null===(a=a[s])||void 0===a?void 0:a.k,chainId:t,address:o,enabled:(null===(n=e[o])||void 0===n||null===(n=n[t])||void 0===n||null===(n=n[s])||void 0===n?void 0:n.e)??!1});l&&i.push(l)}return i}}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/utils/utils.ts"}],[230,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,function(e){const t=null==e?void 0:e.TransactionController;if(!t)return;const i=(null==t?void 0:t.transactions)||{},r=Object.values(i).sort(((e,t)=>e.time>t.time?-1:1));e.TransactionController={...t,transactions:r}}(t.data),t},i.version=void 0;var r=e("lodash");const a=i.version=104}}},{package:"$root$",file:"app/scripts/migrations/104.ts"}],[231,{"../../../shared/constants/eth-methods":4427,"@metamask/keyring-api":1399,"ethereumjs-util":3236,lodash:3783,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=l,function(e){(function(e){e.AccountsController={internalAccounts:{accounts:{},selectedAccount:""}}})(e),function(e){var t;const i=(null===(t=e.PreferencesController)||void 0===t?void 0:t.identities)||{};if(0===Object.keys(i).length)return;const s={};Object.values(i).forEach((e=>{const t=(0,n.v4)({random:(0,a.sha256FromString)(e.address).slice(0,16)});s[t]={address:e.address,id:t,options:{},metadata:{name:e.name,lastSelected:e.lastSelected??undefined,keyring:{type:"HD Key Tree"}},methods:o.ETH_EOA_METHODS,type:r.EthAccountType.Eoa}})),e.AccountsController.internalAccounts.accounts=s}(e),function(e){var t;let i=null===(t=e.PreferencesController)||void 0===t?void 0:t.selectedAddress;if("string"!=typeof i){var r,a;null===(r=global.sentry)||void 0===r||null===(a=r.captureException)||void 0===a||a.call(r,new Error(`state.PreferencesController?.selectedAddress is ${i}`)),i=function(e){var t;const[i]=Object.keys((null===(t=e.PreferencesController)||void 0===t?void 0:t.identities)||{});return i}(e)}const n=function(e,t){return Object.values(e.AccountsController.internalAccounts.accounts).find((e=>e.address.toLowerCase()===t.toLowerCase()))}(e,i);n&&(e.PreferencesController.selectedAddress=n.address,e.AccountsController.internalAccounts={...e.AccountsController.internalAccounts,selectedAccount:n.id})}(e)}(t.data),t},i.version=void 0;var r=e("@metamask/keyring-api"),a=e("ethereumjs-util"),n=e("uuid"),s=e("lodash"),o=e("../../../shared/constants/eth-methods");const l=i.version=105}}},{package:"$root$",file:"app/scripts/migrations/105.ts"}],[232,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);t.meta.version=a;const i=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,securityAlertsEnabled:!0!==t.transactionSecurityCheckEnabled}}}(t.data);return t.data=i,t},i.version=void 0;var r=e("lodash");const a=i.version=106}}},{package:"$root$",file:"app/scripts/migrations/106.js"}],[233,{"@metamask/utils":2255,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=n,t.data=function(e){if(!((0,a.hasProperty)(e,"CachedBalancesController")&&(0,a.isObject)(e.CachedBalancesController)&&(0,a.hasProperty)(e.CachedBalancesController,"cachedBalances")&&(0,a.isObject)(e.CachedBalancesController.cachedBalances)&&(0,a.hasProperty)(e,"AccountTracker")&&(0,a.isObject)(e.AccountTracker)))return e;e.AccountTracker.accountsByChainId||(e.AccountTracker.accountsByChainId={});const t=e.AccountTracker,i=e.CachedBalancesController.cachedBalances;return Object.keys(i).forEach((e=>{t.accountsByChainId[e]||(t.accountsByChainId[e]={}),Object.keys(i[e]).forEach((r=>{if(t.accountsByChainId[e][r]===undefined){const a=i[e][r];t.accountsByChainId[e][r]={address:r,balance:a}}}))})),delete e.CachedBalancesController,e.AccountTracker=t,e}(t.data),t},i.version=void 0;var r=e("lodash"),a=e("@metamask/utils");const n=i.version=107}}},{package:"$root$",file:"app/scripts/migrations/107.ts"}]],[],{});