LavaPack.loadBundle([[10,{"@metamask/snaps-utils":2118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createSnapPublicKeyRequest=function(){return{snapId:s,origin:"",handler:n.HandlerType.OnRpcRequest,request:{method:"getPublicKey"}}},r.createSnapSignMessageRequest=function(e){return{snapId:s,origin:"",handler:n.HandlerType.OnRpcRequest,request:{method:"signMessage",params:{message:e}}}};var n=e("@metamask/snaps-utils");const s="npm:@metamask/message-signing-snap"}}},{package:"$root$",file:"app/scripts/controllers/authentication/auth-snap-requests.ts"}],[100,{"../../../../../shared/constants/app":4423,"eth-rpc-errors":3205},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors");const s={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,r,s,{addSubjectMetadata:i,subjectType:o}){const{origin:a,params:l}=e;if(!l||"object"!=typeof l||Array.isArray(l))return s(n.ethErrors.rpc.invalidParams({data:l}));{const{icon:e=null,name:t=null,...r}=l;i({...r,iconUrl:e,name:t,subjectType:o,origin:a})}return t.result=!0,s()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};r.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.js"}],[101,{"../../../../../shared/constants/app":4423,"./ethereum-chain-utils":95,"eth-rpc-errors":3205},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app"),i=e("./ethereum-chain-utils");const o={methodNames:[s.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,r,o,{findNetworkConfigurationBy:a,setActiveNetwork:l,requestPermittedChainsPermission:c,getCaveat:d,getCurrentChainIdForDomain:u,requestUserApproval:h,getChainPermissionsFeatureFlag:p}){let m;try{m=(0,i.validateSwitchEthereumChainParams)(e,o)}catch(e){return o(e)}const{origin:g}=e,f=u(g);if(f===m)return t.result=null,o();const v=(0,i.findExistingNetwork)(m,a),w=(null==v?void 0:v.id)??(null==v?void 0:v.type);if(!w)return o(n.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${m}". Try adding the chain using ${s.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}));const y={toNetworkConfiguration:v,fromNetworkConfiguration:(0,i.findExistingNetwork)(f,a)};return(0,i.switchChain)(t,o,g,m,y,w,null,{getChainPermissionsFeatureFlag:p,setActiveNetwork:l,requestUserApproval:h,getCaveat:d,requestPermittedChainsPermission:c})},hookNames:{findNetworkConfigurationBy:!0,setActiveNetwork:!0,getCaveat:!0,requestPermittedChainsPermission:!0,getCurrentChainIdForDomain:!0,requestUserApproval:!0,getChainPermissionsFeatureFlag:!0}};r.default=o}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[102,{"../../../../../shared/constants/app":4423,"@metamask/controller-utils":1166,"eth-rpc-errors":3205},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),i=e("../../../../../shared/constants/app");const o={methodNames:[i.MESSAGE_TYPE.WATCH_ASSET,i.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,r,i,{handleWatchAssetRequest:o}){try{const{params:{options:r,type:a},origin:l,networkClientId:c}=e,{tokenId:d}=r;return[n.ERC721,n.ERC1155].includes(a)&&d!==undefined&&"string"!=typeof d?i(s.ethErrors.rpc.invalidParams({message:`Expected parameter 'tokenId' to be type 'string'. Received type '${typeof d}'`})):(await o({asset:r,type:a,origin:l,networkClientId:c}),t.result=!0,i())}catch(e){return i(e)}},hookNames:{handleWatchAssetRequest:!0}};r.default=o}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.js"}],[103,{"./createMethodMiddleware":91,"./createUnsupportedMethodMiddleware":92},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./createMethodMiddleware");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}));var s=e("./createUnsupportedMethodMiddleware");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}}))}))}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[104,{"../util":119,"@segment/loosely-validate-event":2331,buffer:2983,"is-retry-allowed":3606,lodash:3783,"remove-trailing-slash":4197,timers:4295},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=c(e("remove-trailing-slash")),i=c(e("@segment/loosely-validate-event")),o=e("lodash"),a=c(e("is-retry-allowed")),l=e("../util");function c(e){return e&&e.__esModule?e:{default:e}}const d=()=>({});r.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,s.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,i.default)(e,t)}_message(e,t,r){return this._validate(t,e),this.enqueue(e,t,r),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,r=d){if(!this.enable)return void n(r);const s={...t,type:e};if(s.context={...s.context,library:{name:"analytics-node"}},s.timestamp||(s.timestamp=new Date),s.messageId||(s.messageId=(0,l.generateRandomId)()),s.anonymousId&&!(0,o.isString)(s.anonymousId)&&(s.anonymousId=JSON.stringify(s.anonymousId)),s.userId&&!(0,o.isString)(s.userId)&&(s.userId=JSON.stringify(s.userId)),this.queue.push({message:s,callback:r}),!this.flushed)return this.flushed=!0,void this.flush();const i=this.queue.length>=this.flushAt,a=this.queue.reduce(((e,t)=>e+JSON.stringify(t).length),0)>=this.maxQueueSize;(i||a)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=d){if(!this.enable)return n(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return n(e),Promise.resolve();const r=this.queue.splice(0,this.flushAt),s=r.map((e=>e.callback)),i={batch:r.map((e=>e.message)),timestamp:new Date,sentAt:new Date},o={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(i),headers:o},(t=>{n((()=>{s.forEach((e=>e(t,i))),e(t,i)}))}),0)}_retryRequest(e,t,r,n){const s=100*Math.pow(2,n);setTimeout((()=>{this._sendRequest(e,t,r,n+1)}),s)}async _sendRequest(e,t,r,n){return fetch(e,t).then((async s=>{if(s.ok)r();else if(this._isErrorRetryable({response:s})&&n<=this.retryCount)this._retryRequest(e,t,r,n);else{const e=new Error(s.statusText);r(e)}})).catch((s=>{this._isErrorRetryable(s)&&n<=this.retryCount?this._retryRequest(e,t,r,n):r(s)}))}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,a.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[105,{"../../../../shared/constants/time":4447,"./analytics":104},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.segment=r.createSegmentMock=void 0;var n,s=e("../../../../shared/constants/time");(n=e("./analytics"))&&n.__esModule;s.SECOND;const i=(e=1)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(r,n=(()=>undefined)){t.queue.push([r,n]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};r.createSegmentMock=i;r.segment=i(1)}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[1079,{"./chunk-EIQ5DUI6.js":1080,"./chunk-UJIPPGP6.js":1082,"@metamask/base-controller":1089,"@metamask/eth-snap-keyring":1284,"@metamask/keyring-api":1399,"@metamask/keyring-controller":1431,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p,m,g,f,v,w,y,k,C,b,_,T,S,M,E=e("./chunk-EIQ5DUI6.js"),A=e("./chunk-UJIPPGP6.js"),P=e("@metamask/base-controller"),I=e("@metamask/eth-snap-keyring"),N=e("@metamask/keyring-api"),j=e("@metamask/keyring-controller"),R=e("@metamask/utils"),O="AccountsController",x={internalAccounts:{persist:!0,anonymous:!1}},B={internalAccounts:{accounts:{},selectedAccount:""}},U=class extends P.BaseController{constructor({messenger:e,state:t}){super({messenger:e,name:O,metadata:x,state:{...B,...t}}),A.__privateAdd.call(void 0,this,n),A.__privateAdd.call(void 0,this,i),A.__privateAdd.call(void 0,this,a),A.__privateAdd.call(void 0,this,c),A.__privateAdd.call(void 0,this,u),A.__privateAdd.call(void 0,this,p),A.__privateAdd.call(void 0,this,g),A.__privateAdd.call(void 0,this,v),A.__privateAdd.call(void 0,this,y),A.__privateAdd.call(void 0,this,C),A.__privateAdd.call(void 0,this,_),A.__privateAdd.call(void 0,this,S),this.messagingSystem.subscribe("SnapController:stateChange",(e=>A.__privateMethod.call(void 0,this,u,h).call(this,e))),this.messagingSystem.subscribe("KeyringController:stateChange",(e=>A.__privateMethod.call(void 0,this,c,d).call(this,e))),A.__privateMethod.call(void 0,this,S,M).call(this)}getAccount(e){return this.state.internalAccounts.accounts[e]}listAccounts(){return Object.values(this.state.internalAccounts.accounts).filter((e=>N.isEvmAccountType.call(void 0,e.type)))}listMultichainAccounts(e){const t=Object.values(this.state.internalAccounts.accounts);if(!e)return t;if(!R.isCaipChainId.call(void 0,e))throw new Error(`Invalid CAIP-2 chain ID: ${String(e)}`);return t.filter((t=>A.__privateMethod.call(void 0,this,v,w).call(this,t,e)))}getAccountExpect(e){if(!e)return{id:"",address:"",options:{},methods:[],type:N.EthAccountType.Eoa,metadata:{name:"",keyring:{type:""},importTime:0}};const t=this.getAccount(e);if(void 0===t)throw new Error(`Account Id "${e}" not found`);return t}getSelectedAccount(){const e=this.getAccountExpect(this.state.internalAccounts.selectedAccount);if(N.isEvmAccountType.call(void 0,e.type))return e;const t=this.listAccounts();if(!t.length)throw new Error("No EVM accounts");return A.__privateMethod.call(void 0,this,g,f).call(this,t)}getSelectedMultichainAccount(e){if(!e)return this.getAccountExpect(this.state.internalAccounts.selectedAccount);if(!R.isCaipChainId.call(void 0,e))throw new Error(`Invalid CAIP-2 chain ID: ${e}`);const t=Object.values(this.state.internalAccounts.accounts).filter((t=>A.__privateMethod.call(void 0,this,v,w).call(this,t,e)));return A.__privateMethod.call(void 0,this,g,f).call(this,t)}getAccountByAddress(e){return this.listAccounts().find((t=>t.address.toLowerCase()===e.toLowerCase()))}setSelectedAccount(e){const t=this.getAccountExpect(e);this.update((e=>{e.internalAccounts.accounts[t.id].metadata.lastSelected=Date.now(),e.internalAccounts.selectedAccount=t.id})),N.isEvmAccountType.call(void 0,t.type)&&this.messagingSystem.publish("AccountsController:selectedEvmAccountChange",t),this.messagingSystem.publish("AccountsController:selectedAccountChange",t)}setAccountName(e,t){const r=this.getAccountExpect(e);if(this.listAccounts().find((r=>r.metadata.name===t&&r.id!==e)))throw new Error("Account name already exists");this.update((n=>{const s={...r,metadata:{...r.metadata,name:t}},i=E.deepCloneDraft.call(void 0,n);return i.internalAccounts.accounts[e]=s,i}))}async updateAccounts(){const e=await A.__privateMethod.call(void 0,this,i,o).call(this),t=await A.__privateMethod.call(void 0,this,a,l).call(this),r=new Map,n=this.state.internalAccounts.accounts,s=[...t,...e].reduce(((e,t)=>{const s=E.keyringTypeToName.call(void 0,t.metadata.keyring.type),i=r.get(s)??0;i?r.set(s,i+1):r.set(s,1);const o=n[t.id];return e[t.id]={...t,metadata:{...t.metadata,name:A.__privateMethod.call(void 0,this,_,T).call(this,o?.id,"name")??`${s} ${i+1}`,importTime:A.__privateMethod.call(void 0,this,_,T).call(this,o?.id,"importTime")??Date.now(),lastSelected:A.__privateMethod.call(void 0,this,_,T).call(this,o?.id,"lastSelected")??0}},e}),{});this.update((e=>{const t=E.deepCloneDraft.call(void 0,e);return t.internalAccounts.accounts=s,t}))}loadBackup(e){e.internalAccounts&&this.update((t=>{const r=E.deepCloneDraft.call(void 0,t);return r.internalAccounts=e.internalAccounts,r}))}getNextAvailableAccountName(e=j.KeyringTypes.hd){const t=E.keyringTypeToName.call(void 0,e),r=A.__privateMethod.call(void 0,this,p,m).call(this,e),n=r.reduce(((e,r)=>{const n=new RegExp(`${t} ([0-9]+)$`,"u").exec(r.metadata.name);if(n){const t=parseInt(n[1],10);return Math.max(e,t)}return e}),0),s=Math.max(r.length+1,n+1);return`${t} ${s}`}};n=new WeakSet,s=function(e,t){return{id:E.getUUIDFromAddressOfNormalAccount.call(void 0,e),address:e,options:{},methods:[N.EthMethod.PersonalSign,N.EthMethod.Sign,N.EthMethod.SignTransaction,N.EthMethod.SignTypedDataV1,N.EthMethod.SignTypedDataV3,N.EthMethod.SignTypedDataV4],type:N.EthAccountType.Eoa,metadata:{name:"",importTime:Date.now(),keyring:{type:t}}}},i=new WeakSet,o=async function(){const[e]=this.messagingSystem.call("KeyringController:getKeyringsByType",I.SnapKeyring.type);if(!e)return[];return e.listAccounts()},a=new WeakSet,l=async function(){const e=await this.messagingSystem.call("KeyringController:getAccounts"),t=[];for(const r of e){const e=await this.messagingSystem.call("KeyringController:getKeyringForAccount",r),n=e.type;if(!E.isNormalKeyringType.call(void 0,n))continue;const s=E.getUUIDFromAddressOfNormalAccount.call(void 0,r);t.push({id:s,address:r,options:{},methods:[N.EthMethod.PersonalSign,N.EthMethod.Sign,N.EthMethod.SignTransaction,N.EthMethod.SignTypedDataV1,N.EthMethod.SignTypedDataV3,N.EthMethod.SignTypedDataV4],type:N.EthAccountType.Eoa,metadata:{name:A.__privateMethod.call(void 0,this,_,T).call(this,s,"name")??"",importTime:A.__privateMethod.call(void 0,this,_,T).call(this,s,"importTime")??Date.now(),lastSelected:A.__privateMethod.call(void 0,this,_,T).call(this,s,"lastSelected")??0,keyring:{type:e.type}}})}return t},c=new WeakSet,d=function(e){if(e.isUnlocked&&e.keyrings.length>0){const t=[],r=[];for(const n of e.keyrings)n.type===j.KeyringTypes.snap?r.push(...n.accounts.map((e=>({address:e,type:n.type})))):t.push(...n.accounts.map((e=>({address:e,type:n.type}))));const{previousNormalInternalAccounts:n,previousSnapInternalAccounts:s}=this.listAccounts().reduce(((e,t)=>(t.metadata.keyring.type===j.KeyringTypes.snap?e.previousSnapInternalAccounts.push(t):e.previousNormalInternalAccounts.push(t),e)),{previousNormalInternalAccounts:[],previousSnapInternalAccounts:[]}),i=[],o=[];for(const e of t)this.state.internalAccounts.accounts[E.getUUIDFromAddressOfNormalAccount.call(void 0,e.address)]||i.push(e);for(const e of r)s.find((t=>t.address.toLowerCase()===e.address.toLowerCase()))||i.push(e);for(const e of n)t.find((({address:t})=>t.toLowerCase()===e.address.toLowerCase()))||o.push(e);for(const e of s)r.find((({address:t})=>t.toLowerCase()===e.address.toLowerCase()))||o.push(e);if(o.length>0)for(const e of o)A.__privateMethod.call(void 0,this,C,b).call(this,e.id);if(i.length>0)for(const e of i)A.__privateMethod.call(void 0,this,y,k).call(this,e);if(!this.getAccount(this.state.internalAccounts.selectedAccount)){const[e]=this.listAccounts().sort(((e,t)=>(t.metadata.lastSelected??0)-(e.metadata.lastSelected??0)));if(!e)return void this.update((e=>{e.internalAccounts.selectedAccount=""}));this.setSelectedAccount(e.id)}}},u=new WeakSet,h=function(e){const{snaps:t}=e,r=this.listAccounts().filter((e=>e.metadata.snap));this.update((e=>{r.forEach((r=>{const n=e.internalAccounts.accounts[r.id];if(n.metadata.snap){const e=n.metadata.snap.id,r=t[e];r&&(n.metadata.snap.enabled=r.enabled&&!r.blocked)}}))}))},p=new WeakSet,m=function(e){return this.listAccounts().filter((t=>e===j.KeyringTypes.hd||e===j.KeyringTypes.simple?t.metadata.keyring.type===j.KeyringTypes.hd||t.metadata.keyring.type===j.KeyringTypes.simple:t.metadata.keyring.type===e))},g=new WeakSet,f=function(e){return e.reduce(((e,t)=>t.metadata.lastSelected>e.metadata.lastSelected?t:e),e[0])},v=new WeakSet,w=function(e,t){return e.type.startsWith(R.parseCaipChainId.call(void 0,t).namespace)},y=new WeakSet,k=function(e){let t;if(e.type!==j.KeyringTypes.snap)t=A.__privateMethod.call(void 0,this,n,s).call(this,e.address,e.type);else{const[r]=this.messagingSystem.call("KeyringController:getKeyringsByType",I.SnapKeyring.type);if(t=r.getAccountByAddress(e.address),!t)return}const r=this.getNextAvailableAccountName(t.metadata.keyring.type);this.update((e=>{const n=E.deepCloneDraft.call(void 0,e);return n.internalAccounts.accounts[t.id]={...t,metadata:{...t.metadata,name:r,importTime:Date.now(),lastSelected:Date.now()}},n})),this.setSelectedAccount(t.id)},C=new WeakSet,b=function(e){this.update((t=>{delete t.internalAccounts.accounts[e]}))},_=new WeakSet,T=function(e,t){const r=this.getAccount(e);return r?r.metadata[t]:void 0},S=new WeakSet,M=function(){this.messagingSystem.registerActionHandler(`${O}:setSelectedAccount`,this.setSelectedAccount.bind(this)),this.messagingSystem.registerActionHandler(`${O}:listAccounts`,this.listAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${O}:setAccountName`,this.setAccountName.bind(this)),this.messagingSystem.registerActionHandler(`${O}:updateAccounts`,this.updateAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${O}:getSelectedAccount`,this.getSelectedAccount.bind(this)),this.messagingSystem.registerActionHandler(`${O}:getSelectedMultichainAccount`,this.getSelectedMultichainAccount.bind(this)),this.messagingSystem.registerActionHandler(`${O}:getAccountByAddress`,this.getAccountByAddress.bind(this)),this.messagingSystem.registerActionHandler(`${O}:getNextAvailableAccountName`,this.getNextAvailableAccountName.bind(this)),this.messagingSystem.registerActionHandler("AccountsController:getAccount",this.getAccount.bind(this))},r.AccountsController=U}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-7CWWNB3P.js"}],[1080,{"@ethereumjs/util":441,"@metamask/keyring-controller":1431,"@metamask/snaps-utils":2118,"ethereum-cryptography/sha256":3226,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@ethereumjs/util"),s=e("@metamask/keyring-controller"),i=e("@metamask/snaps-utils"),o=e("ethereum-cryptography/sha256"),a=e("uuid");function l(e){return{random:o.sha256.call(void 0,n.toBuffer.call(void 0,e)).slice(0,16)}}r.keyringTypeToName=function(e){if(s.isCustodyKeyring.call(void 0,e))return"Custody";switch(e){case s.KeyringTypes.simple:case s.KeyringTypes.hd:return"Account";case s.KeyringTypes.trezor:return"Trezor";case s.KeyringTypes.ledger:return"Ledger";case s.KeyringTypes.lattice:return"Lattice";case s.KeyringTypes.qr:return"QR";case s.KeyringTypes.snap:return"Snap Account";default:throw new Error(`Unknown keyring ${e}`)}},r.getUUIDOptionsFromAddressOfNormalAccount=l,r.getUUIDFromAddressOfNormalAccount=function(e){return a.v4.call(void 0,l(e))},r.isNormalKeyringType=function(e){return e!==s.KeyringTypes.snap},r.deepCloneDraft=function(e){return i.deepClone.call(void 0,e)}}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-EIQ5DUI6.js"}],[1081,{"@metamask/keyring-api":1399,"@metamask/keyring-controller":1431,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/keyring-api"),s=e("@metamask/keyring-controller"),i=e("uuid");r.createMockInternalAccount=({id:e=i.v4.call(void 0),address:t="0x2990079bcdee240329a520d2444386fc119da21a",type:r=n.EthAccountType.Eoa,name:o="Account 1",keyringType:a=s.KeyringTypes.hd,snap:l,importTime:c=Date.now(),lastSelected:d=Date.now()}={})=>{let u;switch(r){case n.EthAccountType.Eoa:u=[n.EthMethod.PersonalSign,n.EthMethod.Sign,n.EthMethod.SignTransaction,n.EthMethod.SignTypedDataV1,n.EthMethod.SignTypedDataV3,n.EthMethod.SignTypedDataV4];break;case n.EthAccountType.Erc4337:u=[n.EthErc4337Method.PatchUserOperation,n.EthErc4337Method.PrepareUserOperation,n.EthErc4337Method.SignUserOperation];break;case n.BtcAccountType.P2wpkh:u=[n.BtcMethod.SendMany];break;default:throw new Error(`Unknown account type: ${r}`)}return{id:e,address:t,options:{},methods:u,type:r,metadata:{name:o,keyring:{type:a},importTime:c,lastSelected:d,snap:l}}}}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-IBSI66UQ.js"}],[1082,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateMethod=(e,t,r)=>(((e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)})(e,t,"access private method"),r)}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-UJIPPGP6.js"}],[1083,{"./chunk-7CWWNB3P.js":1079,"./chunk-EIQ5DUI6.js":1080,"./chunk-IBSI66UQ.js":1081,"./chunk-UJIPPGP6.js":1082},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-7CWWNB3P.js"),s=e("./chunk-EIQ5DUI6.js"),i=e("./chunk-IBSI66UQ.js");e("./chunk-UJIPPGP6.js"),r.AccountsController=n.AccountsController,r.createMockInternalAccount=i.createMockInternalAccount,r.getUUIDFromAddressOfNormalAccount=s.getUUIDFromAddressOfNormalAccount,r.keyringTypeToName=s.keyringTypeToName}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/index.js"}],[1084,{"./chunk-UJFCPTF3.js":1086,"./chunk-Z4BLTVTB.js":1087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,o,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,n).delete(e)}clearActions(){l.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,i).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=l.__privateGet.call(void 0,this,o).get(e),s=n(...t);s!==r&&(l.__privateGet.call(void 0,this,o).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=l.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,l.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=l.__privateGet.call(void 0,this,i).get(e);if(n){const e=r(...n());l.__privateGet.call(void 0,this,o).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,o).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1085,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1086,{"./chunk-Z4BLTVTB.js":1087},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,i,r),p.__privateSet.call(void 0,this,o,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1087,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1088,{"./chunk-Z4BLTVTB.js":1087,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),i=e("immer");i.enablePatches.call(void 0);function o(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:o}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,i.freeze.call(void 0,o,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,o]=i.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:o}}applyPatches(e){const t=i.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},r.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1089,{"./chunk-G42723LG.js":1084,"./chunk-NINOM2XQ.js":1085,"./chunk-UJFCPTF3.js":1086,"./chunk-Z4BLTVTB.js":1087,"./chunk-ZNOPSWMU.js":1088},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-NINOM2XQ.js"),s=e("./chunk-ZNOPSWMU.js"),i=e("./chunk-G42723LG.js"),o=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=i.ControllerMessenger,r.RestrictedControllerMessenger=o.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/index.js"}],[109,{"./snap-keyring":111},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getAccountsBySnapId",{enumerable:!0,get:function(){return n.getAccountsBySnapId}}),Object.defineProperty(r,"snapKeyringBuilder",{enumerable:!0,get:function(){return n.snapKeyringBuilder}});var n=e("./snap-keyring")}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/index.ts"}],[1090,{"@metamask/base-controller":1097,"@metamask/controller-utils":1103},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/base-controller"),s=e("@metamask/controller-utils"),i=(e=>(e.externallyOwnedAccounts="EXTERNALLY_OWNED_ACCOUNTS",e.contractAccounts="CONTRACT_ACCOUNTS",e.nonAccounts="NON_ACCOUNTS",e))(i||{}),o=class extends n.BaseControllerV1{constructor(e,t){super(e,t),this.name="AddressBookController",this.defaultState={addressBook:{}},this.initialize()}clear(){this.update({addressBook:{}})}delete(e,t){if(t=s.toChecksumHexAddress.call(void 0,t),!s.isValidHexAddress.call(void 0,t)||!this.state.addressBook[e]||!this.state.addressBook[e][t])return!1;const r=Object.assign({},this.state.addressBook);return delete r[e][t],0===Object.keys(r[e]).length&&delete r[e],this.update({addressBook:r}),!0}set(e,t,r=s.toHex.call(void 0,1),n="",i){if(e=s.toChecksumHexAddress.call(void 0,e),!s.isValidHexAddress.call(void 0,e))return!1;const o={address:e,chainId:r,isEns:!1,memo:n,name:t,addressType:i},a=s.normalizeEnsName.call(void 0,t);return a&&(o.name=a,o.isEns=!0),this.update({addressBook:{...this.state.addressBook,[r]:{...this.state.addressBook[r],[e]:o}}}),!0}},a=o;r.AddressType=i,r.AddressBookController=o,r.AddressBookController_default=a}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/chunk-ISKA7MA7.js"}],[1091,{"./chunk-ISKA7MA7.js":1090},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-ISKA7MA7.js");r.AddressBookController=n.AddressBookController,r.AddressType=n.AddressType}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/index.js"}],[1092,{"./chunk-UJFCPTF3.js":1094,"./chunk-Z4BLTVTB.js":1095},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,o,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,n).delete(e)}clearActions(){l.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,i).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=l.__privateGet.call(void 0,this,o).get(e),s=n(...t);s!==r&&(l.__privateGet.call(void 0,this,o).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=l.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,l.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=l.__privateGet.call(void 0,this,i).get(e);if(n){const e=r(...n());l.__privateGet.call(void 0,this,o).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,o).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/address-book-controller>@metamask/base-controller",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1093,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/address-book-controller>@metamask/base-controller",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1094,{"./chunk-Z4BLTVTB.js":1095},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,i,r),p.__privateSet.call(void 0,this,o,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/address-book-controller>@metamask/base-controller",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1095,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/address-book-controller>@metamask/base-controller",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1096,{"./chunk-Z4BLTVTB.js":1095,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),i=e("immer");i.enablePatches.call(void 0);function o(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:o}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,i.freeze.call(void 0,o,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,o]=i.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:o}}applyPatches(e){const t=i.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},r.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/address-book-controller>@metamask/base-controller",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1097,{"./chunk-G42723LG.js":1092,"./chunk-NINOM2XQ.js":1093,"./chunk-UJFCPTF3.js":1094,"./chunk-Z4BLTVTB.js":1095,"./chunk-ZNOPSWMU.js":1096},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-NINOM2XQ.js"),s=e("./chunk-ZNOPSWMU.js"),i=e("./chunk-G42723LG.js"),o=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=i.ControllerMessenger,r.RestrictedControllerMessenger=o.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/address-book-controller>@metamask/base-controller",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1098,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/utils"),s=n.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=n.createModuleLogger,r.projectLogger=s}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1099,{"./chunk-X4PYR7CK.js":1102,"@ethereumjs/util":441,"@metamask/ethjs-unit":1336,"@metamask/utils":2255,"bn.js":2935,buffer:2983,"eth-ens-namehash":3173,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./chunk-X4PYR7CK.js"),i=e("@ethereumjs/util"),o=e("@metamask/ethjs-unit"),a=e("@metamask/utils"),l=n(e("bn.js")),c=n(e("eth-ens-namehash")),d=n(e("fast-deep-equal")),u=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,l.default)(a.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function m(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function g(e,t){const r=await m(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!a.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,a.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=s.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return a.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const n=new(0,l.default)(t),s=new(0,l.default)(r);return e.mul(n).div(s)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),r=t[0]||"0";let n=t[1]||"";if(!n)return o.toWei.call(void 0,r,"gwei");if(n.length<=9)return o.toWei.call(void 0,`${r}.${n}`,"gwei");const s=n.slice(9)[0];n=n.slice(0,9);let i=o.toWei.call(void 0,`${r}.${n}`,"gwei");return Number(s)>=5&&(i=i.add(new(0,l.default)(1))),i},r.weiHexToGweiDec=function(e){const t=new(0,l.default)(a.remove0x.call(void 0,e),16);return o.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=p,r.hexToText=function(e){try{const r=a.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(p(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&a.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(u)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=a.add0x.call(void 0,e);return a.isHexString.call(void 0,t)?i.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?a.add0x.call(void 0,e):e;return!!a.isStrictHexString.call(void 0,r)&&i.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=m,r.handleFetch=g,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:n}){let s;try{s=r?Promise.race([await g(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),r)))]):await g(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==u)throw e;console.error(e)}(e,n)}return s},r.timeoutFetch=async function(e,t,r=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((n,s)=>{const i=(e,t)=>{e?s(e):n(t)};t in e&&"function"==typeof e[t]?e[t](...r,i):e.sendAsync({method:t,params:r},i)}))},r.convertHexToDecimal=(e="0x0")=>a.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return d.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-EDY72VWL.js"}],[11,{"./auth-snap-requests":10,"./services":12,"@metamask/base-controller":1157},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/base-controller"),s=e("./auth-snap-requests"),i=e("./services");function o(e,t){l(e,t),t.add(e)}function a(e,t,r){l(e,t),t.set(e,r)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function d(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,h(e,t,"get"))}function u(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,h(e,t,"set"),r),r}function h(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}const p=18e5,m="AuthenticationController",g={isSignedIn:!1},f={isSignedIn:{persist:!0,anonymous:!0},sessionData:{persist:!0,anonymous:!1}};var v=new WeakMap,w=new WeakMap,y=new WeakMap,k=new WeakSet,C=new WeakSet,b=new WeakSet,_=new WeakSet,T=new WeakMap,S=new WeakSet,M=new WeakMap,E=new WeakSet;class A extends n.BaseController{constructor({messenger:e,state:t,metametrics:r}){super({messenger:e,metadata:f,name:m,state:{...g,...t}}),o(this,E),o(this,S),o(this,_),o(this,b),o(this,C),o(this,k),a(this,v,{writable:!0,value:void 0}),a(this,w,{writable:!0,value:!1}),a(this,y,{writable:!0,value:{setupLockedStateSubscriptions:()=>{const{isUnlocked:e}=this.messagingSystem.call("KeyringController:getState");u(this,w,e),this.messagingSystem.subscribe("KeyringController:unlock",(()=>{u(this,w,!0)})),this.messagingSystem.subscribe("KeyringController:lock",(()=>{u(this,w,!1)}))}}}),a(this,T,{writable:!0,value:void 0}),a(this,M,{writable:!0,value:{}}),u(this,v,r),d(this,y).setupLockedStateSubscriptions(),c(this,k,P).call(this)}async performSignIn(){const{accessToken:e}=await c(this,b,N).call(this);return e}performSignOut(){c(this,C,I).call(this),this.update((e=>{e.isSignedIn=!1,e.sessionData=undefined}))}async getBearerToken(){if(c(this,C,I).call(this),c(this,_,j).call(this,this.state.sessionData))return this.state.sessionData.accessToken;const{accessToken:e}=await c(this,b,N).call(this);return e}async getSessionProfile(){if(c(this,C,I).call(this),c(this,_,j).call(this,this.state.sessionData))return this.state.sessionData.profile;const{profile:e}=await c(this,b,N).call(this);return e}isSignedIn(){return this.state.isSignedIn}}function P(){this.messagingSystem.registerActionHandler("AuthenticationController:getBearerToken",this.getBearerToken.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:getSessionProfile",this.getSessionProfile.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:isSignedIn",this.isSignedIn.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:performSignIn",this.performSignIn.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:performSignOut",this.performSignOut.bind(this))}function I(){if(!this.state.isSignedIn)throw new Error(`${m}: Unable to call method, user is not authenticated`)}async function N(){try{const e=await c(this,S,R).call(this),t=await(0,i.getNonce)(e);if(!t)throw new Error("Unable to get nonce");const r=(0,i.createLoginRawMessage)(t,e),n=await c(this,E,O).call(this,r),s=await(0,i.login)(r,n,d(this,v).getMetaMetricsId());if(null==s||!s.token)throw new Error("Unable to login");const o={identifierId:s.profile.identifier_id,profileId:s.profile.profile_id},a=await(0,i.getAccessToken)(s.token);if(!a)throw new Error("Unable to get Access Token");return this.update((e=>{e.isSignedIn=!0;const t=new Date;t.setTime(t.getTime()+p),e.sessionData={profile:o,accessToken:a,expiresIn:t.toString()}})),{profile:o,accessToken:a}}catch(e){console.error("Failed to authenticate",e);const t=e instanceof Error?e.message:JSON.stringify(e??"");throw new Error(`${m}: Failed to authenticate - ${t}`)}}function j(e){if(!e)return!1;const t=Date.parse(e.expiresIn);if(isNaN(t))return!1;const r=new Date,n=Math.abs(r.getTime()-t);return p>n}async function R(){if(d(this,T))return d(this,T);if(!d(this,w))throw new Error("#snapGetPublicKey - unable to call snap, wallet is locked");const e=await this.messagingSystem.call("SnapController:handleRequest",(0,s.createSnapPublicKeyRequest)());return u(this,T,e),e}async function O(e){if(d(this,M)[e])return d(this,M)[e];if(!d(this,w))throw new Error("#snapSignMessage - unable to call snap, wallet is locked");const t=await this.messagingSystem.call("SnapController:handleRequest",(0,s.createSnapSignMessageRequest)(e));return d(this,M)[e]=t,t}r.default=A}}},{package:"$root$",file:"app/scripts/controllers/authentication/authentication-controller.ts"}],[110,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSnapAndHardwareInfoForMetrics=async function(e,t,r){var n,s,i;if(!r)return{};const o=r.call("AccountsController:getSelectedAccount"),a=o.address,{keyring:l}=o.metadata;let c;var d;null!==(n=o.metadata.snap)&&void 0!==n&&n.id&&(c=r.call("SnapController:get",null===(d=o.metadata.snap)||void 0===d?void 0:d.id));return{account_type:await e(a),device_model:await t(a),account_hardware_type:await async function(){var e;return null!=l&&null!==(e=l.type)&&void 0!==e&&e.includes("Hardware")?l.type:undefined}(),account_snap_type:null===(s=c)||void 0===s?void 0:s.id,account_snap_version:null===(i=c)||void 0===i?void 0:i.version}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/metrics.ts"}],[1100,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},s={...n,rpc:"rpc"};var i=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(i||{}),o={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},a=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(a||{});r.InfuraNetworkType=n,r.NetworkType=s,r.isNetworkType=function(e){return Object.values(s).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(n).includes(e)},r.BuiltInNetworkName=i,r.ChainId=o,r.NetworksTicker=a}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1101,{"./chunk-DBJSLKNR.js":1098,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-DBJSLKNR.js"),s=e("@metamask/utils"),i=e("@spruceid/siwe-parser"),o=n.createModuleLogger.call(void 0,n.projectLogger,"detect-siwe");function a(e){try{const n="string"!=typeof(r=e)?r:s.remove0x.call(void 0,r),i=t.from(n,"hex");return 32===i.length?e:i.toString("utf8")}catch(t){return o(t),e}var r}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=c,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const n=new URL(t),s=c(r.parsedMessage.domain,n.protocol);return 0===s.hostname.localeCompare(n.hostname,void 0,{sensitivity:"accent"})&&(""!==s.port&&s.port!==n.port?""===n.port&&s.port===l[n.protocol]:""===s.username||s.username===n.username)}catch(e){return o(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=a(t);return{isSIWEMessage:!0,parsedMessage:new(0,i.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1102,{"./chunk-LGGBBU6G.js":1100},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-LGGBBU6G.js"),s={[n.NetworkType.goerli]:{chainId:n.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.goerli}.etherscan.io`}},[n.NetworkType.sepolia]:{chainId:n.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.sepolia}.etherscan.io`}},[n.NetworkType.mainnet]:{chainId:n.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[n.NetworkType["linea-goerli"]]:{chainId:n.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[n.NetworkType["linea-sepolia"]]:{chainId:n.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[n.NetworkType["linea-mainnet"]]:{chainId:n.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[n.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},i=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(i||{}),o={[n.ChainId.goerli]:"goerli",[n.ChainId.sepolia]:"sepolia",[n.ChainId.mainnet]:"mainnet",[n.ChainId["linea-goerli"]]:"linea-goerli",[n.ChainId["linea-sepolia"]]:"linea-sepolia",[n.ChainId["linea-mainnet"]]:"linea-mainnet",[n.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=s,r.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.ORIGIN_METAMASK="metamask",r.ApprovalType=i,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=o}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-X4PYR7CK.js"}],[1103,{"./chunk-DBJSLKNR.js":1098,"./chunk-EDY72VWL.js":1099,"./chunk-LGGBBU6G.js":1100,"./chunk-M6G3ISXG.js":1101,"./chunk-X4PYR7CK.js":1102},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var s=e("./chunk-EDY72VWL.js"),i=e("./chunk-X4PYR7CK.js"),o=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=i.ASSET_TYPES,r.ApprovalType=i.ApprovalType,r.BNToHex=s.BNToHex,r.BUILT_IN_NETWORKS=i.BUILT_IN_NETWORKS,r.BuiltInNetworkName=o.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=o.ChainId,r.ERC1155=i.ERC1155,r.ERC1155_INTERFACE_ID=i.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=i.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=i.ERC20,r.ERC721=i.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=i.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=i.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=i.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=i.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=i.GANACHE_CHAIN_ID,r.GWEI=i.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=i.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=o.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=i.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=i.NFT_API_BASE_URL,r.NetworkType=o.NetworkType,r.NetworksTicker=o.NetworksTicker,r.OPENSEA_PROXY_URL=i.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=i.ORIGIN_METAMASK,r.RPC=i.RPC,r.TESTNET_TICKER_SYMBOLS=i.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=s.convertHexToDecimal,r.detectSIWE=n.detectSIWE,r.fetchWithErrorHandling=s.fetchWithErrorHandling,r.fractionBN=s.fractionBN,r.fromHex=s.fromHex,r.getBuyURL=s.getBuyURL,r.gweiDecToWEIBN=s.gweiDecToWEIBN,r.handleFetch=s.handleFetch,r.hexToBN=s.hexToBN,r.hexToText=s.hexToText,r.isInfuraNetworkType=o.isInfuraNetworkType,r.isNetworkType=o.isNetworkType,r.isNonEmptyArray=s.isNonEmptyArray,r.isPlainObject=s.isPlainObject,r.isSafeChainId=s.isSafeChainId,r.isSafeDynamicKey=s.isSafeDynamicKey,r.isSmartContractCode=s.isSmartContractCode,r.isValidHexAddress=s.isValidHexAddress,r.isValidJson=s.isValidJson,r.isValidSIWEOrigin=n.isValidSIWEOrigin,r.normalizeEnsName=s.normalizeEnsName,r.parseDomainParts=n.parseDomainParts,r.query=s.query,r.safelyExecute=s.safelyExecute,r.safelyExecuteWithTimeout=s.safelyExecuteWithTimeout,r.successfulFetch=s.successfulFetch,r.timeoutFetch=s.timeoutFetch,r.toChecksumHexAddress=s.toChecksumHexAddress,r.toHex=s.toHex,r.weiHexToGweiDec=s.weiHexToGweiDec}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1104,{"@metamask/base-controller":1111},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i=(e,t,r)=>(((e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)})(e,t,"access private method"),r),o=e("@metamask/base-controller"),a={announcements:{}},l={announcements:{persist:!0,anonymous:!0}},c=class extends o.BaseController{constructor({messenger:e,state:t,allAnnouncements:r}){const o={...a,...t};super({messenger:e,metadata:l,name:"AnnouncementController",state:o}),((e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)})(this,n),i(this,n,s).call(this,r)}resetViewed(){this.update((({announcements:e})=>{for(const t of Object.values(e))t.isShown=!1}))}updateViewed(e){this.update((({announcements:t})=>{for(const r of Object.keys(e).map(Number))t[r].isShown=e[r]}))}};n=new WeakSet,s=function(e){this.update((t=>{Object.values(e).forEach((e=>{t.announcements[e.id]=t.announcements[e.id]??{...e,isShown:!1}}))}))},r.AnnouncementController=c}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/chunk-ZGM3XNIO.js"}],[1105,{"./chunk-ZGM3XNIO.js":1104},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-ZGM3XNIO.js");r.AnnouncementController=n.AnnouncementController}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/index.js"}],[1106,{"./chunk-UJFCPTF3.js":1108,"./chunk-Z4BLTVTB.js":1109},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,o,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,n).delete(e)}clearActions(){l.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,i).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=l.__privateGet.call(void 0,this,o).get(e),s=n(...t);s!==r&&(l.__privateGet.call(void 0,this,o).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=l.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,l.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=l.__privateGet.call(void 0,this,i).get(e);if(n){const e=r(...n());l.__privateGet.call(void 0,this,o).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,o).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/announcement-controller>@metamask/base-controller",file:"node_modules/@metamask/announcement-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1107,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/announcement-controller>@metamask/base-controller",file:"node_modules/@metamask/announcement-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1108,{"./chunk-Z4BLTVTB.js":1109},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,i,r),p.__privateSet.call(void 0,this,o,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/announcement-controller>@metamask/base-controller",file:"node_modules/@metamask/announcement-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1109,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/announcement-controller>@metamask/base-controller",file:"node_modules/@metamask/announcement-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[111,{"../../../../shared/constants/app":4423,"../../../../shared/constants/metametrics":4434,"../../../../ui/components/component-library/icon":4878,"../../translate":258,"./utils/isBlockedUrl":112,"./utils/showResult":113,"@metamask/eth-snap-keyring":1284,"webextension-polyfill":4402},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.snapKeyringBuilder=r.getAccountsBySnapId=void 0;var n,s=e("@metamask/eth-snap-keyring"),i=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n},o=e("../../../../shared/constants/metametrics"),a=e("../../../../shared/constants/app"),l=e("../../translate"),c=e("../../../../ui/components/component-library/icon"),d=e("./utils/isBlockedUrl"),u=e("./utils/showResult");r.getAccountsBySnapId=async(e,t)=>{const r=await e.getSnapKeyring();return await r.getAccountsBySnapId(t)};r.snapKeyringBuilder=(e,t,r,n,h,p,m,g)=>{const f=()=>new s.SnapKeyring(t(),{addressExists:async t=>(await e.call("KeyringController:getAccounts")).includes(t.toLowerCase()),redirectUser:async(t,r,n)=>{if(r.length>0||n.length>0){const s=await(0,d.isBlockedUrl)(r,(async()=>await e.call("PhishingController:maybeUpdateState")),(t=>e.call("PhishingController:testOrigin",t))),o=await e.call("ApprovalController:addRequest",{origin:t,requestData:{url:r,message:n,isBlockedUrl:s},type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect},!0);Boolean(o)&&r.length>0?i.default.tabs.create({url:r}):console.log("User refused snap account redirection to:",r)}else console.log("Error occurred when redirecting snap account. url or message must be defined")},saveState:async()=>{await r()},addAccount:async(t,s,i,d,h=!1)=>{const f=m(s),v=e=>{p({event:e,category:o.MetaMetricsEventCategory.Accounts,properties:{account_type:o.MetaMetricsEventAccountType.Snap,snap_id:s,snap_name:f}})},w="https://support.metamask.io/hc/en-us/articles/360015289452-How-to-add-accounts-in-your-wallet",y=g(s)&&!h;let k=y,C="";try{if(!y){const{id:t}=e.call("ApprovalController:startFlow");C=t,k=Boolean(await e.call("ApprovalController:addRequest",{origin:s,type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation},!0))}if(!k)throw await i(k),new Error("User denied account creation");try{await i(k),await r(),n(t);const a=e.call("AccountsController:getAccountByAddress",t);if(!a)throw new Error(`Internal account not found for address: ${t}`);e.call("AccountsController:setSelectedAccount",a.id),v(o.MetaMetricsEventName.AddSnapAccountSuccessViewed),y||await(0,u.showSuccess)(e,s,{icon:c.IconName.UserCircleAdd,title:(0,l.t)("snapAccountCreated")},{message:(0,l.t)("snapAccountCreatedDescription"),address:t,learnMoreLink:w}),v(o.MetaMetricsEventName.AddSnapAccountSuccessClicked)}catch(t){const r=t.message;throw await(0,u.showError)(e,s,{icon:c.IconName.UserCircleAdd,title:(0,l.t)("snapAccountCreationFailed")},{message:(0,l.t)("snapAccountCreationFailedDescription",f),learnMoreLink:w,error:r}),v(o.MetaMetricsEventName.AccountAddFailed),new Error(`Error occurred while creating snap account: ${r}`)}}finally{k&&v(o.MetaMetricsEventName.AccountAdded),y||e.call("ApprovalController:endFlow",{id:C})}},removeAccount:async(t,n,s)=>{const i=m(n),{id:d}=e.call("ApprovalController:startFlow"),g="https://support.metamask.io/hc/en-us/articles/360057435092-How-to-remove-an-account-from-your-MetaMask-wallet",f=e=>{p({event:e,category:o.MetaMetricsEventCategory.Accounts,properties:{account_type:o.MetaMetricsEventAccountType.Snap,snap_id:n,snap_name:i}})};let v=!1;try{if(v=Boolean(await e.call("ApprovalController:addRequest",{origin:n,type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval,requestData:{publicAddress:t}},!0)),!v)throw await s(v),new Error("User denied account removal");try{await h(t),await s(v),await r(),f(o.MetaMetricsEventName.RemoveSnapAccountSuccessViewed),await(0,u.showError)(e,n,{icon:c.IconName.UserCircleRemove,title:(0,l.t)("snapAccountRemoved")},{message:(0,l.t)("snapAccountRemovedDescription"),learnMoreLink:g}),f(o.MetaMetricsEventName.RemoveSnapAccountSuccessClicked)}catch(t){const r=t.message;throw await(0,u.showError)(e,n,{icon:c.IconName.UserCircleRemove,title:(0,l.t)("snapAccountRemovalFailed")},{message:(0,l.t)("snapAccountRemovalFailedDescription",i),learnMoreLink:g,error:r}),f(o.MetaMetricsEventName.AccountRemoveFailed),new Error(`Error occurred while removing snap account: ${r}`)}}finally{v&&f(o.MetaMetricsEventName.AccountRemoved),e.call("ApprovalController:endFlow",{id:d})}}});return f.type=s.SnapKeyring.type,f}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/snap-keyring.ts"}],[1110,{"./chunk-Z4BLTVTB.js":1109,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),i=e("immer");i.enablePatches.call(void 0);function o(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:o}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,i.freeze.call(void 0,o,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,o]=i.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:o}}applyPatches(e){const t=i.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},r.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/announcement-controller>@metamask/base-controller",file:"node_modules/@metamask/announcement-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1111,{"./chunk-G42723LG.js":1106,"./chunk-NINOM2XQ.js":1107,"./chunk-UJFCPTF3.js":1108,"./chunk-Z4BLTVTB.js":1109,"./chunk-ZNOPSWMU.js":1110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-NINOM2XQ.js"),s=e("./chunk-ZNOPSWMU.js"),i=e("./chunk-G42723LG.js"),o=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=i.ControllerMessenger,r.RestrictedControllerMessenger=o.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/announcement-controller>@metamask/base-controller",file:"node_modules/@metamask/announcement-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1112,{"./chunk-LKCXZAKD.js":1113,"@metamask/base-controller":1120,"@metamask/rpc-errors":1672,nanoid:1121},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p,m,g,f,v,w,y,k,C=e("./chunk-LKCXZAKD.js"),b=e("@metamask/base-controller"),_=e("@metamask/rpc-errors"),T=e("nanoid"),S="metamask",M="result_error",E="result_success",A="ApprovalController",P={pendingApprovals:{persist:!1,anonymous:!0},pendingApprovalCount:{persist:!1,anonymous:!1},approvalFlows:{persist:!1,anonymous:!1}},I=class extends b.BaseController{constructor({messenger:e,showApprovalRequest:t,state:r={},typesExcludedFromRateLimiting:l=[]}){super({name:A,metadata:P,messenger:e,state:{pendingApprovals:{},pendingApprovalCount:0,approvalFlows:[],...r}}),C.__privateAdd.call(void 0,this,a),C.__privateAdd.call(void 0,this,c),C.__privateAdd.call(void 0,this,u),C.__privateAdd.call(void 0,this,p),C.__privateAdd.call(void 0,this,g),C.__privateAdd.call(void 0,this,v),C.__privateAdd.call(void 0,this,y),C.__privateAdd.call(void 0,this,n,void 0),C.__privateAdd.call(void 0,this,s,void 0),C.__privateAdd.call(void 0,this,i,void 0),C.__privateAdd.call(void 0,this,o,void 0),C.__privateSet.call(void 0,this,n,new Map),C.__privateSet.call(void 0,this,s,new Map),C.__privateSet.call(void 0,this,i,t),C.__privateSet.call(void 0,this,o,l),this.registerMessageHandlers()}registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${A}:clearRequests`,this.clear.bind(this)),this.messagingSystem.registerActionHandler(`${A}:addRequest`,((e,t)=>t?this.addAndShowApprovalRequest(e):this.add(e))),this.messagingSystem.registerActionHandler(`${A}:hasRequest`,this.has.bind(this)),this.messagingSystem.registerActionHandler(`${A}:acceptRequest`,this.accept.bind(this)),this.messagingSystem.registerActionHandler(`${A}:rejectRequest`,this.reject.bind(this)),this.messagingSystem.registerActionHandler(`${A}:updateRequestState`,this.updateRequestState.bind(this)),this.messagingSystem.registerActionHandler(`${A}:startFlow`,this.startFlow.bind(this)),this.messagingSystem.registerActionHandler(`${A}:endFlow`,this.endFlow.bind(this)),this.messagingSystem.registerActionHandler(`${A}:setFlowLoadingText`,this.setFlowLoadingText.bind(this)),this.messagingSystem.registerActionHandler(`${A}:showSuccess`,this.success.bind(this)),this.messagingSystem.registerActionHandler(`${A}:showError`,this.error.bind(this))}addAndShowApprovalRequest(e){const t=C.__privateMethod.call(void 0,this,a,l).call(this,e.origin,e.type,e.id,e.requestData,e.requestState,e.expectsResult);return C.__privateGet.call(void 0,this,i).call(this),t}add(e){return C.__privateMethod.call(void 0,this,a,l).call(this,e.origin,e.type,e.id,e.requestData,e.requestState,e.expectsResult)}get(e){return this.state.pendingApprovals[e]}getApprovalCount(e={}){if(!e.origin&&!e.type)throw new Error("Must specify origin, type, or both.");const{origin:t,type:r}=e;if(t&&r)return C.__privateGet.call(void 0,this,s).get(t)?.get(r)||0;if(t)return Array.from((C.__privateGet.call(void 0,this,s).get(t)||new Map).values()).reduce(((e,t)=>e+t),0);let n=0;for(const e of Object.values(this.state.pendingApprovals))e.type===r&&(n+=1);return n}getTotalApprovalCount(){return this.state.pendingApprovalCount}has(e={}){const{id:t,origin:r,type:i}=e;if(t){if("string"!=typeof t)throw new Error("May not specify non-string id.");return C.__privateGet.call(void 0,this,n).has(t)}if(i&&"string"!=typeof i)throw new Error("May not specify non-string type.");if(r){if("string"!=typeof r)throw new Error("May not specify non-string origin.");return i?Boolean(C.__privateGet.call(void 0,this,s).get(r)?.get(i)):C.__privateGet.call(void 0,this,s).has(r)}if(i){for(const e of Object.values(this.state.pendingApprovals))if(e.type===i)return!0;return!1}throw new Error("Must specify a valid combination of id, origin, and type.")}accept(e,t,r){const n=this.get(e),s=C.__privateMethod.call(void 0,this,v,w).call(this,e);return new Promise(((i,o)=>{const a={success:e=>i({value:e}),error:o};if(r?.waitForResult&&!n.expectsResult)return void o(new(0,C.ApprovalRequestNoResultSupportError)(e));const l=r?.waitForResult?a:void 0,c=n.expectsResult?{value:t,resultCallbacks:l}:t;s.resolve(c),r?.waitForResult||i({value:void 0})}))}reject(e,t){C.__privateMethod.call(void 0,this,v,w).call(this,e).reject(t)}clear(e){for(const t of C.__privateGet.call(void 0,this,n).keys())this.reject(t,e);C.__privateGet.call(void 0,this,s).clear(),this.update((e=>{e.pendingApprovals={},e.pendingApprovalCount=0}))}updateRequestState(e){if(!this.state.pendingApprovals[e.id])throw new(0,C.ApprovalRequestNotFoundError)(e.id);this.update((t=>{t.pendingApprovals[e.id].requestState=e.requestState}))}startFlow(e={}){const t=e.id??T.nanoid.call(void 0),r=e.loadingText??null;return this.update((e=>{e.approvalFlows.push({id:t,loadingText:r})})),!1!==e.show&&C.__privateGet.call(void 0,this,i).call(this),{id:t,loadingText:r}}endFlow({id:e}){if(!this.state.approvalFlows.length)throw new(0,C.NoApprovalFlowsError);if(e!==this.state.approvalFlows.slice(-1)[0].id)throw new(0,C.EndInvalidFlowError)(e,this.state.approvalFlows.map((e=>e.id)));this.update((e=>{e.approvalFlows.pop()}))}setFlowLoadingText({id:e,loadingText:t}){const r=this.state.approvalFlows.findIndex((t=>t.id===e));if(-1===r)throw new(0,C.MissingApprovalFlowError)(e);this.update((e=>{e.approvalFlows[r].loadingText=t}))}async success(e={}){return await C.__privateMethod.call(void 0,this,y,k).call(this,E,e,{message:e.message,header:e.header,title:e.title,icon:e.icon}),{}}async error(e={}){return await C.__privateMethod.call(void 0,this,y,k).call(this,M,e,{error:e.error,header:e.header,title:e.title,icon:e.icon}),{}}};n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e,t,r=T.nanoid.call(void 0),s,i,a){if(C.__privateMethod.call(void 0,this,c,d).call(this,r,e,t,s,i),!C.__privateGet.call(void 0,this,o).includes(t)&&this.has({origin:e,type:t}))throw _.rpcErrors.resourceUnavailable(((e,t)=>`Request of type '${t}' already pending for origin ${e}. Please wait.`)(e,t));return new Promise(((o,l)=>{C.__privateGet.call(void 0,this,n).set(r,{resolve:o,reject:l}),C.__privateMethod.call(void 0,this,u,h).call(this,e,t),C.__privateMethod.call(void 0,this,p,m).call(this,r,e,t,s,i,a)}))},c=new WeakSet,d=function(e,t,r,s,i){let o=null;if(e&&"string"==typeof e?C.__privateGet.call(void 0,this,n).has(e)?o=`Approval request with id '${e}' already exists.`:t&&"string"==typeof t?r&&"string"==typeof r?s&&("object"!=typeof s||Array.isArray(s))?o="Request data must be a plain object if specified.":i&&("object"!=typeof i||Array.isArray(i))&&(o="Request state must be a plain object if specified."):o="Must specify non-empty string type.":o="Must specify non-empty string origin.":o="Must specify non-empty string id.",o)throw _.rpcErrors.internal(o)},u=new WeakSet,h=function(e,t){let r=C.__privateGet.call(void 0,this,s).get(e);r||(r=new Map,C.__privateGet.call(void 0,this,s).set(e,r));const n=r.get(t)||0;r.set(t,n+1)},p=new WeakSet,m=function(e,t,r,n,s,i){const o={id:e,origin:t,type:r,time:Date.now(),requestData:n||null,requestState:s||null,expectsResult:i||!1};this.update((t=>{t.pendingApprovals[e]=o,t.pendingApprovalCount=Object.keys(t.pendingApprovals).length}))},g=new WeakSet,f=function(e){C.__privateGet.call(void 0,this,n).delete(e);const{origin:t,type:r}=this.state.pendingApprovals[e],i=C.__privateGet.call(void 0,this,s).get(t),o=this.getApprovalCount({origin:t}),a=i.get(r);1===o?C.__privateGet.call(void 0,this,s).delete(t):i.set(r,a-1),this.update((t=>{delete t.pendingApprovals[e],t.pendingApprovalCount=Object.keys(t.pendingApprovals).length}))},v=new WeakSet,w=function(e){const t=C.__privateGet.call(void 0,this,n).get(e);if(!t)throw new(0,C.ApprovalRequestNotFoundError)(e);return C.__privateMethod.call(void 0,this,g,f).call(this,e),t},y=new WeakSet,k=async function(e,t,r){try{await this.addAndShowApprovalRequest({origin:S,type:e,requestData:r})}catch(e){console.info("Failed to display result page",e)}finally{if(t.flowToEnd)try{this.endFlow({id:t.flowToEnd})}catch(e){console.info("Failed to end flow",{id:t.flowToEnd,error:e})}}};var N=I;r.ORIGIN_METAMASK=S,r.APPROVAL_TYPE_RESULT_ERROR=M,r.APPROVAL_TYPE_RESULT_SUCCESS=E,r.ApprovalController=I,r.ApprovalController_default=N}}},{package:"@metamask/approval-controller",file:"node_modules/@metamask/approval-controller/dist/chunk-5K4GVAX5.js"}],[1113,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},s=class extends Error{constructor(e){super(`Approval request with id '${e}' not found.`)}},i=class extends Error{constructor(e){super(`Approval acceptance requested result but request with id '${e}' does not support it.`)}},o=class extends Error{constructor(){super("No approval flows found.")}},a=class extends Error{constructor(e,t){super(`Attempted to end flow with id '${e}' which does not match current flow with id '${t.slice(-1)[0]}'. All Flows: ${t.join(", ")}`)}},l=class extends Error{constructor(e){super(`No approval flows found with id '${e}'.`)}};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r),r.ApprovalRequestNotFoundError=s,r.ApprovalRequestNoResultSupportError=i,r.NoApprovalFlowsError=o,r.EndInvalidFlowError=a,r.MissingApprovalFlowError=l}}},{package:"@metamask/approval-controller",file:"node_modules/@metamask/approval-controller/dist/chunk-LKCXZAKD.js"}],[1114,{"./chunk-5K4GVAX5.js":1112,"./chunk-LKCXZAKD.js":1113},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-5K4GVAX5.js"),s=e("./chunk-LKCXZAKD.js");r.APPROVAL_TYPE_RESULT_ERROR=n.APPROVAL_TYPE_RESULT_ERROR,r.APPROVAL_TYPE_RESULT_SUCCESS=n.APPROVAL_TYPE_RESULT_SUCCESS,r.ApprovalController=n.ApprovalController,r.ApprovalRequestNoResultSupportError=s.ApprovalRequestNoResultSupportError,r.ApprovalRequestNotFoundError=s.ApprovalRequestNotFoundError,r.EndInvalidFlowError=s.EndInvalidFlowError,r.MissingApprovalFlowError=s.MissingApprovalFlowError,r.NoApprovalFlowsError=s.NoApprovalFlowsError,r.ORIGIN_METAMASK=n.ORIGIN_METAMASK}}},{package:"@metamask/approval-controller",file:"node_modules/@metamask/approval-controller/dist/index.js"}],[1115,{"./chunk-UJFCPTF3.js":1117,"./chunk-Z4BLTVTB.js":1118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,o,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,n).delete(e)}clearActions(){l.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,i).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=l.__privateGet.call(void 0,this,o).get(e),s=n(...t);s!==r&&(l.__privateGet.call(void 0,this,o).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=l.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,l.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=l.__privateGet.call(void 0,this,i).get(e);if(n){const e=r(...n());l.__privateGet.call(void 0,this,o).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,o).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/approval-controller>@metamask/base-controller",file:"node_modules/@metamask/approval-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1116,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/approval-controller>@metamask/base-controller",file:"node_modules/@metamask/approval-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1117,{"./chunk-Z4BLTVTB.js":1118},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,i,r),p.__privateSet.call(void 0,this,o,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/approval-controller>@metamask/base-controller",file:"node_modules/@metamask/approval-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1118,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/approval-controller>@metamask/base-controller",file:"node_modules/@metamask/approval-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1119,{"./chunk-Z4BLTVTB.js":1118,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),i=e("immer");i.enablePatches.call(void 0);function o(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:o}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,i.freeze.call(void 0,o,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,o]=i.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:o}}applyPatches(e){const t=i.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},r.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/approval-controller>@metamask/base-controller",file:"node_modules/@metamask/approval-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[112,{"../../keyring-snaps-permissions":76},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isBlockedUrl=void 0;var n=e("../../keyring-snaps-permissions");r.isBlockedUrl=async(e,t,r)=>{try{return!(0,n.isProtocolAllowed)(e)||(await t(),r(e).result)}catch(e){return console.error("Invalid URL passed into snap-keyring:",e),!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/isBlockedUrl.ts"}],[1120,{"./chunk-G42723LG.js":1115,"./chunk-NINOM2XQ.js":1116,"./chunk-UJFCPTF3.js":1117,"./chunk-Z4BLTVTB.js":1118,"./chunk-ZNOPSWMU.js":1119},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-NINOM2XQ.js"),s=e("./chunk-ZNOPSWMU.js"),i=e("./chunk-G42723LG.js"),o=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=i.ControllerMessenger,r.RestrictedControllerMessenger=o.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/approval-controller>@metamask/base-controller",file:"node_modules/@metamask/approval-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1121,{"./url-alphabet/index.cjs":1122},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let{urlAlphabet:n}=e("./url-alphabet/index.cjs"),s=e=>crypto.getRandomValues(new Uint8Array(e)),i=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,s=-~(1.6*n*t/e.length);return(i=t)=>{let o="";for(;;){let t=r(s),a=s;for(;a--;)if(o+=e[t[a]&n]||"",o.length===i)return o}}};t.exports={nanoid:(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),customAlphabet:(e,t=21)=>i(e,t,s),customRandom:i,urlAlphabet:n,random:s}}}},{package:"@metamask/approval-controller>nanoid",file:"node_modules/@metamask/approval-controller/node_modules/nanoid/index.browser.cjs"}],[1122,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={urlAlphabet:"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}}}},{package:"@metamask/approval-controller>nanoid",file:"node_modules/@metamask/approval-controller/node_modules/nanoid/url-alphabet/index.cjs"}],[113,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.showSuccess=r.showError=void 0;const n=e=>({name:"SnapAuthorshipHeader",key:"snapHeader",properties:{snapId:e}});r.showError=(e,t,r,s)=>e.call("ApprovalController:showError",{header:[n(t)],title:r.title,icon:r.icon,error:{key:"snapAccountErrorMessage",name:"SnapAccountErrorMessage",properties:s}});r.showSuccess=(e,t,r,s)=>e.call("ApprovalController:showSuccess",{header:[n(t)],title:r.title,icon:r.icon,message:{key:"snapAccountSuccessMessage",name:"SnapAccountSuccessMessage",properties:s}})}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/showResult.ts"}],[115,{"../../../../shared/constants/app":4423,"../../../../shared/constants/gas":4429,"../../../../shared/constants/metametrics":4434,"../../../../shared/constants/transaction":4449,"../../../../shared/lib/transactions-controller-utils":4459,"../../../../shared/modules/conversion.utils":4465,"../../../../shared/modules/metametrics":4474,"../../../../shared/modules/transaction.utils":4488,"../../../../ui/helpers/utils/metrics":5311,"../snap-keyring/metrics":110,"@metamask/eth-query":1271,"@metamask/transaction-controller":2189,"bignumber.js":2888,"ethereumjs-util":3236},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleTransactionSubmitted=r.handleTransactionRejected=r.handleTransactionFailed=r.handleTransactionDropped=r.handleTransactionConfirmed=r.handleTransactionApproved=r.handleTransactionAdded=r.handlePostTransactionBalanceUpdate=r.createTransactionEventFragmentWithTxId=r.METRICS_STATUS_FAILED=void 0;var n,s=e("ethereumjs-util"),i=(n=e("@metamask/eth-query"))&&n.__esModule?n:{default:n},o=e("bignumber.js"),a=e("@metamask/transaction-controller"),l=e("../../../../shared/constants/app"),c=e("../../../../shared/modules/transaction.utils"),d=e("../../../../shared/modules/conversion.utils"),u=e("../../../../shared/constants/transaction"),h=e("../../../../shared/constants/metametrics"),p=e("../../../../shared/constants/gas"),m=e("../../../../shared/lib/transactions-controller-utils"),g=e("../../../../ui/helpers/utils/metrics"),f=e("../../../../shared/modules/metametrics"),v=e("../snap-keyring/metrics");const w=r.METRICS_STATUS_FAILED="failed on-chain";r.handleTransactionAdded=async(e,t)=>{if(!t.transactionMeta)return;const{properties:r,sensitiveProperties:n}=await b({transactionEventPayload:t,transactionMetricsRequest:e});y({eventName:u.TransactionMetaMetricsEvent.added,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:r,sensitiveProperties:n}})};r.handleTransactionApproved=async(e,t)=>{t.transactionMeta&&await k({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionFailed=async(e,t)=>{if(!t.transactionMeta)return;const r={};t.error&&(r.error=t.error),await k({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:r,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionConfirmed=async(e,t)=>{if(0===Object.keys(t).length)return;const r={},n={...t},{txReceipt:s}=n;r.gas_used=null==s?void 0:s.gasUsed;const{submittedTime:i}=n;i&&(r.completion_time=function(e){return Math.round((Date.now()-e)/1e3).toString()}(i)),"0x0"===(null==s?void 0:s.status)&&(r.status=w),await k({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:r,transactionEventPayload:{actionId:n.actionId,transactionMeta:n},transactionMetricsRequest:e})};r.handleTransactionDropped=async(e,t)=>{if(!t.transactionMeta)return;await k({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:{dropped:!0},transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionRejected=async(e,t)=>{t.transactionMeta&&await k({eventName:u.TransactionMetaMetricsEvent.rejected,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionSubmitted=async(e,t)=>{if(!t.transactionMeta)return;const{properties:r,sensitiveProperties:n}=await b({transactionEventPayload:t,transactionMetricsRequest:e});y({eventName:u.TransactionMetaMetricsEvent.submitted,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:r,sensitiveProperties:n}})};r.createTransactionEventFragmentWithTxId=async(e,{transactionId:t,actionId:r})=>{const n={...e.getTransaction(t),actionId:r},{properties:s,sensitiveProperties:i}=await b({transactionEventPayload:{transactionMeta:n},transactionMetricsRequest:e});y({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:{actionId:n.actionId,transactionMeta:n},transactionMetricsRequest:e,payload:{properties:s,sensitiveProperties:i}})};function y({eventName:e,transactionEventPayload:{transactionMeta:t,actionId:r},transactionMetricsRequest:n,payload:s}){if(function(e,t,r){const n=C(t,r.id);return void 0!==e(n)}(n.getEventFragmentById,e,t))return;const i=C(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.added:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.added,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.submitted:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.submitted,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.finalized:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0})}}async function k({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,extraParams:n={}}){const{properties:s,sensitiveProperties:i}=await b({transactionEventPayload:t,transactionMetricsRequest:r,extraParams:n});y({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,payload:{properties:s,sensitiveProperties:i}}),function({eventName:e,transactionEventPayload:{transactionMeta:t},transactionMetricsRequest:r,payload:n}){const s=C(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:case u.TransactionMetaMetricsEvent.finalized:r.updateEventFragment(s,{properties:n.properties,sensitiveProperties:n.sensitiveProperties})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,payload:{properties:s,sensitiveProperties:i}}),function({eventName:e,transactionMetricsRequest:t,transactionEventPayload:{transactionMeta:r}}){const n=C(e,r.id);switch(e){case u.TransactionMetaMetricsEvent.approved:t.finalizeEventFragment(n);break;case u.TransactionMetaMetricsEvent.rejected:t.finalizeEventFragment(n,{abandoned:!0});break;case u.TransactionMetaMetricsEvent.finalized:t.finalizeEventFragment(n)}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r})}function C(e,t){return`transaction-${e===u.TransactionMetaMetricsEvent.finalized||e===u.TransactionMetaMetricsEvent.submitted?"submitted":"added"}-${t}`}async function b({transactionEventPayload:{transactionMeta:e},transactionMetricsRequest:t,extraParams:r={}}){var n;const{type:w,time:y,status:k,chainId:C,origin:b,txParams:{gasPrice:_,gas:T,maxFeePerGas:S,maxPriorityFeePerGas:M,estimateSuggested:E,estimateUsed:A},defaultGasEstimates:P,originalType:I,replacedById:N,customTokenAmount:j,dappProposedTokenAmount:R,currentTokenBalance:O,originalApprovalAmount:x,finalApprovalAmount:B,contractMethodName:U,securityProviderResponse:L,simulationFails:F}=e,D=new i.default(t.provider),G=b===l.ORIGIN_METAMASK?"user":"dapp",{assetType:$,tokenStandard:W}=await(0,c.determineTransactionAssetType)(e,D,t.getTokenStandardAndDetails),H={};if((0,c.isEIP1559Transaction)(e)?(H.max_fee_per_gas=S,H.max_priority_fee_per_gas=M):H.gas_price=_,P){var K,q;const{estimateType:r}=P;if(r){var z,V;H.default_estimate=r;let n=null===(z=e.defaultGasEstimates)||void 0===z?void 0:z.maxFeePerGas,s=null===(V=e.defaultGasEstimates)||void 0===V?void 0:V.maxPriorityFeePerGas;if([p.GasRecommendations.low,p.GasRecommendations.medium,p.GasRecommendations.high].includes(r)){var Q,J;const{gasFeeEstimates:e}=await t.getEIP1559GasFeeEstimates();var Y,Z;if(null!=e&&null!==(Q=e[r])&&void 0!==Q&&Q.suggestedMaxFeePerGas)n=null===(Y=e[r])||void 0===Y?void 0:Y.suggestedMaxFeePerGas,H.default_max_fee_per_gas=n;if(null!=e&&null!==(J=e[r])&&void 0!==J&&J.suggestedMaxPriorityFeePerGas)s=null===(Z=e[r])||void 0===Z?void 0:Z.suggestedMaxPriorityFeePerGas,H.default_max_priority_fee_per_gas=s}}null!==(K=e.defaultGasEstimates)&&void 0!==K&&K.gas&&(H.default_gas=e.defaultGasEstimates.gas),null!==(q=e.defaultGasEstimates)&&void 0!==q&&q.gasPrice&&(H.default_gas_price=e.defaultGasEstimates.gasPrice)}E&&(H.estimate_suggested=E),A&&(H.estimate_used=A),null!=r&&r.gas_used&&(H.gas_used=r.gas_used);const X=function(e){const t={};for(const r in e)(0,s.isHexString)(e[r])?t[r]=(0,d.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}(H);let ee="0";e.txParams.maxFeePerGas&&(ee="2");const te=w&&[a.TransactionType.contractInteraction,a.TransactionType.tokenMethodApprove,a.TransactionType.tokenMethodIncreaseAllowance,a.TransactionType.tokenMethodSafeTransferFrom,a.TransactionType.tokenMethodSetApprovalForAll,a.TransactionType.tokenMethodTransfer,a.TransactionType.tokenMethodTransferFrom,a.TransactionType.swap,a.TransactionType.swapAndSend,a.TransactionType.swapApproval].includes(w),re="Approve";let ne,se,ie,oe,ae=a.TransactionType.simpleSend;w===a.TransactionType.cancel?ae=a.TransactionType.cancel:w===a.TransactionType.retry&&I?ae=I:w===a.TransactionType.deployContract?ae=a.TransactionType.deployContract:te&&(ae=a.TransactionType.contractInteraction,se=U,se===re&&W===u.TokenStandard.ERC20&&("0"===R||"0"===j?ne=u.TransactionApprovalAmountType.revoke:j&&j!==R?ne=u.TransactionApprovalAmountType.custom:R&&(ne=u.TransactionApprovalAmountType.dappProposed),ie=function(e,t,r){if(e===u.TransactionApprovalAmountType.custom&&t&&r)return`${new o.BigNumber(t,10).div(r,10).times(100).round(2)}`;return null}(ne,x,B),oe=function(e,t,r){if((e===u.TransactionApprovalAmountType.custom||e===u.TransactionApprovalAmountType.dappProposed)&&t&&r)return`${new o.BigNumber(t,16).div(r,10).times(100).round(2)}`;return null}(ne,R,O)));const le=t.getTransaction(N),ce={RETRY:a.TransactionType.retry,CANCEL:a.TransactionType.cancel,SAME_NONCE:"other"};let de;null!=r&&r.dropped&&(de=ce.SAME_NONCE,(null==le?void 0:le.type)===a.TransactionType.cancel?de=ce.CANCEL:(null==le?void 0:le.type)===a.TransactionType.retry&&(de=ce.RETRY));const ue=[];1===(null==L?void 0:L.flagAsDangerous)?ue.push(h.MetaMetricsEventUiCustomization.FlaggedAsMalicious):2===(null==L?void 0:L.flagAsDangerous)&&ue.push(h.MetaMetricsEventUiCustomization.FlaggedAsSafetyUnknown);const he=(0,g.getBlockaidMetricsProps)(e);(null==he||null===(n=he.ui_customizations)||void 0===n?void 0:n.length)>0&&ue.push(...he.ui_customizations),F&&ue.push(h.MetaMetricsEventUiCustomization.GasEstimationFailed);const pe=(0,f.getSmartTransactionMetricsProperties)(t,e);let me={chain_id:C,referrer:b,source:G,status:k,network:`${parseInt(C,16)}`,eip_1559_version:ee,gas_edit_type:"none",gas_edit_attempted:"none",gas_estimation_failed:Boolean(F),account_type:await t.getAccountType(t.getSelectedAddress()),device_model:await t.getDeviceModel(t.getSelectedAddress()),asset_type:$,token_standard:W,transaction_type:ae,transaction_speed_up:w===a.TransactionType.retry,...he,ui_customizations:ue.length>0?ue:null,...pe};const ge=await(0,v.getSnapAndHardwareInfoForMetrics)(t.getAccountType,t.getDeviceModel,t.snapAndHardwareMessenger);Object.assign(me,ge),se===re&&(me={...me,transaction_approval_amount_type:ne});let fe={transaction_envelope_type:(0,c.isEIP1559Transaction)(e)?m.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:m.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:y,gas_limit:T,transaction_contract_method:se,transaction_replaced:de,...r,...X};return se===re&&(fe={...fe,transaction_approval_amount_vs_balance_ratio:oe,transaction_approval_amount_vs_proposed_ratio:ie}),{properties:me,sensitiveProperties:fe}}r.handlePostTransactionBalanceUpdate=async({getParticipateInMetrics:e,trackEvent:t},{transactionMeta:r,approvalTransactionMeta:n})=>{var s;if(e()&&r.swapMetaData)if("0x0"===(null===(s=r.txReceipt)||void 0===s?void 0:s.status))t({event:"Swap Failed",sensitiveProperties:{...r.swapMetaData},category:h.MetaMetricsEventCategory.Swaps});else{var i;const e=(0,m.getSwapsTokensReceivedFromTxMeta)(r.destinationTokenSymbol,r,r.destinationTokenAddress,r.txParams.from,r.destinationTokenDecimals,n,r.chainId),s=e?`${new o.BigNumber(e,10).div(r.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,a=null!==(i=r.txReceipt)&&void 0!==i&&i.gasUsed&&r.swapMetaData.estimated_gas?`${new o.BigNumber(r.txReceipt.gasUsed,16).div(r.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,l=function(e,t){var r,n;let s="0x0";null!=t&&t.txReceipt&&(s=(0,m.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const i=(0,m.calcGasTotal)(null===(r=e.txReceipt)||void 0===r?void 0:r.gasUsed,null===(n=e.txReceipt)||void 0===n?void 0:n.effectiveGasPrice),a=new o.BigNumber(i,16).plus(s,16).toString(16);return{approvalGasCostInEth:Number((0,d.hexWEIToDecETH)(s)),tradeGasCostInEth:Number((0,d.hexWEIToDecETH)(i)),tradeAndApprovalGasCostInEth:Number((0,d.hexWEIToDecETH)(a))}}(r,n);t({event:h.MetaMetricsEventName.SwapCompleted,category:h.MetaMetricsEventCategory.Swaps,sensitiveProperties:{...r.swapMetaData,token_to_amount_received:e,quote_vs_executionRatio:s,estimated_vs_used_gasRatio:a,approval_gas_cost_in_eth:l.approvalGasCostInEth,trade_gas_cost_in_eth:l.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:l.tradeAndApprovalGasCostInEth,token_to_amount:r.swapMetaData.token_to_amount.toString(10)}})}}}}},{package:"$root$",file:"app/scripts/lib/transaction/metrics.ts"}],[1153,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BaseControllerV1=void 0;class n{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const[e,t]of Object.entries(this.internalConfig))t!==undefined&&(this[e]=t)}else for(const t of Object.keys(e))void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}r.BaseControllerV1=n,r.default=n}}},{package:"@metamask/base-controller",file:"node_modules/@metamask/base-controller/dist/BaseControllerV1.js"}],[1154,{immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},i=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.getPersistentState=r.getAnonymizedState=r.BaseController=void 0;const o=e("immer");(0,o.enablePatches)();function a(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:i}){n.set(this,void 0),this.messagingSystem=e,this.name=r,s(this,n,i,"f"),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return i(this,n,"f")}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,a]=o.produceWithPatches(i(this,n,"f"),e);return s(this,n,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:a}}applyPatches(e){const t=(0,o.applyPatches)(i(this,n,"f"),e);s(this,n,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},n=new WeakMap,r.getAnonymizedState=function(e,t){return a(e,t,"anonymous")},r.getPersistentState=function(e,t){return a(e,t,"persist")}}}},{package:"@metamask/base-controller",file:"node_modules/@metamask/base-controller/dist/BaseControllerV2.js"}],[1155,{"./RestrictedControllerMessenger":1156},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.ControllerMessenger=void 0;const l=e("./RestrictedControllerMessenger");r.ControllerMessenger=class{constructor(){n.set(this,new Map),s.set(this,new Map),i.set(this,new Map),o.set(this,new Map)}registerActionHandler(e,t){if(a(this,n,"f").has(e))throw new Error(`A handler for ${e} has already been registered`);a(this,n,"f").set(e,t)}unregisterActionHandler(e){a(this,n,"f").delete(e)}clearActions(){a(this,n,"f").clear()}call(e,...t){const r=a(this,n,"f").get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){a(this,i,"f").set(e,t)}publish(e,...t){const r=a(this,s,"f").get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=a(this,o,"f").get(e),s=n(...t);s!==r&&(a(this,o,"f").set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=a(this,s,"f").get(e);if(n||(n=new Map,a(this,s,"f").set(e,n)),n.set(t,r),r){const n=a(this,i,"f").get(e);if(n){const e=r(...n());a(this,o,"f").set(t,e)}}}unsubscribe(e,t){const r=a(this,s,"f").get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&a(this,o,"f").delete(t),r.delete(t)}clearEventSubscriptions(e){a(this,s,"f").delete(e)}clearSubscriptions(){a(this,s,"f").clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new l.RestrictedControllerMessenger({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}},n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap}}},{package:"@metamask/base-controller",file:"node_modules/@metamask/base-controller/dist/ControllerMessenger.js"}],[1156,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a,l,c,d,u=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},h=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.RestrictedControllerMessenger=void 0;r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){n.add(this),s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),a.set(this,void 0),u(this,s,e,"f"),u(this,i,t,"f"),u(this,o,null!=r?r:null,"f"),u(this,a,null!=l?l:null,"f")}registerActionHandler(e,t){if(!h(this,n,"m",d).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,s,"f").registerActionHandler(e,t)}unregisterActionHandler(e){if(!h(this,n,"m",d).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,s,"f").unregisterActionHandler(e)}call(e,...t){if(!h(this,n,"m",c).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return h(this,s,"f").call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!h(this,n,"m",d).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,s,"f").registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!h(this,n,"m",d).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,s,"f").publish(e,...t)}subscribe(e,t,r){if(!h(this,n,"m",l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?h(this,s,"f").subscribe(e,t,r):h(this,s,"f").subscribe(e,t)}unsubscribe(e,t){if(!h(this,n,"m",l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);h(this,s,"f").unsubscribe(e,t)}clearEventSubscriptions(e){if(!h(this,n,"m",d).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${h(this,i,"f")}:'`);h(this,s,"f").clearEventSubscriptions(e)}},s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,n=new WeakSet,l=function(e){const t=h(this,a,"f");return h(this,n,"m",d).call(this,e)||null!==t&&t.includes(e)},c=function(e){const t=h(this,o,"f");return h(this,n,"m",d).call(this,e)||null!==t&&t.includes(e)},d=function(e){return e.startsWith(`${h(this,i,"f")}:`)}}}},{package:"@metamask/base-controller",file:"node_modules/@metamask/base-controller/dist/RestrictedControllerMessenger.js"}],[1157,{"./BaseControllerV1":1153,"./BaseControllerV2":1154,"./ControllerMessenger":1155,"./RestrictedControllerMessenger":1156},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.getPersistentState=r.getAnonymizedState=r.BaseController=r.BaseControllerV1=void 0;var i=e("./BaseControllerV1");Object.defineProperty(r,"BaseControllerV1",{enumerable:!0,get:function(){return i.BaseControllerV1}});var o=e("./BaseControllerV2");Object.defineProperty(r,"BaseController",{enumerable:!0,get:function(){return o.BaseController}}),Object.defineProperty(r,"getAnonymizedState",{enumerable:!0,get:function(){return o.getAnonymizedState}}),Object.defineProperty(r,"getPersistentState",{enumerable:!0,get:function(){return o.getPersistentState}}),s(e("./ControllerMessenger"),r),s(e("./RestrictedControllerMessenger"),r)}}},{package:"@metamask/base-controller",file:"node_modules/@metamask/base-controller/dist/index.js"}],[116,{"../../../../shared/constants/app":4423,"../../../../shared/constants/smartTransactions":4443,"../../../../shared/modules/conversion.utils":4465,"@metamask/smart-transactions-controller/dist/types":1720,"@metamask/transaction-controller":2189,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.submitSmartTransactionHook=void 0;var n,s=e("@metamask/smart-transactions-controller/dist/types"),i=e("@metamask/transaction-controller"),o=(n=e("loglevel"))&&n.__esModule?n:{default:n},a=e("../../../../shared/modules/conversion.utils"),l=e("../../../../shared/constants/smartTransactions"),c=e("../../../../shared/constants/app");function d(e,t){h(e,t),t.add(e)}function u(e,t,r){h(e,t),t.set(e,r)}function h(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function m(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,f(e,t,"get"))}function g(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,f(e,t,"set"),r),r}function f(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}var v=new WeakMap,w=new WeakMap,y=new WeakMap,k=new WeakMap,C=new WeakMap,b=new WeakMap,_=new WeakMap,T=new WeakMap,S=new WeakMap,M=new WeakMap,E=new WeakMap,A=new WeakSet,P=new WeakSet,I=new WeakSet,N=new WeakSet,j=new WeakSet,R=new WeakSet,O=new WeakSet,x=new WeakSet;class B{constructor(e){d(this,x),d(this,O),d(this,R),d(this,j),d(this,N),d(this,I),d(this,P),d(this,A),u(this,v,{writable:!0,value:void 0}),u(this,w,{writable:!0,value:void 0}),u(this,y,{writable:!0,value:void 0}),u(this,k,{writable:!0,value:void 0}),u(this,C,{writable:!0,value:void 0}),u(this,b,{writable:!0,value:void 0}),u(this,_,{writable:!0,value:void 0}),u(this,T,{writable:!0,value:void 0}),u(this,S,{writable:!0,value:void 0}),u(this,M,{writable:!0,value:void 0}),u(this,E,{writable:!0,value:void 0});const{transactionMeta:t,smartTransactionsController:r,transactionController:n,isSmartTransaction:s,controllerMessenger:i,featureFlags:o}=e;g(this,w,""),g(this,v,!1),g(this,M,t),g(this,T,r),g(this,S,n),g(this,_,s),g(this,k,i),g(this,C,o),g(this,b,t.origin!==c.ORIGIN_METAMASK),g(this,y,t.chainId),g(this,E,t.txParams)}async submit(){var e;const t=!(null===(e=m(this,M))||void 0===e||!e.type)&&[i.TransactionType.swapAndSend,i.TransactionType.swapApproval].includes(m(this,M).type),r={transactionHash:undefined};if(!m(this,_)||t)return r;const{id:n}=await m(this,k).call("ApprovalController:startFlow");let s;g(this,w,n);try{s=await m(this,T).getFees({...m(this,E),chainId:m(this,y)},undefined)}catch(e){return o.default.error("Error in smart transaction publish hook, falling back to regular transaction submission",e),p(this,A,U).call(this),r}try{var a;const e=await p(this,R,$).call(this,{getFeesResponse:s}),t=null==e?void 0:e.uuid;if(!t)throw new Error("No smart transaction UUID");const r=null===(a=m(this,C))||void 0===a||null===(a=a.smartTransactions)||void 0===a?void 0:a.returnTxHashAsap;let n;if(p(this,P,L).call(this,{uuid:t}),p(this,N,D).call(this,{uuid:t}),n=r&&null!=e&&e.txHash?e.txHash:await p(this,j,G).call(this,{uuid:t}),null===n)throw new Error("Transaction does not have a transaction hash, there was a problem");return{transactionHash:n}}catch(e){throw o.default.error("Error in smart transaction publish hook",e),p(this,A,U).call(this),e}}}function U(){m(this,v)||(g(this,v,!0),m(this,k).call("ApprovalController:endFlow",{id:m(this,w)}))}function L({uuid:e}){const t=()=>{p(this,A,U).call(this)};m(this,k).call("ApprovalController:addRequest",{id:m(this,w),origin:origin,type:c.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage,requestState:{smartTransaction:{status:s.SmartTransactionStatuses.PENDING,creationTime:Date.now(),uuid:e},isDapp:m(this,b),txId:m(this,M).id}},!0).then(t,t)}async function F({smartTransaction:e}){return await m(this,k).call("ApprovalController:updateRequestState",{id:m(this,w),requestState:{smartTransaction:e,isDapp:m(this,b),txId:m(this,M).id}})}async function D({uuid:e}){m(this,T).eventEmitter.on(`${e}:smartTransaction`,(async e=>{const{status:t}=e;t&&t!==s.SmartTransactionStatuses.PENDING&&(m(this,v)||await p(this,I,F).call(this,{smartTransaction:e}))}))}function G({uuid:e}){return new Promise((t=>{m(this,T).eventEmitter.on(`${e}:smartTransaction`,(async e=>{const{status:r,statusMetadata:n}=e;r&&r!==s.SmartTransactionStatuses.PENDING&&(o.default.debug("Smart Transaction: ",e),null!=n&&n.minedHash?(o.default.debug("Smart Transaction - Received tx hash: ",null==n?void 0:n.minedHash),t(n.minedHash)):t(null))}))}))}async function $({getFeesResponse:e}){var t,r;const n=await p(this,x,H).call(this,(null===(t=e.tradeTxFees)||void 0===t?void 0:t.fees)??[],!1),s=await p(this,x,H).call(this,(null===(r=e.tradeTxFees)||void 0===r?void 0:r.cancelFees)||[],!0);return await m(this,T).submitSignedTransactions({signedTransactions:n,signedCanceledTransactions:s,txParams:m(this,E),transactionMeta:m(this,M)})}function W(e,t){const r={...m(this,E),maxFeePerGas:`0x${(0,a.decimalToHex)(e.maxFeePerGas)}`,maxPriorityFeePerGas:`0x${(0,a.decimalToHex)(e.maxPriorityFeePerGas)}`,gas:t?`0x${(0,a.decimalToHex)(l.CANCEL_GAS_LIMIT_DEC)}`:m(this,E).gas};return t&&(r.to=r.from,r.data="0x"),r}async function H(e,t){const r=e.map((e=>p(this,O,W).call(this,e,t))).map((e=>({...e,chainId:e.chainId||m(this,y)})));return await m(this,S).approveTransactionsWithSameNonce(r,{hasNonce:!0})}r.submitSmartTransactionHook=e=>new B(e).submit()}}},{package:"$root$",file:"app/scripts/lib/transaction/smart-transactions.ts"}],[117,{"../../../../shared/constants/security-provider":4442,"../ppom/ppom-util":89,"@metamask/keyring-api":1399,"ethereumjs-util":3236},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.addDappTransaction=async function(e){const{dappRequest:t}=e,{id:r,method:n,origin:s}=t,{securityAlertResponse:i}=t,o={actionId:r,method:n,origin:s,requireApproval:!0,securityAlertResponse:i},{waitForHash:l}=await a({...e,transactionOptions:o});return await l()},r.addTransaction=async function(e){!function(e){const{chainId:t,ppomController:r,securityAlertsEnabled:n,transactionOptions:s,transactionParams:a,updateSecurityAlertResponse:l}=e,{type:c}=s,d=o.SECURITY_PROVIDER_EXCLUDED_TRANSACTION_TYPES.includes(c);if(!n||!o.SECURITY_PROVIDER_SUPPORTED_CHAIN_IDS.includes(t)||d)return;try{const{from:t,to:n,value:c,data:d}=a,{actionId:u,origin:h}=s,p={method:"eth_sendTransaction",id:u??"",origin:h??"",params:[{from:t,to:n,value:c,data:d}]},m=(0,i.generateSecurityAlertId)();(0,i.validateRequestWithPPOM)({ppomController:r,request:p,securityAlertId:m}).then((e=>{l(p.method,m,e)}));const g={...o.LOADING_SECURITY_ALERT_RESPONSE,securityAlertId:m};e.transactionOptions.securityAlertResponse=g}catch(e){(0,i.handlePPOMError)(e,"Error validating JSON RPC using PPOM: ")}}(e);const{transactionMeta:t,waitForHash:r}=await a(e);if(!e.waitForSubmit)return r().catch((()=>{})),t;const n=await r();return function(e,t){return t.state.transactions.find((t=>t.hash===e))}(n,e.transactionController)};var n=e("@metamask/keyring-api"),s=e("ethereumjs-util"),i=e("../ppom/ppom-util"),o=e("../../../../shared/constants/security-provider");async function a(e){const{selectedAccount:t}=e;return t.type===n.EthAccountType.Erc4337?async function(e){var t;const{networkClientId:r,transactionController:n,transactionOptions:i,transactionParams:o,userOperationController:a}=e,{maxFeePerGas:c,maxPriorityFeePerGas:d}=o,{origin:u,requireApproval:h,type:p}=i,m={...o,maxFeePerGas:(0,s.addHexPrefix)(c),maxPriorityFeePerGas:(0,s.addHexPrefix)(d)},g=null==i||null===(t=i.swaps)||void 0===t?void 0:t.meta;null!=g&&g.type&&delete g.type;const f={networkClientId:r,origin:u,requireApproval:h,swaps:g,type:p},v=await a.addUserOperationFromTransaction(m,f);a.startPollingByNetworkClientId(r);return{transactionMeta:l(v.id,n),waitForHash:v.transactionHash}}(e):async function(e){const{transactionController:t,transactionOptions:r,transactionParams:n,networkClientId:s}=e,{result:i,transactionMeta:o}=await t.addTransaction(n,{...r});return{transactionMeta:o,waitForHash:()=>i}}(e)}function l(e,t){return t.state.transactions.find((t=>t.id===e))}}}},{package:"$root$",file:"app/scripts/lib/transaction/util.ts"}],[118,{"../../../../shared/constants/app":4423,"../../../../shared/constants/verification":4451,"@ethersproject/hash":492,"@ethersproject/wallet":555,"@metamask/rpc-errors":1672,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createTxVerificationMiddleware=function(e,t=a.TRUSTED_SIGNERS){return function(r,c,d,u){if(r.method!==l.MESSAGE_TYPE.ETH_SEND_TRANSACTION||!Array.isArray(r.params)||!function(e){return(0,o.isObject)(e[0])&&"string"==typeof e[0].data&&"string"==typeof e[0].from&&"string"==typeof e[0].to&&"string"==typeof e[0].value&&(!(0,o.hasProperty)(e[0],"chainId")||"string"==typeof e[0].chainId&&e[0].chainId.startsWith("0x"))}(r.params))return d();const h=r.params[0],p="string"==typeof h.chainId?h.chainId.toLowerCase():e.state.providerConfig.chainId,m=(0,a.getExperience)(h.to.toLowerCase(),p);if(!m||!a.EXPERIENCES_TO_VERIFY.includes(m))return d();const g=`0x${h.data.slice(-a.TX_SIG_LEN)}`,f=(0,s.verifyMessage)(function(e){const t={to:(0,n.hashMessage)(e.to.toLowerCase()),from:(0,n.hashMessage)(e.from.toLowerCase()),data:(0,n.hashMessage)(e.data.toLowerCase().slice(0,e.data.length-a.TX_SIG_LEN)),value:(0,n.hashMessage)(e.value.toLowerCase())};return(0,n.hashMessage)(JSON.stringify(t))}(h),g);return f!==t[m]?u(i.rpcErrors.invalidParams("Invalid transaction signature.")):d()}};var n=e("@ethersproject/hash"),s=e("@ethersproject/wallet"),i=e("@metamask/rpc-errors"),o=e("@metamask/utils"),a=e("../../../../shared/constants/verification"),l=e("../../../../shared/constants/app")}}},{package:"$root$",file:"app/scripts/lib/tx-verification/tx-verification-middleware.ts"}],[1189,{"@ethersproject/providers":524,"@metamask/base-controller":1196,"@metamask/controller-utils":1202,"@metamask/utils":2255,"punycode/":3988},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},a=(e,t,r)=>(o(e,t,"read from private field"),r?r.call(e):t.get(e)),l=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},c=(e,t,r,n)=>(o(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),d=e("@ethersproject/providers"),u=e("@metamask/base-controller"),h=e("@metamask/controller-utils"),p=e("@metamask/utils"),m=e("punycode/"),g=p.createProjectLogger.call(void 0,"ens-controller"),f={1:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",4:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",5:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",17e3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",11155111:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},v={ensEntries:{persist:!0,anonymous:!1},ensResolutionsByAddress:{persist:!0,anonymous:!1}},w={ensEntries:{},ensResolutionsByAddress:{}},y=class extends u.BaseController{constructor({registriesByChainId:e=f,messenger:t,state:r={},provider:a,onNetworkDidChange:u}){super({name:"EnsController",metadata:v,messenger:t,state:{...w,ensEntries:Object.fromEntries(Object.entries(e).map((([e,t])=>[h.toHex.call(void 0,e),{".":{address:t,chainId:h.toHex.call(void 0,e),ensName:"."}}]))),...r}}),l(this,s),l(this,n,null),a&&u&&u((t=>{this.resetState();const r=t.providerConfig.chainId;var l,u,p;(l=this,u=s,p=i,o(l,u,"access private method"),p).call(this,r)?c(this,n,new(0,d.Web3Provider)(a,{chainId:h.convertHexToDecimal.call(void 0,r),name:h.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP[r],ensAddress:e[parseInt(r,16)]})):c(this,n,null)}))}resetState(){this.update((e=>{e.ensResolutionsByAddress={}}))}clear(){this.update((e=>{e.ensEntries={}}))}delete(e,t){const r=h.normalizeEnsName.call(void 0,t);return!!(r&&this.state.ensEntries[e]&&this.state.ensEntries[e][r])&&(this.update((t=>{delete t.ensEntries[e][r],0===Object.keys(t.ensEntries[e]).length&&delete t.ensEntries[e]})),!0)}get(e,t){const r=h.normalizeEnsName.call(void 0,t);return r&&this.state.ensEntries[e]&&this.state.ensEntries[e][r]||null}set(e,t,r){if(!Number.isInteger(Number.parseInt(e,10))||!t||"string"!=typeof t||r&&!h.isValidHexAddress.call(void 0,r))throw new Error(`Invalid ENS entry: { chainId:${e}, ensName:${t}, address:${r}}`);const n=h.normalizeEnsName.call(void 0,t);if(!n)throw new Error(`Invalid ENS name: ${t}`);const s=r?h.toChecksumHexAddress.call(void 0,r):null,i=this.state.ensEntries[e];return(!i?.[n]||i[n].address!==s)&&(this.update((t=>{t.ensEntries={...this.state.ensEntries,[e]:{...this.state.ensEntries[e],[n]:{address:s,chainId:e,ensName:n}}}})),!0)}async reverseResolveAddress(e){if(!a(this,n))return;const t=h.toChecksumHexAddress.call(void 0,e);if(this.state.ensResolutionsByAddress[t])return this.state.ensResolutionsByAddress[t];let r,s;try{r=await a(this,n).lookupAddress(t)}catch(e){return void g(e)}if(r){try{s=await a(this,n).resolveName(r)}catch(e){return void g(e)}return s&&"0x0000000000000000000000000000000000000000"!==s&&"0x"!==s&&h.toChecksumHexAddress.call(void 0,s)===t?(this.update((e=>{e.ensResolutionsByAddress[t]=m.toASCII.call(void 0,r)})),r):void 0}}};n=new WeakMap,s=new WeakSet,i=function(e){return Boolean(this.state.ensEntries[e])};var k=y;r.DEFAULT_ENS_NETWORK_MAP=f,r.EnsController=y,r.EnsController_default=k}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/chunk-S7KH3XXU.js"}],[1190,{"./chunk-S7KH3XXU.js":1189},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-S7KH3XXU.js");r.DEFAULT_ENS_NETWORK_MAP=n.DEFAULT_ENS_NETWORK_MAP,r.EnsController=n.EnsController}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/index.js"}],[1191,{"./chunk-UJFCPTF3.js":1193,"./chunk-Z4BLTVTB.js":1194},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,o,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,n).delete(e)}clearActions(){l.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,i).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=l.__privateGet.call(void 0,this,o).get(e),s=n(...t);s!==r&&(l.__privateGet.call(void 0,this,o).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=l.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,l.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=l.__privateGet.call(void 0,this,i).get(e);if(n){const e=r(...n());l.__privateGet.call(void 0,this,o).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,o).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/ens-controller>@metamask/base-controller",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1192,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/ens-controller>@metamask/base-controller",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1193,{"./chunk-Z4BLTVTB.js":1194},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,i,r),p.__privateSet.call(void 0,this,o,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/ens-controller>@metamask/base-controller",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1194,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/ens-controller>@metamask/base-controller",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1195,{"./chunk-Z4BLTVTB.js":1194,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),i=e("immer");i.enablePatches.call(void 0);function o(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:o}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,i.freeze.call(void 0,o,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,o]=i.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:o}}applyPatches(e){const t=i.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},r.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/ens-controller>@metamask/base-controller",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1196,{"./chunk-G42723LG.js":1191,"./chunk-NINOM2XQ.js":1192,"./chunk-UJFCPTF3.js":1193,"./chunk-Z4BLTVTB.js":1194,"./chunk-ZNOPSWMU.js":1195},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-NINOM2XQ.js"),s=e("./chunk-ZNOPSWMU.js"),i=e("./chunk-G42723LG.js"),o=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=i.ControllerMessenger,r.RestrictedControllerMessenger=o.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/ens-controller>@metamask/base-controller",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1197,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/utils"),s=n.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=n.createModuleLogger,r.projectLogger=s}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1198,{"./chunk-X4PYR7CK.js":1201,"@ethereumjs/util":441,"@metamask/ethjs-unit":1336,"@metamask/utils":2255,"bn.js":2935,buffer:2983,"eth-ens-namehash":3173,"fast-deep-equal":3304},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./chunk-X4PYR7CK.js"),i=e("@ethereumjs/util"),o=e("@metamask/ethjs-unit"),a=e("@metamask/utils"),l=n(e("bn.js")),c=n(e("eth-ens-namehash")),d=n(e("fast-deep-equal")),u=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,l.default)(a.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function m(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function g(e,t){const r=await m(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!a.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,a.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=s.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return a.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const n=new(0,l.default)(t),s=new(0,l.default)(r);return e.mul(n).div(s)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),r=t[0]||"0";let n=t[1]||"";if(!n)return o.toWei.call(void 0,r,"gwei");if(n.length<=9)return o.toWei.call(void 0,`${r}.${n}`,"gwei");const s=n.slice(9)[0];n=n.slice(0,9);let i=o.toWei.call(void 0,`${r}.${n}`,"gwei");return Number(s)>=5&&(i=i.add(new(0,l.default)(1))),i},r.weiHexToGweiDec=function(e){const t=new(0,l.default)(a.remove0x.call(void 0,e),16);return o.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=p,r.hexToText=function(e){try{const r=a.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(p(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&a.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(u)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=a.add0x.call(void 0,e);return a.isHexString.call(void 0,t)?i.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?a.add0x.call(void 0,e):e;return!!a.isStrictHexString.call(void 0,r)&&i.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=m,r.handleFetch=g,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:n}){let s;try{s=r?Promise.race([await g(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),r)))]):await g(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==u)throw e;console.error(e)}(e,n)}return s},r.timeoutFetch=async function(e,t,r=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(u)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((n,s)=>{const i=(e,t)=>{e?s(e):n(t)};t in e&&"function"==typeof e[t]?e[t](...r,i):e.sendAsync({method:t,params:r},i)}))},r.convertHexToDecimal=(e="0x0")=>a.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return d.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-EDY72VWL.js"}],[1199,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},s={...n,rpc:"rpc"};var i=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(i||{}),o={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},a=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(a||{});r.InfuraNetworkType=n,r.NetworkType=s,r.isNetworkType=function(e){return Object.values(s).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(n).includes(e)},r.BuiltInNetworkName=i,r.ChainId=o,r.NetworksTicker=a}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[12,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OIDC_TOKENS_ENDPOINT=r.AUTH_NONCE_ENDPOINT=r.AUTH_LOGIN_ENDPOINT=void 0,r.createLoginRawMessage=function(e,t){return`metamask:${e}:${t}`},r.getAccessToken=async function(e){const t=new Headers({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams;r.append("grant_type",l),r.append("client_id",a),r.append("assertion",e);try{const e=await fetch(o,{method:"POST",headers:t,body:r.toString()});if(!e.ok)return null;const n=await e.json();return(null==n?void 0:n.access_token)??null}catch(e){return console.error("authentication-controller/services: unable to get access token",e),null}},r.getNonce=async function(e){const t=new URL(s);t.searchParams.set("identifier",e);try{const e=await fetch(t.toString());if(!e.ok)return null;const r=await e.json();return(null==r?void 0:r.nonce)??null}catch(e){return console.error("authentication-controller/services: unable to get nonce",e),null}},r.login=async function(e,t,r){try{const n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signature:t,raw_message:e,metametrics:{metametrics_id:r,agent:"extension"}})});if(!n.ok)return null;return await n.json()??null}catch(e){return console.error("authentication-controller/services: unable to login",e),null}};const n="https://authentication.api.cx.metamask.io",s=r.AUTH_NONCE_ENDPOINT=`${n}/api/v2/nonce`,i=r.AUTH_LOGIN_ENDPOINT=`${n}/api/v2/srp/login`,o=r.OIDC_TOKENS_ENDPOINT="https://oidc.api.cx.metamask.io/oauth2/token",a="1132f10a-b4e5-4390-a5f2-d9c6022db564",l="urn:ietf:params:oauth:grant-type:jwt-bearer"}}},{package:"$root$",file:"app/scripts/controllers/authentication/services.ts"}],[120,{"../../shared/constants/app":4423,"../../shared/constants/hardware-wallets":4430,"../../shared/constants/keyring":4431,"../../shared/constants/logs":4433,"../../shared/constants/metametrics":4434,"../../shared/constants/methods-tags":4435,"../../shared/constants/network":4436,"../../shared/constants/permissions":4440,"../../shared/constants/smartTransactions":4443,"../../shared/constants/swaps":4445,"../../shared/constants/time":4447,"../../shared/constants/tokens":4448,"../../shared/constants/transaction":4449,"../../shared/constants/urls":4450,"../../shared/lib/metamask-controller-utils":4454,"../../shared/lib/token-util":4458,"../../shared/modules/mv3.utils":4475,"../../shared/modules/network.utils":4476,"../../shared/modules/selectors":4482,"../../shared/modules/string-utils":4486,"../../shared/modules/transaction.utils":4488,"../../shared/notifications":4490,"./controllers/account-order":6,"./controllers/alert":7,"./controllers/app-metadata":8,"./controllers/app-state":9,"./controllers/authentication/authentication-controller":11,"./controllers/decrypt-message":13,"./controllers/encryption-public-key":14,"./controllers/metamask-notifications/metamask-notifications":17,"./controllers/metametrics":24,"./controllers/network-order":25,"./controllers/onboarding":26,"./controllers/permissions":30,"./controllers/preferences":33,"./controllers/push-platform-notifications/push-platform-notifications":34,"./controllers/swaps":40,"./controllers/user-storage/user-storage-controller":47,"./detect-multiple-instances":48,"./lib/AccountIdentitiesPetnamesBridge":51,"./lib/AddressBookPetnamesBridge":52,"./lib/ComposableObservableStore":53,"./lib/SnapsNameProvider":54,"./lib/WeakRefObjectMap":55,"./lib/account-tracker":56,"./lib/backup":57,"./lib/createDupeReqFilterStream":58,"./lib/createLoggerMiddleware":59,"./lib/createMetaRPCHandler":60,"./lib/createMetamaskMiddleware":61,"./lib/createOnboardingMiddleware":62,"./lib/createOriginMiddleware":63,"./lib/createRPCMethodTrackingMiddleware":64,"./lib/createTabIdMiddleware":66,"./lib/encryptor-factory":67,"./lib/hardware-keyring-builder-factory":75,"./lib/keyring-snaps-permissions":76,"./lib/offscreen-bridge/lattice-offscreen-keyring":84,"./lib/offscreen-bridge/ledger-offscreen-bridge":85,"./lib/offscreen-bridge/trezor-offscreen-bridge":86,"./lib/ppom/indexed-db-backend":87,"./lib/ppom/ppom":90,"./lib/ppom/ppom-middleware":88,"./lib/ppom/ppom-util":89,"./lib/rpc-method-middleware":103,"./lib/segment":105,"./lib/snap-keyring":109,"./lib/stream-utils":114,"./lib/transaction/metrics":115,"./lib/transaction/smart-transactions":116,"./lib/transaction/util":117,"./lib/tx-verification/tx-verification-middleware":118,"./lib/util":119,"./snaps/preinstalled-snaps":257,"./translate":258,"@keystonehq/metamask-airgapped-keyring":611,"@metamask/accounts-controller":1083,"@metamask/address-book-controller":1091,"@metamask/announcement-controller":1105,"@metamask/approval-controller":1114,"@metamask/assets-controllers":1146,"@metamask/base-controller":1157,"@metamask/controller-utils":1166,"@metamask/ens-controller":1190,"@metamask/eth-json-rpc-filters":1214,"@metamask/eth-json-rpc-filters/subscriptionManager":1224,"@metamask/eth-json-rpc-middleware":1247,"@metamask/eth-ledger-bridge-keyring":1267,"@metamask/eth-query":1271,"@metamask/eth-trezor-keyring":1308,"@metamask/ethjs-query":1334,"@metamask/gas-fee-controller":1342,"@metamask/keyring-controller":1431,"@metamask/logging-controller":1444,"@metamask/name-controller":1484,"@metamask/network-controller":1510,"@metamask/notification-controller":1532,"@metamask/obs-store":1565,"@metamask/obs-store/dist/asStream":1564,"@metamask/permission-controller":1579,"@metamask/permission-log-controller":1596,"@metamask/phishing-controller":1604,"@metamask/ppom-validator":1628,"@metamask/queued-request-controller":1645,"@metamask/rate-limit-controller":1661,"@metamask/scure-bip39/dist/wordlists/english":1675,"@metamask/selected-network-controller":1687,"@metamask/signature-controller":1695,"@metamask/smart-transactions-controller":1719,"@metamask/snaps-controllers":1948,"@metamask/snaps-rpc-methods":2041,"@metamask/snaps-utils":2118,"@metamask/transaction-controller":2189,"@metamask/user-operation-controller":2221,"@sentry/browser":2364,"await-semaphore":2877,buffer:2983,"eth-lattice-keyring":3174,"eth-rpc-errors":3205,events:3276,"json-rpc-engine":3627,"json-rpc-middleware-stream":3632,lodash:3783,loglevel:3789,nanoid:3876,"readable-stream":4188},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.METAMASK_CONTROLLER_EVENTS=void 0;var n=Ct(e("events")),s=e("readable-stream"),i=e("@metamask/assets-controllers"),o=e("@metamask/obs-store"),a=e("@metamask/obs-store/dist/asStream"),l=e("json-rpc-engine"),c=e("json-rpc-middleware-stream"),d=e("@metamask/eth-json-rpc-middleware"),u=e("lodash"),h=e("@metamask/keyring-controller"),p=Ct(e("@metamask/eth-json-rpc-filters")),m=Ct(e("@metamask/eth-json-rpc-filters/subscriptionManager")),g=e("eth-rpc-errors"),f=e("await-semaphore"),v=Ct(e("loglevel")),w=e("@metamask/eth-trezor-keyring"),y=e("@metamask/eth-ledger-bridge-keyring"),k=Ct(e("eth-lattice-keyring")),C=e("@keystonehq/metamask-airgapped-keyring"),b=Ct(e("@metamask/eth-query")),_=Ct(e("@metamask/ethjs-query")),T=Ct(e("nanoid")),S=e("@sentry/browser"),M=e("@metamask/address-book-controller"),E=e("@metamask/approval-controller"),A=e("@metamask/base-controller"),P=e("@metamask/ens-controller"),I=e("@metamask/phishing-controller"),N=e("@metamask/announcement-controller"),j=e("@metamask/network-controller"),R=e("@metamask/gas-fee-controller"),O=e("@metamask/permission-controller"),x=Ct(e("@metamask/smart-transactions-controller")),B=e("@metamask/selected-network-controller"),U=e("@metamask/logging-controller"),L=e("@metamask/permission-log-controller"),F=e("@metamask/rate-limit-controller"),D=e("@metamask/notification-controller"),G=e("@metamask/snaps-controllers"),$=e("@metamask/snaps-rpc-methods"),W=e("@metamask/accounts-controller"),H=e("@metamask/signature-controller"),K=e("@metamask/ppom-validator"),q=e("@metamask/controller-utils"),z=e("@metamask/scure-bip39/dist/wordlists/english"),V=e("@metamask/name-controller"),Q=e("@metamask/queued-request-controller"),J=e("@metamask/user-operation-controller"),Y=e("@metamask/transaction-controller"),Z=e("@metamask/snaps-utils"),X=e("../../shared/constants/methods-tags"),ee=e("../../shared/constants/transaction"),te=e("../../shared/constants/swaps"),re=e("../../shared/constants/network"),ne=e("../../shared/constants/smartTransactions"),se=e("../../shared/constants/hardware-wallets"),ie=e("../../shared/constants/keyring"),oe=e("../../shared/constants/permissions"),ae=e("../../shared/notifications"),le=e("../../shared/constants/time"),ce=e("../../shared/constants/app"),de=e("../../shared/constants/metametrics"),ue=e("../../shared/constants/logs"),he=e("../../shared/lib/token-util"),pe=e("../../shared/modules/string-utils"),me=e("../../shared/modules/transaction.utils"),ge=e("../../shared/constants/tokens"),fe=e("../../shared/lib/metamask-controller-utils"),ve=e("../../shared/modules/mv3.utils"),we=e("../../shared/modules/network.utils"),ye=e("../../shared/modules/selectors"),ke=e("../../shared/constants/urls"),Ce=e("./lib/transaction/metrics"),be=e("./lib/transaction/smart-transactions"),_e=e("./lib/keyring-snaps-permissions"),Te=e("./lib/SnapsNameProvider"),Se=e("./lib/AddressBookPetnamesBridge"),Me=e("./lib/AccountIdentitiesPetnamesBridge"),Ee=e("./lib/ppom/ppom-middleware"),Ae=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=kt(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=s?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}(e("./lib/ppom/ppom")),Pe=e("./detect-multiple-instances"),Ie=Ct(e("./lib/ComposableObservableStore")),Ne=Ct(e("./lib/account-tracker")),je=Ct(e("./lib/createDupeReqFilterStream")),Re=Ct(e("./lib/createLoggerMiddleware")),Oe=e("./lib/rpc-method-middleware"),xe=Ct(e("./lib/createOriginMiddleware")),Be=Ct(e("./lib/createTabIdMiddleware")),Ue=e("./controllers/network-order"),Le=e("./controllers/account-order"),Fe=Ct(e("./lib/createOnboardingMiddleware")),De=e("./lib/stream-utils"),Ge=Ct(e("./controllers/preferences")),$e=Ct(e("./controllers/app-state")),We=Ct(e("./controllers/alert")),He=Ct(e("./controllers/onboarding")),Ke=Ct(e("./lib/backup")),qe=Ct(e("./controllers/decrypt-message")),ze=Ct(e("./controllers/swaps")),Ve=Ct(e("./controllers/metametrics")),Qe=e("./lib/segment"),Je=Ct(e("./lib/createMetaRPCHandler")),Ye=e("./lib/util"),Ze=Ct(e("./lib/createMetamaskMiddleware")),Xe=e("./lib/hardware-keyring-builder-factory"),et=Ct(e("./controllers/encryption-public-key")),tt=Ct(e("./controllers/app-metadata")),rt=e("./controllers/permissions"),nt=Ct(e("./lib/createRPCMethodTrackingMiddleware")),st=e("./lib/ppom/indexed-db-backend"),it=e("./translate"),ot=e("./lib/offscreen-bridge/trezor-offscreen-bridge"),at=e("./lib/offscreen-bridge/ledger-offscreen-bridge"),lt=e("./lib/snap-keyring"),ct=e("./lib/encryptor-factory"),dt=e("./lib/transaction/util"),ut=e("./lib/offscreen-bridge/lattice-offscreen-keyring"),ht=Ct(e("./snaps/preinstalled-snaps")),pt=e("./lib/WeakRefObjectMap"),mt=Ct(e("./controllers/authentication/authentication-controller")),gt=Ct(e("./controllers/user-storage/user-storage-controller")),ft=e("./controllers/push-platform-notifications/push-platform-notifications"),vt=e("./controllers/metamask-notifications/metamask-notifications"),wt=e("./lib/tx-verification/tx-verification-middleware"),yt=e("./lib/ppom/ppom-util");function kt(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(kt=function(e){return e?r:t})(e)}function Ct(e){return e&&e.__esModule?e:{default:e}}function bt(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function _t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}r.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange",QUEUED_REQUEST_STATE_CHANGE:"QueuedRequestController:stateChange"};var St=new WeakSet,Mt=new WeakSet,Et=new WeakSet;class At extends n.default{constructor(e){var t,r;super(),bt(this,Et),bt(this,Mt),bt(this,St),_t(this,"_trackSnapExportUsage",(0,u.wrap)((0,u.memoize)((()=>(0,u.throttle)(((e,t,r,n)=>{var s;return this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.SnapExportUsed,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,export:t,snap_category:null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category,success:r,origin:n}})}),60*le.SECOND)),((e,t,r,n)=>`${e}${t}${n}`)),((e,...t)=>e(...t)(...t)))),_t(this,"handleWatchAssetRequest",(({asset:e,type:t,origin:r,networkClientId:n})=>{switch(t){case q.ERC20:return this.tokensController.watchAsset({asset:e,type:t,networkClientId:n});case q.ERC721:case q.ERC1155:return this.nftController.watchNft(e,t,r);default:throw new Error(`Asset type ${t} not supported`)}})),_t(this,"removePermissionsFor",(e=>{try{this.permissionController.revokePermissions(e)}catch(e){if(!(e instanceof O.PermissionsRequestNotFoundError))throw e}})),_t(this,"updateCaveat",((e,t,r,n)=>{try{this.controllerMessenger.call("PermissionController:updateCaveat",e,t,r,n)}catch(e){if(!(e instanceof O.PermissionsRequestNotFoundError))throw e}})),_t(this,"updateNetworksList",(e=>{try{this.networkOrderController.updateNetworksList(e)}catch(e){throw v.default.error(e.message),e}})),_t(this,"updateAccountsList",(e=>{try{this.accountOrderController.updateAccountsList(e)}catch(e){throw v.default.error(e.message),e}})),_t(this,"updateHiddenAccountsList",(e=>{try{this.accountOrderController.updateHiddenAccountsList(e)}catch(e){throw v.default.error(e.message),e}})),_t(this,"rejectPermissionsRequest",(e=>{try{this.permissionController.rejectPermissionsRequest(e)}catch(e){if(!(e instanceof O.PermissionsRequestNotFoundError))throw e}})),_t(this,"acceptPermissionsRequest",(e=>{try{this.permissionController.acceptPermissionsRequest(e)}catch(e){if(!(e instanceof O.PermissionsRequestNotFoundError))throw e}})),_t(this,"resolvePendingApproval",(async(e,t,r)=>{try{await this.approvalController.accept(e,t,r)}catch(e){if(!(e instanceof E.ApprovalRequestNotFoundError))throw e}})),_t(this,"rejectPendingApproval",((e,t)=>{try{this.approvalController.reject(e,new g.EthereumRpcError(t.code,t.message,t.data))}catch(e){if(!(e instanceof E.ApprovalRequestNotFoundError))throw e}}));const{isFirstMetaMaskControllerSetup:n}=e;this.defaultMaxListeners=20,this.sendUpdate=(0,u.debounce)(this.privateSendUpdate.bind(this),200*le.MILLISECOND),this.opts=e,this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const s=e.initState||{},o=this.platform.getVersion();this.recordFirstTimeInfo(s),this.featureFlags=e.featureFlags,this.activeControllerConnections=0,this.offscreenPromise=e.offscreenPromise??Promise.resolve(),this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.controllerMessenger=new A.ControllerMessenger,this.loggingController=new U.LoggingController({messenger:this.controllerMessenger.getRestricted({name:"LoggingController"}),state:s.LoggingController}),this.localStoreApiWrapper=e.localStore,this.currentMigrationVersion=e.currentMigrationVersion,this.store=new Ie.default({state:s,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new f.Mutex,this.extension.runtime.onInstalled.addListener((e=>{"update"===e.reason&&("8.1.0"===o&&this.platform.openExtensionInBrowser(),this.loggingController.add({type:U.LogType.GenericLog,data:{event:ue.LOG_EVENT.VERSION_UPDATE,previousVersion:e.previousVersion,version:o}}))})),this.appMetadataController=new tt.default({state:s.AppMetadataController,currentMigrationVersion:this.currentMigrationVersion,currentAppVersion:o});const a=()=>{this.encryptionPublicKeyController.clearUnapproved(),this.decryptMessageController.clearUnapproved(),this.signatureController.clearUnapproved(),this.approvalController.clear(g.ethErrors.provider.userRejectedRequest())};this.queuedRequestController=new Q.QueuedRequestController({messenger:this.controllerMessenger.getRestricted({name:"QueuedRequestController",allowedActions:["NetworkController:getState","NetworkController:setActiveNetwork","SelectedNetworkController:getNetworkClientIdForDomain"],allowedEvents:["SelectedNetworkController:stateChange"]}),shouldRequestSwitchNetwork:({method:e})=>X.methodsRequiringNetworkSwitch.includes(e),clearPendingConfirmations:a,showApprovalRequest:e.showUserConfirmation}),this.approvalController=new E.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation,typesExcludedFromRateLimiting:[q.ApprovalType.EthSign,q.ApprovalType.PersonalSign,q.ApprovalType.EthSignTypedData,q.ApprovalType.Transaction,q.ApprovalType.WatchAsset,q.ApprovalType.EthGetEncryptionPublicKey,q.ApprovalType.EthDecrypt]});const l=this.controllerMessenger.getRestricted({name:"NetworkController"});let c={};s.NetworkController&&(c=s.NetworkController),this.networkController=new j.NetworkController({messenger:l,state:c,infuraProjectId:e.infuraProjectId,trackMetaMetricsEvent:(...e)=>this.metaMetricsController.trackEvent(...e)}),this.networkController.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.deprecatedNetworkVersions={};const d=this.controllerMessenger.getRestricted({name:"TokenListController",allowedEvents:["NetworkController:stateChange"]}),p=this.controllerMessenger.getRestricted({name:"AccountsController",allowedEvents:["SnapController:stateChange","KeyringController:accountRemoved","KeyringController:stateChange"],allowedActions:["KeyringController:getAccounts","KeyringController:getKeyringsByType","KeyringController:getKeyringForAccount"]});this.accountsController=new W.AccountsController({messenger:p,state:s.AccountsController});const m=this.controllerMessenger.getRestricted({name:"PreferencesController",allowedActions:["AccountsController:setSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName"],allowedEvents:["AccountsController:stateChange"]});this.preferencesController=new Ge.default({initState:s.PreferencesController,initLangCode:e.initLangCode,messenger:m,provider:this.provider,networkConfigurations:this.networkController.state.networkConfigurations}),this.tokenListController=new i.TokenListController({chainId:this.networkController.state.providerConfig.chainId,preventPollingOnNetworkRestart:!Tt(this,Et,Nt).call(this,this.preferencesController.store.getState()),messenger:d,state:s.TokenListController}),this.assetsContractController=new i.AssetsContractController({chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e),onNetworkDidChange:e=>l.subscribe("NetworkController:networkDidChange",(()=>{const t=this.networkController.state;return e(t)})),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{provider:this.provider},s.AssetsContractController);const b=this.controllerMessenger.getRestricted({name:"TokensController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:networkDidChange","AccountsController:selectedAccountChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokensController=new i.TokensController({messenger:b,chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:e=>this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(t=>{e({selectedAddress:t.address})})),onNetworkDidChange:e=>l.subscribe("NetworkController:networkDidChange",(()=>{const t=this.networkController.state;return e(t)})),onTokenListStateChange:e=>this.controllerMessenger.subscribe(`${this.tokenListController.name}:stateChange`,e),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),config:{provider:this.provider,selectedAddress:(null===(t=s.AccountsController)||void 0===t||null===(t=t.internalAccounts)||void 0===t||null===(t=t.accounts[null===(r=s.AccountsController)||void 0===r||null===(r=r.internalAccounts)||void 0===r?void 0:r.selectedAccount])||void 0===t?void 0:t.address)??""},state:s.TokensController}),this.controllerMessenger.registerActionHandler("TokensController:getState",(()=>this.tokensController.state));const _=this.controllerMessenger.getRestricted({name:"NftController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.networkController.name}:getNetworkClientById`]});this.nftController=new i.NftController({messenger:_,chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),getERC721AssetName:this.assetsContractController.getERC721AssetName.bind(this.assetsContractController),getERC721AssetSymbol:this.assetsContractController.getERC721AssetSymbol.bind(this.assetsContractController),getERC721TokenURI:this.assetsContractController.getERC721TokenURI.bind(this.assetsContractController),getERC721OwnerOf:this.assetsContractController.getERC721OwnerOf.bind(this.assetsContractController),getERC1155BalanceOf:this.assetsContractController.getERC1155BalanceOf.bind(this.assetsContractController),getERC1155TokenURI:this.assetsContractController.getERC1155TokenURI.bind(this.assetsContractController),onNftAdded:({address:e,symbol:t,tokenId:r,standard:n,source:s})=>this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.NftAdded,category:de.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:t,token_id:r,token_standard:n,asset_type:ee.AssetType.NFT,source:s}}),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{},s.NftController),this.nftController.setApiKey(null),this.nftDetectionController=new i.NftDetectionController({chainId:this.networkController.state.providerConfig.chainId,onNftsStateChange:e=>this.nftController.subscribe(e),onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),getOpenSeaApiKey:()=>this.nftController.openSeaApiKey,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),addNft:this.nftController.addNft.bind(this.nftController),getNftApi:this.nftController.getNftApi.bind(this.nftController),getNftState:()=>this.nftController.state,disabled:this.preferencesController.store.getState().useNftDetection===undefined||!this.preferencesController.store.getState().useNftDetection,selectedAddress:this.preferencesController.store.getState().selectedAddress,getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)}),this.metaMetricsController=new Ve.default({segment:Qe.segment,preferencesStore:this.preferencesController.store,onNetworkDidChange:l.subscribe.bind(l,"NetworkController:networkDidChange"),getNetworkIdentifier:()=>{const{type:e,rpcUrl:t}=this.networkController.state.providerConfig;return e===re.NETWORK_TYPES.RPC?t:e},getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,version:this.platform.getVersion(),environment:"other",extension:this.extension,initState:s.MetaMetricsController,captureException:S.captureException}),this.on("update",(e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}));const T=this.controllerMessenger.getRestricted({name:"GasFeeController",allowedActions:["NetworkController:getEIP1559Compatibility","NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:["NetworkController:stateChange"]}),$=te.GAS_API_BASE_URL;this.gasFeeController=new R.GasFeeController({state:s.GasFeeController,interval:1e4,messenger:T,clientId:te.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkDidChange:e=>{l.subscribe("NetworkController:networkDidChange",(()=>e(this.networkController.state)))},getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${$}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${$}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>{const{chainId:e}=this.networkController.state.providerConfig;return e===re.CHAIN_IDS.BSC},getChainId:()=>this.networkController.state.providerConfig.chainId}),this.appStateController=new $e.default({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),initState:s.AppStateController,onInactiveTimeout:()=>this.setLocked(),preferencesStore:this.preferencesController.store,messenger:this.controllerMessenger.getRestricted({name:"AppStateController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`],allowedEvents:["KeyringController:qrKeyringStateChange"]}),extension:this.extension});const z=this.controllerMessenger.getRestricted({name:"CurrencyRateController",allowedActions:[`${this.networkController.name}:getNetworkClientById`]});this.currencyRateController=new i.CurrencyRateController({includeUsdRate:!0,messenger:z,state:s.CurrencyController});const se=this.currencyRateController.fetchExchangeRate.bind(this.currencyRateController);this.currencyRateController.fetchExchangeRate=(...e)=>this.preferencesController.store.getState().useCurrencyRateCheck?se(...e):{conversionRate:null,usdConversionRate:null};const ie=this.controllerMessenger.getRestricted({name:"PhishingController"});this.phishingController=new I.PhishingController({messenger:ie,state:s.PhishingController,hotlistRefreshInterval:undefined,stalelistRefreshInterval:undefined}),this.ppomController=new K.PPOMController({messenger:this.controllerMessenger.getRestricted({name:"PPOMController",allowedEvents:["NetworkController:stateChange"]}),storageBackend:new st.IndexedDBPPOMStorage("PPOMDB",1),provider:this.provider,ppomProvider:{PPOM:Ae.PPOM,ppomInit:Ae.default},state:s.PPOMController,chainId:this.networkController.state.providerConfig.chainId,securityAlertsEnabled:this.preferencesController.store.getState().securityAlertsEnabled,onPreferencesChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),cdnBaseUrl:"static.cx.metamask.io/api/v1/confirmations/ppom",blockaidPublicKey:"066ad3e8af5583385e312c156d238055215d5f25247c1e91055afa756cb98a88"});const he=this.controllerMessenger.getRestricted({name:"AnnouncementController"});this.announcementController=new N.AnnouncementController({messenger:he,allAnnouncements:ae.UI_NOTIFICATIONS,state:s.AnnouncementController});const pe=this.controllerMessenger.getRestricted({name:"NetworkOrderController",allowedEvents:["NetworkController:stateChange"]});this.networkOrderController=new Ue.NetworkOrderController({messenger:pe,state:s.NetworkOrderController});const me=this.controllerMessenger.getRestricted({name:"AccountOrderController"});this.accountOrderController=new Le.AccountOrderController({messenger:me,state:s.AccountOrderController}),this.tokenRatesController=new i.TokenRatesController({chainId:this.networkController.state.providerConfig.chainId,ticker:this.networkController.state.providerConfig.ticker,selectedAddress:this.accountsController.getSelectedAccount().address,onTokensStateChange:e=>this.tokensController.subscribe(e),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),onPreferencesStateChange:e=>this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(t=>{e({selectedAddress:t.address})})),tokenPricesService:new i.CodefiTokenPricesServiceV2,getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{allTokens:this.tokensController.state.allTokens,allDetectedTokens:this.tokensController.state.allDetectedTokens},s.TokenRatesController),this.preferencesController.store.subscribe((0,Ye.previousValueComparator)(((e,t)=>{const{useCurrencyRateCheck:r}=e,{useCurrencyRateCheck:n}=t;n&&!r?this.tokenRatesController.start():!n&&r&&this.tokenRatesController.stop()}),this.preferencesController.store.getState())),this.ensController=new P.EnsController({messenger:this.controllerMessenger.getRestricted({name:"EnsController"}),provider:this.provider,onNetworkDidChange:l.subscribe.bind(l,"NetworkController:networkDidChange")}),this.onboardingController=new He.default({initState:s.OnboardingController});let ge=[(0,h.keyringBuilderFactory)(C.MetaMaskKeyring)];if(!1===ve.isManifestV3){var fe;const e=null===(fe=this.opts.overrides)||void 0===fe?void 0:fe.keyrings,t=[(null==e?void 0:e.lattice)||k.default,C.MetaMaskKeyring],r=[{keyring:(null==e?void 0:e.trezor)||w.TrezorKeyring,bridge:(null==e?void 0:e.trezorBridge)||w.TrezorConnectBridge},{keyring:(null==e?void 0:e.ledger)||y.LedgerKeyring,bridge:(null==e?void 0:e.ledgerBridge)||y.LedgerIframeBridge}];ge=t.map((e=>(0,h.keyringBuilderFactory)(e))),r.forEach((e=>ge.push((0,Xe.hardwareKeyringBuilderFactory)(e.keyring,e.bridge))))}else ge.push((0,Xe.hardwareKeyringBuilderFactory)(w.TrezorKeyring,ot.TrezorOffscreenBridge),(0,Xe.hardwareKeyringBuilderFactory)(y.LedgerKeyring,at.LedgerOffscreenBridge),(0,h.keyringBuilderFactory)(ut.LatticeKeyringOffscreen));const we=this.controllerMessenger.getRestricted({name:"SnapKeyringBuilder",allowedActions:["ApprovalController:addRequest","ApprovalController:acceptRequest","ApprovalController:rejectRequest","ApprovalController:startFlow","ApprovalController:endFlow","ApprovalController:showSuccess","ApprovalController:showError","PhishingController:test","PhishingController:maybeUpdateState","KeyringController:getAccounts","AccountsController:setSelectedAccount","AccountsController:getAccountByAddress"]});ge.push((0,lt.snapKeyringBuilder)(we,(()=>this.snapController),(async()=>{await this.keyringController.persistAllKeyrings(),await this.accountsController.updateAccounts()}),(e=>this.preferencesController.setSelectedAddress(e)),(e=>this.removeAccount(e)),this.metaMetricsController.trackEvent.bind(this.metaMetricsController),(e=>{if(!e)return null;const t=this.getLocale(),{snaps:r}=this.snapController.state,n=r[e];if(!n)return(0,Z.stripSnapPrefix)(e);if(n.localizationFiles){return(0,Z.getLocalizedSnapManifest)(n.manifest,t,n.localizationFiles).proposedName}return n.manifest.proposedName}),(e=>ht.default.some((t=>t.snapId===e)))));const ke=this.controllerMessenger.getRestricted({name:"KeyringController"});this.keyringController=new h.KeyringController({cacheEncryptionKey:!0,keyringBuilders:ge,state:s.KeyringController,encryptor:e.encryptor||(0,ct.encryptorFactory)(6e5),messenger:ke}),this.controllerMessenger.subscribe("KeyringController:unlock",(()=>this._onUnlock())),this.controllerMessenger.subscribe("KeyringController:lock",(()=>this._onLock())),this.controllerMessenger.subscribe("KeyringController:stateChange",(e=>{this._onKeyringControllerUpdate(e)})),this.permissionController=new O.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,"SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"]}),state:s.PermissionController,caveatSpecifications:(0,rt.getCaveatSpecifications)({getInternalAccounts:this.accountsController.listAccounts.bind(this.accountsController),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController)}),permissionSpecifications:{...(0,rt.getPermissionSpecifications)({getInternalAccounts:this.accountsController.listAccounts.bind(this.accountsController),getAllAccounts:this.keyringController.getAccounts.bind(this.keyringController),captureKeyringTypesWithMissingIdentities:(e=[],t=[])=>{const r=t.filter((t=>!e.some((e=>e.address.toLowerCase()===t.toLowerCase())))).map((e=>this.keyringController.getAccountKeyringType(e))),n=e.length,s=Object.keys(this.accountTracker.store.getState().accounts||{}).length;(0,S.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${n} identities, and the ${r} keyrings included accounts with missing identities. Meanwhile, there are ${s} accounts in the account tracker.`))}}),...this.getSnapPermissionSpecifications()},unrestrictedMethods:rt.unrestrictedMethods}),this.selectedNetworkController=new B.SelectedNetworkController({messenger:this.controllerMessenger.getRestricted({name:"SelectedNetworkController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","NetworkController:getSelectedNetworkClient","PermissionController:hasPermissions","PermissionController:getSubjectNames"],allowedEvents:["NetworkController:stateChange","PermissionController:stateChange"]}),state:s.SelectedNetworkController,useRequestQueuePreference:this.preferencesController.store.getState().useRequestQueue,onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e),domainProxyMap:new pt.WeakRefObjectMap}),this.permissionLogController=new L.PermissionLogController({messenger:this.controllerMessenger.getRestricted({name:"PermissionLogController"}),restrictedMethods:new Set(Object.keys(oe.RestrictedMethods)),state:s.PermissionLogController}),this.subjectMetadataController=new O.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:s.SubjectMetadataController,subjectCacheLimit:100});const Ce=ve.isManifestV3&&"undefined"!=typeof chrome&&void 0!==chrome.offscreen,be={messenger:this.controllerMessenger.getRestricted({name:"ExecutionService"}),setupSnapProvider:this.setupSnapProvider.bind(this)};this.snapExecutionService=!1===Ce?new G.IframeExecutionService({...be,iframeUrl:new URL("https://execution.metamask.io/iframe/6.4.0/index.html")}):new G.OffscreenExecutionService({...be,offscreenPromise:this.offscreenPromise});const _e=this.controllerMessenger.getRestricted({name:"SnapController",allowedEvents:["ExecutionService:unhandledError","ExecutionService:outboundRequest","ExecutionService:outboundResponse"],allowedActions:[`${this.permissionController.name}:getEndowments`,`${this.permissionController.name}:getPermissions`,`${this.permissionController.name}:hasPermission`,`${this.permissionController.name}:hasPermissions`,`${this.permissionController.name}:requestPermissions`,`${this.permissionController.name}:revokeAllPermissions`,`${this.permissionController.name}:revokePermissions`,`${this.permissionController.name}:revokePermissionForAllSubjects`,`${this.permissionController.name}:getSubjectNames`,`${this.permissionController.name}:updateCaveat`,`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:updateRequestState`,`${this.permissionController.name}:grantPermissions`,`${this.subjectMetadataController.name}:getSubjectMetadata`,`${this.subjectMetadataController.name}:addSubjectMetadata`,"ExecutionService:executeSnap","ExecutionService:getRpcRequestHandler","ExecutionService:terminateSnap","ExecutionService:terminateAllSnaps","ExecutionService:handleRpcRequest","SnapsRegistry:get","SnapsRegistry:getMetadata","SnapsRegistry:update","SnapsRegistry:resolveVersion","SnapInterfaceController:createInterface","SnapInterfaceController:getInterface"]}),Ee=!0;this.snapController=new G.SnapController({environmentEndowmentPermissions:Object.values(oe.EndowmentPermissions),excludedPermissions:{...oe.ExcludedSnapPermissions,...oe.ExcludedSnapEndowments},closeAllConnections:this.removeAllConnections.bind(this),state:s.SnapController,messenger:_e,featureFlags:{dappsCanUpdateSnaps:!0,allowLocalSnaps:!1,requireAllowlist:Ee},encryptor:(0,ct.encryptorFactory)(6e5),getMnemonic:this.getPrimaryKeyringMnemonic.bind(this),preinstalledSnaps:ht.default,getFeatureFlags:()=>({disableSnaps:!1===this.preferencesController.store.getState().useExternalServices})}),this.notificationController=new D.NotificationController({messenger:this.controllerMessenger.getRestricted({name:"NotificationController"}),state:s.NotificationController}),this.rateLimitController=new F.RateLimitController({state:s.RateLimitController,messenger:this.controllerMessenger.getRestricted({name:"RateLimitController"}),implementations:{showNativeNotification:{method:(e,t)=>{const r=this.controllerMessenger.call("SubjectMetadataController:getState").subjectMetadata[e];return this.platform._showNotification((null==r?void 0:r.name)??e,t).catch((e=>{v.default.error("Failed to create notification",e)})),null},rateLimitCount:2,rateLimitTimeout:3e5},showInAppNotification:{method:(e,t)=>(this.controllerMessenger.call("NotificationController:show",e,t),null),rateLimitCount:5,rateLimitTimeout:6e4}}});const je=this.controllerMessenger.getRestricted({name:"CronjobController",allowedEvents:["SnapController:snapInstalled","SnapController:snapUpdated","SnapController:snapUninstalled","SnapController:snapEnabled","SnapController:snapDisabled"],allowedActions:[`${this.permissionController.name}:getPermissions`,"SnapController:handleRequest","SnapController:getAll"]});this.cronjobController=new G.CronjobController({state:s.CronjobController,messenger:je});const Re=this.controllerMessenger.getRestricted({name:"SnapsRegistry",allowedEvents:[],allowedActions:[]});this.snapsRegistry=new G.JsonSnapsRegistry({state:s.SnapsRegistry,messenger:Re,refetchOnAllowlistMiss:Ee,url:{registry:"https://acl.execution.metamask.io/latest/registry.json",signature:"https://acl.execution.metamask.io/latest/signature.json"},publicKey:"0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6"});const Oe=this.controllerMessenger.getRestricted({name:"SnapInterfaceController",allowedActions:[`${this.phishingController.name}:maybeUpdateState`,`${this.phishingController.name}:testOrigin`]});this.snapInterfaceController=new G.SnapInterfaceController({state:s.SnapInterfaceController,messenger:Oe}),this.authenticationController=new mt.default({state:s.AuthenticationController,messenger:this.controllerMessenger.getRestricted({name:"AuthenticationController",allowedActions:["KeyringController:getState","SnapController:handleRequest","UserStorageController:disableProfileSyncing"],allowedEvents:["KeyringController:lock","KeyringController:unlock"]}),metametrics:{getMetaMetricsId:()=>this.metaMetricsController.getMetaMetricsId()}}),this.userStorageController=new gt.default({getMetaMetricsState:()=>this.metaMetricsController.state.participateInMetaMetrics,state:s.UserStorageController,messenger:this.controllerMessenger.getRestricted({name:"UserStorageController",allowedActions:["KeyringController:getState","SnapController:handleRequest","AuthenticationController:getBearerToken","AuthenticationController:getSessionProfile","AuthenticationController:isSignedIn","AuthenticationController:performSignOut","AuthenticationController:performSignIn","MetamaskNotificationsController:disableMetamaskNotifications","MetamaskNotificationsController:selectIsMetamaskNotificationsEnabled"],allowedEvents:["KeyringController:lock","KeyringController:unlock"]})});const xe=this.controllerMessenger.getRestricted({name:"PushPlatformNotificationsController",allowedActions:["AuthenticationController:getBearerToken"]});this.pushPlatformNotificationsController=new ft.PushPlatformNotificationsController({state:s.PushPlatformNotificationsController,messenger:xe}),xe.subscribe("PushPlatformNotificationsController:onNewNotifications",(e=>{this.metaMetricsController.trackEvent({category:de.MetaMetricsEventCategory.PushNotifications,event:de.MetaMetricsEventName.NotificationReceived,properties:{notification_channel:"push",notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})})),xe.subscribe("PushPlatformNotificationsController:pushNotificationClicked",(e=>{this.metaMetricsController.trackEvent({category:de.MetaMetricsEventCategory.PushNotifications,event:de.MetaMetricsEventName.NotificationClicked,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id,notification_is_read:e.isRead,click_type:"push_notification"}})})),this.metamaskNotificationsController=new vt.MetamaskNotificationsController({messenger:this.controllerMessenger.getRestricted({name:"MetamaskNotificationsController",allowedActions:["KeyringController:getAccounts","KeyringController:getState","AuthenticationController:getBearerToken","AuthenticationController:isSignedIn","UserStorageController:enableProfileSyncing","UserStorageController:getStorageKey","UserStorageController:performGetStorage","UserStorageController:performSetStorage","PushPlatformNotificationsController:enablePushNotifications","PushPlatformNotificationsController:disablePushNotifications","PushPlatformNotificationsController:updateTriggerPushNotifications"],allowedEvents:["KeyringController:stateChange","KeyringController:lock","KeyringController:unlock","PushPlatformNotificationsController:onNewNotifications"]}),state:s.MetamaskNotificationsController}),this.accountTracker=new Ne.default({provider:this.provider,blockTracker:this.blockTracker,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getNetworkIdentifier:e=>{const{type:t,rpcUrl:r}=e??this.networkController.state.providerConfig;return t===re.NETWORK_TYPES.RPC?r:t},preferencesController:this.preferencesController,onboardingController:this.onboardingController,controllerMessenger:this.controllerMessenger.getRestricted({name:"AccountTracker",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]}),initState:{accounts:{}},onAccountRemoved:this.controllerMessenger.subscribe.bind(this.controllerMessenger,"KeyringController:accountRemoved")}),this.on("controllerConnectionChanged",(e=>{const{completedOnboarding:t}=this.onboardingController.store.getState();e>0&&t?this.triggerNetworkrequests():this.stopNetworkRequests()})),this.onboardingController.store.subscribe((0,Ye.previousValueComparator)((async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n}=t;if(!r&&n){const{address:e}=this.accountsController.getSelectedAccount();this._addAccountsWithBalance(),this.postOnboardingInitialization(),this.triggerNetworkrequests(),await this.tokenDetectionController.detectTokens({selectedAddress:e})}}),this.onboardingController.store.getState()));const Be=this.controllerMessenger.getRestricted({name:"TokenDetectionController",allowedActions:["AccountsController:getSelectedAccount","KeyringController:getState","NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getState","PreferencesController:getState","TokenListController:getState","TokensController:getState","TokensController:addDetectedTokens"],allowedEvents:["AccountsController:selectedAccountChange","KeyringController:lock","KeyringController:unlock","NetworkController:networkDidChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokenDetectionController=new i.TokenDetectionController({messenger:Be,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.addressBookController=new M.AddressBookController(undefined,s.AddressBookController),this.alertController=new We.default({initState:s.AlertController,preferencesStore:this.preferencesController.store,controllerMessenger:this.controllerMessenger.getRestricted({name:"AlertController",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]})}),this.backup=new Ke.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,accountsController:this.accountsController,networkController:this.networkController,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.snapAndHardwareMetricsParams={getSelectedAccount:this.accountsController.getSelectedAccount.bind(this.accountsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]})};const Fe=this.controllerMessenger.getRestricted({name:"TransactionController",allowedActions:[`${this.approvalController.name}:addRequest`,"NetworkController:findNetworkClientIdByChainId","NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]});this.txController=new Y.TransactionController({blockTracker:this.blockTracker,getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),getExternalPendingTransactions:this.getExternalPendingTransactions.bind(this),getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getNetworkClientRegistry:this.networkController.getNetworkClientRegistry.bind(this.networkController),getNetworkState:()=>this.networkController.state,getPermittedAccounts:this.getPermittedAccounts.bind(this),getSavedGasFees:()=>this.preferencesController.store.getState().advancedGasFee[this.networkController.state.providerConfig.chainId],getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,incomingTransactions:{includeTokenTransfers:!1,isEnabled:()=>{var e;return Boolean((null===(e=this.preferencesController.store.getState().incomingTransactionsPreferences)||void 0===e?void 0:e[this.networkController.state.providerConfig.chainId])&&this.onboardingController.store.getState().completedOnboarding)},queryEntireHistory:!1,updateTransactions:!1},isMultichainEnabled:"",isSimulationEnabled:()=>this.preferencesController.store.getState().useTransactionSimulations,messenger:Fe,onNetworkStateChange:e=>{l.subscribe("NetworkController:networkDidChange",(()=>e()))},pendingTransactions:{isResubmitEnabled:()=>{const e=this._getMetaMaskState();return!((0,ye.getSmartTransactionsOptInStatus)(e)&&(0,ye.getCurrentChainSupportsSmartTransactions)(e))}},provider:this.provider,testGasFeeFlows:!1,hooks:{publish:this._publishSmartTransactionHook.bind(this)},sign:(...e)=>this.keyringController.signTransaction(...e),state:s.TransactionController}),this._addTransactionControllerListeners(),this.decryptMessageController=new qe.default({getState:this.getState.bind(this),messenger:this.controllerMessenger.getRestricted({name:"DecryptMessageController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,`${this.keyringController.name}:decryptMessage`]}),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.encryptionPublicKeyController=new et.default({messenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`]}),getEncryptionPublicKey:this.keyringController.getEncryptionPublicKey.bind(this.keyringController),getAccountKeyringType:this.keyringController.getAccountKeyringType.bind(this.keyringController),getState:this.getState.bind(this),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.signatureController=new H.SignatureController({messenger:this.controllerMessenger.getRestricted({name:"SignatureController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.keyringController.name}:signMessage`,`${this.keyringController.name}:signPersonalMessage`,`${this.keyringController.name}:signTypedMessage`,`${this.loggingController.name}:add`]}),isEthSignEnabled:()=>{var e;return null===(e=this.preferencesController.store.getState())||void 0===e||null===(e=e.disabledRpcMethodPreferences)||void 0===e?void 0:e.eth_sign},getAllState:this.getState.bind(this),getCurrentChainId:()=>this.networkController.state.providerConfig.chainId}),this.signatureController.hub.on("cancelWithReason",(({message:e,reason:t})=>{this.metaMetricsController.trackEvent({event:t,category:de.MetaMetricsEventCategory.Transactions,properties:{action:"Sign Request",type:e.type}})})),this.swapsController=new ze.default({getBufferedGasLimit:async(e,t)=>{const{gas:r,simulationFails:n}=await this.txController.estimateGasBuffered(e.txParams,t);return{gasLimit:r,simulationFails:n}},provider:this.provider,getProviderConfig:()=>this.networkController.state.providerConfig,getTokenRatesState:()=>this.tokenRatesController.state,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getLayer1GasFee:this.txController.getLayer1GasFee.bind(this.txController),getNetworkClientId:()=>this.networkController.state.selectedNetworkClientId,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},s.SwapsController),this.smartTransactionsController=new x.default({getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),onNetworkStateChange:l.subscribe.bind(l,"NetworkController:stateChange"),getNonceLock:this.txController.getNonceLock.bind(this.txController),confirmExternalTransaction:this.txController.confirmExternalTransaction.bind(this.txController),getTransactions:this.txController.getTransactions.bind(this.txController),provider:this.provider,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},{supportedChainIds:(0,ne.getAllowedSmartTransactionsChainIds)()},s.SmartTransactionsController);const De=()=>this.preferencesController.store.getState().useExternalNameSources;this.nameController=new V.NameController({messenger:this.controllerMessenger.getRestricted({name:"NameController",allowedActions:[]}),providers:[new V.ENSNameProvider({reverseLookup:this.ensController.reverseResolveAddress.bind(this.ensController)}),new V.EtherscanNameProvider({isEnabled:De}),new V.TokenNameProvider({isEnabled:De}),new V.LensNameProvider({isEnabled:De}),new Te.SnapsNameProvider({messenger:this.controllerMessenger.getRestricted({name:"SnapsNameProvider",allowedActions:["SnapController:getAll","SnapController:get","SnapController:handleRequest","PermissionController:getState"]})})],state:s.NameController});const Je=this.controllerMessenger.getRestricted({name:"PetnamesBridge",allowedEvents:["NameController:stateChange","AccountsController:stateChange"],allowedActions:["AccountsController:listAccounts"]});new Se.AddressBookPetnamesBridge({addressBookController:this.addressBookController,nameController:this.nameController,messenger:Je}).init(),new Me.AccountIdentitiesPetnamesBridge({nameController:this.nameController,messenger:Je}).init(),this.userOperationController=new J.UserOperationController({entrypoint:null,getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),messenger:this.controllerMessenger.getRestricted({name:"UserOperationController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","KeyringController:prepareUserOperation","KeyringController:patchUserOperation","KeyringController:signUserOperation"]}),state:s.UserOperationController}),this.userOperationController.hub.on("user-operation-added",this._onUserOperationAdded.bind(this)),this.userOperationController.hub.on("transaction-updated",this._onUserOperationTransactionUpdated.bind(this)),l.subscribe("NetworkController:networkDidChange",(()=>{this.accountTracker.updateAccounts()})),l.subscribe("NetworkController:networkWillChange",a.bind(this)),this.metamaskMiddleware=(0,Ze.default)({static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${o}`},version:o,getAccounts:async({origin:e},{suppressUnauthorizedError:t=!0}={})=>{if(e===ce.ORIGIN_METAMASK){const e=this.accountsController.getSelectedAccount().address;return e?[e]:[]}return this.isUnlocked()?await this.getPermittedAccounts(e,{suppressUnauthorizedError:t}):[]},processTransaction:(e,t)=>(0,dt.addDappTransaction)(this.getAddTransactionRequest({transactionParams:e,dappRequest:t})),processEthSignMessage:this.signatureController.newUnsignedMessage.bind(this.signatureController),processTypedMessage:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV3:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV4:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processPersonalMessage:this.signatureController.newUnsignedPersonalMessage.bind(this.signatureController),processEncryptionPublicKey:this.encryptionPublicKeyController.newRequestEncryptionPublicKey.bind(this.encryptionPublicKeyController),processDecryptMessage:this.decryptMessageController.newRequestDecryptMessage.bind(this.decryptMessageController),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.state.transactions.find((t=>t.hash===e&&t.status===Y.TransactionStatus.submitted))}),this.on("update",(e=>this._onStateUpdate(e)));const nt={AccountTracker:this.accountTracker.store,TokenRatesController:this.tokenRatesController,DecryptMessageController:this.decryptMessageController,EncryptionPublicKeyController:this.encryptionPublicKeyController,SignatureController:this.signatureController,SwapsController:this.swapsController.store,EnsController:this.ensController,ApprovalController:this.approvalController,PPOMController:this.ppomController};this.store.updateStructure({AccountsController:this.accountsController,AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,TransactionController:this.txController,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,NetworkController:this.networkController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,PhishingController:this.phishingController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,SnapInterfaceController:this.snapInterfaceController,PPOMController:this.ppomController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,MetamaskNotificationsController:this.metamaskNotificationsController,PushPlatformNotificationsController:this.pushPlatformNotificationsController,...nt}),this.memStore=new Ie.default({config:{AccountsController:this.accountsController,AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,NetworkController:this.networkController,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,TxController:this.txController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,SnapInterfaceController:this.snapInterfaceController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,MetamaskNotificationsController:this.metamaskNotificationsController,QueuedRequestController:this.queuedRequestController,PushPlatformNotificationsController:this.pushPlatformNotificationsController,...nt},controllerMessenger:this.controllerMessenger});const it=[this.accountTracker.resetState,this.decryptMessageController.resetState.bind(this.decryptMessageController),this.encryptionPublicKeyController.resetState.bind(this.encryptionPublicKeyController),this.signatureController.resetState.bind(this.signatureController),this.swapsController.resetState,this.ensController.resetState.bind(this.ensController),this.approvalController.clear.bind(this.approvalController)];ve.isManifestV3?!0===n&&(this.resetStates(it),this.extension.storage.session.set({isFirstMetaMaskControllerSetup:!1})):this.resetStates(it);!this.isUnlocked()&&this.onboardingController.store.getState().completedOnboarding,this._startUISync(),this.extension.runtime.getPlatformInfo().then((({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")})),this.setupControllerEventSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener(Pe.onMessageReceived),(0,Pe.checkForMultipleVersionsRunning)(),this.onboardingController.store.getState().completedOnboarding&&this.postOnboardingInitialization()}postOnboardingInitialization(){const{usePhishDetect:e}=this.preferencesController.store.getState();this.networkController.lookupNetwork(),e&&this.phishingController.maybeUpdateState()}triggerNetworkrequests(){this.accountTracker.start(),this.txController.startIncomingTransactionPolling(),this.tokenDetectionController.enable();const e=this.preferencesController.store.getState(),{useCurrencyRateCheck:t,useNftDetection:r}=e;r&&this.nftDetectionController.start(),t&&this.tokenRatesController.start(),Tt(this,Et,Nt).call(this,e)&&this.tokenListController.start()}stopNetworkRequests(){this.accountTracker.stop(),this.txController.stopIncomingTransactionPolling(),this.tokenDetectionController.disable(),this.nftDetectionController.stop();const e=this.preferencesController.store.getState(),{useCurrencyRateCheck:t}=e;t&&this.tokenRatesController.stop(),Tt(this,Et,Nt).call(this,e)&&this.tokenListController.stop()}resetStates(e){e.forEach((e=>{try{e()}catch(e){console.error(e)}}))}async getSnapKeyring(){let[e]=this.keyringController.getKeyringsByType(ie.KeyringType.snap);return e||(e=await this.keyringController.addNewKeyring(ie.KeyringType.snap)),e}trackInsightSnapView(e){this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.InsightSnapViewed,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:e}})}_getSnapMetadata(e){var t;return null===(t=this.snapsRegistry.state.database)||void 0===t||null===(t=t.verifiedSnaps)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.metadata}async handleSnapRequest(e){try{const t=await this.controllerMessenger.call("SnapController:handleRequest",e);return this._trackSnapExportUsage(e.snapId,e.handler,!0,e.origin),t}catch(t){throw this._trackSnapExportUsage(e.snapId,e.handler,!1,e.origin),t}}getLocale(){const{currentLocale:e}=this.preferencesController.store.getState();return e}getSnapPermissionSpecifications(){return{...(0,$.buildSnapEndowmentSpecifications)(Object.keys(oe.ExcludedSnapEndowments)),...(0,$.buildSnapRestrictedMethodSpecifications)(Object.keys(oe.ExcludedSnapPermissions),{getLocale:this.getLocale.bind(this),clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState"),getMnemonic:this.getPrimaryKeyringMnemonic.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.handleSnapRequest.bind(this),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState"),showDialog:(e,t,r,n)=>this.approvalController.addAndShowApprovalRequest({origin:e,type:ce.SNAP_DIALOG_TYPES[t],requestData:{id:r,placeholder:n}}),showNativeNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showNativeNotification",e,t.message),showInAppNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showInAppNotification",e,t.message),updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:e}=this.preferencesController.store.getState();e&&this.controllerMessenger.call("PhishingController:maybeUpdateState")},isOnPhishingList:e=>{const{usePhishDetect:t}=this.preferencesController.store.getState();return!!t&&this.controllerMessenger.call("PhishingController:testOrigin",e).result},createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface"),getInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:getInterface"),getSnapKeyring:this.getSnapKeyring.bind(this)})}}dismissNotifications(e){this.notificationController.dismiss(e)}markNotificationsAsRead(e){this.notificationController.markRead(e)}setupControllerEventSubscriptions(){let e;this.preferencesController.store.subscribe((0,Ye.previousValueComparator)(((e,t)=>{Tt(this,St,Pt).call(this,t,e)}),this.preferencesController.store.getState())),this.controllerMessenger.subscribe(`${this.accountsController.name}:selectedAccountChange`,(async t=>{t.address&&t.address!==e&&(e=t.address,await this._onAccountChange(t.address))})),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(e,t)=>{const r=(0,rt.getChangedAccounts)(e,t);for(const[e,t]of r.entries())this._notifyAccountsChange(e,t)}),rt.getPermittedAccountsByOrigin),this.controllerMessenger.subscribe("NetworkController:networkDidChange",(async()=>{await this.txController.updateIncomingTransactions()})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallStarted`,((e,t,r)=>{var n;const s=null===(n=this._getSnapMetadata(e))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:r?de.MetaMetricsEventName.SnapUpdateStarted:de.MetaMetricsEventName.SnapInstallStarted,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallFailed`,((e,t,r,n)=>{var s;const i=n.includes("User rejected the request."),o=r?de.MetaMetricsEventName.SnapUpdateFailed:de.MetaMetricsEventName.SnapInstallFailed,a=r?de.MetaMetricsEventName.SnapUpdateRejected:de.MetaMetricsEventName.SnapInstallRejected,l=null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category;this.metaMetricsController.trackEvent({event:i?a:o,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:l}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstalled`,((e,t)=>{var r;const n=e.id,s=null===(r=this._getSnapMetadata(n))||void 0===r?void 0:r.category;this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.SnapInstalled,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:n,version:e.version,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUpdated`,((e,t,r)=>{var n;const s=e.id,i=null===(n=this._getSnapMetadata(s))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.SnapUpdated,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:s,old_version:t,new_version:e.version,origin:r,snap_category:i}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapTerminated`,(e=>{const t=Object.values(this.approvalController.state.pendingApprovals).filter((t=>t.origin===e.id&&t.type.startsWith(oe.RestrictedMethods.snap_dialog)));for(const e of t)this.approvalController.reject(e.id,new Error("Snap was terminated."))})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUninstalled`,(e=>{var t;const r=Object.values(this.notificationController.state.notifications).reduce(((t,r)=>(r.origin===e.id&&t.push(r.id),t)),[]);this.dismissNotifications(r);const n=e.id,s=null===(t=this._getSnapMetadata(n))||void 0===t?void 0:t.category;this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.SnapUninstalled,category:de.MetaMetricsEventCategory.Snaps,properties:{snap_id:n,version:e.version,snap_category:s}})}))}createPublicConfigStore(){const e=new o.ObservableStore,t=async({isUnlocked:e})=>{const{chainId:t,networkVersion:r}=await this.getProviderNetworkState();return{isUnlocked:e,chainId:t,networkVersion:r??"loading"}},r=async r=>{var n;(null===(n=r.networksMetadata[r.selectedNetworkClientId])||void 0===n?void 0:n.status)===re.NetworkStatus.Available&&e.putState(await t(r))};return this.on("update",r),r(this.getState()),e}async getProviderState(e){const t=await this.getProviderNetworkState(this.preferencesController.getUseRequestQueue()?e:undefined);return{isUnlocked:this.isUnlocked(),accounts:await this.getPermittedAccounts(e),...t}}async getProviderNetworkState(e=B.METAMASK_DOMAIN){const t=this.controllerMessenger.call("SelectedNetworkController:getNetworkClientIdForDomain",e),r=this.controllerMessenger.call("NetworkController:getNetworkClientById",t),{chainId:n}=r.configuration,{completedOnboarding:s}=this.onboardingController.store.getState();let i=this.deprecatedNetworkVersions[t];if(!i&&s){const e=new b.default(r.provider);i=await new Promise((t=>{e.sendAsync({method:"net_version"},((e,r)=>{e?(console.error(e),t(null)):t((0,we.convertNetworkId)(r))}))})),this.deprecatedNetworkVersions[t]=i}return{chainId:n,networkVersion:i??"loading"}}getState(){const{vault:e}=this.keyringController.state,t=Boolean(e),r=this.memStore.getFlatState();return delete r.vault,{isInitialized:t,...r,snapStates:{},unencryptedSnapStates:{},snaps:Object.values(r.snaps??{}).reduce(((e,t)=>{const{sourceCode:r,auxiliaryFiles:n,...s}=t;return e[t.id]=s,e}),{})}}getApi(){const{accountsController:e,addressBookController:t,alertController:r,appStateController:n,keyringController:s,nftController:i,nftDetectionController:o,currencyRateController:a,tokenDetectionController:l,ensController:c,gasFeeController:d,metaMetricsController:u,networkController:h,announcementController:p,onboardingController:m,appMetadataController:g,permissionController:f,preferencesController:v,swapsController:w,tokensController:y,smartTransactionsController:k,txController:C,assetsContractController:b,backup:_,approvalController:T,phishingController:S,authenticationController:M,userStorageController:E,metamaskNotificationsController:A,pushPlatformNotificationsController:P}=this;return{getState:this.getState.bind(this),setCurrentCurrency:a.setCurrentCurrency.bind(a),setUseBlockie:v.setUseBlockie.bind(v),setUseNonceField:v.setUseNonceField.bind(v),setUsePhishDetect:v.setUsePhishDetect.bind(v),setUseMultiAccountBalanceChecker:v.setUseMultiAccountBalanceChecker.bind(v),dismissOpenSeaToBlockaidBanner:v.dismissOpenSeaToBlockaidBanner.bind(v),setUseSafeChainsListValidation:v.setUseSafeChainsListValidation.bind(v),setUseTokenDetection:v.setUseTokenDetection.bind(v),setUseNftDetection:v.setUseNftDetection.bind(v),setUse4ByteResolution:v.setUse4ByteResolution.bind(v),setUseCurrencyRateCheck:v.setUseCurrencyRateCheck.bind(v),setOpenSeaEnabled:v.setOpenSeaEnabled.bind(v),getUseRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController),getProviderConfig:()=>this.networkController.state.providerConfig,setSecurityAlertsEnabled:v.setSecurityAlertsEnabled.bind(v),setAddSnapAccountEnabled:v.setAddSnapAccountEnabled.bind(v),setUseExternalNameSources:v.setUseExternalNameSources.bind(v),setUseTransactionSimulations:v.setUseTransactionSimulations.bind(v),setUseRequestQueue:this.setUseRequestQueue.bind(this),setIpfsGateway:v.setIpfsGateway.bind(v),setIsIpfsGatewayEnabled:v.setIsIpfsGatewayEnabled.bind(v),setUseAddressBarEnsResolution:v.setUseAddressBarEnsResolution.bind(v),setParticipateInMetaMetrics:u.setParticipateInMetaMetrics.bind(u),setDataCollectionForMarketing:u.setDataCollectionForMarketing.bind(u),setCurrentLocale:v.setCurrentLocale.bind(v),setIncomingTransactionsPreferences:v.setIncomingTransactionsPreferences.bind(v),setServiceWorkerKeepAlivePreference:v.setServiceWorkerKeepAlivePreference.bind(v),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),requestUserApproval:T.addAndShowApprovalRequest.bind(T),addNewAccount:this.addNewAccount.bind(this),getSeedPhrase:this.getSeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),getNextAvailableAccountName:e.getNextAvailableAccountName.bind(e),getAccountsBySnapId:e=>(0,lt.getAccountsBySnapId)(this,e),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),submitQRHardwareCryptoHDKey:s.submitQRCryptoHDKey.bind(s),submitQRHardwareCryptoAccount:s.submitQRCryptoAccount.bind(s),cancelSyncQRHardware:s.cancelQRSynchronization.bind(s),submitQRHardwareSignature:s.submitQRSignature.bind(s),cancelQRHardwareSignRequest:s.cancelQRSignRequest.bind(s),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setProviderType:e=>this.networkController.setProviderType(e),setActiveNetwork:e=>this.networkController.setActiveNetwork(e),setActiveNetworkConfigurationId:e=>{this.networkController.setActiveNetwork(e)},setNetworkClientIdForDomain:(e,t)=>this.selectedNetworkController.setNetworkClientIdForDomain(e,t),rollbackToPreviousProvider:h.rollbackToPreviousProvider.bind(h),removeNetworkConfiguration:this.removeNetworkConfiguration.bind(this),upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getNetworkConfigurationByNetworkClientId:this.networkController.getNetworkConfigurationByNetworkClientId.bind(this.networkController),setSelectedAddress:e=>{const t=this.accountsController.getAccountByAddress(e);if(!t)throw new Error(`No account found for address: ${e}`);this.accountsController.setSelectedAccount(t.id)},toggleExternalServices:this.toggleExternalServices.bind(this),addToken:y.addToken.bind(y),updateTokenType:y.updateTokenType.bind(y),setFeatureFlag:v.setFeatureFlag.bind(v),setPreference:v.setPreference.bind(v),addKnownMethodData:v.addKnownMethodData.bind(v),setDismissSeedBackUpReminder:v.setDismissSeedBackUpReminder.bind(v),setDisabledRpcMethodPreference:v.setDisabledRpcMethodPreference.bind(v),getRpcMethodPreferences:v.getRpcMethodPreferences.bind(v),setAdvancedGasFee:v.setAdvancedGasFee.bind(v),setTheme:v.setTheme.bind(v),setSnapsAddSnapAccountModalDismissed:v.setSnapsAddSnapAccountModalDismissed.bind(v),setSelectedInternalAccount:e=>{this.accountsController.getAccount(e)&&this.accountsController.setSelectedAccount(e)},setAccountName:e.setAccountName.bind(e),setAccountLabel:(e,t)=>{this.preferencesController.setAccountLabel(e,t);const r=this.accountsController.getAccountByAddress(e);if(r===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setAccountName(r.id,t)},getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTokenSymbol:this.getTokenSymbol.bind(this),addNft:i.addNft.bind(i),addNftVerifyOwnership:i.addNftVerifyOwnership.bind(i),removeAndIgnoreNft:i.removeAndIgnoreNft.bind(i),removeNft:i.removeNft.bind(i),checkAndUpdateAllNftsOwnershipStatus:i.checkAndUpdateAllNftsOwnershipStatus.bind(i),checkAndUpdateSingleNftOwnershipStatus:i.checkAndUpdateSingleNftOwnershipStatus.bind(i),isNftOwner:i.isNftOwner.bind(i),setAddressBook:t.set.bind(t),removeFromAddressBook:t.delete.bind(t),setLastActiveTime:n.setLastActiveTime.bind(n),setCurrentExtensionPopupId:n.setCurrentExtensionPopupId.bind(n),setDefaultHomeActiveTabName:n.setDefaultHomeActiveTabName.bind(n),setConnectedStatusPopoverHasBeenShown:n.setConnectedStatusPopoverHasBeenShown.bind(n),setRecoveryPhraseReminderHasBeenShown:n.setRecoveryPhraseReminderHasBeenShown.bind(n),setRecoveryPhraseReminderLastShown:n.setRecoveryPhraseReminderLastShown.bind(n),setTermsOfUseLastAgreed:n.setTermsOfUseLastAgreed.bind(n),setSurveyLinkLastClickedOrClosed:n.setSurveyLinkLastClickedOrClosed.bind(n),setOnboardingDate:n.setOnboardingDate.bind(n),setNewPrivacyPolicyToastClickedOrClosed:n.setNewPrivacyPolicyToastClickedOrClosed.bind(n),setNewPrivacyPolicyToastShownDate:n.setNewPrivacyPolicyToastShownDate.bind(n),setSnapsInstallPrivacyWarningShownStatus:n.setSnapsInstallPrivacyWarningShownStatus.bind(n),setOutdatedBrowserWarningLastShown:n.setOutdatedBrowserWarningLastShown.bind(n),setShowTestnetMessageInDropdown:n.setShowTestnetMessageInDropdown.bind(n),setShowBetaHeader:n.setShowBetaHeader.bind(n),setShowPermissionsTour:n.setShowPermissionsTour.bind(n),setShowAccountBanner:n.setShowAccountBanner.bind(n),setShowNetworkBanner:n.setShowNetworkBanner.bind(n),updateNftDropDownState:n.updateNftDropDownState.bind(n),setFirstTimeUsedNetwork:n.setFirstTimeUsedNetwork.bind(n),setSwitchedNetworkDetails:n.setSwitchedNetworkDetails.bind(n),clearSwitchedNetworkDetails:n.clearSwitchedNetworkDetails.bind(n),setSwitchedNetworkNeverShowMessage:n.setSwitchedNetworkNeverShowMessage.bind(n),tryReverseResolveAddress:c.reverseResolveAddress.bind(c),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),exportAccount:this.exportAccount.bind(this),updateTransaction:C.updateTransaction.bind(C),approveTransactionsWithSameNonce:C.approveTransactionsWithSameNonce.bind(C),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),getNextNonce:this.getNextNonce.bind(this),addTransaction:(e,t)=>(0,dt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!1})),addTransactionAndWaitForPublish:(e,t)=>(0,dt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!0})),createTransactionEventFragment:Ce.createTransactionEventFragmentWithTxId.bind(null,this.getTransactionMetricsRequest()),getTransactions:this.txController.getTransactions.bind(this.txController),updateEditableParams:this.txController.updateEditableParams.bind(this.txController),updateTransactionGasFees:C.updateTransactionGasFees.bind(C),updateTransactionSendFlowHistory:C.updateTransactionSendFlowHistory.bind(C),updatePreviousGasParams:C.updatePreviousGasParams.bind(C),abortTransactionSigning:C.abortTransactionSigning.bind(C),getLayer1GasFee:C.getLayer1GasFee.bind(C),decryptMessage:this.decryptMessageController.decryptMessage.bind(this.decryptMessageController),decryptMessageInline:this.decryptMessageController.decryptMessageInline.bind(this.decryptMessageController),cancelDecryptMessage:this.decryptMessageController.cancelDecryptMessage.bind(this.decryptMessageController),encryptionPublicKey:this.encryptionPublicKeyController.encryptionPublicKey.bind(this.encryptionPublicKeyController),cancelEncryptionPublicKey:this.encryptionPublicKeyController.cancelEncryptionPublicKey.bind(this.encryptionPublicKeyController),setShowTokenAutodetectModalOnUpgrade:g.setShowTokenAutodetectModalOnUpgrade.bind(g),setSeedPhraseBackedUp:m.setSeedPhraseBackedUp.bind(m),completeOnboarding:m.completeOnboarding.bind(m),setFirstTimeFlowType:m.setFirstTimeFlowType.bind(m),setAlertEnabledness:r.setAlertEnabledness.bind(r),setUnconnectedAccountAlertShown:r.setUnconnectedAccountAlertShown.bind(r),setWeb3ShimUsageAlertDismissed:r.setWeb3ShimUsageAlertDismissed.bind(r),removePermissionsFor:this.removePermissionsFor,approvePermissionsRequest:this.acceptPermissionsRequest,rejectPermissionsRequest:this.rejectPermissionsRequest,...(0,rt.getPermissionBackgroundApiMethods)(f),disableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disable"),enableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:enable"),updateSnap:(e,t)=>(this.controllerMessenger.call("SnapController:install",e,t),null),removeSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:remove"),handleSnapRequest:this.handleSnapRequest.bind(this),revokeDynamicSnapPermissions:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:revokeDynamicPermissions"),dismissNotifications:this.dismissNotifications.bind(this),markNotificationsAsRead:this.markNotificationsAsRead.bind(this),disconnectOriginFromSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disconnectOrigin"),updateNetworksList:this.updateNetworksList.bind(this),updateAccountsList:this.updateAccountsList.bind(this),updateHiddenAccountsList:this.updateHiddenAccountsList.bind(this),getPhishingResult:async e=>(await S.maybeUpdateState(),S.test(e)),deleteInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:deleteInterface"),updateInterfaceState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterfaceState"),fetchAndSetQuotes:w.fetchAndSetQuotes.bind(w),setSelectedQuoteAggId:w.setSelectedQuoteAggId.bind(w),resetSwapsState:w.resetSwapsState.bind(w),setSwapsTokens:w.setSwapsTokens.bind(w),clearSwapsQuotes:w.clearSwapsQuotes.bind(w),setApproveTxId:w.setApproveTxId.bind(w),setTradeTxId:w.setTradeTxId.bind(w),setSwapsTxGasPrice:w.setSwapsTxGasPrice.bind(w),setSwapsTxGasLimit:w.setSwapsTxGasLimit.bind(w),setSwapsTxMaxFeePerGas:w.setSwapsTxMaxFeePerGas.bind(w),setSwapsTxMaxFeePriorityPerGas:w.setSwapsTxMaxFeePriorityPerGas.bind(w),safeRefetchQuotes:w.safeRefetchQuotes.bind(w),stopPollingForQuotes:w.stopPollingForQuotes.bind(w),setBackgroundSwapRouteState:w.setBackgroundSwapRouteState.bind(w),resetPostFetchState:w.resetPostFetchState.bind(w),setSwapsErrorKey:w.setSwapsErrorKey.bind(w),setInitialGasEstimate:w.setInitialGasEstimate.bind(w),setCustomApproveTxData:w.setCustomApproveTxData.bind(w),setSwapsLiveness:w.setSwapsLiveness.bind(w),setSwapsFeatureFlags:w.setSwapsFeatureFlags.bind(w),setSwapsUserFeeLevel:w.setSwapsUserFeeLevel.bind(w),setSwapsQuotesPollingLimitEnabled:w.setSwapsQuotesPollingLimitEnabled.bind(w),fetchSmartTransactionFees:k.getFees.bind(k),clearSmartTransactionFees:k.clearFees.bind(k),submitSignedTransactions:k.submitSignedTransactions.bind(k),cancelSmartTransaction:k.cancelSmartTransaction.bind(k),fetchSmartTransactionsLiveness:k.fetchLiveness.bind(k),updateSmartTransaction:k.updateSmartTransaction.bind(k),setStatusRefreshInterval:k.setStatusRefreshInterval.bind(k),trackMetaMetricsEvent:u.trackEvent.bind(u),trackMetaMetricsPage:u.trackPage.bind(u),createEventFragment:u.createEventFragment.bind(u),updateEventFragment:u.updateEventFragment.bind(u),finalizeEventFragment:u.finalizeEventFragment.bind(u),trackInsightSnapView:this.trackInsightSnapView.bind(this),resolvePendingApproval:this.resolvePendingApproval,rejectPendingApproval:this.rejectPendingApproval,resetViewedNotifications:p.resetViewed.bind(p),updateViewedNotifications:p.updateViewed.bind(p),currencyRateStartPollingByNetworkClientId:a.startPollingByNetworkClientId.bind(a),currencyRateStopPollingByPollingToken:a.stopPollingByPollingToken.bind(a),gasFeeStartPollingByNetworkClientId:d.startPollingByNetworkClientId.bind(d),gasFeeStopPollingByPollingToken:d.stopPollingByPollingToken.bind(d),getGasFeeTimeEstimate:d.getTimeEstimate.bind(d),addPollingTokenToAppState:n.addPollingToken.bind(n),removePollingTokenFromAppState:n.removePollingToken.bind(n),backupUserData:_.backupUserData.bind(_),restoreUserData:_.restoreUserData.bind(_),detectTokens:l.detectTokens.bind(l),detectNfts:o.detectNfts.bind(o),addDetectedTokens:y.addDetectedTokens.bind(y),addImportedTokens:y.addTokens.bind(y),ignoreTokens:y.ignoreTokens.bind(y),getBalancesInSingleCall:b.getBalancesInSingleCall.bind(b),performSignIn:M.performSignIn.bind(M),performSignOut:M.performSignOut.bind(M),enableProfileSyncing:E.enableProfileSyncing.bind(E),disableProfileSyncing:E.disableProfileSyncing.bind(E),setIsProfileSyncingEnabled:E.setIsProfileSyncingEnabled.bind(E),checkAccountsPresence:A.checkAccountsPresence.bind(A),createOnChainTriggers:A.createOnChainTriggers.bind(A),deleteOnChainTriggersByAccount:A.deleteOnChainTriggersByAccount.bind(A),updateOnChainTriggersByAccount:A.updateOnChainTriggersByAccount.bind(A),fetchAndUpdateMetamaskNotifications:A.fetchAndUpdateMetamaskNotifications.bind(A),markMetamaskNotificationsAsRead:A.markMetamaskNotificationsAsRead.bind(A),setFeatureAnnouncementsEnabled:A.setFeatureAnnouncementsEnabled.bind(A),enablePushNotifications:P.enablePushNotifications.bind(P),disablePushNotifications:P.disablePushNotifications.bind(P),updateTriggerPushNotifications:P.updateTriggerPushNotifications.bind(P),enableMetamaskNotifications:A.enableMetamaskNotifications.bind(A),disableMetamaskNotifications:A.disableMetamaskNotifications.bind(A),throwTestError:this.throwTestError.bind(this),updateProposedNames:this.nameController.updateProposedNames.bind(this.nameController),setName:this.nameController.setName.bind(this.nameController)}}async exportAccount(e,t){return await this.verifyPassword(t),this.keyringController.exportAccount(t,e)}async getTokenStandardAndDetails(e,t,r){var n,s;const{tokenList:i}=this.tokenListController.state,{tokens:o}=this.tokensController.state,a={...ge.STATIC_MAINNET_TOKEN_LIST[e.toLowerCase()]||{},...i[e.toLowerCase()]||{},...o.find((({address:t})=>(0,pe.isEqualCaseInsensitive)(t,e)))||{}},l=(0,pe.isEqualCaseInsensitive)(a.standard,ee.TokenStandard.ERC20)||!0===a.erc20,c=!(r||(0,pe.isEqualCaseInsensitive)(a.standard,ee.TokenStandard.ERC1155)||(0,pe.isEqualCaseInsensitive)(a.standard,ee.TokenStandard.ERC721)||a.erc721),d=a.decimals!==undefined&&a.symbol;let u;if(l||c&&d)try{const r=t?await(0,he.fetchTokenBalance)(e,t,this.provider):undefined;u={address:e,balance:r,standard:ee.TokenStandard.ERC20,decimals:a.decimals,symbol:a.symbol}}catch(e){v.default.warn(`Failed to get token balance. Error: ${e}`)}u===undefined&&(u=await this.assetsContractController.getTokenStandardAndDetails(e,t,r));if((0,pe.isEqualCaseInsensitive)(u.standard,ee.TokenStandard.ERC1155))try{const n=await(0,he.fetchERC1155Balance)(e,t,r,this.provider),s=null!=n&&n._hex?parseInt(n._hex,16).toString():null;u={...u,balance:s}}catch(e){v.default.warn("Failed to get token balance. Error:",e)}return{...u,decimals:null===(n=u)||void 0===n||null===(n=n.decimals)||void 0===n?void 0:n.toString(10),balance:null===(s=u)||void 0===s||null===(s=s.balance)||void 0===s?void 0:s.toString(10)}}async getTokenSymbol(e){try{const t=await this.assetsContractController.getTokenStandardAndDetails(e);return null==t?void 0:t.symbol}catch(e){return null}}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{return await this.keyringController.createNewVaultAndKeychain(e)}finally{t()}}async createNewVaultAndRestore(e,r){const n=await this.createVaultMutex.acquire();try{const{completedOnboarding:n}=this.onboardingController.store.getState(),s=t.from(r);this.permissionController.clearState(),this.snapController.clearState(),this.notificationController.clear(),this.accountTracker.clearAccounts(),this.txController.clearUnapprovedTransactions(),n&&this.tokenDetectionController.enable();const i=await this.keyringController.createNewVaultAndRestore(e,this._convertMnemonicToWordlistIndices(s));return n&&(await this._addAccountsWithBalance(),this.setLedgerTransportPreference()),i}finally{n()}}async _addAccountsWithBalance(){const{chainId:e}=this.networkController.state.providerConfig,t=new b.default(this.provider),r=await this.keyringController.getAccounts();let n=r[r.length-1];for(let o=r.length;;o++){if("0x0"===await this.getBalance(n,t)){var s,i;await this.tokenDetectionController.detectTokens({selectedAddress:n});const t=null===(s=this.tokensController.state.allTokens)||void 0===s||null===(s=s[e])||void 0===s?void 0:s[n],r=null===(i=this.tokensController.state.allDetectedTokens)||void 0===i||null===(i=i[e])||void 0===i?void 0:i[n];if(0===((null==t?void 0:t.length)??0)&&0===((null==r?void 0:r.length)??0)){1!==o&&await this.removeAccount(n);break}}({addedAccountAddress:n}=await this.keyringController.addNewAccount(o))}}_convertMnemonicToWordlistIndices(e){const t=e.toString().split(" ").map((e=>z.wordlist.indexOf(e)));return new Uint8Array(new Uint16Array(t).buffer)}_convertEnglishWordlistIndicesToCodepoints(e){return t.from(Array.from(new Uint16Array(e.buffer)).map((e=>z.wordlist[e])).join(" "))}getBalance(e,t){return new Promise(((r,n)=>{const s=this.accountTracker.store.getState().accounts[e];s&&s.balance?r(s.balance):t.getBalance(e,((e,t)=>{e?(n(e),v.default.error(e)):r(t||"0x0")}))}))}async submitPassword(e){const{completedOnboarding:t}=this.onboardingController.store.getState();await this.offscreenPromise,await this.keyringController.submitPassword(e);try{await this.blockTracker.checkForLatestBlock()}catch(e){v.default.error("Error while unlocking extension.",e)}await this.accountsController.updateAccounts(),t&&this.setLedgerTransportPreference()}async _loginUser(e){try{await this.submitPassword(e),await this.accountTracker.updateAccountsAllActiveNetworks()}finally{this._startUISync()}}_startUISync(){this.emit("startUISync"),this.startUISync=!0,this.memStore.subscribe(this.sendUpdate.bind(this))}async submitEncryptionKey(){try{const{loginToken:e,loginSalt:t}=await this.extension.storage.session.get(["loginToken","loginSalt"]);if(e&&t){const{vault:r}=this.keyringController.state;if(JSON.parse(r).salt!==t)return console.warn("submitEncryptionKey: Stored salt and vault salt do not match"),void await this.clearLoginArtifacts();await this.keyringController.submitEncryptionKey(e,t)}}catch(e){throw await this.clearLoginArtifacts(),e}}async clearLoginArtifacts(){await this.extension.storage.session.remove(["loginToken","loginSalt"])}async verifyPassword(e){await this.keyringController.verifyPassword(e)}getPrimaryKeyringMnemonic(){const[e]=this.keyringController.getKeyringsByType(ie.KeyringType.hdKeyTree);if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}async getKeyringForDevice(e,t=null){var r,n,s,i;const o=null===(r=this.opts.overrides)||void 0===r?void 0:r.keyrings;let a=null;switch(e){case se.HardwareDeviceNames.trezor:a=(null==o||null===(n=o.trezor)||void 0===n?void 0:n.type)||w.TrezorKeyring.type;break;case se.HardwareDeviceNames.ledger:a=(null==o||null===(s=o.ledger)||void 0===s?void 0:s.type)||y.LedgerKeyring.type;break;case se.HardwareDeviceNames.qr:a=C.MetaMaskKeyring.type;break;case se.HardwareDeviceNames.lattice:a=(null==o||null===(i=o.lattice)||void 0===i?void 0:i.type)||k.default.type;break;default:throw new Error("MetamaskController:getKeyringForDevice - Unknown device")}let[l]=await this.keyringController.getKeyringsByType(a);if(l||(l=await this.keyringController.addNewKeyring(a)),t&&l.setHdPath&&l.setHdPath(t),e===se.HardwareDeviceNames.lattice&&(l.appName="MetaMask"),e===se.HardwareDeviceNames.trezor){const e=l.getModel();this.appStateController.setTrezorModel(e)}return l.network=this.networkController.state.providerConfig.type,l}async attemptLedgerTransportCreation(){const e=await this.getKeyringForDevice(se.HardwareDeviceNames.ledger);return await e.attemptMakeApp()}async connectHardware(e,t,r){const n=await this.getKeyringForDevice(e,r);e===se.HardwareDeviceNames.ledger&&await this.setLedgerTransportPreference(n);let s=[];switch(t){case-1:s=await n.getPreviousPage();break;case 1:s=await n.getNextPage();break;default:s=await n.getFirstPage()}const i=await this.keyringController.getAccounts(),o=[...new Set(i.concat(s.map((e=>e.address.toLowerCase()))))];return this.accountTracker.syncWithAddresses(o),s}async checkHardwareStatus(e,t){return(await this.getKeyringForDevice(e,t)).isUnlocked()}async forgetDevice(e){const t=await this.getKeyringForDevice(e);for(const e of t.accounts)await this.removeAccount(e);return t.forgetDevice(),!0}async getAccountType(e){switch(await this.keyringController.getAccountKeyringType(e)){case ie.KeyringType.trezor:case ie.KeyringType.lattice:case ie.KeyringType.qr:case ie.KeyringType.ledger:return"hardware";case ie.KeyringType.imported:return"imported";case ie.KeyringType.snap:return"snap";default:return"MetaMask"}}async getDeviceModel(e){const t=await this.keyringController.getKeyringForAccount(e);switch(t.type){case ie.KeyringType.trezor:return t.getModel();case ie.KeyringType.qr:return t.getName();case ie.KeyringType.ledger:return se.HardwareDeviceNames.ledger;case ie.KeyringType.lattice:return se.HardwareDeviceNames.lattice;default:return undefined}}getAccountLabel(e,t,r){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${r||""}`.trim()}async unlockHardwareWalletAccount(e,t,r,n){const s=await this.getKeyringForDevice(t,r);s.setAccountToUnlock(e);const i=await this.keyringController.getAccounts(),o=await this.keyringController.addNewAccountForKeyring(s);(await this.keyringController.getAccounts()).forEach((r=>{if(!i.includes(r)){const i=this.getAccountLabel(t===se.HardwareDeviceNames.qr?s.getName():t,e,n);this.preferencesController.setAccountLabel(r,i),this.preferencesController.setSelectedAddress(r);const o=this.accountsController.getAccountByAddress(r);this.accountsController.setAccountName(o.id,i)}}));const a=this.accountsController.listAccounts(),{identities:l}=this.preferencesController.store.getState();return{...o,identities:l,accounts:a}}async addNewAccount(e){const t=await this.keyringController.getAccounts(),{addedAccountAddress:r}=await this.keyringController.addNewAccount(e);return t.includes(r)||this.preferencesController.setSelectedAddress(r),r}async getSeedPhrase(e){return this._convertEnglishWordlistIndicesToCodepoints(await this.keyringController.exportSeedPhrase(e))}async resetAccount(){const e=this.accountsController.getSelectedAccount().address;return this.txController.wipeTransactions(!1,e),this.smartTransactionsController.wipeSmartTransactions({address:e,ignoreNetwork:!1}),this.networkController.resetConnection(),e}async getPermittedAccounts(e,{suppressUnauthorizedError:t=!0}={}){try{return await this.permissionController.executeRestrictedMethod(e,oe.RestrictedMethods.eth_accounts)}catch(e){if(t&&e.code===g.errorCodes.provider.unauthorized)return[];throw e}}removeAllChainIdPermissions(e){this.permissionController.updatePermissionsByCaveat(oe.CaveatTypes.restrictNetworkSwitching,(t=>rt.CaveatMutatorFactories[oe.CaveatTypes.restrictNetworkSwitching].removeChainId(e,t)))}removeNetworkConfiguration(e){const{networkConfigurations:t}=this.networkController.state,{chainId:r}=t[e]??{};if(!r)throw new Error("Network configuration not found");Object.values(t).some((t=>t.chainId===r&&t.id!==e&&t.type!==e))||this.removeAllChainIdPermissions(r),this.networkController.removeNetworkConfiguration(e)}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(oe.CaveatTypes.restrictReturnedAccounts,(t=>rt.CaveatMutatorFactories[oe.CaveatTypes.restrictReturnedAccounts].removeAccount(e,t)))}async removeAccount(e){this.removeAllAccountPermissions(e);const t=await this.keyringController.getKeyringForAccount(e);await this.keyringController.removeAccount(e);const r=t?await t.getAccounts():{};var n;0===(null==r?void 0:r.length)&&(null===(n=t.destroy)||void 0===n||n.call(t));return e}async importAccountWithStrategy(e,t){const{importedAccountAddress:r}=await this.keyringController.importAccountWithStrategy(e,t);this.preferencesController.setSelectedAddress(r)}getAddTransactionRequest({transactionParams:e,transactionOptions:t,dappRequest:r}){var n;return{dappRequest:r,networkClientId:(null==r?void 0:r.networkClientId)??this.networkController.state.selectedNetworkClientId,selectedAccount:this.accountsController.getAccountByAddress(e.from),transactionController:this.txController,transactionOptions:t,transactionParams:e,userOperationController:this.userOperationController,chainId:this.networkController.state.providerConfig.chainId,ppomController:this.ppomController,securityAlertsEnabled:null===(n=this.preferencesController.store.getState())||void 0===n?void 0:n.securityAlertsEnabled,updateSecurityAlertResponse:this.updateSecurityAlertResponse.bind(this)}}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,r){await this.txController.stopTransaction(e,t,r);return this.getState()}async createSpeedUpTransaction(e,t,r){await this.txController.speedUpTransaction(e,t,r);return this.getState()}async estimateGas(e){return new Promise(((t,r)=>new _.default(this.provider).estimateGas(e,((e,n)=>e?r(e):t(n.toString(16))))))}async updateSecurityAlertResponse(e,t,r){(0,yt.updateSecurityAlertResponse)({appStateController:this.appStateController,method:e,securityAlertId:t,securityAlertResponse:r,signatureController:this.signatureController,transactionController:this.txController})}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setUseRequestQueue(e){this.preferencesController.setUseRequestQueue(e)}setupUntrustedCommunication({connectionStream:e,sender:t,subjectType:r}){const{completedOnboarding:n}=this.onboardingController.store.getState(),{usePhishDetect:s}=this.preferencesController.store.getState();let i;if(i=r||(t.id&&t.id!==this.extension.runtime.id?O.SubjectType.Extension:O.SubjectType.Website),s&&n&&t.url){const{hostname:r}=new URL(t.url);this.phishingController.maybeUpdateState();const n=this.phishingController.test(r);if(null!=n&&n.result)return this.sendPhishingWarning(e,r),void this.metaMetricsController.trackEvent({event:de.MetaMetricsEventName.PhishingPageDisplayed,category:de.MetaMetricsEventCategory.Phishing,properties:{url:r}})}const o=(0,De.setupMultiplex)(e);this.setupProviderConnection(o.createStream("metamask-provider"),t,i),t.url&&this.setupPublicConfig(o.createStream("publicConfig"))}setupTrustedCommunication(e,t){const r=(0,De.setupMultiplex)(e);this.setupControllerConnection(r.createStream("controller")),this.setupProviderConnection(r.createStream("provider"),t,O.SubjectType.Internal)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.store.getState();if(!t)return;const r=(0,De.setupMultiplex)(e).createStream("metamask-phishing-safelist");r.on("data",(0,Je.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this),backToSafetyPhishingWarning:this.backToSafetyPhishingWarning.bind(this)},r))}sendPhishingWarning(e,t){(0,De.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=this.getApi();this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,Je.default)(t,e));const r=t=>{(0,De.isStreamWritable)(e)&&e.write({jsonrpc:"2.0",method:"sendUpdate",params:[t]})};this.on("update",r);const n=()=>{(0,De.isStreamWritable)(e)&&e.write({jsonrpc:"2.0",method:"startUISync"})};this.startUISync?n():this.once("startUISync",n);const i=()=>{e.mmFinished||(this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.mmFinished=!0,this.removeListener("update",r))};e.mmFinished=!1,(0,s.finished)(e,i),e.once("close",i),e.once("end",i)}setupProviderConnection(e,t,r){let n,i;n=r===O.SubjectType.Internal?ce.ORIGIN_METAMASK:r===O.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:O.SubjectType.Extension}),t.tab&&t.tab.id&&(i=t.tab.id);const o=this.setupProviderEngine({origin:n,sender:t,subjectType:r,tabId:i}),a=(0,je.default)(),l=(0,c.createEngineStream)({engine:o}),d=this.addConnection(n,{engine:o});(0,s.pipeline)(e,a,l,e,(e=>{var t;o._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),d&&this.removeConnection(n,d),!e||null!==(t=e.message)&&void 0!==t&&t.match("Premature close")||v.default.error(e)}))}setupSnapProvider(e,t){this.setupUntrustedCommunication({connectionStream:t,sender:{snapId:e},subjectType:O.SubjectType.Snap})}setupProviderEngine({origin:e,subjectType:t,sender:r,tabId:n}){const s=new l.JsonRpcEngine;s.push((0,xe.default)({origin:e})),s.push((0,B.createSelectedNetworkMiddleware)(this.controllerMessenger));const i=(0,Q.createQueuedRequestMiddleware)({enqueueRequest:this.queuedRequestController.enqueueRequest.bind(this.queuedRequestController),useRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController),shouldEnqueueRequest:e=>("eth_requestAccounts"!==e.method||!this.permissionController.hasPermission(e.origin,rt.PermissionNames.eth_accounts))&&X.methodsWithConfirmation.includes(e.method)});s.push(i);const o=this.selectedNetworkController.getProviderAndBlockTracker(e),a=(0,p.default)(o),c=(0,m.default)(o);c.events.on("notification",(e=>s.emit("notification",e))),n&&s.push((0,Be.default)({tabId:n})),s.push((0,Re.default)({origin:e})),s.push(this.permissionLogController.createMiddleware()),e===ke.BaseUrl.Portfolio&&s.push((0,wt.createTxVerificationMiddleware)(this.networkController)),s.push((0,Ee.createPPOMMiddleware)(this.ppomController,this.preferencesController,this.networkController,this.appStateController,this.updateSecurityAlertResponse.bind(this)));return s.push((0,nt.default)({trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getMetricsState:this.metaMetricsController.store.getState.bind(this.metaMetricsController.store),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),isConfirmationRedesignEnabled:()=>this.preferencesController.store.getState().preferences.redesignedConfirmationsEnabled,snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),appStateController:this.appStateController})),s.push((0,Oe.createUnsupportedMethodMiddleware)()),s.push((0,Oe.createLegacyMethodMiddleware)({getAccounts:this.getPermittedAccounts.bind(this,e)})),t!==O.SubjectType.Internal&&s.push(this.permissionController.createPermissionMiddleware({origin:e})),t===O.SubjectType.Website&&s.push((0,Fe.default)({location:r.url,registerOnboarding:this.onboardingController.registerOnboarding})),s.push((0,Oe.createMethodMiddleware)({origin:e,subjectType:t,addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),metamaskState:this.getState(),getProviderState:this.getProviderState.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),handleWatchAssetRequest:this.handleWatchAssetRequest.bind(this),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),startApprovalFlow:this.approvalController.startFlow.bind(this.approvalController),endApprovalFlow:this.approvalController.endFlow.bind(this.approvalController),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),requestAccountsPermission:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e},{eth_accounts:{}}),requestPermittedChainsPermission:t=>this.permissionController.requestPermissions({origin:e},{[rt.PermissionNames.permittedChains]:{caveats:[rt.CaveatFactories[oe.CaveatTypes.restrictNetworkSwitching](t)]}}),requestPermissionsForOrigin:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e}),revokePermissionsForOrigin:t=>{try{this.permissionController.revokePermissions({[e]:t})}catch(e){console.log(e)}},getCaveat:({target:t,caveatType:r})=>{try{return this.permissionController.getCaveat(e,t,r)}catch(e){if(!(e instanceof O.PermissionDoesNotExistError))throw e}return undefined},getChainPermissionsFeatureFlag:()=>Boolean(""),getCurrentRpcUrl:()=>this.networkController.state.providerConfig.rpcUrl,upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),setActiveNetwork:async t=>{await this.networkController.setActiveNetwork(t),this.permissionController.hasPermission(e,rt.PermissionNames.eth_accounts)&&this.selectedNetworkController.setNetworkClientIdForDomain(e,t)},findNetworkConfigurationBy:this.findNetworkConfigurationBy.bind(this),getCurrentChainIdForDomain:e=>{const t=this.selectedNetworkController.getNetworkClientIdForDomain(e),{chainId:r}=this.networkController.getNetworkConfigurationByNetworkClientId(t);return r},getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController)})),s.push((0,$.createSnapsMethodMiddleware)(t===O.SubjectType.Snap,{getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getPermitted",e),requestPermissions:async t=>await this.permissionController.requestPermissions({origin:e},t),getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getSnapFile:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getFile",e),installSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:install",e),invokeSnap:this.permissionController.executeRestrictedMethod.bind(this.permissionController,e,oe.RestrictedMethods.wallet_snap),getIsLocked:()=>!this.appStateController.isUnlocked(),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),getAllSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getAll"),handleSnapRpcRequest:t=>this.handleSnapRequest({...t,origin:e}),getAllowedKeyringMethods:(0,_e.keyringSnapPermissionsBuilder)(this.subjectMetadataController,e),createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface",e),getInterfaceState:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).state,updateInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterface",e)})),s.push(a),s.push(c.middleware),s.push(this.metamaskMiddleware),s.push((0,d.providerAsMiddleware)(o.provider)),s}setupPublicConfig(e){const t=(0,a.storeAsStream)(this.publicConfigStore);(0,s.pipeline)(t,e,(e=>{var r;t.destroy(),!e||null!==(r=e.message)&&void 0!==r&&r.match("Premature close")||v.default.error(e)}))}addConnection(e,{engine:t}){if(e===ce.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const r=(0,T.default)();return this.connections[e][r]={engine:t},r}removeConnection(e,t){const r=this.connections[e];r&&(delete r[t],0===Object.keys(r).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach((t=>{this.removeConnection(e,t)}))}notifyConnections(e,t){const r=this.connections[e];r&&Object.values(r).forEach((e=>{e.engine&&e.engine.emit("notification",t)}))}notifyAllConnections(e){const t="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach((e=>{Object.values(this.connections[e]).forEach((async r=>{try{r.engine&&r.engine.emit("notification",await t(e))}catch(e){console.error(e)}}))}))}async _onKeyringControllerUpdate(e){const{keyrings:t}=e,r=t.reduce(((e,{accounts:t})=>e.concat(t)),[]);r.length&&this.accountTracker.syncWithAddresses(r)}_onUnlock(){this.notifyAllConnections((async e=>({method:rt.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!0,accounts:await this.getPermittedAccounts(e)}}))),this.unMarkPasswordForgotten(),this.emit("unlock")}_onLock(){this.notifyAllConnections({method:rt.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!1}}),this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this._notifyChainChange()}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.state.isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async getPendingNonce(e,t){const{nonceDetails:r,releaseLock:n}=await this.txController.getNonceLock(e,undefined),s=r.params.highestSuggested;return n(),s}async getNextNonce(e,t){const r=await this.txController.getNonceLock(e,undefined);return r.releaseLock(),r.nextNonce}throwTestError(e){setTimeout((()=>{const t=new Error(e);throw t.name="TestError",t}))}_addTransactionControllerListeners(){const e=this.getTransactionMetricsRequest();this.controllerMessenger.subscribe("TransactionController:postTransactionBalanceUpdated",Ce.handlePostTransactionBalanceUpdate.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:unapprovedTransactionAdded",(t=>(0,Ce.handleTransactionAdded)(e,{transactionMeta:t}))),this.controllerMessenger.subscribe("TransactionController:transactionApproved",Ce.handleTransactionApproved.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionDropped",Ce.handleTransactionDropped.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionConfirmed",Ce.handleTransactionConfirmed.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionFailed",Ce.handleTransactionFailed.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionNewSwap",(({transactionMeta:e})=>this.swapsController.setTradeTxId(e.id))),this.controllerMessenger.subscribe("TransactionController:transactionNewSwapApproval",(({transactionMeta:e})=>this.swapsController.setApproveTxId(e.id))),this.controllerMessenger.subscribe("TransactionController:transactionRejected",Ce.handleTransactionRejected.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionSubmitted",Ce.handleTransactionSubmitted.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionStatusUpdated",(({transactionMeta:e})=>{this._onFinishedTransaction(e)}))}getTransactionMetricsRequest(){return{...{createEventFragment:this.metaMetricsController.createEventFragment.bind(this.metaMetricsController),finalizeEventFragment:this.metaMetricsController.finalizeEventFragment.bind(this.metaMetricsController),getEventFragmentById:this.metaMetricsController.getEventFragmentById.bind(this.metaMetricsController),getParticipateInMetrics:()=>this.metaMetricsController.state.participateInMetaMetrics,trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),updateEventFragment:this.metaMetricsController.updateEventFragment.bind(this.metaMetricsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTransaction:e=>this.txController.state.transactions.find((t=>t.id===e)),getIsSmartTransaction:()=>(0,ye.getIsSmartTransaction)(this._getMetaMaskState()),getSmartTransactionByMinedTxHash:e=>this.smartTransactionsController.getSmartTransactionByMinedTxHash(e)},snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),provider:this.provider}}toggleExternalServices(e){this.preferencesController.toggleExternalServices(e),this.tokenListController.updatePreventPollingOnNetworkRestart(!e),e?(this.tokenDetectionController.enable(),this.gasFeeController.enableNonRPCGasFeeApis()):(this.tokenDetectionController.disable(),this.gasFeeController.disableNonRPCGasFeeApis())}findNetworkConfigurationBy(e){const{networkConfigurations:t}=this.networkController.state;return Object.values(t).find((t=>Object.keys(e).some((r=>t[r]===e[r]))))||null}async setLedgerTransportPreference(e){const t=window.navigator.hid?se.LedgerTransportTypes.webhid:se.LedgerTransportTypes.u2f,r=e||await this.getKeyringForDevice(se.HardwareDeviceNames.ledger);return null!=r&&r.updateTransportMethod?r.updateTransportMethod(t).catch((e=>{throw e})):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t=this.platform.getVersion();e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e}onClientClosed(){try{this.gasFeeController.stopAllPolling(),this.currencyRateController.stopAllPolling(),this.appStateController.clearPollingTokens()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=ce.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.store.getState()[t].forEach((e=>{this.gasFeeController.stopPollingByPollingToken(e),this.currencyRateController.stopPollingByPollingToken(e),this.appStateController.removePollingToken(e,t)}))}safelistPhishingDomain(e){return this.phishingController.bypass(e)}async backToSafetyPhishingWarning(){const e=this.platform.getExtensionURL();await this.platform.switchToAnotherURL(undefined,e)}setLocked(){return this.keyringController.setLocked()}async _onAccountChange(e){const t=(0,rt.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[r,n]of t.entries())n.includes(e)&&this._notifyAccountsChange(r,n);await this.txController.updateIncomingTransactions()}async _notifyAccountsChange(e,t){this.isUnlocked()&&this.notifyConnections(e,{method:rt.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:await this.getPermittedAccounts(e)}),this.permissionLogController.updateAccountsHistory(e,t)}async _notifyChainChange(){this.preferencesController.getUseRequestQueue()?this.notifyAllConnections((async e=>({method:rt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState(e)}))):this.notifyAllConnections({method:rt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState()})}async _onFinishedTransaction(e){[Y.TransactionStatus.confirmed,Y.TransactionStatus.failed].includes(e.status)&&(await this._createTransactionNotifcation(e),this._updateNFTOwnership(e),this._trackTransactionFailure(e))}async _createTransactionNotifcation(e){const{chainId:t}=e;let r={};if(t){const{networkConfigurations:e}=this.networkController.state,n=Object.values(e).find((e=>e.chainId===t));r=(null==n?void 0:n.rpcPrefs)??{}}try{await this.platform.showTransactionNotification(e,r)}catch(e){v.default.error("Failed to create transaction notification",e)}}_updateNFTOwnership(e){var t;const{type:r,txParams:n,chainId:s}=e;if(r!==Y.TransactionType.tokenMethodTransferFrom||n===undefined)return;const{data:i,to:o,from:a}=n,l=(0,me.parseStandardTokenTransactionData)(i),c=(0,he.getTokenIdParam)(l)??(0,fe.getTokenValueParam)(l),{allNfts:d}=this.nftController.state,u=null==d||null===(t=d[a])||void 0===t||null===(t=t[s])||void 0===t?void 0:t.find((({address:e,tokenId:t})=>(0,pe.isEqualCaseInsensitive)(e,o)&&t===c));u&&this.nftController.checkAndUpdateSingleNftOwnershipStatus(u,!1,{userAddress:a})}_trackTransactionFailure(e){var t;const{txReceipt:r}=e,n=this.getState();r&&"0x0"===r.status&&this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:de.MetaMetricsEventCategory.Background,properties:{action:"Transactions",errorMessage:null===(t=e.simulationFails)||void 0===t?void 0:t.reason,numberOfTokens:n.tokens.length,numberOfAccounts:Object.keys(n.accounts).length}},{matomoEvent:!0})}_onUserOperationAdded(e){const t=this.txController.state.transactions.find((t=>t.id===e.id));t&&(t.type===Y.TransactionType.swap?this.controllerMessenger.publish("TransactionController:transactionNewSwap",{transactionMeta:t}):t.type===Y.TransactionType.swapApproval&&this.controllerMessenger.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:t}))}_onUserOperationTransactionUpdated(e){const t={...e,txParams:{...e.txParams,from:this.accountsController.getSelectedAccount().address}};this.txController.state.transactions.some((e=>e.id===t.id))||this.txController.update((e=>{e.transactions.push(t)})),this.txController.updateTransaction(t,"Generated from user operation"),this.controllerMessenger.publish("TransactionController:transactionStatusUpdated",{transactionMeta:t})}_publishSmartTransactionHook(e){const t=this._getMetaMaskState(),r=(0,ye.getIsSmartTransaction)(t);if(!r)return{transactionHash:undefined};const n=(0,ye.getFeatureFlagsByChainId)(t);return(0,be.submitSmartTransactionHook)({transactionMeta:e,transactionController:this.txController,smartTransactionsController:this.smartTransactionsController,controllerMessenger:this.controllerMessenger,isSmartTransaction:r,featureFlags:n})}_getMetaMaskState(){return{metamask:this.getState()}}}async function Pt(e,t){var r;const{currentLocale:n}=e,{chainId:s}=this.networkController.state.providerConfig;await(0,it.updateCurrentLocale)(n),null!==(r=e.incomingTransactionsPreferences)&&void 0!==r&&r[s]?this.txController.startIncomingTransactionPolling():this.txController.stopIncomingTransactionPolling(),Tt(this,Mt,It).call(this,e,t),this.controllerMessenger.publish("PreferencesController:stateChange",e,[])}function It(e,t){const r=Tt(this,Et,Nt).call(this,t),n=Tt(this,Et,Nt).call(this,e);r!==n&&(this.tokenListController.updatePreventPollingOnNetworkRestart(!n),n?(v.default.debug("Started token list controller polling"),this.tokenListController.start()):(v.default.debug("Stopped token list controller polling"),this.tokenListController.clearingTokenListData(),this.tokenListController.stop()))}function Nt(e){const{useTokenDetection:t,useTransactionSimulations:r,preferences:n}=e??{},{petnamesEnabled:s}=n??{};return t||s||r}r.default=At}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/metamask-controller.js"}],[1200,{"./chunk-DBJSLKNR.js":1197,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-DBJSLKNR.js"),s=e("@metamask/utils"),i=e("@spruceid/siwe-parser"),o=n.createModuleLogger.call(void 0,n.projectLogger,"detect-siwe");function a(e){try{const n="string"!=typeof(r=e)?r:s.remove0x.call(void 0,r),i=t.from(n,"hex");return 32===i.length?e:i.toString("utf8")}catch(t){return o(t),e}var r}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=c,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const n=new URL(t),s=c(r.parsedMessage.domain,n.protocol);return 0===s.hostname.localeCompare(n.hostname,void 0,{sensitivity:"accent"})&&(""!==s.port&&s.port!==n.port?""===n.port&&s.port===l[n.protocol]:""===s.username||s.username===n.username)}catch(e){return o(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=a(t);return{isSIWEMessage:!0,parsedMessage:new(0,i.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1201,{"./chunk-LGGBBU6G.js":1199},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-LGGBBU6G.js"),s={[n.NetworkType.goerli]:{chainId:n.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.goerli}.etherscan.io`}},[n.NetworkType.sepolia]:{chainId:n.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.sepolia}.etherscan.io`}},[n.NetworkType.mainnet]:{chainId:n.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[n.NetworkType["linea-goerli"]]:{chainId:n.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[n.NetworkType["linea-sepolia"]]:{chainId:n.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[n.NetworkType["linea-mainnet"]]:{chainId:n.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[n.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},i=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(i||{}),o={[n.ChainId.goerli]:"goerli",[n.ChainId.sepolia]:"sepolia",[n.ChainId.mainnet]:"mainnet",[n.ChainId["linea-goerli"]]:"linea-goerli",[n.ChainId["linea-sepolia"]]:"linea-sepolia",[n.ChainId["linea-mainnet"]]:"linea-mainnet",[n.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=s,r.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.ORIGIN_METAMASK="metamask",r.ApprovalType=i,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=o}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-X4PYR7CK.js"}],[1202,{"./chunk-DBJSLKNR.js":1197,"./chunk-EDY72VWL.js":1198,"./chunk-LGGBBU6G.js":1199,"./chunk-M6G3ISXG.js":1200,"./chunk-X4PYR7CK.js":1201},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var s=e("./chunk-EDY72VWL.js"),i=e("./chunk-X4PYR7CK.js"),o=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=i.ASSET_TYPES,r.ApprovalType=i.ApprovalType,r.BNToHex=s.BNToHex,r.BUILT_IN_NETWORKS=i.BUILT_IN_NETWORKS,r.BuiltInNetworkName=o.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=i.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=o.ChainId,r.ERC1155=i.ERC1155,r.ERC1155_INTERFACE_ID=i.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=i.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=i.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=i.ERC20,r.ERC721=i.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=i.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=i.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=i.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=i.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=i.GANACHE_CHAIN_ID,r.GWEI=i.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=i.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=o.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=i.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=i.NFT_API_BASE_URL,r.NetworkType=o.NetworkType,r.NetworksTicker=o.NetworksTicker,r.OPENSEA_PROXY_URL=i.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=i.ORIGIN_METAMASK,r.RPC=i.RPC,r.TESTNET_TICKER_SYMBOLS=i.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=s.convertHexToDecimal,r.detectSIWE=n.detectSIWE,r.fetchWithErrorHandling=s.fetchWithErrorHandling,r.fractionBN=s.fractionBN,r.fromHex=s.fromHex,r.getBuyURL=s.getBuyURL,r.gweiDecToWEIBN=s.gweiDecToWEIBN,r.handleFetch=s.handleFetch,r.hexToBN=s.hexToBN,r.hexToText=s.hexToText,r.isInfuraNetworkType=o.isInfuraNetworkType,r.isNetworkType=o.isNetworkType,r.isNonEmptyArray=s.isNonEmptyArray,r.isPlainObject=s.isPlainObject,r.isSafeChainId=s.isSafeChainId,r.isSafeDynamicKey=s.isSafeDynamicKey,r.isSmartContractCode=s.isSmartContractCode,r.isValidHexAddress=s.isValidHexAddress,r.isValidJson=s.isValidJson,r.isValidSIWEOrigin=n.isValidSIWEOrigin,r.normalizeEnsName=s.normalizeEnsName,r.parseDomainParts=n.parseDomainParts,r.query=s.query,r.safelyExecute=s.safelyExecute,r.safelyExecuteWithTimeout=s.safelyExecuteWithTimeout,r.successfulFetch=s.successfulFetch,r.timeoutFetch=s.timeoutFetch,r.toChecksumHexAddress=s.toChecksumHexAddress,r.toHex=s.toHex,r.weiHexToGweiDec=s.weiHexToGweiDec}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1209,{"./base-filter":1210},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./base-filter");t.exports=class extends n{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter-history.js"}],[121,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:2,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/002.js"}],[1210,{"@metamask/safe-event-emitter":1673},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@metamask/safe-event-emitter").default;t.exports=class extends n{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach((e=>this.emit("update",e)))}addInitialResults(e){}getChangesAndClear(){const e=this.updates;return this.updates=[],e}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter.js"}],[1211,{"./base-filter":1210,"./getBlocksForRange":1212,"./hexUtils":1213},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./base-filter"),s=e("./getBlocksForRange"),{incrementHexInt:i}=e("./hexUtils");t.exports=class extends n{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){const r=t,n=i(e),o=(await s({provider:this.provider,fromBlock:n,toBlock:r})).map((e=>e.hash));this.addResults(o)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/block-filter.js"}],[1212,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function s(e){if(e===undefined||null===e)return e;return"0x"+e.toString(16)}function i(e,t){return new Promise(((r,n)=>{e.sendAsync(t,((e,t)=>{e?n(e):t.error?n(t.error):t.result?r(t.result):n(new Error("Result was empty"))}))}))}t.exports=async function({provider:e,fromBlock:t,toBlock:r}){t||(t=r);const o=n(t),a=n(r),l=Array(a-o+1).fill().map(((e,t)=>o+t)).map(s);let c=await Promise.all(l.map((t=>async function(e,t,r){for(let n=0;n<3;n++)try{return await i(e,{id:1,jsonrpc:"2.0",method:t,params:r})}catch(e){console.error(`provider.sendAsync failed: ${e.stack||e.message||e}`)}return null}(e,"eth_getBlockByNumber",[t,!1]))));return c=c.filter((e=>null!==e)),c}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/getBlocksForRange.js"}],[1213,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return e.sort(((e,t)=>"latest"===e||"earliest"===t?1:"latest"===t||"earliest"===e?-1:s(e)-s(t)))}function s(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function i(e){if(e===undefined||null===e)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function o(){return Math.floor(16*Math.random()).toString(16)}t.exports={minBlockRef:function(...e){return n(e)[0]},maxBlockRef:function(...e){const t=n(e);return t[t.length-1]},sortBlockRefs:n,bnToHex:function(e){return"0x"+e.toString(16)},blockRefIsNumber:function(e){return e&&!["earliest","latest","pending"].includes(e)},hexToInt:s,incrementHexInt:function(e){if(e===undefined||null===e)return e;return i(s(e)+1)},intToHex:i,unsafeRandomBytes:function(e){let t="0x";for(let r=0;r<e;r++)t+=o(),t+=o();return t}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/hexUtils.js"}],[1214,{"./block-filter.js":1211,"./hexUtils":1213,"./log-filter.js":1215,"./tx-filter.js":1225,"@metamask/json-rpc-engine":1222,"async-mutex":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("async-mutex").Mutex,{createAsyncMiddleware:s,createScaffoldMiddleware:i}=e("@metamask/json-rpc-engine"),o=e("./log-filter.js"),a=e("./block-filter.js"),l=e("./tx-filter.js"),{intToHex:c,hexToInt:d}=e("./hexUtils");function u(e){return h((async(...t)=>{const r=await e(...t);return c(r.id)}))}function h(e){return s((async(t,r)=>{const n=await e.apply(null,t.params);r.result=n}))}function p(e,t){const r=[];for(let t in e)r.push(e[t]);return r}t.exports=function({blockTracker:e,provider:t}){let r=0,s={};const m=new n,g=function({mutex:e}){return t=>async(r,n,s,i)=>{(await e.acquire())(),t(r,n,s,i)}}({mutex:m}),f=i({eth_newFilter:g(u(w)),eth_newBlockFilter:g(u(y)),eth_newPendingTransactionFilter:g(u(k)),eth_uninstallFilter:g(h(_)),eth_getFilterChanges:g(h(C)),eth_getFilterLogs:g(h(b))}),v=async({oldBlock:e,newBlock:t})=>{if(0===s.length)return;const r=await m.acquire();try{await Promise.all(p(s).map((async r=>{try{await r.update({oldBlock:e,newBlock:t})}catch(e){console.error(e)}})))}catch(e){console.error(e)}r()};return f.newLogFilter=w,f.newBlockFilter=y,f.newPendingTransactionFilter=k,f.uninstallFilter=_,f.getFilterChanges=C,f.getFilterLogs=b,f.destroy=()=>{!async function(){const e=p(s).length;s={},S({prevFilterCount:e,newFilterCount:0})}()},f;async function w(e){const r=new o({provider:t,params:e});await T(r);return r}async function y(){const e=new a({provider:t});await T(e);return e}async function k(){const e=new l({provider:t});await T(e);return e}async function C(e){const t=d(e),r=s[t];if(!r)throw new Error(`No filter for index "${t}"`);return r.getChangesAndClear()}async function b(e){const t=d(e),r=s[t];if(!r)throw new Error(`No filter for index "${t}"`);let n=[];return"log"===r.type&&(n=r.getAllResults()),n}async function _(e){const t=d(e),r=s[t],n=Boolean(r);return n&&await async function(e){const t=p(s).length;delete s[e];const r=p(s).length;S({prevFilterCount:t,newFilterCount:r})}(t),n}async function T(t){const n=p(s).length,i=await e.getLatestBlock();await t.initialize({currentBlock:i}),r++,s[r]=t,t.id=r,t.idHex=c(r);return S({prevFilterCount:n,newFilterCount:p(s).length}),r}function S({prevFilterCount:t,newFilterCount:r}){0===t&&r>0?e.on("sync",v):t>0&&0===r&&e.removeListener("sync",v)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/index.js"}],[1215,{"./base-filter-history":1209,"./hexUtils":1213,"@metamask/eth-query":1216,pify:3919},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@metamask/eth-query"),s=e("pify"),i=e("./base-filter-history"),{bnToHex:o,hexToInt:a,incrementHexInt:l,minBlockRef:c,blockRefIsNumber:d}=e("./hexUtils");t.exports=class extends i{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new n(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:undefined,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map((e=>e.toLowerCase())))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),"earliest"===t&&(t="0x0"),this.params.fromBlock=t;const r=c(this.params.toBlock,e),n=Object.assign({},this.params,{toBlock:r}),s=await this._fetchLogs(n);this.addInitialResults(s)}async update({oldBlock:e,newBlock:t}){const r=t;let n;n=e?l(e):t;const s=Object.assign({},this.params,{fromBlock:n,toBlock:r}),i=(await this._fetchLogs(s)).filter((e=>this.matchLog(e)));this.addResults(i)}async _fetchLogs(e){return await s((t=>this.ethQuery.getLogs(e,t)))()}matchLog(e){if(a(this.params.fromBlock)>=a(e.blockNumber))return!1;if(d(this.params.toBlock)&&a(this.params.toBlock)<=a(e.blockNumber))return!1;const t=e.address&&e.address.toLowerCase();if(this.params.address&&t&&!this.params.address.includes(t))return!1;return this.params.topics.every(((t,r)=>{let n=e.topics[r];if(!n)return!1;n=n.toLowerCase();let s=Array.isArray(t)?t:[t];if(s.includes(null))return!0;s=s.map((e=>e.toLowerCase()));return s.includes(n)}))}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/log-filter.js"}],[1216,{"json-rpc-random-id":3633,xtend:4408},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("json-rpc-random-id")(),s=e("xtend");function i(e){this.currentProvider=e}function o(e){return function(...t){const r=t.pop();this.sendAsync({method:e,params:t},r)}}function a(e,t){return function(...r){const n=r.pop();r.length<e&&r.push("latest"),this.sendAsync({method:t,params:r},n)}}t.exports=i,i.prototype.getBalance=a(2,"eth_getBalance"),i.prototype.getCode=a(2,"eth_getCode"),i.prototype.getTransactionCount=a(2,"eth_getTransactionCount"),i.prototype.getStorageAt=a(3,"eth_getStorageAt"),i.prototype.call=a(2,"eth_call"),i.prototype.protocolVersion=o("eth_protocolVersion"),i.prototype.syncing=o("eth_syncing"),i.prototype.coinbase=o("eth_coinbase"),i.prototype.mining=o("eth_mining"),i.prototype.hashrate=o("eth_hashrate"),i.prototype.gasPrice=o("eth_gasPrice"),i.prototype.accounts=o("eth_accounts"),i.prototype.blockNumber=o("eth_blockNumber"),i.prototype.getBlockTransactionCountByHash=o("eth_getBlockTransactionCountByHash"),i.prototype.getBlockTransactionCountByNumber=o("eth_getBlockTransactionCountByNumber"),i.prototype.getUncleCountByBlockHash=o("eth_getUncleCountByBlockHash"),i.prototype.getUncleCountByBlockNumber=o("eth_getUncleCountByBlockNumber"),i.prototype.sign=o("eth_sign"),i.prototype.sendTransaction=o("eth_sendTransaction"),i.prototype.sendRawTransaction=o("eth_sendRawTransaction"),i.prototype.estimateGas=o("eth_estimateGas"),i.prototype.getBlockByHash=o("eth_getBlockByHash"),i.prototype.getBlockByNumber=o("eth_getBlockByNumber"),i.prototype.getTransactionByHash=o("eth_getTransactionByHash"),i.prototype.getTransactionByBlockHashAndIndex=o("eth_getTransactionByBlockHashAndIndex"),i.prototype.getTransactionByBlockNumberAndIndex=o("eth_getTransactionByBlockNumberAndIndex"),i.prototype.getTransactionReceipt=o("eth_getTransactionReceipt"),i.prototype.getUncleByBlockHashAndIndex=o("eth_getUncleByBlockHashAndIndex"),i.prototype.getUncleByBlockNumberAndIndex=o("eth_getUncleByBlockNumberAndIndex"),i.prototype.getCompilers=o("eth_getCompilers"),i.prototype.compileLLL=o("eth_compileLLL"),i.prototype.compileSolidity=o("eth_compileSolidity"),i.prototype.compileSerpent=o("eth_compileSerpent"),i.prototype.newFilter=o("eth_newFilter"),i.prototype.newBlockFilter=o("eth_newBlockFilter"),i.prototype.newPendingTransactionFilter=o("eth_newPendingTransactionFilter"),i.prototype.uninstallFilter=o("eth_uninstallFilter"),i.prototype.getFilterChanges=o("eth_getFilterChanges"),i.prototype.getFilterLogs=o("eth_getFilterLogs"),i.prototype.getLogs=o("eth_getLogs"),i.prototype.getWork=o("eth_getWork"),i.prototype.submitWork=o("eth_submitWork"),i.prototype.submitHashrate=o("eth_submitHashrate"),i.prototype.sendAsync=function(e,t){var r;this.currentProvider.sendAsync((r=e,s({id:n(),jsonrpc:"2.0",params:[]},r)),(function(e,r){let n=e;return!e&&r.error&&(n=new Error(`EthQuery - RPC Error - ${r.error.message}`)),n?t(n):t(null,r.result)}))}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/eth-query",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/eth-query/index.js"}],[1217,{"@metamask/rpc-errors":1672,"@metamask/safe-event-emitter":1673,"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a,l,c,d,u,h,p,m,g,f=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},v=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},w=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},y=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.JsonRpcEngine=void 0;const k=e("@metamask/rpc-errors"),C=y(e("@metamask/safe-event-emitter")),b=e("@metamask/utils");class _ extends C.default{constructor({notificationHandler:e}={}){super(),n.add(this),i.set(this,!1),o.set(this,void 0),a.set(this,void 0),v(this,o,[],"f"),v(this,a,e,"f")}destroy(){w(this,o,"f").forEach((e=>{"destroy"in e&&"function"==typeof e.destroy&&e.destroy()})),v(this,o,[],"f"),v(this,i,!0,"f")}push(e){w(this,n,"m",l).call(this),w(this,o,"f").push(e)}handle(e,t){if(w(this,n,"m",l).call(this),t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?w(this,n,"m",c).call(this,e,t):w(this,n,"m",c).call(this,e):t?w(this,n,"m",d).call(this,e,t):this._promiseHandle(e)}asMiddleware(){return w(this,n,"m",l).call(this),(e,t,r,n)=>f(this,void 0,void 0,(function*(){try{const[i,a,l]=yield w(_,s,"m",h).call(_,e,t,w(this,o,"f"));return a?(yield w(_,s,"m",m).call(_,l),n(i)):r((e=>f(this,void 0,void 0,(function*(){try{yield w(_,s,"m",m).call(_,l)}catch(t){return e(t)}return e()}))))}catch(e){return n(e)}}))}_promiseHandle(e){return f(this,void 0,void 0,(function*(){return new Promise(((t,r)=>{w(this,n,"m",d).call(this,e,((e,n)=>{e&&n===undefined?r(e):t(n)})).catch(r)}))}))}}function T(e){return JSON.stringify(e,null,2)}r.JsonRpcEngine=_,s=_,i=new WeakMap,o=new WeakMap,a=new WeakMap,n=new WeakSet,l=function(){if(w(this,i,"f"))throw new Error("This engine is destroyed and can no longer be used.")},c=function(e,t){return f(this,void 0,void 0,(function*(){try{if(0===e.length){const e=[{id:null,jsonrpc:"2.0",error:new k.JsonRpcError(k.errorCodes.rpc.invalidRequest,"Request batch must contain plain objects. Received an empty array")}];return t?t(null,e):e}const r=(yield Promise.all(e.map(this._promiseHandle.bind(this)))).filter((e=>e!==undefined));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}}))},d=function(e,t){var r;return f(this,void 0,void 0,(function*(){if(!e||Array.isArray(e)||"object"!=typeof e){const r=new k.JsonRpcError(k.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(r,{id:null,jsonrpc:"2.0",error:r})}if("string"!=typeof e.method){const n=new k.JsonRpcError(k.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return w(this,a,"f")&&!(0,b.isJsonRpcRequest)(e)?t(null):t(n,{id:null!==(r=e.id)&&void 0!==r?r:null,jsonrpc:"2.0",error:n})}if(w(this,a,"f")&&!(0,b.isJsonRpcRequest)(e)){try{yield w(this,a,"f").call(this,e)}catch(n){return t(n)}return t(null)}let n=null;const i=Object.assign({},e),l={id:i.id,jsonrpc:i.jsonrpc};try{yield w(_,s,"m",u).call(_,i,l,w(this,o,"f"))}catch(e){n=e}return n&&(delete l.result,l.error||(l.error=(0,k.serializeError)(n))),t(n,l)}))},u=function(e,t,r){return f(this,void 0,void 0,(function*(){const[n,i,o]=yield w(_,s,"m",h).call(_,e,t,r);if(w(_,s,"m",g).call(_,e,t,i),yield w(_,s,"m",m).call(_,o),n)throw n}))},h=function(e,t,r){return f(this,void 0,void 0,(function*(){const n=[];let i=null,o=!1;for(const a of r)if([i,o]=yield w(_,s,"m",p).call(_,e,t,a,n),o)break;return[i,o,n.reverse()]}))},p=function(e,t,r,n){return f(this,void 0,void 0,(function*(){return new Promise((s=>{const i=e=>{const r=e||t.error;r&&(t.error=(0,k.serializeError)(r)),s([r,!0])},o=r=>{t.error?i(t.error):(r&&("function"!=typeof r&&i(new k.JsonRpcError(k.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof r}" for request:\n${T(e)}`,{request:e})),n.push(r)),s([null,!1]))};try{r(e,t,o,i)}catch(e){i(e)}}))}))},m=function(e){return f(this,void 0,void 0,(function*(){for(const t of e)yield new Promise(((e,r)=>{t((t=>t?r(t):e()))}))}))},g=function(e,t,r){if(!(0,b.hasProperty)(t,"result")&&!(0,b.hasProperty)(t,"error"))throw new k.JsonRpcError(k.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${T(e)}`,{request:e});if(!r)throw new k.JsonRpcError(k.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${T(e)}`,{request:e})}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/JsonRpcEngine.js"}],[1218,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.createAsyncMiddleware=void 0,r.createAsyncMiddleware=function(e){return(t,r,s,i)=>n(this,void 0,void 0,(function*(){let o;const a=new Promise((e=>{o=e}));let l=null,c=!1;const d=()=>n(this,void 0,void 0,(function*(){return c=!0,s((e=>{l=e,o()})),a}));try{yield e(t,r,d),c?(yield a,l(null)):i(null)}catch(e){l?l(e):i(e)}}))}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/createAsyncMiddleware.js"}],[1219,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createScaffoldMiddleware=void 0,r.createScaffoldMiddleware=function(e){return(t,r,n,s)=>{const i=e[t.method];return i===undefined?n():"function"==typeof i?i(t,r,n,s):(r.result=i,s())}}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/createScaffoldMiddleware.js"}],[122,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:3,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/003.js"}],[1220,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getUniqueId=void 0;const n=4294967295;let s=Math.floor(Math.random()*n);r.getUniqueId=function(){return s=(s+1)%n,s}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/getUniqueId.js"}],[1221,{"./getUniqueId":1220},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createIdRemapMiddleware=void 0;const n=e("./getUniqueId");r.createIdRemapMiddleware=function(){return(e,t,r,s)=>{const i=e.id,o=(0,n.getUniqueId)();e.id=o,t.id=o,r((r=>{e.id=i,t.id=i,r()}))}}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/idRemapMiddleware.js"}],[1222,{"./JsonRpcEngine":1217,"./createAsyncMiddleware":1218,"./createScaffoldMiddleware":1219,"./getUniqueId":1220,"./idRemapMiddleware":1221,"./mergeMiddleware":1223},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./createAsyncMiddleware"),r),s(e("./createScaffoldMiddleware"),r),s(e("./getUniqueId"),r),s(e("./idRemapMiddleware"),r),s(e("./JsonRpcEngine"),r),s(e("./mergeMiddleware"),r)}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/index.js"}],[1223,{"./JsonRpcEngine":1217},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mergeMiddleware=void 0;const n=e("./JsonRpcEngine");r.mergeMiddleware=function(e){const t=new n.JsonRpcEngine;return e.forEach((e=>t.push(e))),t.asMiddleware()}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/mergeMiddleware.js"}],[1224,{"./getBlocksForRange.js":1212,"./hexUtils.js":1213,"./index.js":1214,"@metamask/json-rpc-engine":1222,"@metamask/safe-event-emitter":1673},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@metamask/safe-event-emitter").default,{createAsyncMiddleware:s,createScaffoldMiddleware:i}=e("@metamask/json-rpc-engine"),o=e("./index.js"),{unsafeRandomBytes:a,incrementHexInt:l}=e("./hexUtils.js"),c=e("./getBlocksForRange.js");function d(e){return null===e||e===undefined?null:{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}t.exports=function({blockTracker:e,provider:t}){const r={},u=o({blockTracker:e,provider:t});let h=!1;const p=new n,m=i({eth_subscribe:s((async function(n,s){if(h)throw new Error("SubscriptionManager - attempting to use after destroying");const i=n.params[0],o=a(16);let p;switch(i){case"newHeads":p=m({subId:o});break;case"logs":const e=n.params[1];p=f({subId:o,filter:await u.newLogFilter(e)});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${i}"`)}return r[o]=p,void(s.result=o);function m({subId:r}){const n={type:i,destroy:async()=>{e.removeListener("sync",n.update)},update:async({oldBlock:e,newBlock:n})=>{const s=n,i=l(e);(await c({provider:t,fromBlock:i,toBlock:s})).map(d).filter((e=>null!==e)).forEach((e=>{g(r,e)}))}};return e.on("sync",n.update),n}function f({subId:e,filter:t}){t.on("update",(t=>g(e,t)));return{type:i,destroy:async()=>await u.uninstallFilter(t.idHex)}}})),eth_unsubscribe:s((async function(e,t){if(h)throw new Error("SubscriptionManager - attempting to use after destroying");const n=e.params[0],s=r[n];if(!s)return void(t.result=!1);delete r[n],await s.destroy(),t.result=!0}))});return m.destroy=function(){p.removeAllListeners();for(const e in r)r[e].destroy(),delete r[e];h=!0},{events:p,middleware:m};function g(e,t){p.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:e,result:t}})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/subscriptionManager.js"}],[1225,{"./base-filter":1210,"./getBlocksForRange":1212,"./hexUtils":1213},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./base-filter"),s=e("./getBlocksForRange"),{incrementHexInt:i}=e("./hexUtils");t.exports=class extends n{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){const t=e,r=i(e),n=await s({provider:this.provider,fromBlock:r,toBlock:t}),o=[];for(const e of n)o.push(...e.transactions);this.addResults(o)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/tx-filter.js"}],[123,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:4,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/004.js"}],[124,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:5,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,r={...e,KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}};return delete r.vault,delete r.walletNicknames,delete r.config.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/005.js"}],[125,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:6,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=6;try{const e=function(e){const t=e.KeyringController,r={...e,PreferencesController:{selectedAddress:t.selectedAccount}};return delete r.KeyringController.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #6${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/006.js"}],[126,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:7,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=7;try{const e=function(e){const t={...e,TransactionManager:{transactions:e.transactions||[],gasMultiplier:e.gasMultiplier||1}};return delete t.transactions,delete t.gasMultiplier,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #7${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/007.js"}],[1267,{"./ledger-bridge":1268,"./ledger-iframe-bridge":1269,"./ledger-keyring":1270},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./ledger-keyring"),r),s(e("./ledger-iframe-bridge"),r),s(e("./ledger-bridge"),r)}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/index.js"}],[1268,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-bridge.js"}],[1269,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a,l,c=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerIframeBridge=r.IFrameMessageAction=void 0;var d;!function(e){e.LedgerConnectionChange="ledger-connection-change",e.LedgerUnlock="ledger-unlock",e.LedgerMakeApp="ledger-make-app",e.LedgerUpdateTransport="ledger-update-transport",e.LedgerSignTransaction="ledger-sign-transaction",e.LedgerSignPersonalMessage="ledger-sign-personal-message",e.LedgerSignTypedData="ledger-sign-typed-data"}(d=r.IFrameMessageAction||(r.IFrameMessageAction={}));r.LedgerIframeBridge=class{constructor(){n.add(this),this.iframeLoaded=!1,this.isDeviceConnected=!1,this.currentMessageId=0,this.messageCallbacks={}}async init(e){c(this,n,"m",i).call(this,e),this.eventListener=c(this,n,"m",a).bind(this,e),window.addEventListener("message",this.eventListener)}async destroy(){this.eventListener&&window.removeEventListener("message",this.eventListener)}async attemptMakeApp(){return new Promise(((e,t)=>{c(this,n,"m",l).call(this,{action:d.LedgerMakeApp},(r=>{r.success?e(!0):t(r.error)}))}))}async updateTransportMethod(e){return new Promise(((t,r)=>{this.iframeLoaded?c(this,n,"m",l).call(this,{action:d.LedgerUpdateTransport,params:{transportType:e}},(({success:e})=>e?t(!0):r(new Error("Ledger transport could not be updated")))):this.delayedPromise={resolve:t,reject:r,transportType:e}}))}async getPublicKey(e){return c(this,n,"m",s).call(this,d.LedgerUnlock,e)}async deviceSignTransaction(e){return c(this,n,"m",s).call(this,d.LedgerSignTransaction,e)}async deviceSignMessage(e){return c(this,n,"m",s).call(this,d.LedgerSignPersonalMessage,e)}async deviceSignTypedData(e){return c(this,n,"m",s).call(this,d.LedgerSignTypedData,e)}},n=new WeakSet,s=async function(...[e,t]){return new Promise(((r,s)=>{c(this,n,"m",l).call(this,{action:e,params:t},(({success:e,payload:t})=>e?r(t):s(t.error)))}))},i=function(e){this.iframe=document.createElement("iframe"),this.iframe.src=e,this.iframe.allow="hid 'src'",this.iframe.onload=async()=>{if(this.iframeLoaded=!0,this.delayedPromise)try{const e=await this.updateTransportMethod(this.delayedPromise.transportType);this.delayedPromise.resolve(e)}catch(e){this.delayedPromise.reject(e)}finally{delete this.delayedPromise}},document.head.appendChild(this.iframe)},o=function(e){const t=e.split("/");return t.splice(-1,1),t.join("/")},a=function(e,t){if(t.origin===c(this,n,"m",o).call(this,e)&&t.data){const e=this.messageCallbacks[t.data.messageId];e?e(t.data):t.data.action===d.LedgerConnectionChange&&(this.isDeviceConnected=t.data.payload.connected)}},l=function(e,t){this.currentMessageId+=1;const r=Object.assign(Object.assign({},e),{messageId:this.currentMessageId,target:"LEDGER-IFRAME"});if(this.messageCallbacks[this.currentMessageId]=t,!this.iframeLoaded||!this.iframe||!this.iframe.contentWindow)throw new Error("The iframe is not loaded yet");this.iframe.contentWindow.postMessage(r,"*")}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-iframe-bridge.js"}],[127,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:8,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=8;try{const e=function(e){const t={...e,NoticeController:{noticesList:e.noticesList||[]}};return delete t.noticesList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #8${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/008.js"}],[1270,{"@ethereumjs/rlp":424,"@ethereumjs/tx":429,"@ethereumjs/util":441,"@metamask/eth-sig-util":1273,buffer:2983,events:3276,hdkey:3573},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a,l,c,d,u,h,p,m,g,f=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),v=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),w=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return v(t,e),t},y=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},k=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerKeyring=void 0;const C=e("@ethereumjs/rlp"),b=e("@ethereumjs/tx"),_=w(e("@ethereumjs/util")),T=e("@metamask/eth-sig-util"),S=e("buffer"),M=e("events"),E=k(e("hdkey")),A="m",P=`${A}/44'/60'/0'`,I="Ledger Hardware",N="https://metamask.github.io/eth-ledger-bridge-keyring";var j;!function(e){e.Ropsten="http://api-ropsten.etherscan.io",e.Kovan="http://api-kovan.etherscan.io",e.Rinkeby="https://api-rinkeby.etherscan.io",e.Mainnet="https://api.etherscan.io"}(j||(j={}));class R extends M.EventEmitter{constructor({bridge:e}){if(super(),n.add(this),this.type=I,this.page=0,this.perPage=5,this.unlockedAccount=0,this.accounts=[],this.accountDetails={},this.hdk=new E.default,this.hdPath=P,this.paths={},this.network=j.Mainnet,this.implementFullBIP44=!1,this.bridgeUrl=N,!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}async init(){return this.bridge.init(this.bridgeUrl)}async destroy(){return this.bridge.destroy()}async serialize(){return{hdPath:this.hdPath,accounts:this.accounts,accountDetails:this.accountDetails,bridgeUrl:this.bridgeUrl,implementFullBIP44:!1}}async deserialize(e={}){var t,r,i,o,a;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:P,this.bridgeUrl=null!==(r=e.bridgeUrl)&&void 0!==r?r:N,this.accounts=null!==(i=e.accounts)&&void 0!==i?i:[],this.accountDetails=null!==(o=e.accountDetails)&&void 0!==o?o:{},e.accountDetails||y(this,n,"m",s).call(this,e),this.implementFullBIP44=null!==(a=e.implementFullBIP44)&&void 0!==a&&a,this.accounts=this.accounts.filter((e=>Object.keys(this.accountDetails).includes(_.toChecksumAddress(e)))),Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}isConnected(){return this.bridge.isDeviceConnected}setAccountToUnlock(e){this.unlockedAccount="number"==typeof e?e:parseInt(e,10)}setHdPath(e){this.hdPath!==e&&(this.hdk=new E.default),this.hdPath=e}async unlock(e,t=!0){if(this.isUnlocked()&&!e)return"already unlocked";const r=e?y(this,n,"m",p).call(this,e):this.hdPath;let s;try{s=await this.bridge.getPublicKey({hdPath:r})}catch(e){throw e instanceof Error?e:new Error("Unknown error")}return t&&s.chainCode&&(this.hdk.publicKey=S.Buffer.from(s.publicKey,"hex"),this.hdk.chainCode=S.Buffer.from(s.chainCode,"hex")),s.address}async addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((async r=>{const s=this.unlockedAccount,i=s+e;for(let e=s;e<i;e++){const t=y(this,n,"m",u).call(this,e);let r;r=y(this,n,"m",h).call(this)?await this.unlock(t):y(this,n,"m",c).call(this,A,e),this.accountDetails[_.toChecksumAddress(r)]={bip44:y(this,n,"m",h).call(this),hdPath:t},this.accounts.includes(r)||(this.accounts=[...this.accounts,r]),this.page=0}t(this.accounts.slice())})).catch(r)}))}async getFirstPage(){return this.page=0,y(this,n,"m",o).call(this,1)}async getNextPage(){return y(this,n,"m",o).call(this,1)}async getPreviousPage(){return y(this,n,"m",o).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase())),delete this.accountDetails[_.toChecksumAddress(e)]}async attemptMakeApp(){return this.bridge.attemptMakeApp()}async updateTransportMethod(e){return this.bridge.updateTransportMethod(e)}async signTransaction(e,t){let r;if(function(e){return"getChainId"in e&&"function"==typeof e.getChainId}(t))return t.v=_.bufferToHex(t.getChainId()),t.r="0x00",t.s="0x00",r=t.serialize().toString("hex"),y(this,n,"m",i).call(this,e,r,(e=>(t.v=S.Buffer.from(e.v,"hex"),t.r=S.Buffer.from(e.r,"hex"),t.s=S.Buffer.from(e.s,"hex"),t)));const s=t.getMessageToSign(!1);return r=S.Buffer.isBuffer(s)?s.toString("hex"):S.Buffer.from(C.RLP.encode(s)).toString("hex"),y(this,n,"m",i).call(this,e,r,(e=>{const r=t.toJSON();return r.type=t.type,r.v=_.addHexPrefix(e.v),r.r=_.addHexPrefix(e.r),r.s=_.addHexPrefix(e.s),b.TransactionFactory.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})}))}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){const r=await this.unlockAccountByAddress(e);if(!r)throw new Error("Ledger: Unknown error while signing message");let n;try{n=await this.bridge.deviceSignMessage({hdPath:r,message:_.stripHexPrefix(t)})}catch(e){throw e instanceof Error?e:new Error("Ledger: Unknown error while signing message")}let s=parseInt(String(n.v),10).toString(16);s.length<2&&(s=`0${s}`);const i=`0x${n.r}${n.s}${s}`,o=(0,T.recoverPersonalSignature)({data:t,signature:i});if(_.toChecksumAddress(o)!==_.toChecksumAddress(e))throw new Error("Ledger: The signature doesnt match the right address");return i}async unlockAccountByAddress(e){const t=_.toChecksumAddress(e),r=this.accountDetails[t];if(!r)throw new Error(`Ledger: Account for address '${t}' not found`);const{hdPath:n}=r;if((await this.unlock(n,!1)).toLowerCase()!==e.toLowerCase())throw new Error(`Ledger: Account ${e} does not belong to the connected device`);return n}async signTypedData(e,t,r={}){if(!("V4"===r.version))throw new Error("Ledger: Only version 4 of typed data signing is supported");const{domain:n,types:s,primaryType:i,message:o}=T.TypedDataUtils.sanitizeData(t),a=T.TypedDataUtils.hashStruct("EIP712Domain",n,s,T.SignTypedDataVersion.V4).toString("hex"),l=T.TypedDataUtils.hashStruct(i.toString(),o,s,T.SignTypedDataVersion.V4).toString("hex"),c=await this.unlockAccountByAddress(e);if(!c)throw new Error("Ledger: Unknown error while signing message");let d;try{d=await this.bridge.deviceSignTypedData({hdPath:c,domainSeparatorHex:a,hashStructMessageHex:l})}catch(e){throw e instanceof Error?e:new Error("Ledger: Unknown error while signing message")}let u=parseInt(String(d.v),10).toString(16);u.length<2&&(u=`0${u}`);const h=`0x${d.r}${d.s}${u}`,p=(0,T.recoverTypedSignature)({data:t,signature:h,version:T.SignTypedDataVersion.V4});if(_.toChecksumAddress(p)!==_.toChecksumAddress(e))throw new Error("Ledger: The signature doesnt match the right address");return h}exportAccount(){throw new Error("Not supported on this device")}forgetDevice(){this.accounts=[],this.page=0,this.unlockedAccount=0,this.paths={},this.accountDetails={},this.hdk=new E.default}}r.LedgerKeyring=R,n=new WeakSet,s=function(e){if(y(this,n,"m",h).call(this)&&e.accountIndexes)for(const[t,r]of Object.entries(e.accountIndexes))this.accountDetails[t]={bip44:!0,hdPath:y(this,n,"m",u).call(this,r)};y(this,n,"m",h).call(this)||this.accounts.filter((e=>!Object.keys(this.accountDetails).includes(_.toChecksumAddress(e)))).forEach((e=>{try{this.accountDetails[_.toChecksumAddress(e)]={bip44:!1,hdPath:y(this,n,"m",d).call(this,e)}}catch(t){console.log(`failed to migrate account ${e}`)}}))},i=async function(e,t,r){const n=await this.unlockAccountByAddress(e);if(!n)throw new Error("Ledger: Unknown error while signing transaction");let s;try{s=await this.bridge.deviceSignTransaction({tx:t,hdPath:n})}catch(e){throw e instanceof Error?e:new Error("Ledger: Unknown error while signing transaction")}const i=r(s);if(i.verifySignature())return i;throw new Error("Ledger: The transaction signature is not valid")},o=async function(e){this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage;let s;return await this.unlock(),s=y(this,n,"m",h).call(this)?await y(this,n,"m",a).call(this,t,r):y(this,n,"m",l).call(this,t,r),s},a=async function(e,t){const r=[];for(let s=e;s<t;s++){const e=y(this,n,"m",u).call(this,s),t=await this.unlock(e),i=!this.implementFullBIP44||await y(this,n,"m",m).call(this,t);if(r.push({address:t,balance:null,index:s}),!i)break}return r},l=function(e,t){const r=[];for(let s=e;s<t;s++){const e=y(this,n,"m",c).call(this,A,s);r.push({address:e,balance:null,index:s}),this.paths[_.toChecksumAddress(e)]=s}return r},c=function(e,t){const r=this.hdk.derive(`${e}/${t}`),n=_.publicToAddress(r.publicKey,!0).toString("hex");return _.toChecksumAddress(`0x${n}`)},d=function(e){const t=_.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===y(this,n,"m",c).call(this,A,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return y(this,n,"m",u).call(this,r)},u=function(e){return y(this,n,"m",h).call(this)?`m/44'/60'/${e}'/0/0`:`${this.hdPath}/${e}`},h=function(){return"m/44'/60'/0'/0/0"===this.hdPath},p=function(e){return e.toString().replace("m/","")},m=async function(e){const t=y(this,n,"m",g).call(this),r=await window.fetch(`${t}/api?module=account&action=txlist&address=${e}&tag=latest&page=1&offset=1`),s=await r.json();return"0"!==s.status&&s.result.length>0},g=function(){return this.network},R.type=I}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-keyring.js"}],[1279,{"./util":1287},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CaseInsensitiveMap=void 0;const n=e("./util");class s extends Map{static fromObject(e){return new s(Object.entries(e))}toObject(){return Object.fromEntries(this.entries())}get(e){return super.get(e.toLowerCase())}getOrThrow(e,t="Key"){return this.get(e)??(0,n.throwError)(`${t} '${e}' not found`)}has(e){return super.has(e.toLowerCase())}set(e,t){return super.set(e.toLowerCase(),t)}delete(e){return super.delete(e.toLowerCase())}}r.CaseInsensitiveMap=s}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/CaseInsensitiveMap.js"}],[128,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:9,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=9;try{const e=function(e){const t=(0,n.merge)({},e,{CurrencyController:{currentCurrency:e.currentFiat||e.fiatCurrency||"USD",conversionRate:e.conversionRate,conversionDate:e.conversionDate}});return delete t.currentFiat,delete t.fiatCurrency,delete t.conversionRate,delete t.conversionDate,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #9${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/009.js"}],[1280,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DeferredPromise=void 0;r.DeferredPromise=class{constructor(){if(this.resolve=undefined,this.reject=undefined,this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),!this.resolve||!this.reject)throw new Error("Promise constructor failed")}}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/DeferredPromise.js"}],[1281,{"@metamask/keyring-api":1399},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a,l=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},c=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.KeyringSnapControllerClient=void 0;const d=e("@metamask/keyring-api");class u{constructor(e,t,r,a){n.set(this,void 0),s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),l(this,i,e,"f"),l(this,n,t,"f"),l(this,s,r,"f"),l(this,o,a,"f")}async send(e){return c(this,i,"f").handleRequest({snapId:c(this,n,"f"),origin:c(this,s,"f"),handler:c(this,o,"f"),request:e})}}n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap;class h extends d.KeyringClient{constructor({controller:e,snapId:t="undefined",origin:r="metamask",handler:n="onKeyringRequest"}){super(new u(e,t,r,n)),a.set(this,void 0),l(this,a,e,"f")}withSnapId(e){return new h({controller:c(this,a,"f"),snapId:e})}getController(){return c(this,a,"f")}}r.KeyringSnapControllerClient=h,a=new WeakMap}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/KeyringSnapControllerClient.js"}],[1282,{"./CaseInsensitiveMap":1279},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},i=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.SnapIdMap=r.InvalidSnapIdError=void 0;const o=e("./CaseInsensitiveMap");class a extends Error{constructor(e,t){super(`Snap "${e}" is not allowed to set "${t}"`),this.name="InvalidSnapIdError",this.snapId=e,this.key=t}}r.InvalidSnapIdError=a;class l{constructor(e){n.set(this,void 0),s(this,n,new o.CaseInsensitiveMap(e),"f")}toObject(){return i(this,n,"f").toObject()}static fromObject(e){return new l(Object.entries(e))}get(e,t){const r=i(this,n,"f").get(t);return r?.snapId===e?r:undefined}has(e,t){return this.get(e,t)!==undefined}delete(e,t){return this.has(e,t)&&i(this,n,"f").delete(t)}set(e,t){if(i(this,n,"f").has(e)&&!this.has(t.snapId,e))throw new a(t.snapId,e);return i(this,n,"f").set(e,t),this}values(){return i(this,n,"f").values()}get size(){return i(this,n,"f").size}}r.SnapIdMap=l,n=new WeakMap}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/SnapIdMap.js"}],[1283,{"./DeferredPromise":1280,"./KeyringSnapControllerClient":1281,"./SnapIdMap":1282,"./logger":1285,"./types":1286,"./util":1287,"@ethereumjs/tx":429,"@metamask/eth-sig-util":1273,"@metamask/keyring-api":1399,"@metamask/utils":2255,events:3276,superstruct:4288,uuid:1288},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,o,a,l,c,d,u,h,p,m,g,f,v,w,y,k,C,b,_=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},T=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.SnapKeyring=r.SNAP_KEYRING_TYPE=void 0;const S=e("@ethereumjs/tx"),M=e("@metamask/eth-sig-util"),E=e("@metamask/keyring-api"),A=e("@metamask/utils"),P=e("events"),I=e("superstruct"),N=e("uuid"),j=e("./DeferredPromise"),R=e("./KeyringSnapControllerClient"),O=e("./logger"),x=e("./SnapIdMap"),B=e("./types"),U=e("./util");r.SNAP_KEYRING_TYPE="Snap Keyring";class L extends P.EventEmitter{constructor(e,t){super(),n.add(this),s.set(this,void 0),i.set(this,void 0),o.set(this,void 0),a.set(this,void 0),this.type=L.type,_(this,s,new R.KeyringSnapControllerClient({controller:e}),"f"),_(this,o,new x.SnapIdMap,"f"),_(this,i,new x.SnapIdMap,"f"),_(this,a,t,"f")}async handleKeyringSnapMessage(e,t){switch((0,I.assert)(t,B.SnapMessageStruct),t.method){case E.KeyringEvent.AccountCreated:return T(this,n,"m",l).call(this,e,t);case E.KeyringEvent.AccountUpdated:return T(this,n,"m",c).call(this,e,t);case E.KeyringEvent.AccountDeleted:return T(this,n,"m",d).call(this,e,t);case E.KeyringEvent.RequestApproved:return T(this,n,"m",u).call(this,e,t);case E.KeyringEvent.RequestRejected:return T(this,n,"m",h).call(this,e,t);default:throw new Error(`Method not supported: ${t.method}`)}}async serialize(){return{accounts:T(this,i,"f").toObject()}}async deserialize(e){e!==undefined&&_(this,i,x.SnapIdMap.fromObject(e.accounts),"f")}async getAccounts(){return(0,U.unique)([...T(this,i,"f").values()].map((({account:e})=>e.address.toLowerCase())))}async getAccountsBySnapId(e){return(0,U.unique)([...T(this,i,"f").values()].filter((({snapId:t})=>t===e)).map((({account:e})=>e.address.toLowerCase())))}async signTransaction(e,t,r={}){const s=t.common.chainId(),i=(0,U.toJson)({...t.toJSON(),from:e,type:`0x${t.type.toString(16)}`,chainId:(0,A.bigIntToHex)(s)}),o=await T(this,n,"m",p).call(this,{address:e,method:E.EthMethod.SignTransaction,params:[i],chainId:(0,A.toCaipChainId)(A.KnownCaipNamespace.Eip155,`${s}`)}),a=(0,I.mask)(o,(0,I.object)({r:(0,I.string)(),s:(0,I.string)(),v:(0,I.string)()}));return S.TransactionFactory.fromTxData({...i,r:a.r,s:a.s,v:a.v})}async signTypedData(e,t,r={version:M.SignTypedDataVersion.V1}){const s={[M.SignTypedDataVersion.V1]:E.EthMethod.SignTypedDataV1,[M.SignTypedDataVersion.V3]:E.EthMethod.SignTypedDataV3,[M.SignTypedDataVersion.V4]:E.EthMethod.SignTypedDataV4}[r.version]||E.EthMethod.SignTypedDataV1,i=t.domain?.chainId;return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:s,params:(0,U.toJson)([e,t]),...i===undefined?{}:{chainId:(0,A.toCaipChainId)(A.KnownCaipNamespace.Eip155,`${i}`)}}),E.EthBytesStruct)}async signMessage(e,t){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:E.EthMethod.Sign,params:(0,U.toJson)([e,t])}),E.EthBytesStruct)}async signPersonalMessage(e,t){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:E.EthMethod.PersonalSign,params:(0,U.toJson)([t,e])}),E.EthBytesStruct)}async prepareUserOperation(e,t,r){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:E.EthMethod.PrepareUserOperation,params:(0,U.toJson)(t),expectSync:!0,chainId:(0,A.toCaipChainId)(A.KnownCaipNamespace.Eip155,r.chainId)}),E.EthBaseUserOperationStruct)}async patchUserOperation(e,t,r){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:E.EthMethod.PatchUserOperation,params:(0,U.toJson)([t]),expectSync:!0,chainId:(0,A.toCaipChainId)(A.KnownCaipNamespace.Eip155,r.chainId)}),E.EthUserOperationPatchStruct)}async signUserOperation(e,t,r){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:E.EthMethod.SignUserOperation,params:(0,U.toJson)([t]),chainId:(0,A.toCaipChainId)(A.KnownCaipNamespace.Eip155,r.chainId)}),E.EthBytesStruct)}exportAccount(e){throw new Error("Exporting accounts from snaps is not supported.")}async removeAccount(e){const{account:t,snapId:r}=T(this,n,"m",k).call(this,e);T(this,i,"f").delete(r,t.id);try{await T(this,s,"f").withSnapId(r).deleteAccount(t.id)}catch(t){console.error(`Account '${e}' may not have been removed from snap '${r}':`,t)}}getAccountByAddress(e){return this.listAccounts().find((({address:t})=>(0,U.equalsIgnoreCase)(t,e)))}listAccounts(){return[...T(this,i,"f").values()].map((({account:e,snapId:t})=>{const r=T(this,n,"m",C).call(this,t);return{...e,address:e.address.toLowerCase(),metadata:{name:"",importTime:0,keyring:{type:this.type},...r!==undefined&&{snap:r}}}}))}}r.SnapKeyring=L,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,n=new WeakSet,l=async function(e,t){(0,I.assert)(t,E.AccountCreatedEventStruct);const{account:r,accountNameSuggestion:n,displayConfirmation:s}=t.params;if(await T(this,a,"f").addressExists(r.address.toLowerCase()))throw new Error(`Account address '${r.address}' already exists`);if(T(this,i,"f").has(e,r.id))throw new Error(`Account '${r.id}' already exists`);return await T(this,a,"f").addAccount(r.address.toLowerCase(),e,(async t=>{t&&(T(this,i,"f").set(r.id,{account:r,snapId:e}),await T(this,a,"f").saveState())}),n,s),null},c=async function(e,t){(0,I.assert)(t,E.AccountUpdatedEventStruct);const{account:r}=t.params,{account:n}=T(this,i,"f").get(e,r.id)??(0,U.throwError)(`Account '${r.id}' not found`);if(!(0,U.equalsIgnoreCase)(n.address,r.address))throw new Error(`Cannot change address of account '${r.id}'`);return T(this,i,"f").set(r.id,{account:r,snapId:e}),await T(this,a,"f").saveState(),null},d=async function(e,t){(0,I.assert)(t,E.AccountDeletedEventStruct);const{id:r}=t.params,n=T(this,i,"f").get(e,r);if(n===undefined)return null;const{account:{address:s}}=n;return await T(this,a,"f").removeAccount(s.toLowerCase(),e,(async e=>{e&&await T(this,a,"f").saveState()})),null},u=async function(e,t){(0,I.assert)(t,E.RequestApprovedEventStruct);const{id:r,result:n}=t.params,{promise:s}=T(this,o,"f").get(e,r)??(0,U.throwError)(`Request '${r}' not found`);return T(this,o,"f").delete(e,r),s.resolve(n),null},h=async function(e,t){(0,I.assert)(t,E.RequestRejectedEventStruct);const{id:r}=t.params,{promise:n}=T(this,o,"f").get(e,r)??(0,U.throwError)(`Request '${r}' not found`);return T(this,o,"f").delete(e,r),n.reject(new Error("Request rejected by user or snap.")),null},p=async function({address:e,method:t,params:r,chainId:s="",expectSync:i=!1}){const{account:o,snapId:a}=T(this,n,"m",k).call(this,e);if(!T(this,n,"m",m).call(this,o,t))throw new Error(`Method '${t}' not supported for account ${o.address}`);const l=(0,N.v4)(),c=T(this,n,"m",g).call(this,l,a),d=await T(this,n,"m",f).call(this,{snapId:a,requestId:l,account:o,method:t,params:r,chainId:s});if(i&&d.pending)throw new Error(`Request '${l}' to snap '${a}' is pending and expectSync is true.`);return d.pending?((d.redirect?.message||d.redirect?.url)&&await T(this,n,"m",w).call(this,d.redirect,a),c.promise):T(this,n,"m",v).call(this,d,l,a)},m=function(e,t){return e.methods.includes(t)},g=function(e,t){const r=new j.DeferredPromise;return T(this,o,"f").set(e,{promise:r,snapId:t}),r},f=async function({snapId:e,requestId:t,account:r,method:n,params:i,chainId:a}){try{const o={id:t,scope:a,account:r.id,request:{method:n,...i!==undefined&&{params:i}}};return(0,O.projectLogger)("Submit Snap request: ",o),await T(this,s,"f").withSnapId(e).submitRequest(o)}catch(r){throw(0,O.projectLogger)("Snap Request failed: ",{requestId:t}),T(this,o,"f").delete(e,t),r}},v=function(e,t,r){return T(this,o,"f").delete(r,t),e.result},w=async function(e,t){const{message:r="",url:s=""}=e;s&&T(this,n,"m",y).call(this,s,t),await T(this,a,"f").redirectUser(t,s,r)},y=function(e,t){const{origin:r}=new URL(e),i=T(this,s,"f").getController().get(t);if(!i)throw new Error(`Snap '${t}' not found.`);if(!T(this,n,"m",b).call(this,i).includes(r))throw new Error(`Redirect URL domain '${r}' is not an allowed origin by snap '${t}'`)},k=function(e){return[...T(this,i,"f").values()].find((({account:t})=>(0,U.equalsIgnoreCase)(t.address,e)))??(0,U.throwError)(`Account '${e}' not found`)},C=function(e){const t=T(this,s,"f").getController().get(e);return t?{id:e,name:t.manifest.proposedName,enabled:t.enabled}:undefined},b=function(e){return e.manifest.initialPermissions["endowment:keyring"]?.allowedOrigins??[]},L.type=r.SNAP_KEYRING_TYPE}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/SnapKeyring.js"}],[1284,{"./SnapKeyring":1283,"./types":1286},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./types"),r),s(e("./SnapKeyring"),r)}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/index.js"}],[1285,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("eth-snap-keyring")}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/logger.js"}],[1286,{"@metamask/utils":2255,superstruct:4288},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapMessageStruct=void 0;const n=e("@metamask/utils"),s=e("superstruct");r.SnapMessageStruct=(0,s.object)({method:(0,s.string)(),params:(0,s.optional)((0,s.union)([(0,s.array)(n.JsonStruct),(0,s.record)((0,s.string)(),n.JsonStruct)]))})}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/types.js"}],[1287,{superstruct:4288},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.equalsIgnoreCase=r.throwError=r.ensureDefined=r.toJson=r.unique=r.strictMask=void 0;const n=e("superstruct");r.strictMask=function(e,t,r){return(0,n.assert)(e,t,r),e},r.unique=function(e){return[...new Set(e)]},r.toJson=function(e){return JSON.parse(JSON.stringify(e))},r.ensureDefined=function(e){if(e===undefined)throw new Error("Argument is undefined")},r.throwError=function(e){throw new Error(e)},r.equalsIgnoreCase=function(e,t){return e.toLowerCase()===t.toLowerCase()}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/util.js"}],[1288,{"./nil.js":1291,"./parse.js":1292,"./stringify.js":1296,"./v1.js":1297,"./v3.js":1298,"./v4.js":1300,"./v5.js":1301,"./validate.js":1302,"./version.js":1303},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return l.default}});var n=h(e("./v1.js")),s=h(e("./v3.js")),i=h(e("./v4.js")),o=h(e("./v5.js")),a=h(e("./nil.js")),l=h(e("./version.js")),c=h(e("./validate.js")),d=h(e("./stringify.js")),u=h(e("./parse.js"));function h(e){return e&&e.__esModule?e:{default:e}}}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/index.js"}],[1289,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return 14+(e+64>>>9<<4)+1}function s(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,r,n,i,o){return s((a=s(s(t,e),s(n,o)))<<(l=i)|a>>>32-l,r);var a,l}function o(e,t,r,n,s,o,a){return i(t&r|~t&n,e,t,s,o,a)}function a(e,t,r,n,s,o,a){return i(t&n|r&~n,e,t,s,o,a)}function l(e,t,r,n,s,o,a){return i(t^r^n,e,t,s,o,a)}function c(e,t,r,n,s,o,a){return i(r^(t|~n),e,t,s,o,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var d=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let s=0;s<r;s+=8){const r=e[s>>5]>>>s%32&255,i=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let r=1732584193,i=-271733879,d=-1732584194,u=271733878;for(let t=0;t<e.length;t+=16){const n=r,h=i,p=d,m=u;r=o(r,i,d,u,e[t],7,-680876936),u=o(u,r,i,d,e[t+1],12,-389564586),d=o(d,u,r,i,e[t+2],17,606105819),i=o(i,d,u,r,e[t+3],22,-1044525330),r=o(r,i,d,u,e[t+4],7,-176418897),u=o(u,r,i,d,e[t+5],12,1200080426),d=o(d,u,r,i,e[t+6],17,-1473231341),i=o(i,d,u,r,e[t+7],22,-45705983),r=o(r,i,d,u,e[t+8],7,1770035416),u=o(u,r,i,d,e[t+9],12,-1958414417),d=o(d,u,r,i,e[t+10],17,-42063),i=o(i,d,u,r,e[t+11],22,-1990404162),r=o(r,i,d,u,e[t+12],7,1804603682),u=o(u,r,i,d,e[t+13],12,-40341101),d=o(d,u,r,i,e[t+14],17,-1502002290),i=o(i,d,u,r,e[t+15],22,1236535329),r=a(r,i,d,u,e[t+1],5,-165796510),u=a(u,r,i,d,e[t+6],9,-1069501632),d=a(d,u,r,i,e[t+11],14,643717713),i=a(i,d,u,r,e[t],20,-373897302),r=a(r,i,d,u,e[t+5],5,-701558691),u=a(u,r,i,d,e[t+10],9,38016083),d=a(d,u,r,i,e[t+15],14,-660478335),i=a(i,d,u,r,e[t+4],20,-405537848),r=a(r,i,d,u,e[t+9],5,568446438),u=a(u,r,i,d,e[t+14],9,-1019803690),d=a(d,u,r,i,e[t+3],14,-187363961),i=a(i,d,u,r,e[t+8],20,1163531501),r=a(r,i,d,u,e[t+13],5,-1444681467),u=a(u,r,i,d,e[t+2],9,-51403784),d=a(d,u,r,i,e[t+7],14,1735328473),i=a(i,d,u,r,e[t+12],20,-1926607734),r=l(r,i,d,u,e[t+5],4,-378558),u=l(u,r,i,d,e[t+8],11,-2022574463),d=l(d,u,r,i,e[t+11],16,1839030562),i=l(i,d,u,r,e[t+14],23,-35309556),r=l(r,i,d,u,e[t+1],4,-1530992060),u=l(u,r,i,d,e[t+4],11,1272893353),d=l(d,u,r,i,e[t+7],16,-155497632),i=l(i,d,u,r,e[t+10],23,-1094730640),r=l(r,i,d,u,e[t+13],4,681279174),u=l(u,r,i,d,e[t],11,-358537222),d=l(d,u,r,i,e[t+3],16,-722521979),i=l(i,d,u,r,e[t+6],23,76029189),r=l(r,i,d,u,e[t+9],4,-640364487),u=l(u,r,i,d,e[t+12],11,-421815835),d=l(d,u,r,i,e[t+15],16,530742520),i=l(i,d,u,r,e[t+2],23,-995338651),r=c(r,i,d,u,e[t],6,-198630844),u=c(u,r,i,d,e[t+7],10,1126891415),d=c(d,u,r,i,e[t+14],15,-1416354905),i=c(i,d,u,r,e[t+5],21,-57434055),r=c(r,i,d,u,e[t+12],6,1700485571),u=c(u,r,i,d,e[t+3],10,-1894986606),d=c(d,u,r,i,e[t+10],15,-1051523),i=c(i,d,u,r,e[t+1],21,-2054922799),r=c(r,i,d,u,e[t+8],6,1873313359),u=c(u,r,i,d,e[t+15],10,-30611744),d=c(d,u,r,i,e[t+6],15,-1560198380),i=c(i,d,u,r,e[t+13],21,1309151649),r=c(r,i,d,u,e[t+4],6,-145523070),u=c(u,r,i,d,e[t+11],10,-1120210379),d=c(d,u,r,i,e[t+2],15,718787259),i=c(i,d,u,r,e[t+9],21,-343485551),r=s(r,n),i=s(i,h),d=s(d,p),u=s(u,m)}return[r,i,d,u]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};r.default=d}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/md5-browser.js"}],[129,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:10,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=10;try{const e=function(e){const t=(0,n.merge)({},e,{ShapeShiftController:{shapeShiftTxList:e.shapeShiftTxList||[]}});return delete t.shapeShiftTxList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #10${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/010.js"}],[1290,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};r.default=n}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/native-browser.js"}],[1291,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="00000000-0000-0000-0000-000000000000"}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/nil.js"}],[1292,{"./validate.js":1302},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var i=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/parse.js"}],[1293,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/regex.js"}],[1294,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)};const s=new Uint8Array(16)}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/rng-browser.js"}],[1295,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function s(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const i=e.length/4+2,o=Math.ceil(i/16),a=new Array(o);for(let t=0;t<o;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];a[t]=r}a[o-1][14]=8*(e.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<o;++e){const i=new Uint32Array(80);for(let t=0;t<16;++t)i[t]=a[e][t];for(let e=16;e<80;++e)i[e]=s(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let o=r[0],l=r[1],c=r[2],d=r[3],u=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),a=s(o,5)+n(r,l,c,d)+u+t[r]+i[e]>>>0;u=d,d=c,c=s(l,30)>>>0,l=o,o=a}r[0]=r[0]+o>>>0,r[1]=r[1]+l>>>0,r[2]=r[2]+c>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/sha1-browser.js"}],[1296,{"./validate.js":1302},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.unsafeStringify=o;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function o(e,t=0){return i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]}var a=function(e,t=0){const r=o(e,t);if(!(0,s.default)(r))throw TypeError("Stringified UUID is invalid");return r};r.default=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/stringify.js"}],[1297,{"./rng.js":1294,"./stringify.js":1296},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./rng.js"))&&n.__esModule?n:{default:n},i=e("./stringify.js");let o,a,l=0,c=0;var d=function(e,t,r){let n=t&&r||0;const d=t||new Array(16);let u=(e=e||{}).node||o,h=e.clockseq!==undefined?e.clockseq:a;if(null==u||null==h){const t=e.random||(e.rng||s.default)();null==u&&(u=o=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=a=16383&(t[6]<<8|t[7]))}let p=e.msecs!==undefined?e.msecs:Date.now(),m=e.nsecs!==undefined?e.nsecs:c+1;const g=p-l+(m-c)/1e4;if(g<0&&e.clockseq===undefined&&(h=h+1&16383),(g<0||p>l)&&e.nsecs===undefined&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=p,c=m,a=h,p+=122192928e5;const f=(1e4*(268435455&p)+m)%4294967296;d[n++]=f>>>24&255,d[n++]=f>>>16&255,d[n++]=f>>>8&255,d[n++]=255&f;const v=p/4294967296*1e4&268435455;d[n++]=v>>>8&255,d[n++]=255&v,d[n++]=v>>>24&15|16,d[n++]=v>>>16&255,d[n++]=h>>>8|128,d[n++]=255&h;for(let e=0;e<6;++e)d[n+e]=u[e];return t||(0,i.unsafeStringify)(d)};r.default=d}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v1.js"}],[1298,{"./md5.js":1289,"./v35.js":1299},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./v35.js")),s=i(e("./md5.js"));function i(e){return e&&e.__esModule?e:{default:e}}var o=(0,n.default)("v3",48,s.default);r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v3.js"}],[1299,{"./parse.js":1292,"./stringify.js":1296},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=void 0,r.default=function(e,t,r){function n(e,n,o,a){var l;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,i.default)(n)),16!==(null===(l=n)||void 0===l?void 0:l.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+e.length);if(c.set(n),c.set(e,n.length),c=r(c),c[6]=15&c[6]|t,c[8]=63&c[8]|128,o){a=a||0;for(let e=0;e<16;++e)o[a+e]=c[e];return o}return(0,s.unsafeStringify)(c)}try{n.name=e}catch(e){}return n.DNS=o,n.URL=a,n};var n,s=e("./stringify.js"),i=(n=e("./parse.js"))&&n.__esModule?n:{default:n};const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=o;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v35.js"}],[13,{"../../../shared/constants/metametrics":4434,"../../../shared/modules/hexstring-utils":4472,"@metamask/base-controller":1157,"@metamask/controller-utils":1166,"@metamask/message-manager":1460,"@metamask/utils":2255,buffer:2983,events:3276,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.isEIP1024EncryptedMessage=r.getDefaultState=r.default=void 0;var n=u(e("events")),s=u(e("loglevel")),i=e("@metamask/message-manager"),o=e("@metamask/base-controller"),a=e("@metamask/controller-utils"),l=e("@metamask/utils"),c=e("../../../shared/constants/metametrics"),d=e("../../../shared/modules/hexstring-utils");function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p={unapprovedDecryptMsgs:{persist:!1,anonymous:!1},unapprovedDecryptMsgCount:{persist:!1,anonymous:!1}},m=e=>!!((0,l.isObject)(e.data)&&(0,l.hasProperty)(e.data,"version")&&(0,l.hasProperty)(e.data,"nonce")&&(0,l.hasProperty)(e.data,"ephemPublicKey")&&(0,l.hasProperty)(e.data,"ciphertext"));r.isEIP1024EncryptedMessage=m;const g=()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0});r.getDefaultState=g;class f extends o.BaseController{constructor({getState:e,metricsEvent:t,messenger:r}){super({metadata:p,messenger:r,name:"DecryptMessageController",state:{unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}}),h(this,"hub",void 0),h(this,"_getState",void 0),h(this,"_metricsEvent",void 0),h(this,"_decryptMessageManager",void 0),this._getState=e,this._metricsEvent=t,this.hub=new n.default,this._decryptMessageManager=new i.DecryptMessageManager(undefined,undefined,undefined,["decrypted"]),this._decryptMessageManager.hub.on("updateBadge",(()=>{this.hub.emit("updateBadge")})),this._decryptMessageManager.hub.on("unapprovedMessage",(e=>{this._requestApproval(e)})),this._subscribeToMessageState(this._decryptMessageManager,((e,t,r)=>{e.unapprovedDecryptMsgs=t,e.unapprovedDecryptMsgCount=r}))}get unapprovedDecryptMsgCount(){return this._decryptMessageManager.getUnapprovedMessagesCount()}resetState(){this.update((()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0})))}clearUnapproved(){this._decryptMessageManager.update({unapprovedMessages:{},unapprovedMessagesCount:0})}async newRequestDecryptMessage(e,t){return this._decryptMessageManager.addUnapprovedMessageAsync(e,t)}async decryptMessage(e){const t=e.metamaskId;try{const r=await this._decryptMessageManager.approveMessage(e);if(r.data=this._parseMessageData(r.data),!m(r))throw new Error("Invalid encrypted data.");const n=await this.messagingSystem.call("KeyringController:decryptMessage",r);this._decryptMessageManager.setMessageStatusAndResult(t,n,"decrypted"),this._acceptApproval(t)}catch(e){throw s.default.info("MetaMaskController - eth_decrypt failed.",e),this._cancelAbstractMessage(this._decryptMessageManager,t),e}return this._getState()}async decryptMessageInline(e){const t=e.metamaskId;if(e.data=this._parseMessageData(e.data),!m(e))throw new Error("Invalid encrypted data.");const r=await this.messagingSystem.call("KeyringController:decryptMessage",e);return this._decryptMessageManager.setResult(t,r),this._getState()}cancelDecryptMessage(e){return this._decryptMessageManager.rejectMessage(e),this._rejectApproval(e),this._getState()}rejectUnapproved(e){Object.keys(this._decryptMessageManager.getUnapprovedMessages()).forEach((t=>{this._cancelAbstractMessage(this._decryptMessageManager,t,e)}))}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_cancelAbstractMessage(e,t,r){return r&&this._metricsEvent({event:r,category:c.MetaMetricsEventCategory.Messages,properties:{action:"Decrypt Message Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe((e=>{const r=this._migrateMessages(e.unapprovedMessages);this.update((n=>{t(n,r,e.unapprovedMessagesCount)}))}))}_migrateMessages(e){const t={};for(const r of Object.keys(e)){const n=e[r],s=this._migrateMessage(n);t[r]=s}return t}_migrateMessage(e){const{messageParams:t,...r}=e;return{...r,rawSig:e.rawSig,msgParams:t,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,r=e.origin||a.ORIGIN_METAMASK;try{this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:r,type:a.ApprovalType.EthDecrypt},!0)}catch(e){s.default.info("Error adding request to approval controller",e)}}_parseMessageData(e){const r=(0,d.stripHexPrefix)(e),n=t.from(r,"hex");return JSON.parse(n.toString("utf8"))}_rejectApproval(e){try{this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}catch(e){s.default.info("Error rejecting request to approval controller",e)}}}r.default=f}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/decrypt-message.ts"}],[130,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:11,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=11;try{const e=function(e){const t=e;return delete t.TOSHash,delete t.isDisclaimerConfirmed,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #11${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/011.js"}],[1300,{"./native.js":1290,"./rng.js":1294,"./stringify.js":1296},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./native.js")),s=o(e("./rng.js")),i=e("./stringify.js");function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();const o=(e=e||{}).random||(e.rng||s.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return(0,i.unsafeStringify)(o)};r.default=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v4.js"}],[1301,{"./sha1.js":1295,"./v35.js":1299},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./v35.js")),s=i(e("./sha1.js"));function i(e){return e&&e.__esModule?e:{default:e}}var o=(0,n.default)("v5",80,s.default);r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v5.js"}],[1302,{"./regex.js":1293},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./regex.js"))&&n.__esModule?n:{default:n};var i=function(e){return"string"==typeof e&&s.default.test(e)};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/validate.js"}],[1303,{"./validate.js":1302},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var i=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/version.js"}],[1308,{"./trezor-bridge":1309,"./trezor-connect-bridge":1310,"./trezor-keyring":1311},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./trezor-keyring"),r),s(e("./trezor-bridge"),r),s(e("./trezor-connect-bridge"),r)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/index.js"}],[1309,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-bridge.js"}],[131,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:12,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=12;try{const e=function(e){const t=e;return t.NoticeController.noticesList.forEach((e=>{e.read&&(e.body="")})),t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #12${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/012.js"}],[1310,{"@trezor/connect-web":1317},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorConnectBridge=void 0;const o=i(e("@trezor/connect-web"));r.TrezorConnectBridge=class{constructor(){this.trezorConnectInitiated=!1}async init(e){o.default.on(o.DEVICE_EVENT,(e=>{var t;e.type===o.DEVICE.CONNECT&&(this.model=null===(t=e.payload.features)||void 0===t?void 0:t.model)})),this.trezorConnectInitiated||(await o.default.init(e),this.trezorConnectInitiated=!0)}dispose(){return o.default.dispose(),Promise.resolve()}getPublicKey(e){return o.default.getPublicKey(e)}ethereumSignTransaction(e){return o.default.ethereumSignTransaction(e)}ethereumSignMessage(e){return o.default.ethereumSignMessage(e)}ethereumSignTypedData(e){return o.default.ethereumSignTypedData(e)}}}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-connect-bridge.js"}],[1311,{"@ethereumjs/tx":429,"@ethereumjs/util":441,"@trezor/connect-plugin-ethereum":2487,buffer:2983,events:3276,hdkey:3573},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n,s,i,o,a,l,c=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&c(t,e,r);return d(t,e),t},h=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorKeyring=r.TREZOR_CONNECT_MANIFEST=void 0;const m=e("events"),g=u(e("@ethereumjs/util")),f=p(e("hdkey")),v=e("@ethereumjs/tx"),w=e("@trezor/connect-plugin-ethereum"),y="m/44'/60'/0'/0",k={[y]:!0,"m/44'/60'/0'":!0,"m/44'/1'/0'/0":!0},C="Trezor Hardware",b=1e3;async function _(e){return new Promise((t=>setTimeout(t,e)))}function T(e){return"function"==typeof e.getChainId}r.TREZOR_CONNECT_MANIFEST={email:"support@metamask.io",appUrl:"https://metamask.io"};class S extends m.EventEmitter{constructor({bridge:e}){if(super(),n.add(this),this.type=C,this.accounts=[],this.hdk=new f.default,this.hdPath=y,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}getModel(){return this.bridge.model}init(){return this.bridge.init({manifest:r.TREZOR_CONNECT_MANIFEST,lazyLoad:!0})}async destroy(){return this.bridge.dispose()}async serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}async deserialize(e={}){var t,r,n,s;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:y,this.accounts=null!==(r=e.accounts)&&void 0!==r?r:[],this.page=null!==(n=e.page)&&void 0!==n?n:0,this.perPage=null!==(s=e.perPage)&&void 0!==s?s:5,Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}async unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((e,r)=>{this.bridge.getPublicKey({path:this.hdPath,coin:"ETH"}).then((n=>{var s;n.success?(this.hdk.publicKey=t.from(n.payload.publicKey,"hex"),this.hdk.chainCode=t.from(n.payload.chainCode,"hex"),e("just unlocked")):r(new Error((null===(s=n.payload)||void 0===s?void 0:s.error)||"Unknown error"))})).catch((e=>{r(new Error((null==e?void 0:e.toString())||"Unknown error"))}))}))}setAccountToUnlock(e){this.unlockedAccount=parseInt(String(e),10)}async addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((r=>{const s=this.unlockedAccount,i=s+e;for(let e=s;e<i;e++){const t=h(this,n,"m",a).call(this,"m",e);this.accounts.includes(t)||(this.accounts=[...this.accounts,t]),this.page=0}t(this.accounts)})).catch((e=>{r(e)}))}))}async getFirstPage(){return this.page=0,h(this,n,"m",s).call(this,1)}async getNextPage(){return h(this,n,"m",s).call(this,1)}async getPreviousPage(){return h(this,n,"m",s).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){return T(r)?h(this,n,"m",i).call(this,e,r.getChainId(),r,(e=>(r.v=t.from(e.v,"hex"),r.r=t.from(e.r,"hex"),r.s=t.from(e.s,"hex"),r))):h(this,n,"m",i).call(this,e,Number(r.common.chainId()),r,(e=>{const t=r.toJSON();return t.type=r.type,t.v=g.addHexPrefix(e.v),t.r=g.addHexPrefix(e.r),t.s=g.addHexPrefix(e.s),v.TransactionFactory.fromTxData(t,{common:r.common,freeze:Object.isFrozen(r)})}))}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){return new Promise(((r,s)=>{this.unlock().then((i=>{setTimeout((()=>{this.bridge.ethereumSignMessage({path:h(this,n,"m",l).call(this,e),message:g.stripHexPrefix(t),hex:!0}).then((t=>{var n;if(t.success){t.payload.address!==g.toChecksumAddress(e)&&s(new Error("signature doesnt match the right address"));const n=`0x${t.payload.signature}`;r(n)}else s(new Error((null===(n=t.payload)||void 0===n?void 0:n.error)||"Unknown error"))})).catch((e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))}))}),"just unlocked"===i?b:0)})).catch((e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))}))}))}async signTypedData(e,t,{version:r}){var s,i;const o=(0,w.transformTypedData)(t,"V4"===r),{types:a,message:c={},domain:d={},primaryType:u,domain_separator_hash:p,message_hash:m}=o,f=await this.unlock();await _("just unlocked"===f?b:0);const v=await this.bridge.ethereumSignTypedData({path:h(this,n,"m",l).call(this,e),data:{types:Object.assign(Object.assign({},a),{EIP712Domain:null!==(s=a.EIP712Domain)&&void 0!==s?s:[]}),message:c,domain:d,primaryType:u},metamask_v4_compat:!0,domain_separator_hash:p,message_hash:null!=m?m:""});if(v.success){if(g.toChecksumAddress(e)!==v.payload.address)throw new Error("signature doesnt match the right address");return v.payload.signature}throw new Error((null===(i=v.payload)||void 0===i?void 0:i.error)||"Unknown error")}async exportAccount(){return Promise.reject(new Error("Not supported on this device"))}forgetDevice(){this.accounts=[],this.hdk=new f.default,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!k[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new f.default,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}}r.TrezorKeyring=S,n=new WeakSet,s=async function(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise(((e,t)=>{this.unlock().then((t=>{const r=(this.page-1)*this.perPage,s=r+this.perPage,i=[];for(let e=r;e<s;e++){const t=h(this,n,"m",a).call(this,"m",e);i.push({address:t,balance:null,index:e}),this.paths[g.toChecksumAddress(t)]=e}e(i)})).catch((e=>{t(e)}))}))},i=async function(e,t,r,s){var i,a;let c;c=T(r)?{to:h(this,n,"m",o).call(this,r.to),value:h(this,n,"m",o).call(this,r.value),data:h(this,n,"m",o).call(this,r.data),chainId:t,nonce:h(this,n,"m",o).call(this,r.nonce),gasLimit:h(this,n,"m",o).call(this,r.gasLimit),gasPrice:h(this,n,"m",o).call(this,r.gasPrice)}:Object.assign(Object.assign({},r.toJSON()),{chainId:t,to:h(this,n,"m",o).call(this,g.toBuffer(r.to))});try{const t=await this.unlock();await _("just unlocked"===t?b:0);const r=await this.bridge.ethereumSignTransaction({path:h(this,n,"m",l).call(this,e),transaction:c});if(r.success){const t=s(r.payload),n=g.toChecksumAddress(g.addHexPrefix(t.getSenderAddress().toString("hex")));if(n!==g.toChecksumAddress(e))throw new Error("signature doesn't match the right address");return t}throw new Error((null===(i=r.payload)||void 0===i?void 0:i.error)||"Unknown error")}catch(e){throw new Error(null!==(a=null==e?void 0:e.toString())&&void 0!==a?a:"Unknown error")}},o=function(e){return g.bufferToHex(e).toString()},a=function(e,t){const r=this.hdk.derive(`${e}/${t}`),n=g.publicToAddress(r.publicKey,!0).toString("hex");return g.toChecksumAddress(`0x${n}`)},l=function(e){const t=g.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===h(this,n,"m",a).call(this,"m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`},S.type=C}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-keyring.js"}],[1312,{"@trezor/connect-common":2483},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ServiceWorkerWindowChannel=void 0;const n=e("@trezor/connect-common");class s extends n.AbstractMessageChannel{constructor({name:e,channel:t,logger:r,lazyHandshake:n,legacyMode:s,allowSelfOrigin:i=!1,currentId:o}){super({channel:t,sendFn:e=>{if(!this.port)throw new Error("port not assigned");this.port.postMessage(e)},logger:r,lazyHandshake:n,legacyMode:s}),this.name=e,this.allowSelfOrigin=i,this.currentId=o,this.connect()}connect(){chrome.runtime.onConnect.addListener((e=>{var t,r,n,s;e.name===this.name&&((null===(t=this.currentId)||void 0===t?void 0:t.call(this))&&(null===(r=this.currentId)||void 0===r?void 0:r.call(this))!==(null===(s=null===(n=e.sender)||void 0===n?void 0:n.tab)||void 0===s?void 0:s.id)||(this.port=e,this.port.onMessage.addListener(((e,{sender:t})=>{var r,n,s,i;if(!t)return void(null===(r=this.logger)||void 0===r||r.error("service-worker-window","no sender"));const{origin:o}=t,a=["https://connect.trezor.io","https://staging-connect.trezor.io","https://suite.corp.sldev.cz","https://dev.suite.sldev.cz","http://localhost:8088"],l=null===(n=null===chrome||void 0===chrome?void 0:chrome.runtime)||void 0===n?void 0:n.id;l&&a.push(`chrome-extension://${l}`),o?a.includes(o)?(o!==self.origin||this.allowSelfOrigin)&&this.onMessage(e):null===(i=this.logger)||void 0===i||i.error("connect-webextension/messageChannel/extensionPort/onMessage","origin not whitelisted",o):null===(s=this.logger)||void 0===s||s.error("connect-webextension/messageChannel/extensionPort/onMessage","no origin")}))))})),this.isConnected=!0}disconnect(){var e;this.isConnected&&(null===(e=this.port)||void 0===e||e.disconnect(),this.clear(),this.isConnected=!1)}}r.ServiceWorkerWindowChannel=s}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/channels/serviceworker-window.js"}],[1313,{"@trezor/connect-common":2483},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WindowWindowChannel=void 0;const n=e("@trezor/connect-common");class s extends n.AbstractMessageChannel{constructor({windowHere:e,windowPeer:t,channel:r,logger:n,origin:s}){super({channel:r,sendFn:e=>{var r;null===(r=t())||void 0===r||r.postMessage(e,s)},logger:n}),this._listener=this.listener.bind(this),this._windowHere=e,this.connect()}listener(e){const t=Object.assign(Object.assign({},e.data),{success:!0,origin:e.origin,payload:e.data.payload||{},channel:e.data.channel||{peer:this.channel.here,here:this.channel.peer}});this.onMessage(t)}connect(){this._windowHere.addEventListener("message",this._listener),this.isConnected=!0}disconnect(){this.isConnected&&(this._windowHere.removeEventListener("message",this._listener),this.isConnected=!1)}}r.WindowWindowChannel=s}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/channels/window-window.js"}],[1314,{"@trezor/connect/lib/data/connectSettings":2503},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.parseConnectSettings=r.getEnv=void 0;const n=e("@trezor/connect/lib/data/connectSettings");r.getEnv=()=>{var e;if("undefined"!=typeof chrome&&void 0!==(null===(e=chrome.runtime)||void 0===e?void 0:e.onConnect))return"webextension";if("undefined"!=typeof navigator){if("string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return"react-native";if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)return"electron"}return"web"};r.parseConnectSettings=(e={})=>{var t;const s=Object.assign({popup:!0},e);let i;if("undefined"!=typeof window?i=window.__TREZOR_CONNECT_SRC:"undefined"!=typeof global&&(i=global.__TREZOR_CONNECT_SRC),"string"==typeof i&&(s.connectSrc=i,s.debug=!0),"undefined"!=typeof window&&"string"==typeof(null===(t=window.location)||void 0===t?void 0:t.search)){const e=((e,t)=>{const r=new URLSearchParams(e),n={};return Array.from(r.entries()).forEach((([e,r])=>{t.includes(e)&&(n[e]=decodeURIComponent(r))})),n})(window.location.search,["trezor-connect-src"]);e["trezor-connect-src"]&&(s.debug=!0,s.connectSrc=e["trezor-connect-src"])}return"string"!=typeof e.env&&(s.env=(0,r.getEnv)()),(0,n.parseConnectSettings)(s)}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/connectSettings.js"}],[1315,{"./inlineStyles":1316,"@trezor/connect/lib/constants/errors":2498,"@trezor/connect/lib/events":2510,"@trezor/connect/lib/utils/debug":2537,"@trezor/connect/lib/utils/urlUtils":2538,"@trezor/utils":2578,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initIframeLogger=r.clearTimeout=r.postMessage=r.init=r.dispose=r.error=r.timeout=r.initPromise=r.origin=r.instance=void 0;const n=e("tslib"),s=e("@trezor/utils"),i=n.__importStar(e("@trezor/connect/lib/constants/errors")),o=e("@trezor/connect/lib/events"),a=e("@trezor/connect/lib/utils/urlUtils"),l=e("@trezor/connect/lib/utils/debug"),c=n.__importDefault(e("./inlineStyles"));r.initPromise=(0,s.createDeferred)(),r.timeout=0;r.dispose=()=>{if(r.instance&&r.instance.parentNode)try{r.instance.parentNode.removeChild(r.instance)}catch(e){}r.instance=null,r.timeout=0};r.init=async e=>{r.initPromise=(0,s.createDeferred)();const t=document.getElementById("trezorconnect");let n;if(t?r.instance=t:(r.instance=document.createElement("iframe"),r.instance.frameBorder="0",r.instance.width="0px",r.instance.height="0px",r.instance.style.position="absolute",r.instance.style.display="none",r.instance.style.border="0px",r.instance.style.width="0px",r.instance.style.height="0px",r.instance.id="trezorconnect"),"web"===e.env){const t=e.manifest?JSON.stringify(e.manifest):"undefined",r=`version=${e.version}&manifest=${encodeURIComponent(btoa(JSON.stringify(t)))}`;n=`${e.iframeSrc}?${r}`}else n=e.iframeSrc;r.instance.setAttribute("src",n),e.webusb&&console.warn('webusb option is deprecated. use `transports: ["WebUsbTransport"] instead`'),navigator.usb&&r.instance.setAttribute("allow","usb"),r.origin=(0,a.getOrigin)(r.instance.src),r.timeout=window.setTimeout((()=>{r.initPromise.reject(i.TypedError("Init_IframeTimeout"))}),1e4);const l=()=>{var t,n;if(!r.instance)return void r.initPromise.reject(i.TypedError("Init_IframeBlocked"));try{const e=null===(t=r.instance.contentWindow)||void 0===t?void 0:t.location.origin;if(!e||"null"===e)return window.clearTimeout(r.timeout),r.error=i.TypedError("Init_IframeBlocked"),(0,r.dispose)(),void r.initPromise.reject(r.error)}catch(e){}let s;"undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect&&(chrome.runtime.onConnect.addListener((()=>{})),s=chrome.runtime.id),null===(n=r.instance.contentWindow)||void 0===n||n.postMessage({type:o.IFRAME.INIT,payload:{settings:e,extension:s}},r.origin),r.instance.onload=null};r.instance.attachEvent?r.instance.attachEvent("onload",l):r.instance.onload=l,document.body&&(document.body.appendChild(r.instance),(()=>{if(!r.instance)throw i.TypedError("Init_IframeBlocked");const e=r.instance.ownerDocument,t=e.head||e.getElementsByTagName("head")[0],n=document.createElement("style");n.setAttribute("type","text/css"),n.setAttribute("id","TrezorConnectStylesheet"),n.styleSheet?(n.styleSheet.cssText=c.default,t.appendChild(n)):(n.appendChild(document.createTextNode(c.default)),t.append(n))})());try{await r.initPromise.promise}catch(e){throw r.instance&&(r.instance.parentNode&&r.instance.parentNode.removeChild(r.instance),r.instance=null),e}finally{window.clearTimeout(r.timeout),r.timeout=0}};r.postMessage=e=>{var t;if(!r.instance)throw i.TypedError("Init_IframeBlocked");null===(t=r.instance.contentWindow)||void 0===t||t.postMessage(e,r.origin)};r.clearTimeout=()=>{window.clearTimeout(r.timeout)};r.initIframeLogger=()=>{(0,l.setLogWriter)((()=>({add:e=>{(0,r.postMessage)({type:o.IFRAME.LOG,payload:e})}})))}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/iframe/index.js"}],[1316,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.default='.trezorconnect-container{position:fixed!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-ms-flex-direction:column!important;flex-direction:column!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important;z-index:10000!important;width:100%!important;height:100%!important;top:0!important;left:0!important;background:rgba(0,0,0,.35)!important;overflow:auto!important;padding:20px!important;margin:0!important}.trezorconnect-container .trezorconnect-window{position:relative!important;display:block!important;width:370px!important;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif!important;margin:auto!important;border-radius:3px!important;background-color:#fff!important;text-align:center!important;overflow:hidden!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head{text-align:left;padding:12px 24px!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-logo{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close{cursor:pointer!important;height:24px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close svg{fill:#757575;-webkit-transition:fill .3s ease-in-out!important;transition:fill .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close:hover svg{fill:#494949}.trezorconnect-container .trezorconnect-window .trezorconnect-body{padding:24px 24px 32px!important;background:#FBFBFB!important;border-top:1px solid #EBEBEB}.trezorconnect-container .trezorconnect-window .trezorconnect-body h3{color:#505050!important;font-size:16px!important;font-weight:500!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body p{margin:8px 0 24px!important;font-weight:400!important;color:#A9A9A9!important;font-size:12px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button{width:100%!important;padding:12px 24px!important;margin:0!important;border-radius:3px!important;font-size:14px!important;font-weight:300!important;cursor:pointer!important;background:#01B757!important;color:#fff!important;border:0!important;-webkit-transition:background-color .3s ease-in-out!important;transition:background-color .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:hover{background-color:#00AB51!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:active{background-color:#009546!important}/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0IiwiJHN0ZGluIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLHlCQUNJLFNBQUEsZ0JBQ0EsUUFBQSxzQkFDQSxRQUFBLHVCQUNBLFFBQUEsc0JBRUEsUUFBQSxlQUNBLG1CQUFBLG1CQUNBLHNCQUFBLGlCQUNBLHVCQUFBLGlCQUNBLG1CQUFBLGlCQUNBLGVBQUEsaUJBRUEsa0JBQUEsaUJBQ0Esb0JBQUEsaUJBQ0EsZUFBQSxpQkNmTSxZQUFhLGlCREFyQixRQUFTLGdCQWtCSCxNQUFBLGVBQ0EsT0FBQSxlQUNBLElBQUEsWUFDQSxLQUFBLFlBQ0EsV0FBQSwwQkFDQSxTQUFBLGVBQ0EsUUFBQSxlQUNBLE9BQUEsWUNkUiwrQ0RYRSxTQUFVLG1CQTZCQSxRQUFBLGdCQUNBLE1BQUEsZ0JBQ0EsWUFBQSxjQUFBLG1CQUFBLFdBQUEsT0FBQSxpQkFBQSxNQUFBLHFCQUNBLE9BQUEsZUNmVixjQUFlLGNEakJmLGlCQWlCRSxlQWtCWSxXQUFBLGlCQ2ZkLFNBQVUsaUJEbUJJLG1FQUNBLFdBQUEsS0NoQmQsUUFBUyxLQUFLLGVEeEJkLFFBQVMsc0JBMENTLFFBQUEsdUJBQ0EsUUFBQSxzQkNmbEIsUUFBUyxlRGlCSyxrQkE1QlosaUJBOEJvQixvQkFBQSxpQkNoQmxCLGVBQWdCLGlCRC9CWixZQWlCTixpQkFzQ1EsdUZBQ0EsaUJBQUEsRUNwQlYsYUFBYyxFRHBDVixTQUFVLEVBMkRBLEtBQUEsRUFFQSx3RkNwQmQsT0FBUSxrQkR6Q1IsT0FBUSxlQWlFTSw0RkFDQSxLQUFBLFFBQ0EsbUJBQUEsS0FBQSxJQUFBLHNCQ3BCZCxXQUFZLEtBQUssSUFBSyxzQkR3QlIsa0dBQ0EsS0FBQSxRQUVBLG1FQUNBLFFBQUEsS0FBQSxLQUFBLGVBQ0EsV0FBQSxrQkFDQSxXQUFBLElBQUEsTUFBQSxRQUVBLHNFQUNBLE1BQUEsa0JBQ0EsVUFBQSxlQ3JCZCxZQUFhLGNEd0JLLHFFQ3JCbEIsT0FBUSxJQUFJLEVBQUksZUR3QkYsWUFBQSxjQUNJLE1BQUEsa0JDdEJsQixVQUFXLGVBRWIsMEVBQ0UsTUFBTyxlQUNQLFFBQVMsS0FBSyxlQUNkLE9BQVEsWUFDUixjQUFlLGNBQ2YsVUFBVyxlQUNYLFlBQWEsY0FDYixPQUFRLGtCQUNSLFdBQVksa0JBQ1osTUFBTyxlQUNQLE9BQVEsWUFDUixtQkFBb0IsaUJBQWlCLElBQUssc0JBQzFDLFdBQVksaUJBQWlCLElBQUssc0JBRXBDLGdGQUNFLGlCQUFrQixrQkFFcEIsaUZBQ0UsaUJBQWtCIn0= */'}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/iframe/inlineStyles.js"}],[1317,{"./connectSettings":1314,"./iframe":1315,"./popup":1318,"./webusb/button":1320,"@trezor/connect/lib/constants/errors":2498,"@trezor/connect/lib/data/config":2502,"@trezor/connect/lib/events":2510,"@trezor/connect/lib/exports":2517,"@trezor/connect/lib/factory":2518,"@trezor/connect/lib/utils/debug":2537,"@trezor/utils":2578,events:3276,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});const n=e("tslib"),s=n.__importDefault(e("events")),i=n.__importStar(e("@trezor/connect/lib/constants/errors")),o=e("@trezor/connect/lib/events"),a=e("@trezor/connect/lib/factory"),l=e("@trezor/connect/lib/utils/debug"),c=e("@trezor/connect/lib/data/config"),d=e("@trezor/utils"),u=n.__importStar(e("./iframe")),h=n.__importStar(e("./popup")),p=n.__importDefault(e("./webusb/button")),m=e("./connectSettings"),g=new s.default,f=(0,l.initLog)("@trezor/connect-web");let v,w=(0,m.parseConnectSettings)();const y=(0,d.createDeferredManager)({initialId:1}),k=()=>{const e=new h.PopupManager(w,{logger:f});return e.on(o.POPUP.CLOSED,(e=>{u.postMessage({type:o.POPUP.CLOSED,payload:e?{error:e}:null})})),e},C=()=>(g.removeAllListeners(),u.dispose(),w=(0,m.parseConnectSettings)(),v&&v.close(),Promise.resolve(undefined)),b=e=>{if(e.origin!==u.origin)return;const t=(0,o.parseMessage)(e.data);switch(f.log("handleMessage",t),t.event){case o.RESPONSE_EVENT:{const{id:e=0,success:r,payload:n}=t;y.resolve(e,{id:e,success:r,payload:n})||f.warn(`Unknown message id ${e}`);break}case o.DEVICE_EVENT:case o.TRANSPORT_EVENT:case o.BLOCKCHAIN_EVENT:g.emit(t.event,t),g.emit(t.type,t.payload);break;case o.UI_EVENT:if(t.type===o.IFRAME.BOOTSTRAP){u.clearTimeout();break}t.type===o.IFRAME.LOADED&&u.initPromise.resolve(),t.type===o.IFRAME.ERROR&&u.initPromise.reject(t.payload.error),g.emit(t.event,t),g.emit(t.type,t.payload);break;default:f.log("Undefined message",e.data)}},_=async(e={})=>{var t;if(u.instance)throw i.TypedError("Init_AlreadyInitialized");if(w=(0,m.parseConnectSettings)(Object.assign(Object.assign({},w),e)),!w.manifest)throw i.TypedError("Init_ManifestMissing");(null===(t=w.transports)||void 0===t?void 0:t.length)||(w.transports=["BridgeTransport","WebUsbTransport"]),w.lazyLoad?w.lazyLoad=!1:(v||(v=k()),f.enabled=!!w.debug,window.addEventListener("message",b),window.addEventListener("unload",C),await u.init(w),!1!==w.sharedLogger&&u.initIframeLogger())},T=async e=>{if(!u.instance&&!u.timeout){if(w=(0,m.parseConnectSettings)(w),!w.manifest)return(0,o.createErrorMessage)(i.TypedError("Init_ManifestMissing"));v||(v=k()),v.request();try{await _(w)}catch(e){return v&&(["Init_IframeBlocked","Init_IframeTimeout"].includes(e.code)?v.postMessage((0,o.createUiMessage)(o.UI.IFRAME_FAILURE)):v.clear()),(0,o.createErrorMessage)(e)}}if(u.timeout)return(0,o.createErrorMessage)(i.TypedError("Init_ManifestMissing"));if(u.error)return(0,o.createErrorMessage)(u.error);w.popup&&v&&v.request();try{const{promiseId:t,promise:r}=y.create();u.postMessage({id:t,type:o.IFRAME.CALL,payload:e});const n=await r;return n?(!n.success&&"Device_CallInProgress"!==n.payload.code&&v&&v.unlock(),n):(v&&v.unlock(),(0,o.createErrorMessage)(i.TypedError("Method_NoResponse")))}catch(e){return f.error("__call error",e),v&&v.clear(!1),(0,o.createErrorMessage)(e)}},S=(0,a.factory)({eventEmitter:g,manifest:e=>{w=(0,m.parseConnectSettings)(Object.assign(Object.assign({},w),{manifest:e}))},init:_,call:T,requestLogin:async e=>{if("function"==typeof e.callback){const{callback:t}=e,r=async e=>{const{data:r}=e;if(r&&r.type===o.UI.LOGIN_CHALLENGE_REQUEST)try{const e=await t();u.postMessage({type:o.UI.LOGIN_CHALLENGE_RESPONSE,payload:e})}catch(e){u.postMessage({type:o.UI.LOGIN_CHALLENGE_RESPONSE,payload:e.message})}};window.addEventListener("message",r,!1);const n=await T(Object.assign(Object.assign({method:"requestLogin"},e),{asyncChallenge:!0,callback:null}));return window.removeEventListener("message",r),n}return T(Object.assign({method:"requestLogin"},e))},uiResponse:e=>{if(!u.instance)throw i.TypedError("Init_NotInitialized");u.postMessage(e)},renderWebUSBButton:e=>{(0,p.default)(e,w.webusbSrc)},disableWebUSB:()=>{if(!u.instance)throw i.TypedError("Init_NotInitialized");u.postMessage({type:o.TRANSPORT.DISABLE_WEBUSB})},requestWebUSBDevice:async()=>{try{await window.navigator.usb.requestDevice({filters:c.config.webusb}),u.postMessage({type:o.TRANSPORT.REQUEST_DEVICE})}catch(e){}},cancel:e=>{v&&v.emit(o.POPUP.CLOSED,e)},dispose:C});r.default=S,n.__exportStar(e("@trezor/connect/lib/exports"),r)}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/index.js"}],[1318,{"../channels/serviceworker-window":1312,"../channels/window-window":1313,"./showPopupRequest":1319,"@trezor/connect/lib/events":2510,"@trezor/connect/lib/utils/urlUtils":2538,"@trezor/utils":2578,events:3276,tslib:4308},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PopupManager=void 0;const n=e("tslib").__importDefault(e("events")),s=e("@trezor/utils"),i=e("@trezor/connect/lib/events"),o=e("@trezor/connect/lib/utils/urlUtils"),a=e("./showPopupRequest"),l=e("../channels/serviceworker-window"),c=e("../channels/window-window");class d extends n.default{constructor(e,{logger:t}){var r;super(),this.locked=!1,this.extensionTabId=0,this.injectContentScript=e=>{chrome.permissions.getAll((t=>{var r;(null===(r=t.permissions)||void 0===r?void 0:r.includes("scripting"))&&chrome.scripting.executeScript({target:{tabId:e},func:()=>{}}).then((()=>this.logger.debug("content script injected"))).catch((e=>this.logger.error("content script injection error",e)))}))},this.settings=e,this.origin=(0,o.getOrigin)(e.popupSrc),this.logger=t,"webextension"===this.settings.env?this.channel=new l.ServiceWorkerWindowChannel({name:"trezor-connect",channel:{here:"@trezor/connect-webextension",peer:"@trezor/connect-content-script"},logger:t,currentId:()=>{var e,t;if("tab"===(null===(e=this.popupWindow)||void 0===e?void 0:e.mode))return null===(t=this.popupWindow)||void 0===t?void 0:t.tab.id},legacyMode:!this.settings.useCoreInPopup}):this.channel=new c.WindowWindowChannel({windowHere:window,windowPeer:()=>{var e,t;if("window"===(null===(e=this.popupWindow)||void 0===e?void 0:e.mode))return null===(t=this.popupWindow)||void 0===t?void 0:t.window},channel:{here:"@trezor/connect-web",peer:"@trezor/connect-popup"},logger:t,origin:this.origin}),this.settings.useCoreInPopup||(this.iframeHandshakePromise=(0,s.createDeferred)(i.IFRAME.LOADED),this.channelIframe=new c.WindowWindowChannel({windowHere:window,windowPeer:()=>window,channel:{here:"@trezor/connect-web",peer:"@trezor/connect-iframe"},logger:t,origin:this.origin}),null===(r=this.channelIframe)||void 0===r||r.on("message",this.handleMessage.bind(this))),this.settings.useCoreInPopup?(this.handshakePromise=(0,s.createDeferred)(),this.channel.on("message",this.handleCoreMessage.bind(this))):"webextension"===this.settings.env?this.channel.on("message",this.handleExtensionMessage.bind(this)):this.channel.on("message",this.handleMessage.bind(this)),this.channel.init()}async request(){var e,t,r,n,s,i;if(this.settings.useCoreInPopup&&"tab"===(null===(e=this.popupWindow)||void 0===e?void 0:e.mode)){await(i=null===(r=null===(t=this.popupWindow)||void 0===t?void 0:t.tab)||void 0===r?void 0:r.id,new Promise((e=>{if(!i)return e(!1);chrome.tabs.get(i,(function(){chrome.runtime.lastError?e(!1):e(!0)}))})))||this.clear()}if(this.locked)return void("tab"===(null===(n=this.popupWindow)||void 0===n?void 0:n.mode)&&this.popupWindow.tab.id?chrome.tabs.update(this.popupWindow.tab.id,{active:!0}):"window"===(null===(s=this.popupWindow)||void 0===s?void 0:s.mode)&&this.popupWindow.window.focus());this.popupWindow&&!this.locked&&this.close();const o=this.open.bind(this);this.locked=!0;const a="webextension"===this.settings.env?1:850;this.requestTimeout=setTimeout((()=>{this.requestTimeout=undefined,o()}),a)}unlock(){this.locked=!1}open(){const e=this.settings.popupSrc;this.settings.useCoreInPopup?this.openWrapper(e):(this.popupPromise=(0,s.createDeferred)(i.POPUP.LOADED),this.openWrapper(e),this.closeInterval=setInterval((()=>{this.popupWindow&&("tab"===this.popupWindow.mode&&this.popupWindow.tab.id?chrome.tabs.get(this.popupWindow.tab.id,(e=>{e||(this.emit(i.POPUP.CLOSED),this.clear())})):"window"===this.popupWindow.mode&&this.popupWindow.window.closed&&(this.clear(),this.emit(i.POPUP.CLOSED)))}),500),this.openTimeout=setTimeout((()=>{this.clear(),(0,a.showPopupRequest)(this.open.bind(this),(()=>{this.emit(i.POPUP.CLOSED)}))}),3e3))}openWrapper(e){if("webextension"===this.settings.env)chrome.windows.getCurrent((t=>{this.logger.debug("opening popup. currentWindow: ",t),"normal"!==t.type?chrome.windows.create({url:e},(e=>{chrome.tabs.query({windowId:null==e?void 0:e.id,active:!0},(e=>{this.popupWindow={mode:"tab",tab:e[0]},this.injectContentScript(e[0].id)}))})):chrome.tabs.query({currentWindow:!0,active:!0},(t=>{this.extensionTabId=t[0].id,chrome.tabs.create({url:e,index:t[0].index+1},(e=>{this.popupWindow={mode:"tab",tab:e},this.injectContentScript(e.id)}))}))}));else{const t=window.open(e,"modal");if(!t)return;this.popupWindow={mode:"window",window:t}}this.channel.isConnected||this.channel.connect()}handleCoreMessage(e){var t;e.type===i.POPUP.CORE_LOADED?(this.channel.postMessage({type:i.POPUP.HANDSHAKE,payload:{settings:this.settings}}),null===(t=this.handshakePromise)||void 0===t||t.resolve()):e.type===i.POPUP.CLOSED&&this.channel.resolveMessagePromises({code:"Method_Interrupted",error:i.POPUP.CLOSED})}handleExtensionMessage(e){e.type===i.POPUP.ERROR||e.type===i.POPUP.LOADED||e.type===i.POPUP.BOOTSTRAP?this.handleMessage(e):e.type===i.POPUP.EXTENSION_USB_PERMISSIONS?chrome.tabs.query({currentWindow:!0,active:!0},(e=>{chrome.tabs.create({url:"trezor-usb-permissions.html",index:e[0].index+1},(e=>{}))})):e.type===i.POPUP.CLOSE_WINDOW&&this.clear()}handleMessage(e){var t,r;if(e.type===i.IFRAME.LOADED)null===(t=this.iframeHandshakePromise)||void 0===t||t.resolve(e.payload);else if(e.type===i.POPUP.BOOTSTRAP)this.openTimeout&&clearTimeout(this.openTimeout);else if(e.type===i.POPUP.ERROR&&this.popupWindow){const t=e.payload&&"string"==typeof e.payload.error?e.payload.error:null;this.emit(i.POPUP.CLOSED,t?`Popup error: ${t}`:null),this.clear()}else e.type===i.POPUP.LOADED?(this.openTimeout&&clearTimeout(this.openTimeout),this.popupPromise&&this.popupPromise.resolve(),null===(r=this.iframeHandshakePromise)||void 0===r||r.promise.then((e=>{this.channel.postMessage({type:i.POPUP.INIT,payload:Object.assign(Object.assign({},e),{settings:this.settings})})}))):e.type!==i.POPUP.CANCEL_POPUP_REQUEST&&e.type!==i.UI.CLOSE_UI_WINDOW||this.clear(!1)}clear(e=!0){this.locked=!1,this.popupPromise=undefined,this.handshakePromise=(0,s.createDeferred)(),this.channel&&this.channel.disconnect(),this.requestTimeout&&(clearTimeout(this.requestTimeout),this.requestTimeout=undefined),this.openTimeout&&(clearTimeout(this.openTimeout),this.openTimeout=undefined),this.closeInterval&&(clearInterval(this.closeInterval),this.closeInterval=undefined),e&&this.extensionTabId&&(chrome.tabs.update(this.extensionTabId,{active:!0}),this.extensionTabId=0)}close(){if(this.popupWindow){if(this.logger.debug("closing popup"),"tab"===this.popupWindow.mode){let e=chrome.runtime.lastError;this.popupWindow.tab.id&&chrome.tabs.remove(this.popupWindow.tab.id,(()=>{e=chrome.runtime.lastError,e&&this.logger.error("closed with error",e)}))}else"window"===this.popupWindow.mode&&this.popupWindow.window.close();this.popupWindow=undefined}}async postMessage(e){var t,r;if(!this.popupWindow&&e.type!==i.UI.REQUEST_UI_WINDOW&&this.openTimeout)return this.clear(),void(0,a.showPopupRequest)(this.open.bind(this),(()=>{this.emit(i.POPUP.CLOSED)}));this.popupPromise&&await this.popupPromise.promise,"window"===(null===(t=this.popupWindow)||void 0===t?void 0:t.mode)?this.popupWindow.window.postMessage(e,this.origin):"tab"===(null===(r=this.popupWindow)||void 0===r?void 0:r.mode)&&this.channel.postMessage(e)}}r.PopupManager=d}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/popup/index.js"}],[1319,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.showPopupRequest=void 0;const n="TrezorConnectInteractionLayer",s=`\n    <div class="trezorconnect-container" id="${n}">\n        <div class="trezorconnect-window">\n            <div class="trezorconnect-head">\n                <svg class="trezorconnect-logo" x="0px" y="0px" viewBox="0 0 163.7 41.9" width="78px" height="20px" preserveAspectRatio="xMinYMin meet">\n                    <polygon points="101.1,12.8 118.2,12.8 118.2,17.3 108.9,29.9 118.2,29.9 118.2,35.2 101.1,35.2 101.1,30.7 110.4,18.1 101.1,18.1"/>\n                    <path d="M158.8,26.9c2.1-0.8,4.3-2.9,4.3-6.6c0-4.5-3.1-7.4-7.7-7.4h-10.5v22.3h5.8v-7.5h2.2l4.1,7.5h6.7L158.8,26.9z M154.7,22.5 h-4V18h4c1.5,0,2.5,0.9,2.5,2.2C157.2,21.6,156.2,22.5,154.7,22.5z"/>\n                    <path d="M130.8,12.5c-6.8,0-11.6,4.9-11.6,11.5s4.9,11.5,11.6,11.5s11.7-4.9,11.7-11.5S137.6,12.5,130.8,12.5z M130.8,30.3 c-3.4,0-5.7-2.6-5.7-6.3c0-3.8,2.3-6.3,5.7-6.3c3.4,0,5.8,2.6,5.8,6.3C136.6,27.7,134.2,30.3,130.8,30.3z"/>\n                    <polygon points="82.1,12.8 98.3,12.8 98.3,18 87.9,18 87.9,21.3 98,21.3 98,26.4 87.9,26.4 87.9,30 98.3,30 98.3,35.2 82.1,35.2 "/>\n                    <path d="M24.6,9.7C24.6,4.4,20,0,14.4,0S4.2,4.4,4.2,9.7v3.1H0v22.3h0l14.4,6.7l14.4-6.7h0V12.9h-4.2V9.7z M9.4,9.7 c0-2.5,2.2-4.5,5-4.5s5,2,5,4.5v3.1H9.4V9.7z M23,31.5l-8.6,4l-8.6-4V18.1H23V31.5z"/>\n                    <path d="M79.4,20.3c0-4.5-3.1-7.4-7.7-7.4H61.2v22.3H67v-7.5h2.2l4.1,7.5H80l-4.9-8.3C77.2,26.1,79.4,24,79.4,20.3z M71,22.5h-4V18 h4c1.5,0,2.5,0.9,2.5,2.2C73.5,21.6,72.5,22.5,71,22.5z"/>\n                    <polygon points="40.5,12.8 58.6,12.8 58.6,18.1 52.4,18.1 52.4,35.2 46.6,35.2 46.6,18.1 40.5,18.1 "/>\n                </svg>\n                <div class="trezorconnect-close">\n                    <svg x="0px" y="0px" viewBox="24 24 60 60" width="24px" height="24px" preserveAspectRatio="xMinYMin meet">\n                        <polygon class="st0" points="40,67.9 42.1,70 55,57.1 67.9,70 70,67.9 57.1,55 70,42.1 67.9,40 55,52.9 42.1,40 40,42.1 52.9,55 "/>\n                    </svg>\n                </div>\n            </div>\n            <div class="trezorconnect-body">\n                <h3>Popup was blocked</h3>\n                <p>Please click to "Continue" to open popup manually</p>\n                <button class="trezorconnect-open">Continue</button>\n            </div>\n        </div>\n    </div>\n`;r.showPopupRequest=(e,t)=>{if(document.getElementById(n))return;const r=document.createElement("div");r.id=n,r.className="trezorconnect-container",r.innerHTML=s,document.body&&document.body.appendChild(r);r.getElementsByClassName("trezorconnect-open")[0].onclick=()=>{e(),document.body&&document.body.removeChild(r)};r.getElementsByClassName("trezorconnect-close")[0].onclick=()=>{t(),document.body&&document.body.removeChild(r)}}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/popup/showPopupRequest.js"}],[132,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:13,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=13;try{const e=function(e){const t=e,{config:r}=t;r&&r.provider&&"testnet"===r.provider.type&&(t.config.provider.type="ropsten");return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #13${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/013.js"}],[1320,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.default=(e="",t)=>{const r=e||".trezor-webusb-button",n=document.querySelectorAll(r),s=`${t}?${Date.now()}`;n.forEach((e=>{if(e.getElementsByTagName("iframe").length<1){const t=e.getBoundingClientRect(),r=document.createElement("iframe");r.frameBorder="0",r.width=`${Math.round(t.width)}px`,r.height=`${Math.round(t.height)}px`,r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.style.zIndex="1",r.setAttribute("allow","usb"),r.setAttribute("scrolling","no"),r.src=s,e.append(r)}}))}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-web/lib/webusb/button.js"}],[133,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:14,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=14;try{const e=function(e){const t=e;return t.NetworkController={},t.NetworkController.provider=t.config.provider,delete t.config.provider,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #14${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/014.js"}],[134,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),s=e("lodash");r.default={version:15,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=15;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=r;t.TransactionController.transactions=e.map((e=>e.err?("Gave up submitting tx."===e.err.message&&(e.status=n.TransactionStatus.failed),e):e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #15${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/015.js"}],[135,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),s=e("lodash");r.default={version:16,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=16;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>e.err?("transaction with the same hash was already imported."===e.err&&(e.status=n.TransactionStatus.submitted,delete e.err),e):e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #16${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/016.js"}],[136,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),s=e("lodash");r.default={version:17,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=17;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(!e.status===n.TransactionStatus.failed||e.retryCount>0&&e.retryCount<2&&(e.status=n.TransactionStatus.submitted,delete e.err),e)))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #17${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/017.js"}],[137,{"fast-json-patch":3310,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("fast-json-patch"))&&n.__esModule?n:{default:n},i=e("lodash");r.default={version:18,migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=18;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>{if(!e.history||0===e.history.length){const t=function(e){const t={...e};return delete t.history,(0,i.cloneDeep)(t)}(e);return e.history=[t],e}const t=(r=e.history,r.map(((e,t)=>0===t?e:function(e,t,r){const n=s.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}(r[t-1],e)))).filter((e=>!Array.isArray(e)||e.length>0));var r;return e.history=t,e}))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #18${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/018.js"}],[138,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),s=e("lodash");r.default={version:19,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=19;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(((e,t,r)=>{if(e.status!==n.TransactionStatus.submitted)return e;const s=function(e){const t=e.map((e=>{const{nonce:t}=e.txParams;return parseInt(t||"0x0",16)}));return Math.max.apply(null,t)}(r.filter((e=>e.status===n.TransactionStatus.confirmed)).filter((t=>t.txParams.from===e.txParams.from)).filter((t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from))),i=function(e,t){const r=e.map((e=>{const{nonce:t}=e.txParams;return parseInt(t,16)}));let n=t;for(;r.includes(n);)n+=1;return n}(r.filter((e=>e.status===n.TransactionStatus.submitted)).filter((t=>t.txParams.from===e.txParams.from)).filter((t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from)),s),o=Math.max(i,s);return parseInt(e.txParams.nonce,16)>o+1&&(e.status=n.TransactionStatus.failed,e.err={message:"nonce too high",note:"migration 019 custom error"}),e}))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #19${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/019.js"}],[139,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:20,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=20;try{const e=function(e){const t=e;"metamask"in t&&!("firstTimeInfo"in t.metamask)&&(t.metamask.firstTimeInfo={version:"3.12.0",date:Date.now()});return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #20${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/020.js"}],[14,{"../../../shared/constants/app":4423,"../../../shared/constants/keyring":4431,"../../../shared/constants/metametrics":4434,"@metamask/base-controller":1157,"@metamask/message-manager":1460,events:3276,loglevel:3789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=d(e("events")),s=d(e("loglevel")),i=e("@metamask/message-manager"),o=e("@metamask/base-controller"),a=e("../../../shared/constants/metametrics"),l=e("../../../shared/constants/keyring"),c=e("../../../shared/constants/app");function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h={unapprovedEncryptionPublicKeyMsgs:{persist:!1,anonymous:!1},unapprovedEncryptionPublicKeyMsgCount:{persist:!1,anonymous:!1}};class p extends o.BaseController{constructor({messenger:e,getEncryptionPublicKey:t,getAccountKeyringType:r,getState:s,metricsEvent:o}){super({name:"EncryptionPublicKeyController",metadata:h,messenger:e,state:{unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}}),u(this,"hub",void 0),u(this,"_getEncryptionPublicKey",void 0),u(this,"_getAccountKeyringType",void 0),u(this,"_getState",void 0),u(this,"_encryptionPublicKeyManager",void 0),u(this,"_metricsEvent",void 0),this._getEncryptionPublicKey=t,this._getAccountKeyringType=r,this._getState=s,this._metricsEvent=o,this.hub=new n.default,this._encryptionPublicKeyManager=new i.EncryptionPublicKeyManager(undefined,undefined,undefined,["received"]),this._encryptionPublicKeyManager.hub.on("updateBadge",(()=>{this.hub.emit("updateBadge")})),this._encryptionPublicKeyManager.hub.on("unapprovedMessage",(e=>{this._requestApproval(e,"eth_getEncryptionPublicKey")})),this._subscribeToMessageState(this._encryptionPublicKeyManager,((e,t,r)=>{e.unapprovedEncryptionPublicKeyMsgs=t,e.unapprovedEncryptionPublicKeyMsgCount=r}))}get unapprovedMsgCount(){return this._encryptionPublicKeyManager.getUnapprovedMessagesCount()}resetState(){this.update((()=>({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0})))}async newRequestEncryptionPublicKey(e,t){switch(await this._getAccountKeyringType(e)){case l.KeyringType.ledger:return new Promise(((e,t)=>{t(new Error("Ledger does not support eth_getEncryptionPublicKey."))}));case l.KeyringType.trezor:return new Promise(((e,t)=>{t(new Error("Trezor does not support eth_getEncryptionPublicKey."))}));case l.KeyringType.lattice:return new Promise(((e,t)=>{t(new Error("Lattice does not support eth_getEncryptionPublicKey."))}));case l.KeyringType.qr:return Promise.reject(new Error("QR hardware does not support eth_getEncryptionPublicKey."));default:return this._encryptionPublicKeyManager.addUnapprovedMessageAsync({from:e},t)}}async encryptionPublicKey(e){s.default.info("MetaMaskController - encryptionPublicKey");const t=e.metamaskId;try{const r=await this._encryptionPublicKeyManager.approveMessage(e),n=await this._getEncryptionPublicKey(r.from);return this._encryptionPublicKeyManager.setMessageStatusAndResult(t,n,"received"),this._acceptApproval(t),this._getState()}catch(e){throw s.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",e),this._cancelAbstractMessage(this._encryptionPublicKeyManager,t),e}}cancelEncryptionPublicKey(e){return this._cancelAbstractMessage(this._encryptionPublicKeyManager,e)}rejectUnapproved(e){Object.keys(this._encryptionPublicKeyManager.getUnapprovedMessages()).forEach((t=>{this._cancelAbstractMessage(this._encryptionPublicKeyManager,t,e)}))}clearUnapproved(){this._encryptionPublicKeyManager.update({unapprovedMessages:{},unapprovedMessagesCount:0})}_cancelAbstractMessage(e,t,r){return r&&this._metricsEvent({event:r,category:a.MetaMetricsEventCategory.Messages,properties:{action:"Encryption public key Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe((e=>{const r=this._migrateMessages(e.unapprovedMessages);this.update((n=>{t(n,r,e.unapprovedMessagesCount)}))}))}_migrateMessages(e){const t={};for(const r of Object.keys(e)){const n=e[r],s=this._migrateMessage(n);t[r]=s}return t}_migrateMessage(e){const{messageParams:t,...r}=e;return{...r,rawSig:e.rawSig,msgParams:t.from,origin:t.origin}}_requestApproval(e,t){const r=e.metamaskId,n=e.origin||c.ORIGIN_METAMASK;this.messagingSystem.call("ApprovalController:addRequest",{id:r,origin:n,type:t},!0).catch((()=>{}))}_acceptApproval(e){this.messagingSystem.call("ApprovalController:acceptRequest",e)}_rejectApproval(e){this.messagingSystem.call("ApprovalController:rejectRequest",e,"Cancel")}}r.default=p}}},{package:"$root$",file:"app/scripts/controllers/encryption-public-key.ts"}],[140,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:21,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=21;try{const e=function(e){const t=e;return delete t.BlacklistController,delete t.RecentBlocks,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #21${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/021.js"}],[141,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/transaction-controller"),s=e("lodash");r.default={version:22,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=22;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(e.status!==n.TransactionStatus.submitted||e.submittedTime||(e.submittedTime=(new Date).getTime()),e)))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #22${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/022.js"}],[142,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),s=e("@metamask/transaction-controller");r.default={version:23,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=23;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;if(e.length<=40)return t;const r=e.reverse();let n=!0;for(;r.length>40&&n;){const e=r.findIndex((e=>e.status===s.TransactionStatus.failed||e.status===s.TransactionStatus.rejected||e.status===s.TransactionStatus.confirmed||e.status===s.TransactionStatus.dropped));e<0?n=!1:r.splice(e,1)}t.TransactionController.transactions=r.reverse()}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #23${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/023.js"}],[143,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),s=e("@metamask/transaction-controller");r.default={version:24,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=24;const r=function(e){const t=e;if(!t.TransactionController)return t;const{transactions:r}=t.TransactionController;return t.TransactionController.transactions=r.map(((e,t)=>(e.status===s.TransactionStatus.unapproved&&e.txParams&&e.txParams.from&&(e.txParams.from=e.txParams.from.toLowerCase()),e))),t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/024.js"}],[1438,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e=>(e.GenericLog="GenericLog",e.EthSignLog="EthSignLog",e))(n||{});r.LogType=n}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/chunk-B6ES7RHK.js"}],[1439,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/chunk-JUURNM6C.js"}],[144,{"../lib/util":119,"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),s=e("@metamask/transaction-controller"),i=e("../lib/util");r.default={version:25,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=25;const r=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(e.status!==s.TransactionStatus.unapproved||(e.txParams=function(e){const t={from:e=>(0,i.addHexPrefix)(e).toLowerCase(),to:()=>(0,i.addHexPrefix)(e.to).toLowerCase(),nonce:e=>(0,i.addHexPrefix)(e),value:e=>(0,i.addHexPrefix)(e),data:e=>(0,i.addHexPrefix)(e),gas:e=>(0,i.addHexPrefix)(e),gasPrice:e=>(0,i.addHexPrefix)(e)},r={};return Object.keys(t).forEach((n=>{e[n]&&(r[n]=t[n](e[n]))})),r}(e.txParams)),e)))}return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/025.js"}],[1440,{"./chunk-UJIPPGP6.js":1443,"@metamask/base-controller":1450,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i=e("./chunk-UJIPPGP6.js"),o=e("@metamask/base-controller"),a=e("uuid"),l="LoggingController",c={logs:{persist:!0,anonymous:!1}},d={logs:{}},u=class extends o.BaseController{constructor({messenger:e,state:t}){super({name:l,metadata:c,messenger:e,state:{...d,...t}}),i.__privateAdd.call(void 0,this,n),this.messagingSystem.registerActionHandler(`${l}:add`,(e=>this.add(e)))}add(e){const t={id:i.__privateMethod.call(void 0,this,n,s).call(this),timestamp:Date.now(),log:e};this.update((e=>{e.logs[t.id]=t}))}clear(){this.update((e=>{e.logs={}}))}};n=new WeakSet,s=function(){let e=a.v1.call(void 0);for(;e in this.state.logs;)e=a.v1.call(void 0);return e},r.LoggingController=u}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/chunk-LZJQW27Y.js"}],[1441,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/chunk-PMCRFQY3.js"}],[1442,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e=>(e.EthSign="eth_sign",e.PersonalSign="personal_sign",e.EthSignTypedData="eth_signTypedData",e.EthSignTypedDataV3="eth_signTypedData_v3",e.EthSignTypedDataV4="eth_signTypedData_v4",e))(n||{}),s=(e=>(e.Proposed="proposed",e.Rejected="rejected",e.Signed="signed",e))(s||{});r.SigningMethod=n,r.SigningStage=s}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/chunk-PUIX5TCG.js"}],[1443,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateMethod=(e,t,r)=>(((e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)})(e,t,"access private method"),r)}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/chunk-UJIPPGP6.js"}],[1444,{"./chunk-B6ES7RHK.js":1438,"./chunk-JUURNM6C.js":1439,"./chunk-LZJQW27Y.js":1440,"./chunk-PMCRFQY3.js":1441,"./chunk-PUIX5TCG.js":1442,"./chunk-UJIPPGP6.js":1443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-LZJQW27Y.js");e("./chunk-PMCRFQY3.js");var s=e("./chunk-PUIX5TCG.js");e("./chunk-JUURNM6C.js");var i=e("./chunk-B6ES7RHK.js");e("./chunk-UJIPPGP6.js"),r.LogType=i.LogType,r.LoggingController=n.LoggingController,r.SigningMethod=s.SigningMethod,r.SigningStage=s.SigningStage}}},{package:"@metamask/logging-controller",file:"node_modules/@metamask/logging-controller/dist/index.js"}],[1445,{"./chunk-UJFCPTF3.js":1447,"./chunk-Z4BLTVTB.js":1448},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,o,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,n).delete(e)}clearActions(){l.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,i).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=l.__privateGet.call(void 0,this,o).get(e),s=n(...t);s!==r&&(l.__privateGet.call(void 0,this,o).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=l.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,l.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=l.__privateGet.call(void 0,this,i).get(e);if(n){const e=r(...n());l.__privateGet.call(void 0,this,o).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,o).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/logging-controller>@metamask/base-controller",file:"node_modules/@metamask/logging-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1446,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/logging-controller>@metamask/base-controller",file:"node_modules/@metamask/logging-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1447,{"./chunk-Z4BLTVTB.js":1448},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,i,o,a,l,c,d,u,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakSet,l=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,d=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,u,h).call(this,e)||null!==t&&t.includes(e)},u=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,u),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,i,r),p.__privateSet.call(void 0,this,o,l)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,c,d).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,u,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/logging-controller>@metamask/base-controller",file:"node_modules/@metamask/logging-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1448,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/logging-controller>@metamask/base-controller",file:"node_modules/@metamask/logging-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1449,{"./chunk-Z4BLTVTB.js":1448,immer:3587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),i=e("immer");i.enablePatches.call(void 0);function o(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const i=t[s];if(!i)throw new Error(`No metadata found for '${String(s)}'`);const o=i[r],a=e[s];return"function"==typeof o?n[s]=o(a):o&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:o}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,i.freeze.call(void 0,o,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,o]=i.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:o}}applyPatches(e){const t=i.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},r.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/logging-controller>@metamask/base-controller",file:"node_modules/@metamask/logging-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[145,{lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:26,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=26;try{const e=t.data;t.data=function(e){if(!e.KeyringController||!e.PreferencesController)return e;if(!e.KeyringController.walletNicknames)return e;return e.PreferencesController.identities=Object.keys(e.KeyringController.walletNicknames).reduce(((t,r)=>(t[r]={name:e.KeyringController.walletNicknames[r],address:r},t)),{}),delete e.KeyringController.walletNicknames,e}(e)}catch(e){return console.warn(`MetaMask Migration #26${e.stack}`),Promise.reject(e)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/026.js"}],[1450,{"./chunk-G42723LG.js":1445,"./chunk-NINOM2XQ.js":1446,"./chunk-UJFCPTF3.js":1447,"./chunk-Z4BLTVTB.js":1448,"./chunk-ZNOPSWMU.js":1449},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-NINOM2XQ.js"),s=e("./chunk-ZNOPSWMU.js"),i=e("./chunk-G42723LG.js"),o=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=i.ControllerMessenger,r.RestrictedControllerMessenger=o.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/logging-controller>@metamask/base-controller",file:"node_modules/@metamask/logging-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1454,{"@metamask/base-controller":1157,events:3276},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractMessageManager=void 0;const i=e("@metamask/base-controller"),o=e("events");class a extends i.BaseControllerV1{constructor(e,t,r,n,s){super(e,t),this.hub=new o.EventEmitter,this.name="AbstractMessageManager",this.defaultState={unapprovedMessages:{},unapprovedMessagesCount:0},this.messages=[],this.securityProviderRequest=r,this.additionalFinishStatuses=null!=n?n:[],this.getCurrentChainId=s,this.initialize()}saveMessageList(e=!0){const t=this.getUnapprovedMessages(),r=this.getUnapprovedMessagesCount();this.update({unapprovedMessages:t,unapprovedMessagesCount:r}),e&&this.hub.emit("updateBadge")}setMessageStatus(e,t){const r=this.getMessage(e);if(!r)throw new Error(`${this.name}: Message not found for id: ${e}.`);r.status=t,this.updateMessage(r),this.hub.emit(`${e}:${t}`,r),("rejected"===t||"signed"===t||"errored"===t||this.additionalFinishStatuses.includes(t))&&this.hub.emit(`${e}:finished`,r)}updateMessage(e,t=!0){const r=this.messages.findIndex((t=>e.id===t.id));-1!==r&&(this.messages[r]=e),this.saveMessageList(t)}securityCheck(e){return n(this,void 0,void 0,(function*(){if(this.securityProviderRequest){const t=yield this.securityProviderRequest(e,e.type);return Object.assign(Object.assign({},e),{securityProviderResponse:t})}return e}))}getUnapprovedMessagesCount(){return Object.keys(this.getUnapprovedMessages()).length}getUnapprovedMessages(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addMessage(e){return n(this,void 0,void 0,(function*(){const t=yield this.securityCheck(e);this.messages.push(t),this.saveMessageList()}))}getMessage(e){return this.messages.find((t=>t.id===e))}getAllMessages(){return this.messages}approveMessage(e){return this.setMessageStatusApproved(e.metamaskId),this.prepMessageForSigning(e)}setMessageStatusApproved(e){this.setMessageStatus(e,"approved")}setMessageStatusInProgress(e){this.setMessageStatus(e,"inProgress")}setMessageStatusSigned(e,t){this.setMessageStatusAndResult(e,t,"signed")}setMessageStatusAndResult(e,t,r){this.setResult(e,t),this.setMessageStatus(e,r)}setResult(e,t){const r=this.getMessage(e);r&&(r.rawSig=t,this.updateMessage(r,!1))}setMetadata(e,t){const r=this.getMessage(e);if(!r)throw new Error(`${this.name}: Message not found for id: ${e}.`);r.metadata=t,this.updateMessage(r,!1)}rejectMessage(e){this.setMessageStatus(e,"rejected")}waitForFinishStatus(e,t){return n(this,void 0,void 0,(function*(){const{metamaskId:r}=e,n=s(e,["metamaskId"]);return new Promise(((e,s)=>{this.hub.once(`${r}:finished`,(r=>{switch(r.status){case"signed":return e(r.rawSig);case"rejected":return s(new Error(`MetaMask ${t} Signature: User denied message signature.`));case"errored":return s(new Error(`MetaMask ${t} Signature: ${r.error}`));default:return s(new Error(`MetaMask ${t} Signature: Unknown problem: ${JSON.stringify(n)}`))}}))}))}))}}r.AbstractMessageManager=a,r.default=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/AbstractMessageManager.js"}],[1455,{"./AbstractMessageManager":1454,"./utils":1461,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.DecryptMessageManager=void 0;const s=e("uuid"),i=e("./AbstractMessageManager"),o=e("./utils");class a extends i.AbstractMessageManager{constructor(){super(...arguments),this.name="DecryptMessageManager"}addUnapprovedMessageAsync(e,t){return n(this,void 0,void 0,(function*(){(0,o.validateDecryptedMessageData)(e);const r=yield this.addUnapprovedMessage(e,t);return new Promise(((t,n)=>{this.hub.once(`${r}:finished`,(r=>{switch(r.status){case"decrypted":return t(r.rawSig);case"rejected":return n(new Error("MetaMask DecryptMessage: User denied message decryption."));case"errored":return n(new Error("MetaMask DecryptMessage: This message cannot be decrypted."));default:return n(new Error(`MetaMask DecryptMessage: Unknown problem: ${JSON.stringify(e)}`))}}))}))}))}addUnapprovedMessage(e,t){return n(this,void 0,void 0,(function*(){t&&(e.origin=t.origin),e.data=(0,o.normalizeMessageData)(e.data);const r=(0,s.v1)(),n={id:r,messageParams:e,status:"unapproved",time:Date.now(),type:"eth_decrypt"};return yield this.addMessage(n),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{metamaskId:r})),r}))}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}r.DecryptMessageManager=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/DecryptMessageManager.js"}],[1456,{"./AbstractMessageManager":1454,"./utils":1461,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.EncryptionPublicKeyManager=void 0;const s=e("uuid"),i=e("./AbstractMessageManager"),o=e("./utils");class a extends i.AbstractMessageManager{constructor(){super(...arguments),this.name="EncryptionPublicKeyManager"}addUnapprovedMessageAsync(e,t){return n(this,void 0,void 0,(function*(){(0,o.validateEncryptionPublicKeyMessageData)(e);const r=yield this.addUnapprovedMessage(e,t);return new Promise(((t,n)=>{this.hub.once(`${r}:finished`,(r=>{switch(r.status){case"received":return t(r.rawSig);case"rejected":return n(new Error("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:return n(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}}))}))}))}addUnapprovedMessage(e,t){return n(this,void 0,void 0,(function*(){t&&(e.origin=t.origin);const r=(0,s.v1)(),n={id:r,messageParams:e,status:"unapproved",time:Date.now(),type:"eth_getEncryptionPublicKey"};return yield this.addMessage(n),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{metamaskId:r})),r}))}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve({from:e.data})}}r.EncryptionPublicKeyManager=a,r.default=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/EncryptionPublicKeyManager.js"}],[1457,{"./AbstractMessageManager":1454,"./utils":1461,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};Object.defineProperty(r,"__esModule",{value:!0}),r.MessageManager=void 0;const i=e("uuid"),o=e("./AbstractMessageManager"),a=e("./utils");class l extends o.AbstractMessageManager{constructor(){super(...arguments),this.name="MessageManager"}addUnapprovedMessage(e,t){return n(this,void 0,void 0,(function*(){(0,a.validateSignMessageData)(e),t&&(e.origin=t.origin),e.data=(0,a.normalizeMessageData)(e.data);const r=(0,i.v1)(),n={id:r,messageParams:e,securityAlertResponse:null==t?void 0:t.securityAlertResponse,status:"unapproved",time:Date.now(),type:"eth_sign"};return yield this.addMessage(n),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},e),{metamaskId:r})),r}))}prepMessageForSigning(e){const{metamaskId:t}=e,r=s(e,["metamaskId"]);return Promise.resolve(r)}}r.MessageManager=l,r.default=l}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/MessageManager.js"}],[1458,{"./AbstractMessageManager":1454,"./utils":1461,"@metamask/controller-utils":1463,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};Object.defineProperty(r,"__esModule",{value:!0}),r.PersonalMessageManager=void 0;const i=e("@metamask/controller-utils"),o=e("uuid"),a=e("./AbstractMessageManager"),l=e("./utils");class c extends a.AbstractMessageManager{constructor(){super(...arguments),this.name="PersonalMessageManager"}addUnapprovedMessage(e,t){return n(this,void 0,void 0,(function*(){(0,l.validateSignMessageData)(e),t&&(e.origin=t.origin),e.data=(0,l.normalizeMessageData)(e.data);const r=(0,i.detectSIWE)(e),n=Object.assign(Object.assign({},e),{siwe:r}),s=(0,o.v1)(),a={id:s,messageParams:n,securityAlertResponse:null==t?void 0:t.securityAlertResponse,status:"unapproved",time:Date.now(),type:"personal_sign"};return yield this.addMessage(a),this.hub.emit("unapprovedMessage",Object.assign(Object.assign({},n),{metamaskId:s})),s}))}prepMessageForSigning(e){const{metamaskId:t}=e,r=s(e,["metamaskId"]);return Promise.resolve(r)}}r.PersonalMessageManager=c,r.default=c}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/PersonalMessageManager.js"}],[1459,{"./AbstractMessageManager":1454,"./utils":1461,uuid:4354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};Object.defineProperty(r,"__esModule",{value:!0}),r.TypedMessageManager=void 0;const i=e("uuid"),o=e("./AbstractMessageManager"),a=e("./utils");class l extends o.AbstractMessageManager{constructor(){super(...arguments),this.name="TypedMessageManager"}addUnapprovedMessage(e,t,r){var s;return n(this,void 0,void 0,(function*(){if("V1"===r&&(0,a.validateTypedSignMessageDataV1)(e),"V3"===r||"V4"===r){const t=null===(s=this.getCurrentChainId)||void 0===s?void 0:s.call(this);(0,a.validateTypedSignMessageDataV3V4)(e,t)}"string"==typeof e.data||"V3"!==r&&"V4"!==r||(e.data=JSON.stringify(e.data));const n=(0,i.v1)(),o=Object.assign(Object.assign({},e),{metamaskId:n,version:r});t&&(e.origin=t.origin);const l={id:n,messageParams:e,securityAlertResponse:null==t?void 0:t.securityAlertResponse,status:"unapproved",time:Date.now(),type:"eth_signTypedData"};return yield this.addMessage(l),this.hub.emit("unapprovedMessage",o),n}))}setMessageStatusErrored(e,t){const r=this.getMessage(e);r&&(r.error=t,this.updateMessage(r),this.setMessageStatus(e,"errored"))}prepMessageForSigning(e){const{metamaskId:t,version:r}=e,n=s(e,["metamaskId","version"]);return Promise.resolve(n)}}r.TypedMessageManager=l,r.default=l}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/TypedMessageManager.js"}],[146,{"@metamask/transaction-controller":2189,lodash:3783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),s=e("@metamask/transaction-controller");r.default={version:27,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=27;const r=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.filter((e=>e.status!==s.TransactionStatus.rejected))}return t}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/027.js"}],[1460,{"./AbstractMessageManager":1454,"./DecryptMessageManager":1455,"./EncryptionPublicKeyManager":1456,"./MessageManager":1457,"./PersonalMessageManager":1458,"./TypedMessageManager":1459},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./AbstractMessageManager"),r),s(e("./MessageManager"),r),s(e("./PersonalMessageManager"),r),s(e("./TypedMessageManager"),r),s(e("./EncryptionPublicKeyManager"),r),s(e("./DecryptMessageManager"),r)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/index.js"}],[1461,{"@metamask/controller-utils":1463,"@metamask/eth-sig-util":1273,"@metamask/utils":2255,buffer:2983,jsonschema:3636},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.validateDecryptedMessageData=r.validateEncryptionPublicKeyMessageData=r.validateTypedSignMessageDataV3V4=r.validateTypedSignMessageDataV1=r.validateSignMessageData=r.normalizeMessageData=void 0;const n=e("@metamask/controller-utils"),s=e("@metamask/eth-sig-util"),i=e("@metamask/utils"),o=e("jsonschema"),a=/^[0-9A-Fa-f]+$/gu;function l(e,t){if(!e||"string"!=typeof e||!(0,n.isValidHexAddress)(e))throw new Error(`Invalid "${t}" address: ${e} must be a valid string.`)}r.normalizeMessageData=function(e){try{const t=(0,i.remove0x)(e);if(t.match(a))return(0,i.add0x)(t)}catch(e){}return(0,i.bytesToHex)(t.from(e,"utf8"))},r.validateSignMessageData=function(e){const{from:t,data:r}=e;if(l(t,"from"),!r||"string"!=typeof r)throw new Error(`Invalid message "data": ${r} must be a valid string.`)},r.validateTypedSignMessageDataV1=function(e){if(l(e.from,"from"),!e.data||!Array.isArray(e.data))throw new Error(`Invalid message "data": ${e.data} must be a valid array.`);try{(0,s.typedSignatureHash)(e.data)}catch(e){throw new Error("Expected EIP712 typed data.")}},r.validateTypedSignMessageDataV3V4=function(e,t){if(l(e.from,"from"),!e.data||Array.isArray(e.data)||"object"!=typeof e.data&&"string"!=typeof e.data)throw new Error('Invalid message "data": Must be a valid string or object.');let r;if("object"==typeof e.data)r=e.data;else try{r=JSON.parse(e.data)}catch(e){throw new Error("Data must be passed as a valid JSON string.")}if((0,o.validate)(r,s.TYPED_MESSAGE_SCHEMA).errors.length>0)throw new Error("Data must conform to EIP-712 schema. See https://git.io/fNtcx.");if(!t)throw new Error("Current chainId cannot be null or undefined.");let{chainId:n}=r.domain;if(n){"string"==typeof n&&(n=parseInt(n,n.startsWith("0x")?16:10));const e=parseInt(t,16);if(Number.isNaN(e))throw new Error(`Cannot sign messages for chainId "${n}", because MetaMask is switching networks.`);if(n!==e)throw new Error(`Provided chainId "${n}" must match the active chainId "${e}"`)}},r.validateEncryptionPublicKeyMessageData=function(e){const{from:t}=e;l(t,"from")},r.validateDecryptedMessageData=function(e){const{from:t}=e;l(t,"from")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/utils.js"}],[1462,{"./types":1466},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=r.ApprovalType=r.ORIGIN_METAMASK=r.OPENSEA_PROXY_URL=r.BUILT_IN_NETWORKS=r.TESTNET_TICKER_SYMBOLS=r.ASSET_TYPES=r.GWEI=r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=r.ERC1155_METADATA_URI_INTERFACE_ID=r.ERC1155_INTERFACE_ID=r.ERC721_ENUMERABLE_INTERFACE_ID=r.ERC721_METADATA_INTERFACE_ID=r.ERC721_INTERFACE_ID=r.ERC20=r.ERC1155=r.ERC721=r.MAX_SAFE_CHAIN_ID=r.GANACHE_CHAIN_ID=r.IPFS_DEFAULT_GATEWAY_URL=r.FALL_BACK_VS_CURRENCY=r.RPC=void 0;const n=e("./types");r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH"},r.BUILT_IN_NETWORKS={[n.NetworkType.goerli]:{chainId:n.ChainId.goerli,ticker:n.NetworksTicker.goerli,rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.goerli}.etherscan.io`}},[n.NetworkType.sepolia]:{chainId:n.ChainId.sepolia,ticker:n.NetworksTicker.sepolia,rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.sepolia}.etherscan.io`}},[n.NetworkType.mainnet]:{chainId:n.ChainId.mainnet,ticker:n.NetworksTicker.mainnet,rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[n.NetworkType["linea-goerli"]]:{chainId:n.ChainId["linea-goerli"],ticker:n.NetworksTicker["linea-goerli"],rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[n.NetworkType["linea-mainnet"]]:{chainId:n.ChainId["linea-mainnet"],ticker:n.NetworksTicker["linea-mainnet"],rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[n.NetworkType.rpc]:{chainId:undefined,blockExplorerUrl:undefined,ticker:undefined,rpcPrefs:undefined}},r.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v2",r.ORIGIN_METAMASK="metamask",function(e){e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset"}(r.ApprovalType||(r.ApprovalType={})),r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP={[n.ChainId.goerli]:n.BuiltInNetworkName.Goerli,[n.ChainId.sepolia]:n.BuiltInNetworkName.Sepolia,[n.ChainId.mainnet]:n.BuiltInNetworkName.Mainnet,[n.ChainId["linea-goerli"]]:n.BuiltInNetworkName.LineaGoerli,[n.ChainId["linea-mainnet"]]:n.BuiltInNetworkName.LineaMainnet,[n.ChainId.aurora]:n.BuiltInNetworkName.Aurora}}}},{package:"@metamask/message-manager>@metamask/controller-utils",file:"node_modules/@metamask/message-manager/node_modules/@metamask/controller-utils/dist/constants.js"}],[1463,{"./constants":1462,"./siwe":1465,"./types":1466,"./util":1467},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./constants"),r),s(e("./util"),r),s(e("./types"),r),s(e("./siwe"),r)}}},{package:"@metamask/message-manager>@metamask/controller-utils",file:"node_modules/@metamask/message-manager/node_modules/@metamask/controller-utils/dist/index.js"}],[1464,{"@metamask/utils":2255},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("controller-utils")}}},{package:"@metamask/message-manager>@metamask/controller-utils",file:"node_modules/@metamask/message-manager/node_modules/@metamask/controller-utils/dist/logger.js"}],[1465,{"./logger":1464,"@metamask/utils":2255,"@spruceid/siwe-parser":2481,buffer:2983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.detectSIWE=r.isValidSIWEOrigin=r.parseDomainParts=void 0;const n=e("@metamask/utils"),s=e("@spruceid/siwe-parser"),i=e("./logger"),o=(0,i.createModuleLogger)(i.projectLogger,"detect-siwe");function a(e){try{const s="string"!=typeof(r=e)?r:(0,n.remove0x)(r),i=t.from(s,"hex");return 32===i.length?e:i.toString("utf8")}catch(t){return o(t),e}var r}const l={"http:":"80","https:":"443"};r.parseDomainParts=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.isValidSIWEOrigin=e=>{var t;try{const{origin:n,siwe:s}=e;if(!n||!(null===(t=null==s?void 0:s.parsedMessage)||void 0===t?void 0:t.domain))return!1;const i=new URL(n),o=(0,r.parseDomainParts)(s.parsedMessage.domain,i.protocol);return 0===o.hostname.localeCompare(i.hostname,undefined,{sensitivity:"accent"})&&(""!==o.port&&o.port!==i.port?""===i.port&&o.port===l[i.protocol]:""===o.username||o.username===i.username)}catch(e){return o(e),!1}};r.detectSIWE=e=>{try{const{data:t}=e,r=a(t);return{isSIWEMessage:!0,parsedMessage:new s.ParsedMessage(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/message-manager>@metamask/controller-utils",file:"node_modules/@metamask/message-manager/node_modules/@metamask/controller-utils/dist/siwe.js"}],[1466,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n;Object.defineProperty(r,"__esModule",{value:!0}),r.NetworksTicker=r.ChainId=r.BuiltInNetworkName=r.isInfuraNetworkType=r.isNetworkType=r.NetworkType=r.InfuraNetworkType=void 0,r.InfuraNetworkType={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-mainnet":"linea-mainnet"},r.NetworkType=Object.assign(Object.assign({},r.InfuraNetworkType),{rpc:"rpc"}),r.isNetworkType=function(e){return Object.values(r.NetworkType).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(r.InfuraNetworkType).includes(e)},function(e){e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaMainnet="linea-mainnet",e.Aurora="aurora"}(n=r.BuiltInNetworkName||(r.BuiltInNetworkName={})),r.ChainId={[n.Mainnet]:"0x1",[n.Goerli]:"0x5",[n.Sepolia]:"0xaa36a7",[n.Aurora]:"0x4e454152",[n.LineaGoerli]:"0xe704",[n.LineaMainnet]:"0xe708"},function(e){e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc=""}(r.NetworksTicker||(r.NetworksTicker={}))}}},{package:"@metamask/message-manager>@metamask/controller-utils",file:"node_modules/@metamask/message-manager/node_modules/@metamask/controller-utils/dist/types.js"}]],[],{});